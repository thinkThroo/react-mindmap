{"version":3,"sources":["../node_modules/@blink-mind/plugin-simple-text-editor/node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/plugin-simple-text-editor/lib/main.es.js","../../src/topic-reference/utils.ts","../../src/topic-reference/add-reference-topic-panel.tsx","../../src/topic-reference/ext-data-reference.ts","../../src/topic-reference/op-function.ts","../../src/topic-reference/reference-topic-thumbnail.tsx","../../src/topic-reference/reference-topic-list.tsx","../../src/topic-reference/topic-ext-reference.tsx","../../src/topic-reference/topic-reference-checkbox.tsx","../../src/search/search-panel.tsx","../../src/search/utils.ts","../../src/search/search-plugin.tsx","../../src/topic-reference/topic-reference-plugin.tsx","../node_modules/@blink-mind/icons/index.js","../node_modules/@blink-mind/renderer-react/lib/main.es.js","../../src/components/common/base-widget.tsx","../../src/components/common/drag-scroll-widget.tsx","../../src/components/common/save-ref.tsx","../../src/components/common/styled.tsx","../../src/plugins/event.ts","../../src/utils/icon.tsx","../../src/utils/keys.ts","../../src/utils/events.ts","../../src/utils/file.ts","../../src/utils/css.ts","../../src/utils/index.ts","../../src/plugins/hotkey.ts","../../src/plugins/operation.ts","../../src/plugins/react/components/topic-context-menu.tsx","../../src/plugins/react/context-menu.tsx","../../src/plugins/react/components/topic-drop-effect.tsx","../../src/plugins/react/drag-and-drop.tsx","../../src/plugins/react/components/editor-root-breadcrumbs.tsx","../../src/plugins/react/components/mind-drag-scroll-widget.tsx","../../src/plugins/react/components/modals.tsx","../../src/plugins/react/components/root-sublinks.tsx","../../src/plugins/react/components/root-widget.tsx","../../src/plugins/react/components/topic-collapse-icon.tsx","../../src/plugins/react/components/topic-content.tsx","../../src/plugins/react/components/topic-content-widget.tsx","../../src/plugins/react/components/topic-desc.tsx","../../src/plugins/react/components/topic-highlight.tsx","../../src/plugins/react/components/topic-sub-links.tsx","../../src/plugins/react/components/topic-widget.tsx","../../src/plugins/react/components/view-port-util/view-port-viewer.tsx","../../src/plugins/react/drawer.tsx","../../src/plugins/react/theme.tsx","../../src/plugins/react/rendering.tsx","../../src/plugins/react/components/right-top-panel/right-top-panel.tsx","../../src/plugins/react/components/right-top-panel/styled.tsx","../../src/plugins/react/components/right-top-panel/components.tsx","../../src/plugins/react/components/style-editor/border-style-editor.tsx","../../src/plugins/react/components/style-editor/link-style-editor.tsx","../../src/plugins/react/components/style-editor/text-style-editor.tsx","../../src/plugins/react/components/style-editor/style-editor.tsx","../../src/plugins/react/components/style-editor/clear-all-custom-style.tsx","../../src/plugins/react/components/style-editor/padding-style-editor.tsx","../../src/plugins/react/components/theme-editor/topic-theme-editor.tsx","../../src/plugins/react/components/theme-editor/theme-editor.tsx","../../src/utils/blueprint.ts","../../src/plugins/react/right-top-panel-plugin.tsx","../../src/plugins/react/utils.tsx","../../src/plugins/style.ts","../../src/plugins/index.ts","../../src/plugins/react/index.ts","../../src/plugins/layout.tsx","../../src/plugins/get-value.ts","../../src/components/diagram.tsx","../../src/components/rich-text-editor.tsx","../../src/components/topic-desc-editor.tsx","../../src/markdown-serializer.ts","../../src/rich-text-editor-plugin.tsx","../../src/json-serializer-plugin.ts","../../src/themes/theme-random-color-square.ts","../../src/themes/theme1.ts","../../src/themes/theme2.ts","../../src/themes/theme3.ts","../../src/themes/theme4.ts","../../src/theme-selector-plugin.ts","../../src/topic-block-topology.tsx","../../src/utils.ts","../../src/tools-config.ts","../../src/topology-diagram.tsx","../../src/topology-diagram-utils.tsx","../../src/topology-drawer.tsx","../../src/plugin.tsx","views/workspaces/workspace/map/images/default.jpg","views/workspaces/workspace/map/images/theme1.jpg","views/workspaces/workspace/map/images/theme2.jpg","views/workspaces/workspace/map/images/theme3.jpg","views/workspaces/workspace/map/images/theme4.jpg","../node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/icons/iconfont/topology/index.js","../../src/controller.ts","../../src/types/index.ts","../../src/plugins/core.ts","../../src/models/block.ts","../../src/models/topic.ts","../../src/models/utils/index.ts","../../src/models/modifiers/modifiers.ts","../../src/configs/theme/default-theme.ts","../../src/models/config.ts","../../src/models/model.ts","../../src/configs/theme/types.ts","utils/config.js","services/workspace.js","store/actions/workspace.js","store/action-types/workspace.js","models/index.js","utils/project.js","services/dashboard.js","models/title.js","services/project.js","store/actions/projects.js","views/fragments/workspace-dd/index.js","views/fragments/header.js","views/fragments/edit-dropdowns/label-dd.js","store/actions/label.js","store/actions/status.js","views/dashboard/body/sidebar/index.js","views/fragments/checkbox/index.js","views/dashboard/body/list/modal.js","views/dashboard/body/list/index.js","services/analyse.js","views/fragments/select.js","views/project/edit/edit.js","views/dashboard/body/index.js","views/dashboard/index.js","views/project/common/header/index.js","views/project/common/sidebar/index.js","views/workspaces/workspace/map/component/toolbar/toolbar-item-open.js","views/workspaces/workspace/map/component/toolbar/toolbar-item-layout.js","views/workspaces/workspace/map/component/toolbar/toolbar-item-theme.js","views/workspaces/workspace/map/component/toolbar/toolbar-item-export.js","views/workspaces/workspace/map/utils/index.js","../node_modules/@blink-mind/plugins/lib/main.es.js","views/workspaces/workspace/map/component/toolbar/toolbar-item-search.js","views/workspaces/workspace/map/component/toolbar/toolbar.js","views/workspaces/workspace/map/component/mindmap.js","views/project/edit/index.js","views/project/reminders/notify.js","views/project/reminders/index.js","views/project/assess/index.js","views/roadmap/components/Gantt/Gantt.js","views/roadmap/components/Gantt/index.js","views/roadmap/components/Toolbar/Toolbar.js","views/roadmap/components/Toolbar/index.js","views/roadmap/components/MessageArea/MessageArea.js","views/roadmap/index.js","views/project/index.js","views/login/index.js","services/user.js","views/workspaces/dashboard/index.js","views/workspaces/workspace/index.js","App.js","serviceWorker.js","store/reducers/add-task.js","store/reducers/events.js","store/reducers/filter.js","store/reducers/notes.js","store/reducers/sidebar.js","store/reducers/projects.js","store/reducers/edit-project.js","store/reducers/workspace.js","store/reducers/project-modal.js","store/action-types/project-modal.js","store/reducers/index.js","store/index.js","index.js","views/workspaces/workspace/map/packages/core/node_modules/is-plain-object/index.js","views/workspaces/workspace/map/packages/core/node_modules/isobject/index.js"],"names":["DiagramLayoutType","BlockType","FocusMode","OpType","_Record","Block","_super","this","apply","arguments","key","get","value","obj","isList","Array","isArray","map","create","Error","concat","type","data","defaultConfigRecord","readOnly","allowUndo","layoutDir","LEFT_AND_RIGHT","theme","name","randomColor","background","highlightColor","marginH","marginV","contentStyle","lineHeight","linkStyle","lineRadius","lineType","lineWidth","rootTopic","fontSize","borderRadius","padding","subLinkStyle","lineColor","primaryTopic","borderWidth","borderStyle","normalTopic","border","_Record2","Config","_super2","createKey","replace","c","r","Math","random","toString","_Record3","Topic","_super3","index","blocks","findIndex","b","block","_obj$parentKey","parentKey","_obj$subKeys","subKeys","_obj$collapse","collapse","createList","_ref","_ref$parentKey","_ref$content","content","_ref$subKeys","_ref$collapse","relations","style","defaultModelRecord","topics","extData","config","rootTopicKey","editorRootTopicKey","focusKey","focusMode","formatVersion","zoomFactor","_extendStatics","d","Object","setPrototypeOf","__proto__","p","hasOwnProperty","__extends","__","constructor","prototype","_assign","assign","t","s","i","n","length","call","cooked","raw","templateObject_1","Content","div","defineProperty","props","SimpleTextEditor","_this","state","onMouseDown","e","stopPropagation","onMouseMove","onKeyDown","_handleClick","event","root","contains","target","onClickOutSide","rootRef","saveRef","ref","initState","onChange","_a","setState","componentDidMount","document","addEventListener","componentWillUnmount","removeEventListener","getCustomizeProps","getContent","deserialize","render","topicKey","_b","getRefKeyFunc","placeholder","editorProps","bind","contentProps","autoFocus","contentEditorRefKey","TopicContentEditor","nativeEvent","ctrlKey","code","save","model","getTopic","getBlock","whiteSpace","editingContentKey","controller","run","opType","blockType","log$2","descEditorRefKey","TopicDescEditor","editingDescKey","getTopicTitle","maxLength","text","substr","renderTopicContentEditor","renderTopicDescEditor","isBlockEmpty","next","serializeBlockData","serialize","Root","styled","ZIndex","Title","AddReferenceTopicPanel","zIndex","React.createElement","Flex","justifyContent","Button","onClick","referenceKeys","opArray","FOCUS_TOPIC","NORMAL","SET_FOCUS_MODE","defaultReferenceRecord","keyList","List","dataMap","Map","Record","defaultExtDataReferenceRecord","reference","getReferenceKeys","has","toArray","getReferencedKeys","res","forEach","v","k","includes","push","setReferenceTopicKeys","getExtDataItem","ExtDataReference","referenceRecord","ReferenceRecord","set","setIn","ButtonPlace","ReferenceTopicThumbnail","refKey","refType","removeHandler","deleteConfirm","setDeleteConfirm","getValue","PropKey","TOPIC_TITLE","deleteAlertProps","isOpen","cancelButtonText","onConfirm","onCancel","onClose","Alert","Group","GroupList","GroupTitle","GotoBtn","ReferenceTopicList","referenceGroup","thumbProps","delete","indexOf","referencedKeys","referencedGroup","currentTopic","cancelEvent","TopicExtReference","refRecord","size","iconProps","className","iconClassName","tabIndex","icon","TopicBlockIcon","tooltipProps","interactionKind","PopoverInteractionKind","CLICK","hoverOpenDelay","Popover","TopicReferenceCheckbox","selectedTopicKeys","a","checked","setChecked","checkboxProps","add","StyledCheckbox","StyledNavOmniBar","Omnibar","ofType","TopicTitle","StyledPopover","Tip","TipContent","INPUT_PROPS","SearchPanel","setSearchWord","navigateToTopic","sections","topic","title","getAllSections","inputProps","itemListPredicate","query","items","filter","item","toLowerCase","itemRenderer","section","needTip","sectionTitle","titleProps","titleEl","popoverProps","fill","HOVER_TARGET_ONLY","resetOnSelect","setSearchWorld","customizeHotKeys","hotKeys","globalHotKeys","label","combo","renderDiagramCustomize","searchPanelProps","Set","startSetReferenceTopics","ModelModifier","focusTopic","customizeTopicContextMenu","MenuDivider","MenuItem","Icon","whiteList","TOGGLE_COLLAPSE","getOpMap","opMap","beforeOpFunction","DELETE_TOPIC","allDeleteKeys","getAllSubTopicKeys","deleteKey","withMutations","updateIn","DIAGRAM_CUSTOMIZE_BASE_Z_INDEX","panelProps","renderTopicContentOthers","EXT_KEY_TOPIC_REFERENCE","checkBoxProps","checkbox","renderTopicExtReference","clearSelectedReferenceKeys","clear","getSelectedReferenceKeys","from","deserializeExtDataItem","extDataKey","extDataItem","extDataReference","update","__rest","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","__values","o","m","Symbol","iterator","done","__read","ar","error","__spread","__makeTemplateObject","templateObject_2","templateObject_1$1","templateObject_2$1","templateObject_3","templateObject_4","templateObject_5","templateObject_6","templateObject_7","templateObject_8","templateObject_9","templateObject_10","templateObject_11","BaseWidget","operation","arg","enumerable","configurable","log","DragScrollView","DragScrollContent","DragScrollWidget","contentResizeCallback","entries","observer","oldContentRect","widgetStyle","width","clientWidth","viewBox","height","clientHeight","bigView","contentRect","contentResizeObserver","contentRef","observe","viewBoxRef","enableMouseWheel","altKey","preventDefault","passive","setViewBoxScroll","bigViewRef","setWidgetStyle","left","top","scrollLeft","scrollTop","setViewBoxScrollDelta","deltaLeft","deltaTop","mouseKey","needKeyPressed","canDragFunc","button","_lastCoordX","clientX","_lastCoordY","clientY","ele","onMouseUp","handleContextMenu","setZoomFactor","transform","transformOrigin","children","defaultProps","log$1","SaveRef","getRef","node","fireListener","deleteRef","observers","e_1","listeners","listeners_1","listeners_1_1","listener","e_1_1","return","registerRefListener","flexDirection","alignItems","Margin","margin","ShowMenuIcon","IconBg","Btn","CloseIcon","span","PanelTabRoot","EventPlugin","eventListeners","handleTopicClick","EDITING_CONTENT","handleTopicDoubleClick","handleTopicContextMenu","SHOW_POPUP","handleActiveModalClose","activeModalProps","once","only","origin","fn","fireEvent","IconName","SHOW_MENU","CLOSE","COLOR_PICKER","NOTES","PLUS","MINUS","COLLAPSE_ALL","EXPAND_ALL","CENTER","TRASH","SEARCH","THEME","EXPORT","OPEN_FILE","iconName","contentRefKey","topicWidgetRefKey","topicRefKey","linksRefKey","linksSvgRefKey","collapseRefKey","dropAreaRefKey","dir","RefKey","DIAGRAM_ROOT_KEY","DRAG_SCROLL_WIDGET_KEY","SVG_HIGHLIGHT_KEY","FOCUS_HIGHLIGHT_KEY","DROP_EFFECT_KEY","EventKey","CENTER_ROOT_TOPIC","TOPIC_CONTEXT_MENU_ENABLED","browserDownloadFile","url","filename","link","createElement","href","download","click","browserDownloadText","encodeURIComponent","browserOpenFile","accept","input","Promise","resolve","reject","evt","file","files","fr","FileReader","onload","txt","result","onerror","readAsText","paddingCss","right","_c","bottom","_d","getLinkKey","fromKey","toKey","centerY","rect","centerX","centerPointX","p1","p2","x","centerPointY","y","center","_getRelativeRect","el","rel","scale","getBoundingClientRect","relCenter","elCenter","getRelativeVector","HotKeyName","ADD_CHILD","ADD_SIBLING","EDIT_CONTENT","EDIT_NOTES","SET_EDITOR_ROOT","HotKeyPlugin","handleKeyDown","undefined","op","topicHotKeys","START_EDITING_CONTENT","START_EDITING_DESC","log$3","OperationPlugin","OpMap","toggleCollapse","collapseAll","expandAll","EXPAND_TO","expandTo","addChild","addSibling","deleteTopic","setFocusMode","SET_STYLE","setStyle","SET_THEME","setTheme","SET_TOPIC_BLOCK","setBlockData","DELETE_TOPIC_BLOCK","deleteBlock","DESC","EDITING_DESC","DRAG_AND_DROP","srcKey","dstKey","dropDir","srcTopic","dstTopic","srcParentKey","srcParentSubKeys","srcIndex","dstSubKeys_1","dstParentKey_1","dstParentSubKeys_1","dstIndex","newDstParentSubKeys_1","insert","setEditorRootTopicKey","undoStack","redoStack","enabled","whiteListOperation","isOperationEnabled","enableOperation","disableOperation","getAllowUndo","getUndoRedoStack","setUndoStack","setRedoStack","canUndo","canRedo","undo","newModel","peek","shift","change","redo","callback","opNotInWhiteList","undoStack_1","reduce","acc","cur","opFunc","opFuncProps","deleteRefKey","allSubKeys","allSubKeys_1","allSubKeys_1_1","beforeOperation","afterOperation","afterOpFunction","TopicContextMenu","shortcut","rootCanUse","templateObject_1$2","templateObject_1$3","log$4","DropEffectSvg","svg","TopicDropEffect","layout","targetProps","svgRect","stroke","strokeDasharray","strokeWidth","log$5","DropArea","DragAndDropPlugin","dragTargetKey","dragTargetDir","renderTopicDropArea","eventHandlers","onDragEnter","ev","onDragLeave","onDragOver","onDrop","renderDragAndDropEffect","getDragTargetProps","handleTopicDragStart","DRAGGING","canDrop","ANCESTOR","handleTopicDragEnter","handleTopicDragLeave","relatedTarget","handleTopicDrop","templateObject_1$4","templateObject_2$2","templateObject_3$1","templateObject_1$5","templateObject_2$3","templateObject_1$6","templateObject_1$7","templateObject_2$4","templateObject_1$8","templateObject_2$5","templateObject_3$2","EditorRootBreadcrumbsRoot","TooltipContent","BreadcrumbTitle","EditorRootBreadcrumbs","breadcrumbRenderer","breadProps","needTooltip","position","BOTTOM_RIGHT","breadcrumb","show","editingRootKey","unshift","breadcrumbProps","NodeLayer","DIV","MindDragScrollWidget","dragScrollWidget","onWheel","deltaY","renderHotkeys","TypeError","global","nodeLayer","rootTopicRect","nodeLayerRect","componentDidUpdate","nodeKey","rootWidgetProps","Modals","handleClose","activeModal","enforceFocus","usePortal","DIALOG_BODY","minHeight","RootLinksSvg","log$6","RootSubLinks","curves","curve","vDir","hDir","radius","log$7","LayerPart","topicDirection","LEFT","RootWidget","renderPartTopics","isRoot","subTopics","cxName","topicStyle","topicContent","MAIN","partTopics","L","R","LEFT_TO_RIGHT","RIGHT_TO_LEFT","TOP_TO_BOTTOM","B","Icon$1","RIGHT","TopicCollapseIcon","onClickCollapse","iconfont","templateObject_1$9","templateObject_2$6","log$8","EditingRoot","EditingWrapper","cancelEvent$1","TopicContent","child","editor","wrapper_1","rect_1","editorDiv","contentResizeObserver_1","templateObject_1$a","templateObject_2$7","templateObject_1$b","log$9","TopicContent$1","TopicContentWithDropArea","TopicContentWidget","onDragStart","handleTopicClickTimeout","setTimeout","onDoubleClick","clearTimeout","needRelocation","oldCollapseIconVector","dragEnter","renderContextMenu","onContextMenuClose","newRect","newVector","vector","draggable","collapseIcon","prevDropArea","nextDropArea","dropEventHandlers","log$a","TooltipContentWrapper","TopicDesc","isEditing","descEditor","diagramRoot","maxWidth","maxHeight","dRect","classname","POPOVER_DISMISS","HOVER","templateObject_1$c","templateObject_1$d","templateObject_1$e","templateObject_2$8","templateObject_3$3","templateObject_1$f","templateObject_2$9","templateObject_3$4","templateObject_1$g","FocusHighlightSvg","TopicHighlight","TopicLinksSvg","log$b","TopicSubLinks","p3","z","collapseRect","subContent","abs","log$c","Node","NodeChildren","NodeTopic","TopicWidget","renderSubTopics","subLinks","layoutLinks","links","propsMore","log$d","ViewerRoot","Item_","ZoomFactorSpan","Item","tooltip","TOP","ICON","ViewPortViewer","zoomFactorChange","onClickResetZoom","onClickAddZoom","onClickMinusZoom","onClickCollapseAll","centerRootTopic","onClickExpandAll","floor","DescEditorWrapper","renderDrawer","hasBackdrop","backdropProps","isCloseButtonShown","descData","Theme","templateObject_1$h","log$e","RenderingPlugin","diagramProps","DiagramRoot","getDiagramProps","renderDiagram","nProps","renderEditorRootBreadcrumbs","renderModals","renderModal","getActiveModalProps","renderDoc","renderRootWidget","renderTopicWidget","renderTopicContent","renderTopicCollapseIcon","renderTopicBlocks","blockKey","renderTopicBlock","CONTENT","renderTopicBlockContent","renderTopicBlockDesc","renderSubLinks","renderRootSubLinks","renderFocusItemHighlight","renderRootWidgetOtherChildren","renderViewPortViewer","templateObject_1$i","templateObject_2$a","PanelRoot","StyledTabs","RightTopPanel","selectedTabId","handleTabIdChange","expand","setExpand","id","templateObject_1$j","templateObject_2$b","templateObject_3$5","templateObject_4$1","templateObject_5$1","templateObject_6$1","templateObject_7$1","SettingTitle","SettingItem","SettingBoxContainer","SettingLabel","SettingRow","ColorBar","color","WithBorder","SettingGroup","SettingItemColorPicker","handleColorChange","onChangeComplete","hex","SettingItemButton","handleClick","SettingItemNumericInput","restProps","flexProps","SettingItemSelect","onItemSelect","PxSelect","pxProps","filterable","renderItem","unit","borderWidthItems","keys","borderWidthItems$1","borderRadiusItems","borderStyleItems","BorderStyleEditor","setContentStyle","borderColor","lineTypes","renderLineTypeItem","modifiers","LinkStyleEditor","showLinkStyle","showSubLinkStyle","setLinkStyle","setSubLinkStyle","TextStyleEditor","fontSizeNumInputProps","min","max","parseInt","onValueChange","lineHeightInputProps","copiedStyle","log$f","StyleEditor","linkStyleEditorProps","contentStyleEditorPros","JSON","stringify","ClearAllCustomStyle","PaddingStyleEditor","commonProps","setPadding","topProps","rightProps","bottomProps","leftProps","templateObject_1$k","TopicThemeEditorRoot","TopicThemeEditor","setTopicStyle","tabId","ThemeEditor","handler","alertThemeError","setAlertThemeError","handleRandomColorChange","rootTopicEditorProps","rootTopicEditor","primaryTopicEditorProps","primaryTopicEditor","normalTopicEditorProps","normalTopicEditor","tabsProps","topicThemes","panel","alertProps","alert","then","parse","RightTopPanelPlugin","renderRightTopPanel","renderRightTopPanelTabs","renderTopicStyleEditor","tProps","renderThemeEditor","log$g","UtilsPlugin","tempValueMap","eventListenerMap","addTempValueChangeListener","removeTempValueChangeListener","l","getTempValue","setTempValue","deleteTempValue","log$h","StylePlugin","colorMap","colorIndex","getTopicStyle","getTopicContentStyle","themeStyle","visualLevel","getTopicVisualLevel","ROOT","PRIMARY","customStyle","getLinkStyle","presetStyle","parentSubLinkStyle","getSubLinkStyle","setTopicContentStyle","styleObj","newStyleObj","newStyleStr","getTopicThemeStyle","getRandomColor","colors","clearAllCustomStyle","keySeq","DefaultPlugin","renderTopicContextMenu","onClickItem","labelElement","getPartTopics","subTopicCount","slice","ceil","createSubTopics","tKey","topicProps","highlight","dropEffect","layoutTopic","topicWidget","subKey","setLayoutDir","getRelativeRect","element","getRelativeRectFromViewPort","getRelativeVectorFromViewPort","addZoomFactorChangeEventListener","removeZoomFactorChangeEventListener","getZoomFactor","moveTopicToCenter","DESCENDANT","dragScroll","focusTopicAndMoveToCenter","propKey","Diagram","resolveController","plugins","TheDefaultPlugin","defaultPlugin","construct","openNewModel","React.PureComponent","debug","ResizeObserver","React.Component","Checkbox","Stack","Menu","getRelationship","TopicRelationship","PopoverPosition","Breadcrumb","Tooltip","Breadcrumbs","Hotkey","Hotkeys","HotkeysTarget","Dialog","Classes","TopicDirection","css","cx","ContextMenuTarget","Position","Drawer","ThemeProvider","React.Fragment","Tabs","Divider","SketchPicker","NumericInput","Select","InputGroup","clone","merge","Tab","isThemeType","TopicVisualLevel","isEqual","SimpleTextEditorPlugin","memoizeOne","Controller","NodeContent","richEditorProps","editorValue","nodeContentProps","RichMarkDownEditor","MarkdownSerializer","markdownSerializer","serializeModel","nextRes","valueSeq","deserializeModel","Model","serializeExtData","deserializeExtData","serializeExtDataItem","isImmutable","toJS","serializeConfig","deserializeConfig","serializeTopic","deserializeTopic","deserializeTopics","serializeBlock","deserializeBlock","deserializeBlockData","deserializeBlocks","themeRandomColorSquare","theme1","theme2","boxShadow","theme3","theme4","themeMap","defaultTheme","getAllThemes","themeKey","allTheme","TopicBlockTopology","ToolsConfig","group","paddingLeft","paddingRight","paddingTop","paddingBottom","iconFamily","iconColor","textMaxLine","image","is3D","zRotate","fillStyle","iconSize","strokeStyle","font","fontFamily","fontWeight","rectInParent","rotate","textAlign","textBaseline","Canvas","Tools","ToolTitle","ToolbarButtons","toolsConfig","canvasOptions","onMessage","diagramUtil","topology","setCanvasData","canvasRegister","registerNode","flowData","flowDataAnchors","flowDataIconRect","flowDataTextRect","flowSubprocess","flowSubprocessIconRect","flowSubprocessTextRect","flowDb","flowDbIconRect","flowDbTextRect","flowDocument","flowDocumentAnchors","flowDocumentIconRect","flowDocumentTextRect","flowInternalStorage","flowInternalStorageIconRect","flowInternalStorageTextRect","flowExternStorage","flowExternStorageAnchors","flowExternStorageIconRect","flowExternStorageTextRect","flowQueue","flowQueueIconRect","flowQueueTextRect","flowManually","flowManuallyAnchors","flowManuallyIconRect","flowManuallyTextRect","flowDisplay","flowDisplayAnchors","flowDisplayIconRect","flowDisplayTextRect","flowParallel","flowParallelAnchors","flowComment","flowCommentAnchors","activityFinal","activityFinalIconRect","activityFinalTextRect","swimlaneV","swimlaneVIconRect","swimlaneVTextRect","swimlaneH","swimlaneHIconRect","swimlaneHTextRect","fork","forkHAnchors","forkIconRect","forkTextRect","forkVAnchors","simpleClass","simpleClassIconRect","simpleClassTextRect","interfaceClass","interfaceClassIconRect","interfaceClassTextRect","lifeline","lifelineAnchors","lifelineIconRect","lifelineTextRect","sequenceFocus","sequenceFocusAnchors","sequenceFocusIconRect","sequenceFocusTextRect","on","Topology","openData","open","onDrag","dataTransfer","setData","renderTools","btn","onContextMenu","canvasData","getTopology","scaleTo","DiagramWrapper","TopologyDrawer","utilProps","backdropClassName","canOutsideClickClose","topologyData","TopologyDiagram","TopologyDiagramUtils","startEditingTopology","renderTopicBlockTopology","topoProps","module","exports","compose","middleware","middleware_1","middleware_1_1","context","dispatch","err","options","registerPlugin","plugin","CorePlugin","args","_i","fns","composedFn","currentModel","BOTTOM","SIBLING","NONE","fromJSON","_e","getKeyPath","reverse","getParentTopic","pTopic","child_1","pItem","idx_1","sibling_1","topicKeys","deleteKeys","dKey","dt","index_1","isModel","attrs","createEmpty","object","values","level","warning","isPlainObject","urls","register","login","base","list","defaults","getWorkspaces","fetch","localStorage","getItem","method","headers","response","ok","json","msg","statusText","status","catch","console","deleteWorkspaceService","addWorkspaceMW","workspace","payload","user_id","body","createWiki","_id","addWorkspace","history","setWorkspacesMw","workspaces","setWorkspaces","setActiveWSProjectMW","activeWSProject","setActiveWSProject","deleteWorkspaceMw","deleteWorkspace","ProjectModel","project","newProject","quill","quillText","quillContent","toolbar","header","description","outcome","reward","startTime","Date","endTime","duration","reminders","progress","tasks","tasksCount","date","isTask","offsetForTz","projectProps","updateModel","umData","prop","createProject","workspace_id","getProjects","TitleModel","ntitle","updateProject","project_id","updateProjectService","delay","isThrottled","wrapper","throttle","getProject","workspaceId","projectId","updateWSProject","ws_id","addProject","tid","meta","updateProjectTask","updateProjectMW","getState","projects","lodash","cloneDeep","activeProjectId","tk","val","filteredTopic","rt","bindTrackToMap","activeProject","tp","task_id","projModelInstance","setText","setActiveProjectMW","setActiveProject","setProjectsMW","setProjects","WorkspaceDD","toggleWsModal","allData","isLblHovered","activeWsName","showWsModal","labelInpChange","updatedData","handleWsClick","ws","loading","wsMeta","addToWorkspaces","createdWs","w","foundWs","wsName","match","params","src","alt","onMouseEnter","hoverIn","onMouseLeave","hoverOut","Component","withRouter","connect","wikis","Header","class","LabelDD","showLabelModal","labelInp","changeLabel","persist","mode","innerText","setLabelMW","setStatusMW","modalClickHandler","deleteLabel","addLabelMW","addStatusMW","deleteLabelMW","deleteStatusMW","refData","onlyModal","Boolean","active","onlyInput","modalView","toggleLabelModal","addLabel","$event","ownProps","sideBar","activeLabel","activeStatus","addStatus","deleteStatus","Sidebar","navToWSDashboard","toggleCPModal","ProjectModal","projectType","checkedTypes","projectTypes","handleInpChange","getProjectType","pt","statusCode","proj","toggleProject","handleChange","isChecked","prevState","ProjectsList","showEditIcon","showActionsDD","toggleProjectModal","getProjProgress","dl","accumulator","currentValue","deleteProject","delProjectMW","onCreate","updatedList","getActiveProjects","activeProjects","toggleEdit","switchToProject","fromEdit","substring","deleteProjectService","delProject","getDuration","distance","getTime","tech","handleProjectTypeChange","EditComponent","getDeepClonedObj","addProjectMW","toggleEditModal","saveContent","editorContainerIds","toggleModal","currentContent","initContent","Delta","Quill","import","modules","scrollingContainer","setContents","delta","eItem","getContents","getText","properties","initializeProjEditor","calcDuration","off","clearInterval","timer","isSidebarOpen","updateProperties","viewMode","timeFormat","disabled","toDate","DashboardBody","cpModal","togglePanel","Dashboard","to","resetId","split","activeClassName","ToolbarItemOpen","diagram","ToolbarItemLayout","layoutDirs","ToolbarItemTheme","themes","defaultThemeImg","theme1Img","theme2Img","theme3Img","theme4Img","ToolbarItemExport","jsonStr","downloadFile","NavOmniBar","ToolbarItemSearch","Toolbar","onClickUndo","onClickRedo","updateWsMap","navBack","React","PureComponent","RichTextEditorPlugin","ThemeSelectorPlugin","TopicReferencePlugin","SearchPlugin","TopologyDiagramPlugin","JsonSerializerPlugin","Mindmap","editNode","enModel","parsedTopic","togglePropertiesModal","diagramRef","bindUpdatedTitle","umodel","setProperties","activeWorkspace","getMap","getTopicFromMap","initModel","window","rootKey","generateSimpleModel","toolbarProps","renderToolbar","EditProject","togglePropertiesModalSt","Notify","notify","notifyTitle","ignore","tag","now","lang","sound","playSound","getElementById","play","swRegistration","getNotifications","notifications","WebSocket","onopen","wsInitObj","send","onmessage","close","handleButtonClick","handleButtonClick2","notSupported","handleNotSupported","onPermissionGranted","handlePermissionGranted","onPermissionDenied","handlePermissionDenied","onShow","handleNotificationOnShow","handleNotificationOnClick","handleNotificationOnClose","onError","handleNotificationOnError","timeout","preload","hidden","autostart","loop","Reminders","formatAMPM","minutes","getMinutes","hours","getHours","ampm","getDay","getMonth","getDate","getFullYear","taskKeys","Assess","Gantt","dataProcessor","specifyColumns","dateEditor","map_to","gantt","columns","tree","align","min_duration","setupQuickInfo","quickinfo_buttons","locale","labels","$click","buttons","view_mindmap","initZoom","ext","zoom","init","levels","scale_height","min_column_width","scales","step","format","dateToStr","date_to_str","endDate","setLevel","onDataUpdated","createDataProcessor","action","nextProps","xml_date","quick_info","ganttContainer","templates","tooltip_text","start","end","task","tooltip_date_format","lightbox","focus","time_format","section_period","initGanttDataProcessor","destructor","setZoom","handleZoomChange","onZoomChange","zoomRadios","isActive","MessageArea","messages","message","Roadmap","currentZoom","roadmap","updateRoadmap","logDataUpdate","handleRoadmapGanttParse","Project","phase","View","Login","useState","email","setEmail","password","setPassword","cpassword","setCpassword","pwdMismatch","setPwdMismatch","isLogin","setIsLogin","cookies","Cookies","useHistory","handleInput","handleView","handleSubmit","getTimezoneOffset","token","storeCredsLocally","setItem","onSubmit","required","WorkspacesDashboard","$e","Workspace","App","exact","path","location","hostname","completed","events","nto","dtCount","notes","tlOptions","defaultState","activeDate","nextActiveLbl","interval","newState","uState","utState","dState","cState","spState","isSet","track","analyse","projectModal","combineReducers","thunk","store","createStore","rootReducer","applyMiddleware","navigator","serviceWorker","ready","registration","unregister","isObjectObject","ctor","prot"],"mappings":"uJAmBIA,E,8EAEJ,SAAWA,GACTA,EAAkBA,EAAiC,cAAI,GAAK,gBAC5DA,EAAkBA,EAAiC,cAAI,GAAK,gBAC5DA,EAAkBA,EAAkC,eAAI,GAAK,iBAC7DA,EAAkBA,EAAiC,cAAI,GAAK,gBAJ9D,CAKGA,IAAsBA,EAAoB,KAE7C,IAKIC,EACO,UADPA,EAEI,OAEJC,EACM,SADNA,EAEe,kBAFfA,EAGY,eAUZC,EAae,kBAgBf,EAAqB,SAAUC,GACjC,YAAUC,EAAOD,GAEjB,IAAIE,EAAS,YAAaD,GAE1B,SAASA,IAGP,OAFA,YAAgBE,KAAMF,GAEfC,EAAOE,MAAMD,KAAME,WA8B5B,OA3BA,YAAaJ,EAAO,CAAC,CACnBK,IAAK,OACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,UAEjB,CACDD,IAAK,OACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,WAEhB,CAAC,CACHD,IAAK,SACLE,MAAO,SAAgBC,GACrB,OAAO,IAAIR,EAAMQ,KAElB,CACDH,IAAK,aACLE,MAAO,SAAoBC,GACzB,GAAI,OAAKC,OAAOD,IAAQE,MAAMC,QAAQH,GAEpC,OAAO,eAAKA,EAAII,IAAIZ,EAAMa,SAG5B,MAAM,IAAIC,MAAM,mEAAmEC,OAAOP,QAIvFR,EAtCgB,CAuCvB,iBA7CuB,CACvBgB,KAAM,KACNX,IAAK,KACLY,KAAM,QAgDR,IAuDIC,EAAsB,CACxBC,UAAU,EACVC,WAAW,EACXC,UAAW1B,EAAkB2B,eAC7BC,MA3DiB,CACjBC,KAAM,UACNC,aAAa,EACbC,WAAY,gBACZC,eAAgB,UAChBC,QAAS,GACTC,QAAS,GACTC,aAAc,CACZC,WAAY,OAEdC,UAAW,CACTC,WAAY,EACZC,SAAU,QACVC,UAAW,OAEbC,UAAW,CACTN,aAAc,CACZO,SAAU,OACVC,aAAc,OACdC,QAAS,uBAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,sBAGfC,aAAc,CACZZ,aAAc,CACZa,YAAa,MACbC,YAAa,QACbN,aAAc,OACdD,SAAU,OACVE,QAAS,uBAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,sBAGfI,YAAa,CACXf,aAAc,CACZgB,OAAQ,oBACRR,aAAc,OACdD,SAAU,OACVE,QAAS,YAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,YAWb,EAAsB,SAAUM,GAClC,YAAUC,EAAQD,GAElB,IAAIE,EAAU,YAAaD,GAE3B,SAASA,IAGP,OAFA,YAAgB9C,KAAM8C,GAEfC,EAAQ9C,MAAMD,KAAME,WA8B7B,OA3BA,YAAa4C,EAAQ,CAAC,CACpB3C,IAAK,YACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,eAEjB,CACDD,IAAK,WACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,cAEjB,CACDD,IAAK,YACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,eAEjB,CACDD,IAAK,QACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,YAEhB,CAAC,CACHD,IAAK,WACLE,MAAO,SAAkBC,GACvB,OAAO,IAAIwC,EAAOxC,OAIfwC,EAtCiB,CAuCxB,iBAAO9B,IAET,SAASgC,IACP,MAAO,uCAAuCC,QAAQ,SAAS,SAAUC,GACvE,IAAIC,EAAoB,GAAhBC,KAAKC,SAAgB,EAE7B,OADc,MAANH,EAAYC,EAAQ,EAAJA,EAAU,GACzBG,SAAS,OAItB,IAUI,EAAqB,SAAUC,GACjC,YAAUC,EAAOD,GAEjB,IAAIE,EAAU,YAAaD,GAE3B,SAASA,IAGP,OAFA,YAAgBxD,KAAMwD,GAEfC,EAAQxD,MAAMD,KAAME,WAoG7B,OAjGA,YAAasD,EAAO,CAAC,CACnBrD,IAAK,WACLE,MAAO,SAAkBS,GACvB,IAAI4C,EAAQ1D,KAAK2D,OAAOC,WAAU,SAAUC,GAC1C,OAAOA,EAAE/C,OAASA,KAEpB,OAAe,IAAX4C,EAAqB,CACvBA,MAAOA,EACPI,MAAO,MAEF,CACLJ,MAAOA,EACPI,MAAO9D,KAAK2D,OAAOvD,IAAIsD,MAG1B,CACDvD,IAAK,MACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,SAEjB,CACDD,IAAK,YACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,eAEjB,CACDD,IAAK,WACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,cAEjB,CACDD,IAAK,UACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,aAEjB,CACDD,IAAK,SACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,YAEjB,CACDD,IAAK,YACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,eAEjB,CACDD,IAAK,QACLC,IAAK,WACH,OAAOJ,KAAKI,IAAI,YAEhB,CAAC,CACHD,IAAK,WACLE,MAAO,SAAkBC,GACvB,IAAIH,EAAMG,EAAIH,IACV4D,EAAiBzD,EAAI0D,UACrBA,OAA+B,IAAnBD,EAA4B,KAAOA,EAC/CJ,EAASrD,EAAIqD,OACbM,EAAe3D,EAAI4D,QACnBA,OAA2B,IAAjBD,EAA0B,GAAKA,EACzCE,EAAgB7D,EAAI8D,SAExB,OAAO,IAAIZ,EAAM,CACfrD,IAAKA,EACL6D,UAAWA,EACXI,cAJ+B,IAAlBD,GAAmCA,EAKhDD,QAAS,eAAKA,GACdP,OAAQ,EAAMU,WAAWV,OAG5B,CACDxD,IAAK,SACLE,MAAO,SAAgBiE,GACrB,IAAInE,EAAMmE,EAAKnE,IACXoE,EAAiBD,EAAKN,UACtBA,OAA+B,IAAnBO,EAA4B,KAAOA,EAC/CC,EAAeF,EAAKG,QACpBA,OAA2B,IAAjBD,EAA0B,GAAKA,EACzCE,EAAeJ,EAAKJ,QACpBA,OAA2B,IAAjBQ,EAA0B,GAAKA,EACzCC,EAAgBL,EAAKF,SACrBA,OAA6B,IAAlBO,GAAmCA,EAC9Cb,EAAQ,EAAMnD,OAAO,CACvBG,KAAMpB,EACNqB,KAAM0D,EACNtE,IAAK,OAGP,OAAO,IAAIqD,EAAM,CACfrD,IAAKA,EACL6D,UAAWA,EACXL,OAJW,eAAK,CAACG,IAKjBI,QAAS,eAAKA,GACdE,SAAUA,QAKTZ,EA5GgB,CA6GvB,iBAvHuB,CACvBrD,IAAK,KACL6D,UAAW,KACXI,UAAU,EACVF,QAAS,KACTP,OAAQ,KACRiB,UAAW,KACXC,MAAO,QA2KC,IAAM,YAkThB,IAmBIC,EAAqB,CACvBC,OAAQ,gBACRC,QAAS,gBACTC,OAAQ,IAAI,EACZC,aAAc,KACdC,mBAAoB,KACpBC,SAAU,KACVC,UAAW,KACXC,cAAe,KACfC,WAAY,GA6LZ,iBAAOT,GASG,IAAM,mBA4DlB,I,gCCt9BIU,EAAiB,SAAuBC,EAAG5B,GAW7C,OAVA2B,EAAiBE,OAAOC,gBAAkB,CACxCC,UAAW,cACApF,OAAS,SAAUiF,EAAG5B,GACjC4B,EAAEG,UAAY/B,IACX,SAAU4B,EAAG5B,GAChB,IAAK,IAAIgC,KAAKhC,EACRA,EAAEiC,eAAeD,KAAIJ,EAAEI,GAAKhC,EAAEgC,MAIhBJ,EAAG5B,IAG3B,SAASkC,EAAUN,EAAG5B,GAGpB,SAASmC,IACPhG,KAAKiG,YAAcR,EAHrBD,EAAeC,EAAG5B,GAMlB4B,EAAES,UAAkB,OAANrC,EAAa6B,OAAO/E,OAAOkD,IAAMmC,EAAGE,UAAYrC,EAAEqC,UAAW,IAAIF,GAGjF,IAAIG,EAAU,WAaZ,OAZAA,EAAUT,OAAOU,QAAU,SAAkBC,GAC3C,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAItG,UAAUuG,OAAQF,EAAIC,EAAGD,IAG9C,IAAK,IAAIV,KAFTS,EAAIpG,UAAUqG,GAGRb,OAAOQ,UAAUJ,eAAeY,KAAKJ,EAAGT,KAAIQ,EAAER,GAAKS,EAAET,IAI7D,OAAOQ,IAGMpG,MAAMD,KAAME,YAe7B,IAZ8ByG,EAAQC,EAkJlCC,EAtIA,EAAM,IAAM,oBACZC,EAAU,UAAOC,IAAIF,IAbKF,EAawD,CAAC,0CAA2C,gBAAiB,2BAb7GC,EAayI,CAAC,0CAA2C,gBAAiB,2BAZtOlB,OAAOsB,eACTtB,OAAOsB,eAAeL,EAAQ,MAAO,CACnCtG,MAAOuG,IAGTD,EAAOC,IAAMA,EAO6BC,EAJrCF,IAIiQ,SAAUM,GAClR,OAAOA,EAAMhG,SAAW,KAAO,WAC9B,SAAUgG,GACX,OAAOA,EAAMhG,SAAW,UAAY,UAGlC,EAEJ,SAAUlB,GAGR,SAASmH,EAAiBD,GACxB,IAAIE,EAAQpH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KA8BxC,OA5BAmH,EAAMC,MAAQ,CACZ3C,QAAS,MAGX0C,EAAME,YAAc,SAAUC,GAC5BA,EAAEC,mBAGJJ,EAAMK,YAAc,SAAUF,KAI9BH,EAAMM,UAAY,SAAUH,KAE5BH,EAAMO,aAAe,SAAUC,IACXR,EAAMS,KAAKC,SAASF,EAAMG,SAC9BX,EAAMY,eAAeJ,IAGrCR,EAAMa,QAAU,SAAUC,GACxB,OAAO,SAAUC,GACfD,EAAQC,GACRf,EAAMS,KAAOM,IAIjBf,EAAMgB,YAEChB,EAwFT,OAzHApB,EAAUmB,EAAkBnH,GAoC5BmH,EAAiBhB,UAAUkC,SAAW,SAAUC,GAC9C,IAAIhI,EAAQgI,EAAGhI,MACf,EAAI,WAAYA,GAChBL,KAAKsI,SAAS,CACZ7D,QAASpE,KAIb6G,EAAiBhB,UAAUqC,kBAAoB,WAC9BvI,KAAKiH,MAAMhG,UAE1BuH,SAASC,iBAAiB,QAASzI,KAAK0H,eAG1CR,EAAiBhB,UAAUwC,qBAAuB,WACjC1I,KAAKiH,MAAMhG,UAE1BuH,SAASG,oBAAoB,QAAS3I,KAAK0H,eAG7CR,EAAiBhB,UAAU6B,eAAiB,SAAUT,KAEtDJ,EAAiBhB,UAAU0C,kBAAoB,WAC7C,OAAO,MAGT1B,EAAiBhB,UAAU2C,WAAa,WACtC,IACIpE,EADQzE,KAAK4I,oBAAoB9E,MACjB/C,KACpB,OAAe,MAAX0D,EAAwB,MAEL,kBAAZA,IACTA,EAAU,IAAgBqE,YAAYrE,IAGjCA,IAGTyC,EAAiBhB,UAAUiC,UAAY,WACrC,IAAI1D,EAAUzE,KAAK6I,aACnB7I,KAAKoH,MAAQ,CACX3C,QAASA,IAIbyC,EAAiBhB,UAAU6C,OAAS,WAClC,IAAIV,EAAKrI,KAAKiH,MACV+B,EAAWX,EAAGW,SACdf,EAAUI,EAAGJ,QAEbgB,EAAKjJ,KAAK4I,oBACV3H,EAAWgI,EAAGhI,SACdiI,EAAgBD,EAAGC,cACnBC,EAAcF,EAAGE,YACjBtE,EAAQoE,EAAGpE,MAEf,EAAI5D,GACJ,IAAId,EAAM+I,EAAcF,GACpBvE,EAAUxD,EAAWjB,KAAK6I,aAAe7I,KAAKoH,MAAM3C,QAGpD4C,EADKrH,KACYqH,YACjBG,EAFKxH,KAEYwH,YACjBC,EAHKzH,KAGUyH,UAEf2B,EAAc,CAChB/I,MAAOoE,EACPxD,SAAUA,EACVmH,SAAUpI,KAAKoI,SAASiB,KAAKrJ,MAC7BmJ,YAAaA,EACbtE,MAAOA,GAELyE,EAAe,CACjBnJ,IAAKA,EACLc,SAAUA,EACViH,IAAKlI,KAAKgI,QAAQC,EAAQ9H,IAC1BkH,YAAaA,EACbG,YAAaA,EACbC,UAAWA,GAEb,OAAO,wBAAcX,EAASX,EAAQ,GAAImD,GAAe,wBAAc,SAAQnD,EAAQ,GAAIiD,EAAa,CACtGG,WAAW,OAIRrC,EA1HT,CA2HE,iBAGE,EAAQ,IAAM,6BAElB,SAASsC,EAAoBrJ,GAC3B,MAAO,kBAAoBA,EAG7B,IAAI,EAEJ,SAAUJ,GAGR,SAAS0J,EAAmBxC,GAC1B,IAAIE,EAAQpH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KAQxC,OANAmH,EAAMM,UAAY,SAAUH,GACtBA,EAAEoC,YAAYC,SAAkC,UAAvBrC,EAAEoC,YAAYE,MACzCzC,EAAM0C,QAIH1C,EA0CT,OArDApB,EAAU0D,EAAoB1J,GAc9B0J,EAAmBvD,UAAU0C,kBAAoB,WAC/C,IAAIP,EAAKrI,KAAKiH,MACV6C,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACd/H,EAAWoH,EAAGpH,SAMlB,MAAO,CACL6C,MANUgG,EAAMC,SAASf,GAAUgB,SAAStK,GAAmBoE,MAO/D7C,SAAUA,EACViI,cAPkBM,EAQlBL,YAAa,MACbtE,MARU,CACVoF,WAAY,SAWhBR,EAAmBvD,UAAU6B,eAAiB,SAAUT,GACtD,EAAM,kBACNtH,KAAK6J,QAGPJ,EAAmBvD,UAAU2D,KAAO,WAClC,IAAIxB,EAAKrI,KAAKiH,MACV6C,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACHc,EAAMI,oBAAsBlB,GAE1BhJ,KAAKiH,MAAMkD,WACjBC,IAAI,YAAajE,EAAQA,EAAQ,GAAInG,KAAKiH,OAAQ,CAC3DoD,OAAQzK,EACR0K,UAAW5K,EACXqB,KAAMf,KAAKoH,MAAM3C,QACjBY,UAAW1F,MAIR8J,EAtDT,CAuDE,GAEEc,EAAQ,IAAM,0BAElB,SAASC,EAAiBrK,GACxB,MAAO,eAAiBA,EAG1B,IAAI,EAEJ,SAAUJ,GAGR,SAAS0K,EAAgBxD,GACvB,IAAIE,EAAQpH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KAGxC,OADAuK,EAAM,eACCpD,EAmDT,OAzDApB,EAAU0E,EAAiB1K,GAS3B0K,EAAgBvE,UAAUiC,UAAY,WACpCpI,EAAOmG,UAAUiC,UAAUzB,KAAK1G,MAEhC,IAAIqI,EAAKrI,KAAKiH,MACVkD,EAAa9B,EAAG8B,WAEhBhK,EAAM,mBADKkI,EAAGW,SAEd3I,EAAQL,KAAKoH,MAAM3C,QACvB0F,EAAWC,IAAI,eAAgB,CAC7BjK,IAAKA,EACLE,MAAOA,KAIXoK,EAAgBvE,UAAU0C,kBAAoB,WAC5C,IAAIP,EAAKrI,KAAKiH,MACV6C,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SAIlB,MAAO,CACLlF,MAJUgG,EAAMC,SAASf,GAAUgB,SAAStK,GAAgBoE,MAK5D7C,SAJa6I,EAAMY,iBAAmB1B,EAKtCE,cAJkBsB,EAKlBrB,YAAa,2BAIjBsB,EAAgBvE,UAAUkC,SAAW,SAAUC,GAC7C,IAAIhI,EAAQgI,EAAGhI,MACfkK,EAAM,YACN,IAAItB,EAAKjJ,KAAKiH,MACVkD,EAAalB,EAAGkB,WAChBnB,EAAWC,EAAGD,SAGlB,KAFYC,EAAGa,MACMY,iBAAmB1B,GACxC,CACA,IAAI7I,EAAM,mBAAqB6I,EAC/BmB,EAAWC,IAAI,eAAgB,CAC7BjK,IAAKA,EACLE,MAAOA,IAETL,KAAKsI,SAAS,CACZ7D,QAASpE,MAINoK,EA1DT,CA2DE,GAiDa,UA/Cf,WACE,MAAO,CACLE,cAAe,SAAuB1D,GACpC,IAAI6C,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACnBnB,EAAW/B,EAAM+B,SACjB4B,EAAY3D,EAAM2D,UAElB9G,EADQgG,EAAMC,SAASf,GACTgB,SAAStK,GAAmBoE,MAC1C+G,EAAOV,EAAWC,IAAI,qBAAsBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC1EnD,MAAOA,KAOT,OAJiB,MAAb8G,IACFC,EAAOA,EAAKpE,OAASmE,EAAYC,EAAKC,OAAO,EAAGF,GAAa,MAAQC,GAGhEA,GAETE,yBAA0B,SAAkC9D,GAC1D,OAAO,wBAAc,EAAoBd,EAAQ,GAAIc,KAEvD+D,sBAAuB,SAA+B/D,GACpD,OAAO,wBAAc,EAAiBd,EAAQ,GAAIc,KAEpDgE,aAAc,SAAsBhE,EAAOiE,GACzC,IAAIpH,EAAQmD,EAAMnD,MACdqG,EAAalD,EAAMkD,WAEvB,OAAIrG,EAAMhD,OAASpB,GAAqBoE,EAAMhD,OAASpB,EAChC,MAAdoE,EAAM/C,MAAgE,KAAhDoJ,EAAWC,IAAI,qBAAsBnD,GAG7DiE,KAETC,mBAAoB,SAA4BlE,EAAOiE,GACrD,IAAIpH,EAAQmD,EAAMnD,MAElB,OAAIA,EAAMhD,OAASpB,GAAqBoE,EAAMhD,OAASpB,EACxB,kBAAfoE,EAAM/C,KAAoB+C,EAAM/C,KAAO,IAAgBqK,UAAUtH,EAAM/C,MAGhFmK,Q,+jCClYN,I,ICODG,EAAOC,EAAOC,SAAPD,CAAc,yTAUrBE,EAAQF,EAAOvE,IAAG,yEAIxB,SAAgB0E,EAAuBxE,GAC7B,IAAAyE,EAAA,EAAAA,OAAQvB,EAAA,EAAAA,WAAYnB,EAAA,EAAAA,SA8B5B,OACE2C,gBAACN,EAAI,CAACK,OAAQA,GACZC,gBAACH,EAAK,mGAING,gBAACC,OAAI,CAACC,eAAgB,gBACpBF,gBAACG,SAAM,CAACC,QA3BS,SAAAzE,GACrB,IAAM0E,EAAgB7B,EAAWC,IAAI,2BAA4BnD,GACjEkD,EAAWC,IAAI,kBAAmBnD,GAClCkD,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRgF,QAAS,CACP,CACE5B,ODlCkC,+BCmClCrB,SAAQ,EACRgD,cAAa,GAEf,CACE3B,OAAQzK,SAAOsM,YACflD,SAAQ,EACR3D,UAAW1F,YAAUwM,YAI3BhC,EAAWC,IAAI,6BAA8BnD,KASV,WAC/B0E,gBAACG,SAAM,CAACC,QArCQ,SAAAzE,GACpB6C,EAAWC,IAAI,6BAA8BnD,GAC7CkD,EAAWC,IAAI,kBAAmBnD,GAClCkD,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOwM,eACf/G,UAAW1F,YAAUwM,YA+BW,YCpDtC,IAAME,EAA8C,CAClDC,QAASC,SACTC,QAASC,SAGX,2B,+CAQA,OARqCC,OACnC,sBAAI,sBAAO,C,IAAX,WACE,OAAO1M,KAAKI,IAAI,Y,gCAGlB,sBAAI,sBAAO,C,IAAX,WACE,OAAOJ,KAAKI,IAAI,Y,gCAEpB,EARA,CAAqCsM,SAAOL,IActCM,EAA4D,CAChEC,UAAWH,SAGb,2B,+CAqBA,OArBsCC,OACpC,sBAAI,wBAAS,C,IAAb,WACE,OAAO1M,KAAKI,IAAI,c,gCAGlB,YAAAyM,iBAAA,SAAiB7D,GACf,OAAIhJ,KAAK4M,UAAUE,IAAI9D,GACdhJ,KAAK4M,UAAUxM,IAAI4I,GAAUsD,QAAQS,UAEvC,IAGT,YAAAC,kBAAA,SAAkBhE,GAChB,IAAMiE,EAAM,GAMZ,OALAjN,KAAK4M,UAAUM,SAAQ,SAACC,EAAGC,GACrBD,EAAEb,QAAQe,SAASrE,IACrBiE,EAAIK,KAAKF,MAGNH,GAEX,EArBA,CAAsCP,SAAOC,ICzB7C,SAAgBY,EAAsB,G,IACpCzD,EAAA,EAAAA,MACAd,EAAA,EAAAA,SACAgD,EAAA,EAAAA,cAEIhH,EAA4B8E,EAAM0D,eHJI,kBGMxCC,GAGEC,EACF1I,EAAQ4H,UAAUxM,IAAI4I,IAAa,IAAI2E,EAMzC,OAJAD,EAAkBA,EAAgBE,IAAI,UAAWrB,OAAKP,IACtDhH,EAAUA,EAAQ6I,MAAM,CAAC,YAAa7E,GAAW0E,GACjD5D,EAAQA,EAAM+D,MAAM,CAAC,UHdqB,mBGcqB7I,GCdjE,I,MAAMqG,EAAOC,EAAOvE,IAAG,yOAQjBD,EAAUwE,EAAOvE,IAAG,iKAMpB+G,EAAcxC,EAAOvE,IAAG,yDAS9B,SAAgBgH,EAAwB9G,GAC9B,IAAAkD,EAAA,EAAAA,WAAY6D,EAAA,EAAAA,OAAQC,EAAA,EAAAA,QAASC,EAAA,EAAAA,cAC/B,sBAACC,EAAA,KAAeC,EAAA,KAUhB3J,EAAU0F,EAAWkE,SAASC,UAAQC,YAAW,OAClDtH,GAAK,CACR+B,SAAUgF,EACVpD,UAAW,OAEP4D,EAAmB,CACvBC,OAAQN,EACRO,iBAAkB,SAClBC,UAAW,SAAArH,GACT4G,EAAc5G,IAEhBsH,SAAU,SAAAtH,GACR8G,GAAiB,IAEnBS,QAAS,SAAAvH,GACP8G,GAAiB,KAGrB,OACEzC,gBAACN,EAAI,KACHM,gBAAC7E,EAAO,CAACiF,QA7BG,SAAAzE,GACdA,EAAEC,kBACF4C,EAAWC,IAAI,4BAA2B,OAAOnD,GAAK,CAAE+B,SAAUgF,OA2BpCvJ,GAC5BkH,gBAACmC,EAAW,KACG,cAAZG,GACCtC,gCACEA,gBAACG,SAAM,CAACC,QA5BI,SAAAzE,GACpB8G,GAAiB,KA2BqB,UAC9BzC,gBAACmD,QAAK,KAAKN,GACT7C,0EC1Dd,I,UAAMN,EAAOC,EAAOvE,IAAG,qBAEjBgI,EAAQzD,EAAOvE,IAAG,6DAIlBiI,EAAY1D,EAAOvE,IAAG,2GAKtBkI,EAAa3D,EAAOvE,IAAG,uGAKvBmI,EAAU5D,EAAOvE,IAAG,qKAM1B,SAAgBoI,EAAmBlI,GACzB,IAAA+B,EAAA,EAAAA,SAAUmB,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MACxB9E,EAA4B8E,EAAM9E,QAAQ5E,IL3BN,mBK+CpC4L,EAAgBhH,EAAQ6H,iBAAiB7D,GAEzCoG,EACqB,IAAzBpD,EAAcvF,OAAe,KAC3BkF,gBAACoD,EAAK,KACJpD,gBAACsD,EAAU,0BACXtD,gBAACqD,EAAS,KACPhD,EAActL,KAAI,SAAAP,GACjB,IAxBc6N,EAwBRqB,EAAU,OACXpI,GAAK,CACR9G,IAAG,EACH6N,OAAQ7N,EACR8N,QAAS,YACTC,eA7BYF,EA6BmB7N,EA7BT,SAAAmH,GAChCA,EAAEC,kBACF,IAAM+E,EAAUtH,EAAQ4H,UAAUxM,IAAI4I,GAAUsD,QAChDnC,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRgF,QAAS,CACP,CACE5B,OLxCkC,+BKyClCrB,SAAUA,EACV3D,UAAW1F,YAAUwM,OACrBH,cAAeM,EAAQgD,OAAOhD,EAAQiD,QAAQvB,IAASjB,mBAsBrD,OAAOpB,gBAACoC,EAAuB,KAAKsB,SAMxCG,EAAiBxK,EAAQgI,kBAAkBhE,GAE3CyG,EACsB,IAA1BD,EAAe/I,OAAe,KAC5BkF,gBAACoD,EAAK,KACJpD,gBAACsD,EAAU,2BACXtD,gBAACqD,EAAS,KACPQ,EAAe9O,KAAI,SAAAP,GAClB,IAAMkP,EAAU,OACXpI,GAAK,CACR9G,IAAG,EACH6N,OAAQ7N,EACR8N,QAAS,eAGX,OAAOtC,gBAACoC,EAAuB,KAAKsB,SAWxCK,EAAe5F,EAAM1E,WAAa4D,GACtC2C,gBAACoD,EAAK,KACJpD,gBAACuD,EAAO,CAACnD,QAPkB,SAAAzE,GAC7BA,EAAEC,kBACF4C,EAAWC,IAAI,4BAA6BnD,KAKF,sBAI5C,OACE0E,gBAACN,EAAI,CAAChE,YAAasI,eAChBP,EACAK,EACAC,G,SCrGSE,EAAkB3I,GACxB,IAAA6C,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SACThE,EACJ8E,EAAM9E,QAAQ5E,INP0B,oBMOW,IAAIqN,EACnDoC,EAAY7K,EAAQ4H,UAAUxM,IAAI4I,GAClCwG,EAAiB,GAIvB,GAHAxK,EAAQ4H,UAAUM,SAAQ,SAACC,EAAGC,GACxBD,EAAEb,QAAQe,SAASrE,IAAWwG,EAAelC,KAAKF,OAGxC,MAAbyC,GAAgD,IAA3BA,EAAUvD,QAAQwD,OACd,IAA1BN,EAAe/I,OAEf,OAAO,KAET,IAAMsJ,EAAY,CAChBC,UAAWC,gBAAc,aACzBC,UAAW,GAEPC,EAAOxE,gBAACyE,iBAAc,KAAKL,IAE3BM,EAAe,CACnB9G,WAAW,EACX9E,QAHqBkH,gBAACwD,EAAkB,KAAKlI,IAI7Ca,OAAQqI,EACRG,gBAAiBC,yBAAuBC,MACxCC,eAAgB,KAElB,OAAO9E,gBAAC+E,UAAO,KAAKL,I,SClCNM,EAAuB1J,GAC7B,IAAA+B,EAAA,EAAAA,SAAU4H,EAAA,EAAAA,kBACZC,EAAID,EAAkB9D,IAAI9D,GAC1B,qBAAC8H,EAAA,KAASC,EAAA,KACVC,EAAgB,CACpBF,QAAO,EACP1I,SAAU,WACJwI,EAAkB9D,IAAI9D,GACxB4H,EAAkBtB,OAAOtG,GAEzB4H,EAAkBK,IAAIjI,GAExB+H,GAAYD,KAGhB,OAAOnF,gBAACuF,iBAAc,KAAKF,ICR7B,I,UAEMG,EAAmB7F,EAFN8F,UAAQC,SAEF/F,CAAkB,yJAMrCgG,EAAahG,EAAOvE,IAAG,iTAWvBwK,EAAgBjG,EAAOoF,UAAPpF,CAAe,+DAI/BkG,GAAMlG,EAAOvE,IAAG,yOAQhB0K,GAAanG,EAAOvE,IAAG,qFAUvB2K,GAAgC,CACpCvI,YAAa,UAKf,SAAgBwI,GAAY1K,GAClB,IAAA6C,EAAA,EAAAA,MAAsBK,GAAf,EAAAyH,cAAe,EAAAzH,YAuBxB0H,EAAkB,SAAA7I,GAAY,gBAAA1B,GAClC6C,EAAWC,IAAI,4BAA2B,OAAOnD,GAAK,CAAE+B,SAAQ,OA+C5D8I,EA9DiB,WACrB,IAAM7E,EAAM,GAUZ,OATAnD,EAAM/E,OAAOmI,SAAQ,SAAC6E,EAAO/I,GAC3BiE,EAAIK,KAAK,CACPnN,IAAK6I,EACLgJ,MAAO7H,EAAWC,IAAI,gBAAe,OAChCnD,GAAK,CACR+B,SAAQ,UAIPiE,EAmDQgF,GAEjB,OACEtG,gBAACwF,EAAgB,CACfe,WAAYR,GACZS,kBAdyD,SAC3DC,EACAC,GAEA,OAAOA,EAAMC,QAAO,SAAAC,GAClB,OAAAA,EAAKP,MAAMQ,cAAcnF,SAAS+E,EAAMI,mBAUxC/D,QAAQ,EACR4D,MAAOP,EACPW,aApDiD,SAACC,EAASzL,GAQrD,IAAA9G,EAAA,EAAAA,IAAK,IAAA6R,MAEPW,EAAUC,EAAanM,OADX,IAEZuL,EAAQW,EACVC,EAAa9H,OAAO,EAHN,KAGsB,MACpC8H,EACEC,EAAa,CACjB1S,IAAG,EACH4L,QAAS8F,EAAgB1R,IAErB2S,EAAUnH,gBAAC2F,EAAU,KAAKuB,GAAab,GAMvCe,EAAe,CACnB5S,IAAG,EACH2H,OAAQgL,EACRrO,QAPAkH,gBAAC6F,GAAG,KACF7F,gBAAC8F,GAAU,KAAEmB,IAOfI,MAAM,EACN1C,gBAAiBC,yBAAuB0C,kBACxCxC,eAAgB,KAElB,OAAOkC,EAAUhH,gBAAC4F,EAAa,KAAKwB,IAAmBD,GAsBrDjE,QAhFY,WACd1E,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOwM,eACf/G,UAAW1F,YAAUwM,WA6ErB+G,eAAe,I,oBC7IY,oB,sBADE,iB,0BCQjC,IAAMC,EAAiB,SAAA7M,KAGvB,MAAO,CACL8M,iBAAA,SAAiBnM,EAAOiE,GACd,IAAAf,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MACduJ,EAAyBnI,IAc/B,OAZAmI,EAAQC,cAAc1F,IDhBO,iBCgBkB,CAC7C2F,MAAO,SACPC,MAAO,WACP/L,UAAW,WACT0C,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOsM,YACflD,SAAUc,EAAM1E,SAChBC,UDvBqB,0BC2BpBgO,GAGTI,uBAAsB,SAACxM,EAAOiE,GAC5B,IAAM+B,EAAM/B,IAEZ,GDjC2B,sBCgCnB,EAAApB,MACEzE,UAAiC,CACzC,IAAMqO,EAAgB,KACpBvT,IAAK,gBACF8G,GAAK,CACRkM,eAAc,IAEhBlG,EAAIK,KAAK3B,gBAACgG,GAAW,KAAK+B,KAE5B,OAAOzG,K,kCCfX,IAAI2D,EAAoB,IAAI+C,IAC5B,SAASC,EAAwB,G,IAAE9J,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAClChE,EAA4B8E,EAAM0D,eXtBA,kBWwBtCC,GAUF,OAPAmD,EAAoB,IAAI+C,IAAI3O,EAAQ6H,iBAAiB7D,IAErDc,EAAQ+J,gBAAcC,WAAW,CAC/BhK,MAAK,EACLd,SAAQ,EACR3D,UXtCJ,oCW2CA,MAAO,CACL0O,0BAAyB,SAAC9M,EAAOiE,GACvB,IAAAf,EAAA,EAAAA,WAWR,OACEwB,gCACGT,IACDS,gBAACqI,cAAW,MACZrI,gBAACsI,WAAQ,CACP9T,IXrD2B,0BWsD3BgQ,KAAM+D,OAAK,aACXrJ,KAAK,uBACLkB,QAlBN,SAAmCzE,GACjC6C,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OX9CR,wCWgDMF,EAAWC,IAAI,mBAAkB,OAC5BnD,GAAK,CACRkN,UAAW,CAACvU,SAAOwU,yBAiBzBC,SAAQ,SAACpN,EAAOiE,GACd,IAAMoJ,EAAQpJ,IAGd,OAFAoJ,EAAM1G,IXrEV,qCWqEkDgG,GAC9CU,EAAM1G,IXrEgC,+BWqEEL,GACjC+G,GAGTC,iBAAA,SAAiBtN,EAAOiE,GACtB,IAAIpB,EAAeoB,IACXb,EAAA,EAAAA,OAAQrB,EAAA,EAAAA,SAEhB,GACEqB,IAAWzK,SAAO4U,cAClBxL,IAAac,EAAM3E,mBACnB,CACA,IAAMsP,EAAgBC,qBAAmB5K,EAAOd,GAChDyL,EAAcnH,KAAKtE,GAEnB,IAAI,EAA4Bc,EAAM0D,eXlFF,kBWoFlCC,GAEE,EAAY,EAAQb,UAExB6H,EAAcvH,SAAQ,SAACyH,GACrB,IAAMnF,EAAiB,EAAQxC,kBAAkB2H,IAGjD,EAAY,EAAUC,eAAc,SAAAhI,GAClC4C,EAAetC,SAAQ,SAAAC,GACrBP,EAAUiI,SAAS,CAAC1H,EAAG,YAAY,SAACb,GAClC,OAAAA,EAAQgD,OAAOhD,EAAQiD,QAAQoF,cAKvB7H,IAAI6H,KAChB,EAAY,EAAUrF,OAAOqF,OAIjC,EAAU,EAAQ/G,IAAI,YAAa,GACnC9D,EAAQA,EAAM+D,MAAM,CAAC,UX1Ge,mBW0G2B,GAEjE,OAAO/D,GAGT2J,uBAAA,SAAuBxM,EAA8BiE,GAC3C,IAAApB,EAAA,EAAAA,MACF4B,EADS,EAAAvB,WAEFkE,SAASC,UAAQwG,gCAAkC,EAC1D7H,EAAM/B,IACZ,GX1HJ,oCW0HQpB,EAAMzE,UAA+C,CACvD,IAAM0P,EAAU,OACX9N,GAAK,CACRyE,OAAM,EACN1C,SAAUc,EAAM1E,SAChBjF,IAAK,2BAEP8M,EAAIK,KAAK3B,gBAACF,EAAsB,KAAKsJ,KAEvC,OAAO9H,GAGT+H,yBAAwB,SAAC/N,EAAOiE,GACtB,IAAApB,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUmB,EAAA,EAAAA,WACnB8C,EAAM/B,IAOZ,GANA+B,EAAIK,KACFnD,EAAWC,IAAI,0BAAyB,OACnCnD,GAAK,CACR9G,IAAK8U,mCX5Ib,oCWgJMnL,EAAMzE,WACNyE,EAAM1E,WAAa4D,EACnB,CACA,IAAMkM,EAAa,OAAQjO,GAAK,CAAE9G,IAAK,WAAYyQ,kBAAiB,IAC9DuE,EAAWxJ,gBAACgF,EAAsB,KAAKuE,IAC7CjI,EAAIK,KAAK6H,GAEX,OAAOlI,GAGTmI,wBAAuB,SAACnO,EAAOiE,GAC7B,OAAOS,gBAACiE,EAAiB,KAAK3I,KAGhCoO,2BAA0B,WACxBzE,EAAkB0E,SAGpBC,yBAAwB,WACtB,OAAO/U,MAAMgV,KAAK5E,IAIpB6E,uBAAsB,SAACxO,EAAOiE,GACpB,IAAAwK,EAAA,EAAAA,WAAYC,EAAA,EAAAA,YACpB,GXnKsC,oBWmKlCD,EAA6C,CAC/C,IAAIE,EAAmB,IAAInI,E,WAChBtN,GACT,IAAMoS,EAAOoD,EAAY/I,UAAUzM,GAC7BuN,EAAkB,IAAIC,EAAgB,CAC1CrB,QAASC,OAAKgG,EAAKjG,SACnBE,QAASC,MAAI8F,EAAK/F,WAEpBoJ,EAAmBA,EAAiBC,OAAO,aAAa,SAAAjJ,GACtD,OAAAA,EAAUgB,IAAIzN,EAAKuN,OAPvB,IAAK,IAAMvN,KAAOwV,EAAY/I,U,EAAnBzM,GAUX,OAAOyV,EAET,OAAO1K,Q,iCCxLb,e,gCCAA,2pEAgCI1F,EAAiB,SAAuBC,EAAG5B,GAW7C,OAVA2B,EAAiBE,OAAOC,gBAAkB,CACxCC,UAAW,cACApF,OAAS,SAAUiF,EAAG5B,GACjC4B,EAAEG,UAAY/B,IACX,SAAU4B,EAAG5B,GAChB,IAAK,IAAIgC,KAAKhC,EACRA,EAAEiC,eAAeD,KAAIJ,EAAEI,GAAKhC,EAAEgC,MAIhBJ,EAAG5B,IAG3B,SAASkC,EAAUN,EAAG5B,GAGpB,SAASmC,IACPhG,KAAKiG,YAAcR,EAHrBD,EAAeC,EAAG5B,GAMlB4B,EAAES,UAAkB,OAANrC,EAAa6B,OAAO/E,OAAOkD,IAAMmC,EAAGE,UAAYrC,EAAEqC,UAAW,IAAIF,GAGjF,IAAIG,EAAU,WAaZ,OAZAA,EAAUT,OAAOU,QAAU,SAAkBC,GAC3C,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAItG,UAAUuG,OAAQF,EAAIC,EAAGD,IAG9C,IAAK,IAAIV,KAFTS,EAAIpG,UAAUqG,GAGRb,OAAOQ,UAAUJ,eAAeY,KAAKJ,EAAGT,KAAIQ,EAAER,GAAKS,EAAET,IAI7D,OAAOQ,IAGMpG,MAAMD,KAAME,YAG7B,SAAS4V,EAAOxP,EAAGgB,GACjB,IAAIjB,EAAI,GAER,IAAK,IAAIR,KAAKS,EACRZ,OAAOQ,UAAUJ,eAAeY,KAAKJ,EAAGT,IAAMyB,EAAEiI,QAAQ1J,GAAK,IAAGQ,EAAER,GAAKS,EAAET,IAG/E,GAAS,MAALS,GAAqD,oBAAjCZ,OAAOqQ,sBAA2C,KAAIxP,EAAI,EAAb,IAAgBV,EAAIH,OAAOqQ,sBAAsBzP,GAAIC,EAAIV,EAAEY,OAAQF,IAClIe,EAAEiI,QAAQ1J,EAAEU,IAAM,GAAKb,OAAOQ,UAAU8P,qBAAqBtP,KAAKJ,EAAGT,EAAEU,MAAKF,EAAER,EAAEU,IAAMD,EAAET,EAAEU,KAEhG,OAAOF,EAGT,SAAS4P,EAAWC,EAAYpO,EAAQ3H,EAAKgW,GAC3C,IAEI1Q,EAFAvC,EAAIhD,UAAUuG,OACdtD,EAAID,EAAI,EAAI4E,EAAkB,OAATqO,EAAgBA,EAAOzQ,OAAO0Q,yBAAyBtO,EAAQ3H,GAAOgW,EAE/F,GAAuB,kBAAZE,SAAoD,oBAArBA,QAAQC,SAAyBnT,EAAIkT,QAAQC,SAASJ,EAAYpO,EAAQ3H,EAAKgW,QAAW,IAAK,IAAI5P,EAAI2P,EAAWzP,OAAS,EAAGF,GAAK,EAAGA,KAC1Kd,EAAIyQ,EAAW3P,MAAIpD,GAAKD,EAAI,EAAIuC,EAAEtC,GAAKD,EAAI,EAAIuC,EAAEqC,EAAQ3H,EAAKgD,GAAKsC,EAAEqC,EAAQ3H,KAASgD,GAE5F,OAAOD,EAAI,GAAKC,GAAKuC,OAAOsB,eAAec,EAAQ3H,EAAKgD,GAAIA,EAG9D,SAASoT,EAASC,GAChB,IAAIC,EAAsB,oBAAXC,QAAyBF,EAAEE,OAAOC,UAC7CpQ,EAAI,EACR,OAAIkQ,EAAUA,EAAE/P,KAAK8P,GACd,CACLtL,KAAM,WAEJ,OADIsL,GAAKjQ,GAAKiQ,EAAE/P,SAAQ+P,OAAI,GACrB,CACLnW,MAAOmW,GAAKA,EAAEjQ,KACdqQ,MAAOJ,KAMf,SAASK,EAAOL,EAAGhQ,GACjB,IAAIiQ,EAAsB,oBAAXC,QAAyBF,EAAEE,OAAOC,UACjD,IAAKF,EAAG,OAAOD,EACf,IACIrT,EAEAmE,EAHAf,EAAIkQ,EAAE/P,KAAK8P,GAEXM,EAAK,GAGT,IACE,WAAc,IAANtQ,GAAgBA,KAAM,MAAQrD,EAAIoD,EAAE2E,QAAQ0L,MAClDE,EAAGxJ,KAAKnK,EAAE9C,OAEZ,MAAO0W,GACPzP,EAAI,CACFyP,MAAOA,GAET,QACA,IACM5T,IAAMA,EAAEyT,OAASH,EAAIlQ,EAAU,SAAIkQ,EAAE/P,KAAKH,GAC9C,QACA,GAAIe,EAAG,MAAMA,EAAEyP,OAInB,OAAOD,EAGT,SAASE,IACP,IAAK,IAAIF,EAAK,GAAIvQ,EAAI,EAAGA,EAAIrG,UAAUuG,OAAQF,IAC7CuQ,EAAKA,EAAGjW,OAAOgW,EAAO3W,UAAUqG,KAGlC,OAAOuQ,EAGT,SAASG,EAAqBtQ,EAAQC,GASpC,OARIlB,OAAOsB,eACTtB,OAAOsB,eAAeL,EAAQ,MAAO,CACnCtG,MAAOuG,IAGTD,EAAOC,IAAMA,EAGRD,EAGT,IA4MIE,EAAkBqQ,EAiGlBC,EAAoBC,EAAoBC,EAAkBC,EAAkBC,EAAkBC,EAAkBC,EAAkBC,EAAkBC,EAAkBC,EAAmBC,EA7SzLC,EAEJ,SAAU/X,GAGR,SAAS+X,EAAW7Q,GAClB,OAAOlH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KAoBrC,OAvBA+F,EAAU+R,EAAY/X,GAMtB+X,EAAW5R,UAAU6R,UAAY,SAAU1N,EAAQ2N,GACjDhY,KAAKiH,MAAMkD,WAAWC,IAAI,YAAajE,EAAQ,CAC7CkE,OAAQA,GACP2N,KAGLF,EAAW5R,UAAUkE,IAAM,SAAU9I,EAAM0W,GACzChY,KAAKiH,MAAMkD,WAAWC,IAAI9I,EAAM0W,IAGlCtS,OAAOsB,eAAe8Q,EAAW5R,UAAW,QAAS,CACnD9F,IAAK,WACH,OAAOJ,KAAKiH,MAAM6C,MAAMC,SAAS/J,KAAKiH,MAAM+B,WAE9CiP,YAAY,EACZC,cAAc,IAETJ,EAxBT,CAyBE,iBAEEK,EAAM,IAAM,2BACZC,EAAiB,UAAOrR,IAAIF,IAAqBA,EAAmBoQ,EAAqB,CAAC,mFAAoF,CAAC,sFAC/KoB,EAAoB,UAAOtR,IAAImQ,IAAqBA,EAAmBD,EAAqB,CAAC,oDAAqD,CAAC,uDAEnJqB,EAEJ,SAAUvY,GAGR,SAASuY,EAAiBrR,GACxB,IAAIE,EAAQpH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KA2HxC,OAzHAmH,EAAMoR,sBAAwB,SAAUC,EAASC,GAC/C,GAAItR,EAAMuR,eAAgB,CACxB,IAAIC,EAAc,CAChBC,MAAOzR,EAAM1C,QAAQoU,YAA0C,EAA5B1R,EAAM2R,QAAQD,YACjDE,OAAQ5R,EAAM1C,QAAQuU,aAA4C,EAA7B7R,EAAM2R,QAAQE,cAErD7R,EAAM8R,QAAQpU,MAAM+T,MAAQD,EAAYC,MAAQ,KAChDzR,EAAM8R,QAAQpU,MAAMkU,OAASJ,EAAYI,OAAS,KAGpD5R,EAAMuR,eAAiBF,EAAQ,GAAGU,aAGpC/R,EAAMgS,sBAAwB,IAAI,UAAehS,EAAMoR,uBAEvDpR,EAAMiS,WAAa,SAAUlR,GACvBA,IACFf,EAAM1C,QAAUyD,EAEhBf,EAAMgS,sBAAsBE,QAAQlS,EAAM1C,WAI9C0C,EAAMmS,WAAa,SAAUpR,GACvBA,IACFf,EAAM2R,QAAU5Q,EAEXf,EAAMF,MAAMsS,mBACfpB,EAAI,4BAEJhR,EAAM2R,QAAQrQ,iBAAiB,SAAS,SAAUnB,GAChD6Q,EAAI,YACH7Q,EAAEqC,SAAWrC,EAAEkS,SAAWlS,EAAEmS,mBAC5B,CACDC,SAAS,KAIbvS,EAAMwS,iBAAiBxS,EAAM2R,QAAQD,YAAa1R,EAAM2R,QAAQE,gBAIpE7R,EAAMyS,WAAa,SAAU1R,GACvBA,IACFf,EAAM8R,QAAU/Q,IAIpBf,EAAM0S,eAAiB,WACjB1S,EAAM1C,SAAW0C,EAAM2R,SAAW3R,EAAM8R,UAC1C9R,EAAM8R,QAAQpU,MAAM+T,MAAkE,GAAzDzR,EAAM1C,QAAQoU,YAAc1R,EAAM2R,QAAQD,aAAmB,KAC1F1R,EAAM8R,QAAQpU,MAAMkU,OAAqE,GAA3D5R,EAAM1C,QAAQuU,aAAe7R,EAAM2R,QAAQE,cAAoB,KAC7F7R,EAAM1C,QAAQI,MAAMiV,KAAO3S,EAAM2R,QAAQD,YAAc,KACvD1R,EAAM1C,QAAQI,MAAMkV,IAAM5S,EAAM2R,QAAQE,aAAe,OAI3D7R,EAAMwS,iBAAmB,SAAUG,EAAMC,GACvC5B,EAAI,oBAAsB2B,EAAO,IAAMC,GAEnC5S,EAAM2R,UACR3R,EAAM2R,QAAQkB,WAAaF,EAC3B3S,EAAM2R,QAAQmB,UAAYF,IAI9B5S,EAAM+S,sBAAwB,SAAUC,EAAWC,GACjDjC,EAAI,yBAA2BgC,EAAY,IAAMC,GAE7CjT,EAAM2R,UACR3R,EAAM2R,QAAQkB,YAAcG,EAC5BhT,EAAM2R,QAAQmB,WAAaG,IAI/BjT,EAAME,YAAc,SAAUC,GAM5B,IAAIe,EAAKlB,EAAMF,MACXoT,EAAWhS,EAAGgS,SACdC,EAAiBjS,EAAGiS,eACpBC,EAAclS,EAAGkS,YACrB,KAAIA,GAAgBA,OAEH,IAAbjT,EAAEkT,QAA6B,SAAbH,GAAoC,IAAb/S,EAAEkT,QAA6B,UAAbH,GAAsB,CACnF,GAAIC,IACGhT,EAAEqC,QAAS,OAGlBxC,EAAMsT,YAActT,EAAM2R,QAAQkB,WAAa1S,EAAEoC,YAAYgR,QAC7DvT,EAAMwT,YAAcxT,EAAM2R,QAAQmB,UAAY3S,EAAEoC,YAAYkR,QAC5D,IAAIC,EAAM1T,EAAM2R,QAChB+B,EAAIpS,iBAAiB,YAAatB,EAAMK,aACxCqT,EAAIpS,iBAAiB,UAAWtB,EAAM2T,aAI1C3T,EAAM2T,UAAY,SAAUxT,GAC1B,IAAIuT,EAAM1T,EAAM2R,QAChB+B,EAAIlS,oBAAoB,YAAaxB,EAAMK,aAC3CqT,EAAIlS,oBAAoB,UAAWxB,EAAM2T,YAG3C3T,EAAMK,YAAc,SAAUF,GAC5BH,EAAM2R,QAAQkB,WAAa7S,EAAMsT,YAAcnT,EAAEoT,QACjDvT,EAAM2R,QAAQmB,UAAY9S,EAAMwT,YAAcrT,EAAEsT,SAGlDzT,EAAM4T,kBAAoB,SAAUzT,GAClCA,EAAEmS,kBAGJtS,EAAMC,MAAQ,CACZuR,YAAa,CACXC,MAAO,UACPG,OAAQ,YAGL5R,EAuCT,OArKApB,EAAUuS,EAAkBvY,GAiI5BuY,EAAiBpS,UAAUqC,kBAAoB,WAC7CvI,KAAK6Z,iBACLrR,SAASC,iBAAiB,cAAezI,KAAK+a,oBAGhDzC,EAAiBpS,UAAUwC,qBAAuB,WAChDF,SAASG,oBAAoB,cAAe3I,KAAK+a,oBAGnDzC,EAAiBpS,UAAU8U,cAAgB,SAAUzV,GACnDvF,KAAKiZ,QAAQpU,MAAMoW,UAAY,SAAW1V,EAAa,IACvDvF,KAAKiZ,QAAQpU,MAAMqW,gBAAkB,WAGvC5C,EAAiBpS,UAAU6C,OAAS,WAClC,IAAIlE,EAAQsB,EAAQ,GAAInG,KAAKoH,MAAMuR,aAKnC,OAAO,wBAAcP,EAAgB,CACnClQ,IAAKlI,KAAKsZ,WACVjS,YAAarH,KAAKqH,aACjB,wBAAc,MAAO,CACtBxC,MAAOA,EACPqD,IAAKlI,KAAK4Z,YACT,wBAAcvB,EAAmB,CAClCnQ,IAAKlI,KAAKoZ,WACVvU,MAAO7E,KAAKoH,MAAMxF,cACjB5B,KAAKiH,MAAMkU,SAASnb,KAAK2Z,iBAAkB3Z,KAAKka,2BAGrD5B,EAAiB8C,aAAe,CAC9Bf,SAAU,OACVC,gBAAgB,GAEXhC,EAtKT,CAuKE,aAGE+C,EAAQ,IAAM,iBAEdC,EAEJ,SAAUvb,GAGR,SAASub,IACP,IAAInU,EAAmB,OAAXpH,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAyDhE,OAvDAmH,EAAMoU,OAAS,SAAUja,GAEvB,OADA+Z,EAAMlU,GACCA,EAAM7F,IAGf6F,EAAMc,QAAU,SAAU3G,GACxB,OAAO,SAAUka,GACXA,IACFrU,EAAM7F,GAAQka,EAEdrU,EAAMsU,aAAana,EAAMka,MAK/BrU,EAAMuU,UAAY,SAAUpa,GAC1B+Z,EAAM,aAAc/Z,UACb6F,EAAM7F,IAGf6F,EAAMwU,UAAY,IAAIlP,IAEtBtF,EAAMsU,aAAe,SAAUna,EAAM4G,GACnC,IAAI0T,EAAKvT,EAET,GAAIlB,EAAMwU,UAAU7O,IAAIxL,GAAO,CAC7B,IAAIua,EAAY1U,EAAMwU,UAAUvb,IAAIkB,GAEpC,IACE,IAAK,IAAIwa,EAAcvF,EAASsF,GAAYE,EAAgBD,EAAY5Q,QAAS6Q,EAAcnF,KAAMmF,EAAgBD,EAAY5Q,OAAQ,EAEvI8Q,EADeD,EAAc1b,OACpBiB,EAAM4G,IAEjB,MAAO+T,GACPL,EAAM,CACJ7E,MAAOkF,GAET,QACA,IACMF,IAAkBA,EAAcnF,OAASvO,EAAKyT,EAAYI,SAAS7T,EAAG3B,KAAKoV,GAC/E,QACA,GAAIF,EAAK,MAAMA,EAAI7E,UAM3B5P,EAAMgV,oBAAsB,SAAU7a,EAAM0a,GACrC7U,EAAMwU,UAAU7O,IAAIxL,GAGvB6F,EAAMwU,UAAUvb,IAAIkB,GAAMgM,KAAK0O,GAF/B7U,EAAMwU,UAAU/N,IAAItM,EAAM,CAAC0a,KAMxB7U,EAOT,OAnEApB,EAAUuV,EAASvb,GA+DnBub,EAAQpV,UAAU6C,OAAS,WACzB,OAAO/I,KAAKiH,MAAMkU,SAASnb,KAAKiI,QAASjI,KAAKub,OAAQvb,KAAK0b,UAAW1b,KAAKmc,oBAAoB9S,KAAKrJ,QAG/Fsb,EApET,CAqEE,aAEE1P,EAAO,UAAO7E,IAAIoQ,IAAuBA,EAAqBF,EAAqB,CAAC,yCAA0C,qBAAsB,yBAA0B,OAAQ,CAAC,yCAA0C,qBAAsB,yBAA0B,UAAU,SAAUhQ,GACvS,OAAOA,EAAMmV,cAAgBnV,EAAMmV,cAAgB,SAClD,SAAUnV,GACX,OAAOA,EAAMoV,cACZ,SAAUpV,GACX,OAAOA,EAAM4E,kBAEXyQ,EAAS,UAAOvV,IAAIqQ,IAAuBA,EAAqBH,EAAqB,CAAC,eAAgB,OAAQ,CAAC,eAAgB,UAAU,SAAUhQ,GACrJ,OAAOA,EAAMsV,UAEXC,EAAe,UAAO3L,EAAEwG,IAAqBA,EAAmBJ,EAAqB,CAAC,qCAAsC,CAAC,wCAC7HwF,EAAS,UAAO1V,IAAIuQ,IAAqBA,EAAmBL,EAAqB,CAAC,2CAA4C,CAAC,8CAC/HyF,EAAM,UAAO3V,IAAIwQ,IAAqBA,EAAmBN,EAAqB,CAAC,iEAAkE,CAAC,oEAClJ/F,EAAiB,kBAAO,WAAP,CAAiBsG,IAAqBA,EAAmBP,EAAqB,CAAC,wCAAyC,CAAC,2CAC1I0F,EAAY,kBAAOD,EAAP,CAAYjF,IAAqBA,EAAmBR,EAAqB,CAAC,4EAA6E,CAAC,+EACpKzL,GAAQ,UAAOzE,IAAI2Q,IAAqBA,EAAmBT,EAAqB,CAAC,uBAAwB,CAAC,0BAC1G7G,GAAiB,UAAOwM,KAAKjF,IAAqBA,EAAmBV,EAAqB,CAAC,wEAAyE,CAAC,2EACrK1L,GAAS,UAAOxE,IAAI6Q,IAAsBA,EAAoBX,EAAqB,CAAC,gBAAiB,OAAQ,CAAC,gBAAiB,UAAU,SAAUhQ,GACrJ,OAAOA,EAAMyE,UAEXmR,GAAe,UAAO9V,IAAI8Q,IAAsBA,EAAoBZ,EAAqB,CAAC,oEAAqE,CAAC,uEAEhK1M,GAAQ,IAAM,gBAElB,SAASuS,KACP,IAAIC,EAAiB,GACrB,MAAO,CACLC,iBAAkB,SAA0B/V,GAC1CsD,GAAM,oBACN,IAAIJ,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACrBuB,GAAMT,EAAMvE,YAEiB,OAAzBuE,EAAMY,gBACNZ,EAAMI,oBAAsBlB,IAC5Bc,EAAM1E,WAAa4D,GAAYc,EAAMzE,YAAc,YAAU4X,iBACjE9S,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAO6B,YACf7G,UAAW,YAAU8G,YAGzB+Q,uBAAwB,SAAgCjW,GACtD,IAAIkD,EAAalD,EAAMkD,WAEM,OADjBlD,EAAM6C,MACRY,gBACVP,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAO6B,YACf7G,UAAW,YAAU4X,oBAGzBE,uBAAwB,SAAgClW,GACrCA,EAAMkD,WACZC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAO6B,YACf7G,UAAW,YAAU+X,eAGzBC,uBAAwB,SAAgCpW,GACtD,IAAIkD,EAAalD,EAAMkD,WACnBmT,EAAmBnT,EAAWC,IAAI,sBAAuBnD,GAC7D,OAAwB,MAApBqW,EAAiC,KAEP,cAA1BA,EAAiBhc,KACZ,WACL6I,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtD5B,UAAW,YAAU8G,OACrB9B,OAAQ,SAAO6B,qBAJrB,GASFzD,iBAAkB,SAA0BxB,GAC1C,IAAI9G,EAAM8G,EAAM9G,IACZ6b,EAAW/U,EAAM+U,SACjBuB,EAAOtW,EAAMsW,KACbpT,EAAalD,EAAMkD,WAUvB,SAASqT,IACPxB,IACA7R,EAAWC,IAAI,sBAAuB,CACpCjK,IAAKA,EACL6b,SAAUA,IAbTe,EAAe5c,KAAM4c,EAAe5c,GAAO,IAE5Cod,GACFC,EAAKC,OAASzB,EACde,EAAe5c,GAAKmN,KAAKkQ,IAEzBT,EAAe5c,GAAKmN,KAAK0O,IAW7BrT,oBAAqB,SAA6B1B,GAChD,IAAI9G,EAAM8G,EAAM9G,IACZ6b,EAAW/U,EAAM+U,SAEjBe,EAAe5c,KACjB4c,EAAe5c,GAAO4c,EAAe5c,GAAKmS,QAAO,SAAUoL,GACzD,OAAOA,IAAO1B,GAAY0B,EAAGD,SAAWzB,OAI9C2B,UAAW,SAAmB1W,GAC5B,IAAI9G,EAAM8G,EAAM9G,IAEZ4c,EAAe5c,IACjB4c,EAAe5c,GAAK+M,SAAQ,SAAUwQ,GACpC,OAAOA,SAOjB,IAAIE,GAAW,CACbC,UAAW,YACXC,MAAO,QACPC,aAAc,eACdC,MAAO,QACPC,KAAM,OACNC,MAAO,QACPC,aAAc,WACdC,WAAY,SACZC,OAAQ,SACRC,MAAO,QACPC,OAAQ,SACRC,MAAO,QACPC,OAAQ,SACRC,UAAW,YAGb,SAASzO,GAAc3O,GACrB,MAAO,oBAAsBA,EAG/B,SAAS4S,GAAKyK,GACZ,OAAO,wBAAc,OAAQ,CAC3B3O,UAAWC,GAAc0O,KAI7B,SAASC,GAAcze,GACrB,MAAO,WAAaA,EAGtB,SAASqJ,GAAoBrJ,GAC3B,MAAO,kBAAoBA,EAG7B,SAASqK,GAAiBrK,GACxB,MAAO,eAAiBA,EAG1B,SAAS0e,GAAkB1e,GACzB,MAAO,gBAAkBA,EAG3B,SAAS2e,GAAY3e,GACnB,MAAO,SAAWA,EAGpB,SAAS4e,GAAY5e,GACnB,MAAO,SAAWA,EAGpB,SAAS6e,GAAe7e,GACtB,MAAO,aAAeA,EAGxB,SAAS8e,GAAe9e,GACtB,MAAO,YAAcA,EAGvB,SAAS+e,GAAe/e,EAAKgf,GAC3B,MAAO,YAAcA,EAAM,IAAMhf,EAGnC,IAAIif,GAAS,CACXC,iBAAkB,eAClBC,uBAAwB,mBACxBC,kBAAmB,gBACnBC,oBAAqB,kBACrBC,gBAAiB,eAEfC,GAAW,CACbC,kBAAmB,qBAEjBrR,GAAU,CACZwG,+BAAgC,iCAChC8K,2BAA4B,6BAC5BrR,YAAa,eAGXoB,GAAc,SAAqBrI,GACrCA,EAAEC,mBAGJ,SAASsY,GAAoBC,EAAKC,GAChC,IAAIC,EAAOxX,SAASyX,cAAc,KAClCD,EAAKE,KAAOJ,EACZE,EAAKG,SAAWJ,EAChBC,EAAKI,QAGP,SAASC,GAAoBxV,EAAMkV,GAEjCF,GADU,mBAAqBS,mBAAmBzV,GACzBkV,GAG3B,SAASQ,GAAgBC,GACvB,IAAIC,EAAQjY,SAASyX,cAAc,SAGnC,OAFAQ,EAAM3f,KAAO,OACb2f,EAAMD,OAASA,EACR,IAAIE,SAAQ,SAAUC,EAASC,GACpCH,EAAMhY,iBAAiB,UAAU,SAAUoY,GAEzC,IAAIC,EAAOD,EAAI/Y,OAAOiZ,MAAM,GACxBC,EAAK,IAAIC,WAEbD,EAAGE,OAAS,SAAUL,GACpB,IAAIM,EAAMN,EAAI/Y,OAAOsZ,OAErBT,EAAQQ,IAGVH,EAAGK,QAAU,SAAUR,GACrBD,EAAOC,EAAI/Y,OAAOiP,QAGpBiK,EAAGM,WAAWR,MAEhBL,EAAML,WAIV,SAASmB,GAAWvJ,GAClB,IAAI3P,EAAK2P,EAAI+B,IACTA,OAAa,IAAP1R,EAAgB,EAAIA,EAC1BY,EAAK+O,EAAIwJ,MACTA,OAAe,IAAPvY,EAAgB,EAAIA,EAC5BwY,EAAKzJ,EAAI0J,OACTA,OAAgB,IAAPD,EAAgB,EAAIA,EAC7BE,EAAK3J,EAAI8B,KAEb,OAAOC,EAAM,MAAQyH,EAAQ,MAAQE,EAAS,YAD5B,IAAPC,EAAgB,EAAIA,GAC8B,KAG/D,SAASC,GAAWC,EAASC,GAC3B,MAAO,QAAUD,EAAU,IAAMC,EAGnC,SAASC,GAAQC,GACf,OAAQA,EAAKjI,IAAMiI,EAAKN,QAAU,EAGpC,SAASO,GAAQD,GACf,OAAQA,EAAKlI,KAAOkI,EAAKR,OAAS,EAGpC,SAASU,GAAaC,EAAIC,GACxB,OAAQD,EAAGE,EAAID,EAAGC,GAAK,EAGzB,SAASC,GAAaH,EAAIC,GACxB,OAAQD,EAAGI,EAAIH,EAAGG,GAAK,EAGzB,SAASC,GAAOR,GACd,MAAO,EAAEA,EAAKlI,KAAOkI,EAAKR,OAAS,GAAIQ,EAAKjI,IAAMiI,EAAKN,QAAU,GAGnE,SAASe,GAAiBC,EAAIC,EAAKC,QACnB,IAAVA,IACFA,EAAQ,GAGV,IAAIZ,EAAOU,EAAGG,wBAEVC,EAAYN,GADFG,EAAIE,yBAEdE,EAAWP,GAAOR,GACtBe,EAAS,IAAMA,EAAS,GAAKD,EAAU,IAAMF,EAC7CG,EAAS,IAAMA,EAAS,GAAKD,EAAU,IAAMF,EAC7C,IAAIhK,EAAQoJ,EAAKpJ,MAAQgK,EACrB7J,EAASiJ,EAAKjJ,OAAS6J,EAC3B,MAAO,CACL9I,KAAMiJ,EAAS,GAAKnK,EAAQ,EAC5B4I,MAAOuB,EAAS,GAAKnK,EAAQ,EAC7BmB,IAAKgJ,EAAS,GAAKhK,EAAS,EAC5B2I,OAAQqB,EAAS,GAAKhK,EAAS,EAC/BH,MAAOA,EACPG,OAAQA,GAIZ,SAASiK,GAAkBN,EAAIC,GAC7B,IAAIX,EAAOU,EAAGG,wBAEVC,EAAYN,GADFG,EAAIE,yBAEdE,EAAWP,GAAOR,GACtB,MAAO,CAACe,EAAS,GAAKD,EAAU,GAAIC,EAAS,GAAKD,EAAU,IAyB9D,IAAIG,GAAa,CACfC,UAAW,YACXC,YAAa,cACb3O,aAAc,eACd4O,aAAc,eACdC,WAAY,aACZC,gBAAiB,mBAmBnB,SAASC,KACP,MAAO,CACLnQ,iBAAkB,SAA0BnM,GAC1C,IAAIuc,EAAgB,SAAuBnZ,GACzC,OAAO,SAAU/C,IApBzB,SAAY+C,EAAQpD,GAClB,IAAI+B,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,gBAENsZ,IAAbza,IACF/B,EAAQd,EAAQA,EAAQ,GAAIc,GAAQ,CAClC+B,SAAUc,EAAM1E,YAIpB+E,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQA,KAUFqZ,CAAGrZ,EAAQpD,KA8Bf,MAAO,CACL0c,aA3BiB,IAAIlX,IAAI,CAAC,CAACwW,GAAWC,UAAW,CACjD3P,MAAO,YACPC,MAAO,MACP/L,UAAW+b,EAAc,SAAON,aAC9B,CAACD,GAAWE,YAAa,CAC3B5P,MAAO,cACPC,MAAO,QACP/L,UAAW+b,EAAc,SAAOL,eAC9B,CAACF,GAAWzO,aAAc,CAC5BjB,MAAO,eACPC,MAAO,MACP/L,UAAW+b,EAAc,SAAOhP,gBAC9B,CAACyO,GAAWG,aAAc,CAC5B7P,MAAO,eACPC,MAAO,QACP/L,UAAW+b,EAAc,SAAOI,yBAC9B,CAACX,GAAWI,WAAY,CAC1B9P,MAAO,aACPC,MAAO,UACP/L,UAAW+b,EAAc,SAAOK,sBAC9B,CAACZ,GAAWK,gBAAiB,CAC/B/P,MAAO,kBACPC,MAAO,kBACP/L,UAAW+b,EAAc,SAAOF,qBAKhChQ,cAHkB,IAAI7G,OA6M9B,IAAIqX,GAAQ,IAAM,oBAElB,SAASC,KA6FP,IAAIC,EAAQ,IAAIvX,IAAI,CAAC,CAAC,SAAO2H,gBAAiB,gBAAc6P,gBAAiB,CAAC,SAAO9F,aAAc,gBAAc+F,aAAc,CAAC,SAAO9F,WAAY,gBAAc+F,WAAY,CAAC,SAAOC,UAAW,gBAAcC,UAAW,CAAC,SAAOnB,UAAW,gBAAcoB,UAAW,CAAC,SAAOnB,YAAa,gBAAcoB,YAAa,CAAC,SAAO/P,aAAc,gBAAcgQ,aAAc,CAAC,SAAOtY,YAAa,gBAAc4H,YAAa,CAAC,SAAO1H,eAAgB,gBAAcqY,cAAe,CAAC,SAAOC,UAAW,gBAAcC,UAAW,CAAC,SAAOC,UAAW,gBAAcC,UAAW,CAAC,SAAOC,gBAAiB,gBAAcC,cAAe,CAAC,SAAOC,mBAAoB,gBAAcC,aAAc,CAAC,SAAOrB,sBA5FhoB,SAA6Bvb,GACrD,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SAClB,OAAO,gBAAc8K,WAAW,CAC9BhK,MAAOA,EACPd,SAAUA,EACV3D,UAAW,YAAU4X,oBAsF8qB,CAAC,SAAO4G,mBAlFxrB,SAA0Bxb,GAC/C,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SAEdmN,EADQrM,EAAMC,SAASf,GACVgB,SAAS,YAAUkb,MAgBpC,OAdkB,MAAd/O,EAAKrS,OAAoC,MAAnBqS,EAAKrS,MAAM/C,OACnC+I,EAAQ,gBAAcib,aAAa,CACjCjb,MAAOA,EACPd,SAAUA,EACVsB,UAAW,YAAU4a,KACrBnkB,KAAM,MAIV+I,EAAQ,gBAAcgK,WAAW,CAC/BhK,MAAOA,EACPd,SAAUA,EACV3D,UAAW,YAAU8f,iBAgE6tB,CAAC,SAAOC,cA3D9vB,SAAqBne,GACnB,IAAIoe,EAASpe,EAAMoe,OACfC,EAASre,EAAMqe,OACfC,EAAUte,EAAMse,QAChBzb,EAAQ7C,EAAM6C,MACd0b,EAAW1b,EAAMC,SAASsb,GAC1BI,EAAW3b,EAAMC,SAASub,GAC1BI,EAAeF,EAASxhB,UAExB2hB,EADiB7b,EAAMC,SAAS2b,GACExhB,QAClC0hB,EAAWD,EAAiBpW,QAAQ8V,GAGxC,GAFAM,EAAmBA,EAAiBrW,OAAOsW,GAE3B,OAAZL,EAAkB,CACpB,IAAIM,EAAeJ,EAASvhB,QAC5B2hB,EAAeA,EAAavY,KAAK+X,GACjCvb,EAAQA,EAAM8K,eAAc,SAAU6B,GACpCA,EAAE5I,MAAM,CAAC,SAAU6X,EAAc,WAAYC,GAAkB9X,MAAM,CAAC,SAAUwX,EAAQ,aAAcC,GAAQzX,MAAM,CAAC,SAAUyX,EAAQ,WAAYO,GAAchY,MAAM,CAAC,SAAUyX,EAAQ,aAAa,UAEpM,CACL,IAAIQ,EAAiBL,EAASzhB,UAE1B+hB,EADgBjc,EAAMC,SAAS+b,GACI5hB,QACnC8hB,EAAWD,EAAmBxW,QAAQ+V,GAE1C,GAAII,IAAiBI,EAAgB,CACnC,IAAIG,EAAwB,iBAC5BF,EAAmB7Y,SAAQ,SAAU/M,GAC/BA,IAAQklB,IAGNY,EAFA9lB,IAAQmlB,EACM,SAAZC,EACsBU,EAAsB3Y,KAAK+X,GAAQ/X,KAAKnN,GAExC8lB,EAAsB3Y,KAAKnN,GAAKmN,KAAK+X,GAGvCY,EAAsB3Y,KAAKnN,OAIzD2J,EAAQA,EAAM8K,eAAc,SAAU6B,GACpCA,EAAE5I,MAAM,CAAC,SAAUiY,EAAgB,WAAYG,UAGjC,SAAZV,EACFQ,EAAqBA,EAAmBG,OAAOF,EAAUX,GACpC,SAAZE,IACTQ,EAAqBA,EAAmBG,OAAOF,EAAW,EAAGX,IAG/Dvb,EAAQA,EAAM8K,eAAc,SAAU6B,GACpCA,EAAE5I,MAAM,CAAC,SAAU6X,EAAc,WAAYC,GAAkB9X,MAAM,CAAC,SAAUwX,EAAQ,aAAcS,GAAgBjY,MAAM,CAAC,SAAUiY,EAAgB,WAAYC,GAAoBlY,MAAM,CAAC,SAAUiY,EAAgB,aAAa,MAK3O,OAAOhc,IAGkxB,CAAC,SAAOwZ,gBAAiB,gBAAc6C,yBAC9zBC,EAAY,kBACZC,EAAY,kBACZC,GAAU,EACVC,EAAqB,IAAI5S,IAC7B,MAAO,CACL6S,mBAAoB,SAA4Bvf,GAC9C,OAAOqf,GAETG,gBAAiB,WACfH,GAAU,GAEZI,iBAAkB,SAA0Bre,GAC1C,IAAI8L,EAAY9L,EAAG8L,UACnBmS,GAAU,EACNnS,EAAWoS,EAAqB,IAAI5S,IAAIQ,GAAgBoS,EAAmBjR,SAYjFjB,SAAU,SAAkBpN,GAC1B,OAAO+c,GAET2C,aAAc,SAAsB1f,GAClC,IAAI6C,EAAQ7C,EAAM6C,MACdO,EAASpD,EAAMoD,OAEnB,GAAIA,EACF,OAAQA,GACN,KAAK,SAAO6B,YACZ,KAAK,SAAO0X,sBACZ,KAAK,SAAOC,mBACV,OAAO,EAIb,OAAQ/Z,EAAMzE,WACZ,IAAK,eACL,IAAK,kBACH,OAAO,EAGX,OAAOyE,EAAM7E,OAAO/D,WAEtB0lB,iBAAkB,WAChB,MAAO,CACLR,UAAWA,EACXC,UAAWA,IAGfQ,aAAc,SAAsB5f,GAClC6c,GAAM,eAAgB7c,EAAMmf,WAC5BA,EAAYnf,EAAMmf,WAEpBU,aAAc,SAAsB7f,GAClC6c,GAAM,eAAgB7c,EAAMof,WAC5BA,EAAYpf,EAAMof,WAEpBU,QAAS,SAAiB9f,GACxB,IAAIkD,EAAalD,EAAMkD,WACnBic,EAAYjc,EAAWC,IAAI,mBAAoBnD,GAAOmf,UACtDllB,EAAYiJ,EAAWC,IAAI,eAAgBnD,GAC/C,OAAOmf,EAAUtW,KAAO,GAAK5O,GAE/B8lB,QAAS,SAAiB/f,GACxB,IAAIkD,EAAalD,EAAMkD,WACnBkc,EAAYlc,EAAWC,IAAI,mBAAoBnD,GAAOof,UACtDnlB,EAAYiJ,EAAWC,IAAI,eAAgBnD,GAC/C,OAAOof,EAAUvW,KAAO,GAAK5O,GAE/B+lB,KAAM,SAAchgB,GAClB,IAAIkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MAElB,GAAKK,EAAWC,IAAI,eAAgBnD,GAApC,CAIA,IAAIoB,EAAK8B,EAAWC,IAAI,mBAAoBnD,GACxCmf,EAAY/d,EAAG+d,UACfC,EAAYhe,EAAGge,UAEfa,EAAWd,EAAUe,OACpBD,IACL/c,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzDmf,UAAWA,EAAUgB,WAEvBjd,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzDof,UAAWA,EAAU/Y,KAAKxD,MAE5Bga,GAAMoD,GACN/c,EAAWkd,OAAOH,MAEpBI,KAAM,SAAcrgB,GAClB,IAAIkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MAElB,GAAKK,EAAWC,IAAI,eAAgBnD,GAApC,CAIA,IAAIoB,EAAK8B,EAAWC,IAAI,mBAAoBnD,GACxCmf,EAAY/d,EAAG+d,UACfC,EAAYhe,EAAGge,UAEfa,EAAWb,EAAUc,OACpBD,IACL/c,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzDmf,UAAWA,EAAU9Y,KAAKxD,MAE5BK,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzDof,UAAWA,EAAUe,WAEvBjd,EAAWkd,OAAOH,MAGpBnP,UAAW,SAAmB9Q,GAC5B,IAAIkD,EAAalD,EAAMkD,WACnBE,EAASpD,EAAMoD,OACfP,EAAQ7C,EAAM6C,MACdmC,EAAUhF,EAAMgF,QAChBsb,EAAWtgB,EAAMsgB,SAErB,GAAe,MAAXtb,IAAoBzL,MAAMC,QAAQwL,GACpC,MAAM,IAAIrL,MAAM,iDAGlB,GAAc,MAAVyJ,GAA6B,MAAX4B,EACpB,MAAM,IAAIrL,MAAM,2CAKlB,IAFyBuJ,EAAWC,IAAI,qBAAsBnD,GAErC,CAKvB,GAAgC,IAA5Bsf,EAAmBzW,KAAY,OAEnC,GAAe,MAAX7D,EAAiB,CACnB,IAAIub,EAAmBvb,EAAQqG,QAAO,SAAUoR,GAC9C,OAAQ6C,EAAmBzZ,IAAI4W,EAAGrZ,WAGpC,GAAImd,GAAoBA,EAAiB/gB,OAAS,EAChD,YAEG,IAAK8f,EAAmBzZ,IAAIzC,GACjC,OAIJyZ,GAAM,aAAczZ,GACpByZ,GAAM,aAAcha,GACpBga,GAAM,aAAc7c,GACpB,IAUIigB,EAVA5S,EAAQnK,EAAWC,IAAI,WAAYnD,GAGvC,GAFAkD,EAAWC,IAAI,kBAAmBnD,GAE9BkD,EAAWC,IAAI,eAAgBnD,GAAQ,CACzC,IAAIwgB,EAActd,EAAWC,IAAI,mBAAoBnD,GAAOmf,UAC5Djc,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzDmf,UAAWqB,EAAYna,KAAKxD,MAMhC,GAAe,MAAXmC,EACFib,EAAWjb,EAAQyb,QAAO,SAAUC,EAAKC,GACvC,IAAIvd,EAASud,EAAIvd,OACjB,IAAKiK,EAAMxH,IAAIzC,GAAS,MAAM,IAAIzJ,MAAM,UAAYyJ,EAAS,eAC7D,IAAIwd,EAASvT,EAAMlU,IAAIiK,GAEnByd,EAAc3hB,EAAQA,EAAQ,CAChCgE,WAAYA,GACXyd,GAAM,CACP9d,MAAO6d,IAGL1a,EAAM9C,EAAWC,IAAI,mBAAoB0d,GAO7C,OANA7a,EAAM4a,EAAO1hB,EAAQA,EAAQ,GAAI2hB,GAAc,CAC7Che,MAAOmD,KAETA,EAAM9C,EAAWC,IAAI,kBAAmBjE,EAAQA,EAAQ,GAAI2hB,GAAc,CACxEhe,MAAOmD,OAGRnD,OACE,CACL,IAAKwK,EAAMxH,IAAIzC,GAAS,MAAM,IAAIzJ,MAAM,UAAYyJ,EAAS,eAC7D,IAAIwd,EAASvT,EAAMlU,IAAIiK,GACvB6c,EAAW/c,EAAWC,IAAI,mBAAoBnD,GAC9CigB,EAAWW,EAAO1hB,EAAQA,EAAQ,GAAIc,GAAQ,CAC5C6C,MAAOod,KAETA,EAAW/c,EAAWC,IAAI,kBAAmBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACvE6C,MAAOod,KAIXpD,GAAM,YAAaoD,GACnB/c,EAAWkd,OAAOH,EAAUK,GAC5Bpd,EAAWC,IAAI,iBAAkBnD,IAEnC8gB,aAAc,SAAsB9gB,GAClC,IAAI2U,EAAKvT,EAELyB,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjB0S,EAAYzU,EAAMyU,UAClBsM,EAAa,6BAAmBle,EAAOd,GAC3Cgf,EAAW1a,KAAKtE,GAEhB,IACE,IAAK,IAAIif,EAAe1R,EAASyR,GAAaE,EAAiBD,EAAa/c,QAASgd,EAAetR,KAAMsR,EAAiBD,EAAa/c,OAAQ,CAC9I,IAAI/K,EAAM+nB,EAAe7nB,MACzBqb,EAAUqD,GAAY5e,IACtBub,EAAUsD,GAAe7e,IACzBub,EAAUkD,GAAcze,IACxBub,EAAUlS,GAAoBrJ,IAC9Bub,EAAUlR,GAAiBrK,IAC3Bub,EAAUmD,GAAkB1e,IAC5Bub,EAAUoD,GAAY3e,IACtBub,EAAUuD,GAAe9e,IACzBub,EAAUwD,GAAe/e,EAAK,SAC9Bub,EAAUwD,GAAe/e,EAAK,UAEhC,MAAO8b,GACPL,EAAM,CACJ7E,MAAOkF,GAET,QACA,IACMiM,IAAmBA,EAAetR,OAASvO,EAAK4f,EAAa/L,SAAS7T,EAAG3B,KAAKuhB,GAClF,QACA,GAAIrM,EAAK,MAAMA,EAAI7E,SAKzBoR,gBAAiB,SAAyBlhB,KAC1CmhB,eAAgB,SAAwBnhB,KAExCsN,iBAAkB,SAA0BtN,GAC1C,IAAIkD,EAAalD,EAAMkD,WACnBE,EAASpD,EAAMoD,OACfP,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SAMrB,OAJIqB,IAAW,SAAOmK,cAAgBxL,IAAac,EAAM3E,oBACvDgF,EAAWC,IAAI,eAAgBnD,GAG1B6C,GAETue,gBAAiB,SAAyBphB,GACxC,OAAOA,EAAM6C,QAKnB,IAAIwe,GAEJ,SAAUvoB,GAGR,SAASuoB,IACP,OAAkB,OAAXvoB,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAQ7D,OAXA+F,EAAUuiB,EAAkBvoB,GAM5BuoB,EAAiBpiB,UAAU6C,OAAS,WAClC,IAAIoB,EAAanK,KAAKiH,MAAMkD,WAC5B,OAAO,wBAAc,OAAM,KAAMA,EAAWC,IAAI,4BAA6BpK,KAAKiH,SAG7EqhB,EAZT,CAaExQ,GAEEzF,GAAQ,CAAC,CACXlC,KAAM,OACNoD,MAAO,OACPgV,SAAU,QACVC,YAAY,EACZne,OAAQ,SAAOuZ,uBACd,CACDzT,KAAM,cACNoD,MAAO,cACPgV,SAAU,QACVle,OAAQ,SAAO8Y,aACd,CACDhT,KAAM,YACNoD,MAAO,YACPgV,SAAU,MACVC,YAAY,EACZne,OAAQ,SAAO6Y,WACd,CACD/S,KAAM,QACNoD,MAAO,aACPgV,SAAU,UACVC,YAAY,EACZne,OAAQ,SAAOwZ,oBACd,CACD1T,KAAM,cACNoD,MAAO,cACPgV,SAAU,MACVle,OAAQ,SAAOmK,cACd,CACDrE,KAAM,OACNoD,MAAO,qBACPgV,SAAU,kBACVle,OAAQ,SAAOiZ,kBAmCjB,IAiFImF,GAkJAC,GAnOAC,GAAQ,IAAM,0BACdC,GAAgB,UAAOC,IAAIJ,KAAuBA,GAAqBxR,EAAqB,CAAC,6HAA8H,CAAC,gIAE5N6R,GAEJ,SAAU/oB,GAGR,SAAS+oB,IACP,IAAI3hB,EAAmB,OAAXpH,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAKhE,OAHAmH,EAAMC,MAAQ,CACZ3C,QAAS,MAEJ0C,EAgET,OAxEApB,EAAU+iB,EAAiB/oB,GAW3B+oB,EAAgB5iB,UAAU6iB,OAAS,WACjC,IAAI9hB,EAAQjH,KAAKiH,MACboB,EAAKrI,KAAKiH,MACVsU,EAASlT,EAAGkT,OACZzR,EAAQzB,EAAGyB,MACXvE,EAAa8C,EAAG9C,WAEhByjB,EADa3gB,EAAG8B,WACSC,IAAI,qBAAsBnD,GACnD9G,EAAM6oB,EAAY7oB,IAClBolB,EAAUyD,EAAYzD,QAG1B,GAFAoD,GAAM,SAAUpD,GAEJ,OAARplB,EAAJ,CAOA,IAQIsE,EAAU8W,EANE,OAAZgK,EACO3G,GAAcze,GAEd+e,GAAe/e,EAAKolB,IAI3BsD,EAAMtN,EAAO,mBACbtC,EAAUsC,EAAO6D,GAAOE,wBAAwBrG,QAEhDC,EAAcuJ,GAAiBhe,EAASwU,EAAS1T,GAEjD0jB,EAAUxG,GAAiBoG,EAAK5P,EAAS1T,GAGzC8c,EAAInJ,EAAYY,KAAOmP,EAAQnP,KADrB,EAEVyI,EAAIrJ,EAAYa,IAAMkP,EAAQlP,IAFpB,EAGVnB,EAAQM,EAAYN,MAAQ,EAC5BG,EAASG,EAAYH,OAAS,EAClC/Y,KAAKsI,SAAS,CACZ7D,QAAS,wBAAc,IAAK,KAAM,wBAAc,OAAQ,CACtD4d,EAAGA,EACHE,EAAGA,EACH3J,MAAOA,EACPG,OAAQA,EACR/F,KAAM,OACNkW,OAAQpf,EAAM7E,OAAO5D,MAAMI,eAC3B0nB,gBAAiB,MACjBC,YAAa,YApCfppB,KAAKsI,SAAS,CACZ7D,QAAS,QAwCfqkB,EAAgB5iB,UAAU6C,OAAS,WACjC,IAAId,EAAUjI,KAAKiH,MAAMgB,QACzB,OAAO,wBAAc2gB,GAAe,CAClC1gB,IAAKD,EAAQ,oBACZjI,KAAKoH,MAAM3C,UAGTqkB,EAzET,CA0EEhR,GAGEuR,GAAQ,IAAM,wBACdC,GAAW,UAAOviB,IAAI2hB,KAAuBA,GAAqBzR,EAAqB,CAAC,eAAgB,2CAA4C,CAAC,eAAgB,8CAA8C,SAAUhQ,GAC/N,OAAOA,EAAM8R,OAAS,QAGxB,SAASwQ,KACP,IAAIC,EAAgB,KAChBC,EAAgB,KACpB,MAAO,CACLC,oBAAqB,SAA6BziB,GAChD,IAAI+B,EAAW/B,EAAM+B,SACjBuc,EAAUte,EAAMse,QAChBtd,EAAUhB,EAAMgB,QAChBkC,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MA8Bd6f,EAAgB,CAClBC,YA7BgB,SAAqBC,GACrCR,GAAM,cAAergB,EAAUuc,GAC/Bpb,EAAWC,IAAI,uBAAwBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACjE4iB,GAAIA,EACJtE,QAASA,MA0BXuE,YAtBgB,SAAqBD,GACrCR,GAAM,cAAergB,EAAUuc,GAC/Bpb,EAAWC,IAAI,uBAAwBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACjE4iB,GAAIA,EACJtE,QAASA,MAmBXwE,WAfe,SAAoBF,GACnCA,EAAGpQ,kBAeHuQ,OAZW,SAAgBH,GAC3BR,GAAM,SAAUrgB,EAAUuc,GAC1Bpb,EAAWC,IAAI,kBAAmBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC5D4iB,GAAIA,EACJtE,QAASA,OAUb,OAAO,wBAAc+D,GAAUnjB,EAAQ,CACrC4S,OAAQjP,EAAM7E,OAAO5D,MAAMM,QAAU,EACrCuG,IAAKD,EAAQiX,GAAelW,EAAUuc,KACrCoE,KAELM,wBAAyB,SAAiChjB,GACxDoiB,GAAM,2BACN,IAAIphB,EAAUhB,EAAMgB,QACpB,OAAO,wBAAc6gB,GAAiB3iB,EAAQ,CAC5C+B,IAAKD,EAAQmX,GAAOK,kBACnBxY,KAELijB,mBAAoB,SAA4BjjB,GAC9C,MAAO,CACL9G,IAAKqpB,EACLjE,QAASkE,IAGbU,qBAAsB,SAA8BljB,GAClD,IAAIkD,EAAalD,EAAMkD,WACdlD,EAAM4iB,GACZtiB,kBACH4C,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAO6B,YACf7G,UAAW,YAAU+kB,aAGzBC,QAAS,SAAiBpjB,GACxB,IAAIoe,EAASpe,EAAMoe,OACfC,EAASre,EAAMqe,OACfxb,EAAQ7C,EAAM6C,MACdyb,EAAUte,EAAMse,QACpB,OAAIF,IAAWvb,EAAM3E,oBAAsBkgB,IAAWC,GAAU,0BAAgBxb,EAAOub,EAAQC,KAAY,oBAAkBgF,YACzHhF,IAAWxb,EAAM3E,oBAAkC,OAAZogB,KAC5Bzb,EAAMC,SAASsb,GACjBrhB,YAAcshB,GAAsB,OAAZC,KAGvCgF,qBAAsB,SAA8BtjB,GAClD,IAAIse,EAAUte,EAAMse,QAChBvc,EAAW/B,EAAM+B,SACjBmB,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MAClBuf,GAAM,wBAAyBrgB,EAAUuc,GAC3Bpb,EAAWC,IAAI,UAAWjE,EAAQA,EAAQ,GAAIc,GAAQ,CAClEoe,OAAQvb,EAAM1E,SACdkgB,OAAQtc,OAIRwgB,EAAgBxgB,EAChBygB,EAAgBlE,EAChBpb,EAAWkd,OAAOvd,KAGtB0gB,qBAAsB,SAA8BvjB,GAClD,IAAIkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjBuc,EAAUte,EAAMse,QAChBhK,EAAStU,EAAMsU,OAEfkP,EADKxjB,EAAM4iB,GACQngB,YAAY+gB,cACnCpB,GAAM,wBAAyBrgB,EAAUuc,GACzC,IAAI9gB,EAAU8W,EAAOqD,GAAc5V,IAE/BvE,GAAWgmB,GAAiBhmB,EAAQoD,SAAS4iB,KAIjDjB,EAAgB,KAChBC,EAAgB,KAChBtf,EAAWkd,OAAOvd,KAEpB4gB,gBAAiB,SAAyBzjB,GACxCoiB,GAAM,mBACN,IAAIlf,EAAalD,EAAMkD,WACnBnB,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MAClB7C,EAAQd,EAAQA,EAAQ,GAAIc,GAAQ,CAClCoe,OAAQvb,EAAM1E,SACdkgB,OAAQtc,IAEVwgB,EAAgB,KAChBC,EAAgB,KAEZtf,EAAWC,IAAI,UAAWnD,IAC5BkD,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAO+a,mBAQzB,IAsFIuF,GAAoBC,GAAoBC,GAgJxCC,GAAoBC,GA2JpBC,GAmFAC,GAAoBC,GA+BpBC,GAAoBC,GAAoBC,GAnfxCC,GAA4B,kBAAO/f,GAAP,CAAeof,KAAuBA,GAAqB1T,EAAqB,CAAC,yIAA0I,CAAC,4IACxPsU,GAAiB,UAAOxkB,IAAI6jB,KAAuBA,GAAqB3T,EAAqB,CAAC,2BAA4B,CAAC,8BAC3HuU,GAAkB,UAAO5O,KAAKiO,KAAuBA,GAAqB5T,EAAqB,CAAC,IAAK,CAAC,OAEtGwU,GAEJ,SAAU1rB,GAGR,SAAS0rB,EAAsBxkB,GAC7B,IAAIE,EAAQpH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KAwCxC,OAtCAmH,EAAMgf,sBAAwB,SAAUnd,GACtC,OAAO,WACL,IAAIX,EAAKlB,EAAMF,MACX6C,EAAQzB,EAAGyB,MACXK,EAAa9B,EAAG8B,WAEhBL,EAAM3E,qBAAuB6D,GAC/BmB,EAAWkd,OAAO,gBAAclB,sBAAsB,CACpDrc,MAAOA,EACPd,SAAUA,OAMlB7B,EAAMukB,mBAAqB,SAAUzkB,GACnC,IAAI4D,EAAO5D,EAAM4D,KACb8gB,EAAa7V,EAAO7O,EAAO,CAAC,SAE5B2kB,EAAc/gB,EAAKpE,OAAS,EAC5BuL,EAAQ4Z,EAAc/gB,EAAKC,OAAO,EAAG,GAAK,MAAQD,EAGlDwF,EAAe,CACjB5L,QAFY,wBAAc8mB,GAAgB,KAAM1gB,GAGhDghB,SAAU,kBAAgBC,cAExBC,EAAa,wBAAc,aAAY5lB,EAAQ,GAAIwlB,GAAa,wBAAcH,GAAiB,KAAMxZ,IACzG,OAAO4Z,EAAc,wBAAc,UAASzlB,EAAQ,GAAIkK,GAAe0b,GAAcA,GAOvF5kB,EAAMC,MAAQ,CACZ4kB,MAAM,GAED7kB,EAiCT,OA5EApB,EAAU0lB,EAAuB1rB,GA8CjC0rB,EAAsBvlB,UAAU6C,OAAS,WACvC,IAAI9B,EAAQjH,KAAKiH,MACb6C,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACnBuB,EAASzE,EAAMyE,OACfugB,EAAiBniB,EAAM3E,mBAC3B,GAAI8mB,IAAmBniB,EAAM5E,aAAc,OAAO,KAIlD,IAHA,IAAImN,EAAQ,GACRN,EAAQjI,EAAMC,SAASkiB,GAEX,MAATla,GAAe,CACpB,IAAIC,EAAQ7H,EAAWkE,SAASC,GAAQC,YAAapI,EAAQA,EAAQ,GAAIc,GAAQ,CAC/E+B,SAAU+I,EAAM5R,OAElBkS,EAAM6Z,QAAQ,CACZrhB,KAAMmH,EACNjG,QAAS/L,KAAKmmB,sBAAsBpU,EAAM5R,OAE5C4R,EAAQjI,EAAMC,SAASgI,EAAM/N,WAG/B,IAAImoB,EAAkB,CACpB9Z,MAAOA,EACPqZ,mBAAoB1rB,KAAK0rB,oBAE3B,OAAO,wBAAcJ,GAA2B,CAC9C5f,OAAQA,GACP,wBAAc,cAAavF,EAAQ,GAAIgmB,MAGrCV,EA7ET,CA8EE3T,GAGEsU,GAAY,UAAOrlB,IAAI+jB,KAAuBA,GAAqB7T,EAAqB,CAAC,wFAAyF,CAAC,2FACnLoV,GAAM,UAAOtlB,IAAIgkB,KAAuBA,GAAqB9T,EAAqB,CAAC,oDAAqD,OAAQ,CAAC,oDAAqD,UAAU,SAAUhQ,GAC5N,OAAOA,EAAM5F,MAAMG,cAGjB8qB,GAEJ,SAAUvsB,GAGR,SAASusB,EAAqBrlB,GAC5B,IAAIE,EAAQpH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KAoBxC,OAlBAmH,EAAM6T,cAAgB,SAAUzV,GAC9B4B,EAAMolB,iBAAiBvR,cAAczV,IAGvC4B,EAAMqlB,QAAU,SAAUllB,GACxB,GAAIA,EAAEkS,QAAUlS,EAAEqC,QAAS,CACzB,IAAIQ,EAAahD,EAAMF,MAAMkD,WACzB5E,EAAa4E,EAAWC,IAAI,gBAAiBjD,EAAMF,QACvD1B,GAA2B+B,EAAEoC,YAAY+iB,OAAS,EAAI,IAAO,IAC5C,KAAKlnB,EAAa,IAC/BA,EAAa,IAAGA,EAAa,GAEjC4E,EAAWC,IAAI,gBAAiBjE,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CAChE1B,WAAYA,OAKX4B,EA6GT,OApIApB,EAAUumB,EAAsBvsB,GA0BhCusB,EAAqBpmB,UAAUwmB,cAAgB,WAC7C,IAAIzlB,EAAQjH,KAAKiH,MACbkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACduJ,EAAUlJ,EAAWC,IAAI,mBAAoBnD,GACjD,GAAgB,OAAZoM,EAAkB,OAAO,KAE7B,KAAMA,EAAQsQ,wBAAwBlX,KAAO4G,EAAQC,yBAAyB7G,KAC5E,MAAM,IAAIkgB,UAAU,gDAGtB,IAAIxR,EAAW,GAmBf,OAjBIrR,EAAMzE,YAAc,YAAU8G,QAAUrC,EAAMzE,YAAc,YAAU+X,YACxE/J,EAAQsQ,aAAazW,SAAQ,SAAUC,EAAGC,GACxC+N,EAAS7N,KAAK,wBAAc,SAAQnH,EAAQ,CAC1ChG,IAAKiN,GACJD,EAAG,CACJyf,QAAQ,SAKdvZ,EAAQC,cAAcpG,SAAQ,SAAUC,EAAGC,GACzC+N,EAAS7N,KAAK,wBAAc,SAAQnH,EAAQ,CAC1ChG,IAAKiN,GACJD,EAAG,CACJyf,QAAQ,SAGL,wBAAc,UAAS,KAAMzR,IAGtCmR,EAAqBpmB,UAAUqC,kBAAoB,WACjD,IAAIF,EAAKrI,KAAKiH,MACVsU,EAASlT,EAAGkT,OACZzR,EAAQzB,EAAGyB,MACEzB,EAAG8B,WACTC,IAAI,mCAAoCjE,EAAQA,EAAQ,GAAInG,KAAKiH,OAAQ,CAClF+U,SAAUhc,KAAKgb,iBAEjB,IAAI9Y,EAAYqZ,EAAOuD,GAAYhV,EAAM3E,qBAErC0nB,EAAYtR,EAAO,cACnBuR,EAAgB5qB,EAAU2gB,wBAC1BkK,EAAgBF,EAAUhK,wBAC9B7iB,KAAKusB,iBAAiBrS,sBAAsB,EAAG4S,EAAc/S,IAAMgT,EAAchT,IAAM/Z,KAAKusB,iBAAiBzT,QAAQ+J,wBAAwB9J,OAAS,EAAI+T,EAAc/T,QACxK/Y,KAAK+oB,UAGPuD,EAAqBpmB,UAAUwC,qBAAuB,WACnC1I,KAAKiH,MAAMkD,WACjBC,IAAI,sCAAuCjE,EAAQA,EAAQ,GAAInG,KAAKiH,OAAQ,CACrF+U,SAAUhc,KAAKgb,kBAInBtV,OAAOsB,eAAeslB,EAAqBpmB,UAAW,mBAAoB,CACxE9F,IAAK,WACH,OAAOJ,KAAKiH,MAAMsU,OAAO6D,GAAOE,yBAElCrH,YAAY,EACZC,cAAc,IAGhBoU,EAAqBpmB,UAAU8mB,mBAAqB,WACjChtB,KAAKiH,MAAMkD,WACjBC,IAAI,YAAajE,EAAQA,EAAQ,GAAInG,KAAKiH,OAAQ,CAC3D9G,IAAKuf,GAASC,qBAEhB3f,KAAK+oB,UAGPuD,EAAqBpmB,UAAU6iB,OAAS,WACrB/oB,KAAKiH,MAAMkD,WACjBC,IAAI,SAAUpK,KAAKiH,QAGhCqlB,EAAqBpmB,UAAU6C,OAAS,WACtC,IAAI5B,EAAQnH,KAERqI,EAAKrI,KAAKiH,MACVgB,EAAUI,EAAGJ,QACb6B,EAAQzB,EAAGyB,MACXK,EAAa9B,EAAG8B,WAChB8iB,EAAUnjB,EAAM3E,mBACpB,OAAO,wBAAcknB,GAAK,CACxBG,QAASxsB,KAAKwsB,SACb,wBAAclU,EAAkBnS,EAAQ,GAAInG,KAAKoH,MAAO,CACzDmS,kBAAkB,EAClBhU,WAAYuE,EAAMvE,WAClB2C,IAAKD,EAAQmX,GAAOE,2BAClB,SAAU3F,EAAkBO,GAC9B,IAAIgT,EAAkB/mB,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CACtD+B,SAAUikB,EACVtT,iBAAkBA,EAClBO,sBAAuBA,IAGzB,OAAO,wBAAckS,GAAW,CAC9BlkB,IAAKD,EAAQ,eACZkC,EAAWC,IAAI,mBAAoB8iB,SAI1CZ,EAAuBrW,EAAW,CAAC,iBAAgBqW,GApIrD,CAsIE,aAIEa,GAEJ,SAAUptB,GAGR,SAASotB,IACP,IAAIhmB,EAAmB,OAAXpH,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAQhE,OANAmH,EAAMimB,YAAc,WAClB,IACI/P,EADalW,EAAMF,MAAMkD,WACWC,IAAI,yBAA0BjD,EAAMF,OAC5EoW,GAA0BA,KAGrBlW,EAuBT,OAlCApB,EAAUonB,EAAQptB,GAclBotB,EAAOjnB,UAAU6C,OAAS,WACxB,IAAIoB,EAAanK,KAAKiH,MAAMkD,WACxBkjB,EAAcljB,EAAWC,IAAI,cAAepK,KAAKiH,OACjDqW,EAAmBnT,EAAWC,IAAI,sBAAuBpK,KAAKiH,OAClE,OAAO,wBAAc,SAAQ,CAC3B4H,QAAS7O,KAAKotB,YACd3e,OAAwB,OAAhB4e,EACR9jB,WAAW,EACX+jB,cAAc,EACdC,WAAW,EACXvb,MAAOsL,GAAoBA,EAAiBtL,MAC5CnN,MAAOyY,GAAoBA,EAAiBzY,OAC3C,wBAAc,MAAO,CACtBmL,UAAW,UAAQwd,YACnB3oB,MAAO,CACL4oB,UAAW,IAEZJ,KAGEF,EAnCT,CAoCErV,GAEE4V,GAAe,UAAO7E,IAAImC,KAAuBA,GAAqB/T,EAAqB,CAAC,6HAA8H,CAAC,gIAC3N0W,GAAQ,IAAM,uBAEdC,GAEJ,SAAU7tB,GAGR,SAAS6tB,IACP,IAAIzmB,EAAmB,OAAXpH,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAKhE,OAHAmH,EAAMC,MAAQ,CACZymB,OAAQ,IAEH1mB,EAgGT,OAxGApB,EAAU6nB,EAAc7tB,GAWxB6tB,EAAa1nB,UAAU6iB,OAAS,WAC9B,IAeI5G,EAAIC,EAfJnb,EAAQjH,KAAKiH,MACb6C,EAAQ7C,EAAM6C,MACdyR,EAAStU,EAAMsU,OACfvS,EAAW/B,EAAM+B,SACjBzD,EAAa0B,EAAM1B,WACnB4E,EAAalD,EAAMkD,WACnB4H,EAAQjI,EAAMC,SAASf,GACvBvE,EAAU8W,EAAOqD,GAAc5V,IAC/B6f,EAAMtN,EAAOyD,GAAehW,IAC5BiQ,EAAUsC,EAAO6D,GAAOE,wBAAwBrG,QAEhDC,EAAcuJ,GAAiBhe,EAASwU,EAAS1T,GAEjD0jB,EAAUxG,GAAiBoG,EAAK5P,EAAS1T,GAG7C4c,EAAK,CACHE,EAAGJ,GAAQ/I,GAAe+P,EAAQnP,KAClCyI,EAAGR,GAAQ7I,GAAe+P,EAAQlP,KAEpC,IAAI8T,EAAS,GACb9b,EAAM7N,QAAQgJ,SAAQ,SAAU/M,GAC9B,IAwBI2tB,EAxBAhsB,EAAYqI,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzE+B,SAAU7I,KAER6B,EAAWF,EAAUE,SAGrBggB,EAAOS,GAFWlH,EAAOqD,GAAcze,IAEE8Y,EAAS1T,GAoBtD,GANA6c,EAAK,CACHC,GAZAD,EADEJ,EAAKlI,KAAOZ,EAAYsI,MACrB,CACHa,EAAGL,EAAKlI,KACRyI,EAAGR,GAAQC,IAGR,CACHK,EAAGL,EAAKR,MACRe,EAAGR,GAAQC,KAKPK,EAAI4G,EAAQnP,KAClByI,EAAGH,EAAGG,EAAI0G,EAAQlP,KAIH,UAAb/X,EACF8rB,EAAQ,KAAO3L,EAAGE,EAAI,IAAMF,EAAGI,EAAI,MAAQJ,EAAGE,EAAI,IAAMC,GAAaH,EAAIC,GAAM,IAAMF,GAAaC,EAAIC,GAAM,IAAMA,EAAGG,EAAI,IAAMH,EAAGC,EAAI,IAAMD,EAAGG,OAC1I,GAAiB,SAAbvgB,EACT8rB,EAAQ,KAAO3L,EAAGE,EAAI,IAAMF,EAAGI,EAAI,MAAQH,EAAGC,EAAI,IAAMD,EAAGG,OACtD,GAAiB,UAAbvgB,EAAsB,CAC/B,IAAI+rB,EAAO3L,EAAGG,EAAIJ,EAAGI,EAAI,GAAK,EAC1ByL,EAAO5L,EAAGC,EAAIF,EAAGE,EAAI,GAAK,EAC1B4L,EAASnsB,EAAUC,WAEvB,GAAc,MAAVksB,EACF,MAAM,IAAIrtB,MAAM,4DAIhBktB,EADE1L,EAAGG,IAAMJ,EAAGI,EACN,KAAOJ,EAAGE,EAAI,IAAMF,EAAGI,EAAI,MAAQH,EAAGC,EAGtC,KAAOF,EAAGE,EAAI,IAAMF,EAAGI,EAAI,QAAUH,EAAGG,EAAIwL,EAAOE,GAAU,MAAQA,EAAS,IAAMA,EAAS,SAAWF,EAAOC,IAAS,EAAI,EAAI,GAAK,KAAO7L,EAAGE,EAAI4L,EAASD,GAAQ,IAAM5L,EAAGG,EAAI,MAAQH,EAAGC,EAIxMwL,EAAOvgB,KAAK,wBAAc,OAAQ,CAChCnN,IAAK,QAAUA,EACfsF,EAAGqoB,EACH1E,YAAatnB,EAAUG,UACvBinB,OAAQpnB,EAAUS,UAClByQ,KAAM,aAGVhT,KAAKsI,SAAS,CACZulB,OAAQA,KAIZD,EAAa1nB,UAAU6C,OAAS,WAC9B4kB,GAAM,UACN,IAAItlB,EAAKrI,KAAKiH,MACV+B,EAAWX,EAAGW,SACdf,EAAUI,EAAGJ,QACjB,OAAO,wBAAcylB,GAAc,CACjCxlB,IAAKD,EAAQ+W,GAAehW,KAC3B,wBAAc,IAAK,KAAMhJ,KAAKoH,MAAMymB,UAGlCD,EAzGT,CA0GE9V,GAGEoW,GAAQ,IAAM,YACdC,GAAY,UAAOpnB,IAAIkkB,KAAuBA,GAAqBhU,EAAqB,CAAC,+DAAgE,8CAA+C,OAAQ,CAAC,+DAAgE,8CAA+C,UAAU,SAAUhQ,GAEtV,OAAOA,EAAMmnB,iBAAmB,iBAAeC,KAAO,WAAa,gBAClE,SAAUpnB,GAEX,OAAOA,EAAMmnB,iBAAmB,iBAAeC,KAAO,qBAAuB,wBAE3E7qB,GAAQ,UAAOuD,IAAImkB,KAAuBA,GAAqBjU,EAAqB,CAAC,sFAAuF,CAAC,yFAE7KqX,GAEJ,SAAUvuB,GAGR,SAASuuB,IACP,OAAkB,OAAXvuB,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KA+D7D,OAlEA+F,EAAUuoB,EAAYvuB,GAMtBuuB,EAAWpoB,UAAUqoB,iBAAmB,SAAUxpB,EAAQoa,GACxD,IAAI9W,EAAKrI,KAAKiH,MACVkD,EAAa9B,EAAG8B,WAChBlC,EAAUI,EAAGJ,QACbgF,EAAM9C,EAAWC,IAAI,kBAAmBjE,EAAQA,EAAQ,GAAInG,KAAKiH,OAAQ,CAC3EkY,IAAKA,EACLqP,QAAQ,EACRzpB,OAAQA,KAEV,IAAKkI,EAAK,OAAO,KACjB,IAAIwhB,EAAYxhB,EAAIwhB,UAChBC,EAAS,aAAevP,IAAQ,iBAAekP,KAAO,OAAS,SACnE,OACE,uBADK,CACSF,GAAW,CACvBC,eAAgBjP,EAChBjX,IAAKD,EAAQymB,IACZD,IAIPH,EAAWpoB,UAAU6C,OAAS,WAC5BmlB,GAAM,UACN,IAAIjnB,EAAQjH,KAAKiH,MACb6C,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjBf,EAAUhB,EAAMgB,QAChBkC,EAAalD,EAAMkD,WACnBwkB,EAAaxkB,EAAWC,IAAI,uBAAwBnD,GACpDhC,EAAS6E,EAAM7E,OACf2pB,EAAezkB,EAAWC,IAAI,qBAAsBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAClF0nB,WAAYA,EACZxP,IAAK,iBAAe0P,QAElBC,EAAa3kB,EAAWC,IAAI,gBAAiB,CAC/C2e,OAAQ9jB,EAAO9D,UACf2I,MAAOA,EACPd,SAAUA,IAER9G,EAAY,wBAAcsB,GAAO,CACnC0E,IAAKD,EAAQ6W,GAAY9V,KACxB4lB,GACCzT,EAAWhR,EAAWC,IAAI,gCAAiCnD,GAE/D,OAAQhC,EAAO9D,WACb,KAAK,oBAAkBC,eACrB,OAAO,wBAAc,WAAU,KAAMpB,KAAKuuB,iBAAiBO,EAAWC,EAAG,KAAM7sB,EAAWlC,KAAKuuB,iBAAiBO,EAAWE,EAAG,KAAM7T,GAEtI,KAAK,oBAAkB8T,cACrB,OAAO,wBAAc,WAAU,KAAM/sB,EAAWlC,KAAKuuB,iBAAiBO,EAAWE,EAAG,KAAM7T,GAE5F,KAAK,oBAAkB+T,cACrB,OAAO,wBAAc,WAAU,KAAMlvB,KAAKuuB,iBAAiBO,EAAWC,EAAG,KAAM7sB,EAAWiZ,GAE5F,KAAK,oBAAkBgU,cACrB,OAAO,wBAAc,WAAU,KAAMjtB,EAAWlC,KAAKuuB,iBAAiBO,EAAWM,EAAG,KAAMjU,GAG9F,OAAO,MAGFmT,EAnET,CAoEE,aAGEe,GAAS,UAAOtoB,IAAIskB,KAAuBA,GAAqBpU,EAAqB,CAAC,wDAAyD,mHAAoH,iHAAkH,CAAC,wDAAyD,mHAAoH,oHAAoH,SAAU5O,GACnqB,IAAI8W,EAAM9W,EAAG8W,IACb,OAAIA,IAAQ,iBAAemQ,MAAc,cAAInE,KAAuBA,GAAqBlU,EAAqB,CAAC,mCAAoC,CAAC,sCAChJkI,IAAQ,iBAAekP,KAAa,cAAIjD,KAAuBA,GAAqBnU,EAAqB,CAAC,kCAAmC,CAAC,0CAAlJ,KACC,SAAUhQ,GACX,OAAOA,EAAMzF,cAGf,SAAS+tB,GAAkBtoB,GACzB,IAAIoB,EAEAyB,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjB2lB,EAAa1nB,EAAM0nB,WACnBxP,EAAMlY,EAAMkY,IACZlX,EAAUhB,EAAMgB,QAChBunB,EAAkBvoB,EAAMuoB,gBACxBzd,EAAQjI,EAAMC,SAASf,GAC3B,OAAO+I,EAAM7N,QAAQ4L,KAAO,EAAI,wBAAcuf,GAAQ,CACpDnnB,IAAKD,EAAQgX,GAAejW,IAC5B+C,QAASyjB,EACThuB,WAAYmtB,EAAWntB,WACvB2d,IAAKA,EACLnP,UAAW,KAAI3H,EAAK,CAClB8H,MAAM,EACNsf,UAAU,GACTpnB,EAAG,OAAS0J,EAAM3N,SAAW,OAAS,WAAY,EAAMiE,MACxD,KAIP,IAgEIqnB,GAAoBC,GAhEpBC,GAAQ,IAAM,uBACdC,GAAc,UAAO9oB,IAAI2oB,KAAuBA,GAAqBzY,EAAqB,CAAC,6BAA8B,CAAC,gCAC1H6Y,GAAiB,UAAO/oB,IAAI4oB,KAAuBA,GAAqB1Y,EAAqB,CAAC,qGAAsG,CAAC,wGAErM8Y,GAAgB,SAAuBzoB,GACzCsoB,GAAM,eACNtoB,EAAEmS,iBACFnS,EAAEC,mBAGJ,SAASyoB,GAAa/oB,GACpB,IAQIgpB,EARA9lB,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjBuS,EAAStU,EAAMsU,OACfta,EAAW6I,EAAMI,oBAAsBlB,EACvCknB,EAAS/lB,EAAWC,IAAI,2BAA4BjE,EAAQA,EAAQ,GAAIc,GAAQ,CAClFhG,SAAUA,KAIZ,GAAIA,EACFgvB,EAAQC,MACH,CACL,IAAIC,EASAC,EAAS,CACXxX,MAAO,GACPG,OAAQ,IAENsX,EAAY9U,EAAO,kBAAoBvS,GACvCqnB,IAAWD,EAASC,EAAUxN,yBAElC,IAMIyN,EAA0B,IAAI,WANN,SAA+B9X,EAASC,GAClE,IAAItV,EAAIqV,EAAQ,GAAGU,YACnBiX,EAAUtrB,MAAMiV,MAAQsW,EAAOxX,MAAQzV,EAAEyV,OAAS,EAAI,KACtDuX,EAAUtrB,MAAMkV,KAAOqW,EAAOrX,OAAS5V,EAAE4V,QAAU,EAAI,QAIzD6W,GAAMQ,GACNH,EAAQ,wBAAc,WAAU,KAAM,wBAAc,MAAO,CACzDprB,MAAO,CACL+T,MAAOwX,EAAOxX,MACdG,OAAQqX,EAAOrX,UAEf,wBAAc+W,GAAgB,CAChC5nB,IA5Be,SAAoBA,GAC/BA,IACFioB,EAAYjoB,EACZooB,EAAwBjX,QAAQ8W,MA0BjCD,IAGL,OAAO,wBAAcL,GAAa,CAChCjG,YAAamG,GACbhG,WAAYgG,IACXE,GAIL,IA+KIM,GAAoBC,GAyDpBC,GAxOAC,GAAQ,IAAM,6BACdC,GAAiB,UAAO5pB,IAAIwpB,KAAuBA,GAAqBtZ,EAAqB,CAAC,kHAAmH,CAAC,qHAClN2Z,GAA2B,UAAO7pB,IAAIypB,KAAuBA,GAAqBvZ,EAAqB,CAAC,6BAA8B,CAAC,gCAEvI4Z,GAEJ,SAAU9wB,GAGR,SAAS8wB,EAAmB5pB,GAC1B,IAAIE,EAAQpH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KAmFxC,OAjFAmH,EAAM2pB,YAAc,SAAUjH,GAC5B1iB,EAAMiD,IAAI,uBAAwBjE,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CAClE4iB,GAAIA,MAIR1iB,EAAM4iB,WAAa,SAAUF,GAE3BA,EAAGpQ,kBAGLtS,EAAMyiB,YAAc,SAAUC,GAC5B6G,GAAM,cAAevpB,EAAMF,MAAM+B,UAEjC7B,EAAMiD,IAAI,uBAAwBjE,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CAClE4iB,GAAIA,EACJtE,QAAS,SAIbpe,EAAM2iB,YAAc,SAAUD,GAC5B1iB,EAAMiD,IAAI,uBAAwBjE,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CAClE4iB,GAAIA,EACJtE,QAAS,SAIbpe,EAAM6iB,OAAS,SAAUH,GACvB6G,GAAM,UAENvpB,EAAMiD,IAAI,kBAAmBjE,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CAC7D4iB,GAAIA,EACJtE,QAAS,SAIbpe,EAAM4E,QAAU,SAAU8d,GACxB,IACI1f,EADQhD,EAAMF,MACKkD,WAEvBhD,EAAM4pB,wBAA0BC,YAAW,WAIzC7mB,EAAWC,IAAI,mBAAoBjE,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CACnE4iB,GAAIA,OAEL,MAGL1iB,EAAM8pB,cAAgB,SAAUpH,GAC9BqH,aAAa/pB,EAAM4pB,yBACF5pB,EAAMF,MAAMkD,WAClBC,IAAI,yBAA0BjE,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CACzE4iB,GAAIA,MAIR1iB,EAAMgqB,gBAAiB,EAEvBhqB,EAAMqoB,gBAAkB,SAAUloB,GAChCA,EAAEC,kBACF,IAAIc,EAAKlB,EAAMF,MACX+B,EAAWX,EAAGW,SACduS,EAASlT,EAAGkT,OAChBpU,EAAMgqB,gBAAiB,EACvB,IACInP,EADezG,EAAO0D,GAAejW,IACjB6Z,wBACxB6N,GAAM,UAAW1O,GACjB7a,EAAMiqB,sBAAwB,CAACpP,EAAKlI,KAAOkI,EAAKpJ,MAAQ,EAAGoJ,EAAKjI,IAAMiI,EAAKjJ,OAAS,GACpF2X,GAAM,wBAAyBvpB,EAAMiqB,uBAKrCjqB,EAAM4Q,UAAU,SAAO3D,gBAAiBjN,EAAMF,QAGhDE,EAAMC,MAAQ,CACZiqB,WAAW,GAENlqB,EA+ET,OArKApB,EAAU8qB,EAAoB9wB,GAyF9B8wB,EAAmB3qB,UAAUorB,kBAAoB,WAC/C,IAAInnB,EAAanK,KAAKiH,MAAMkD,WAE5B,GAAKA,EAAWkE,SAASC,GAAQsR,2BAA4BzZ,EAAQ,GAAInG,KAAKiH,QAO9E,OAHAjH,KAAK+X,UAAU,SAAO7L,YAAa/F,EAAQA,EAAQ,GAAInG,KAAKiH,OAAQ,CAClE5B,UAAW,YAAU+X,cAEhBjT,EAAWC,IAAI,yBAA0BpK,KAAKiH,QAGvD4pB,EAAmB3qB,UAAUqrB,mBAAqB,aAGlDV,EAAmB3qB,UAAU8mB,mBAAqB,WAChD,GAAIhtB,KAAKmxB,eAAgB,CACvB,IAAI9oB,EAAKrI,KAAKiH,MACVsU,EAASlT,EAAGkT,OACZvS,EAAWX,EAAGW,SACdkR,EAAwB7R,EAAG6R,sBAE3BsX,EADUjW,EAAO0D,GAAejW,IACd6Z,wBAKlB4O,EAAY,CAACD,EAAQ1X,KAAO0X,EAAQ5Y,MAAQ,EAAG4Y,EAAQzX,IAAMyX,EAAQzY,OAAS,GAClF2X,GAAM,aAAce,GACpBf,GAAM,aAAc1wB,KAAKoxB,uBAEzB,IAAIM,EAAS,CAACD,EAAU,GAAKzxB,KAAKoxB,sBAAsB,GAAIK,EAAU,GAAKzxB,KAAKoxB,sBAAsB,IACtGV,GAAM,SAAUgB,GAChBxX,EAAsBwX,EAAO,GAAIA,EAAO,IACxC1xB,KAAKmxB,gBAAiB,IAI1BN,EAAmB3qB,UAAU6C,OAAS,WACpC,IAAI9B,EAAQjH,KAAKiH,MACbgB,EAAUhB,EAAMgB,QAChBe,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACnBwkB,EAAa1nB,EAAM0nB,WACnBxP,EAAMlY,EAAMkY,IAChBuR,GAAM,SAAU1nB,EAAUc,EAAMzE,WAChC,IAAIssB,EAAYxnB,EAAWC,IAAI,qBAAsBnD,IAAU6C,EAAMI,oBAAsBlB,EACvF4oB,EAAeznB,EAAWC,IAAI,0BAA2BjE,EAAQA,EAAQ,GAAIc,GAAQ,CACvFuoB,gBAAiBxvB,KAAKwvB,gBAAgBnmB,KAAKrJ,SAEzC6xB,EAAe1nB,EAAWC,IAAI,sBAAuBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACnFse,QAAS,UAEPuM,EAAe3nB,EAAWC,IAAI,sBAAuBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACnFse,QAAS,UAEPwM,EAAoB,CACtBnI,YAAa5pB,KAAK4pB,YAClBE,YAAa9pB,KAAK8pB,YAClBC,WAAY/pB,KAAK+pB,WACjBC,OAAQhqB,KAAKgqB,QAGf,OAAO,wBAAc4G,GAA0B,KAAMiB,EAAc,wBAAclB,GAAgBxqB,EAAQ,CACvGtB,MAAO8pB,EACPgD,UAAWA,EACXzpB,IAAKD,EAAQ2W,GAAc5V,IAC3B8nB,YAAa9wB,KAAK8wB,YAClB/kB,QAAS/L,KAAK+L,QACdklB,cAAejxB,KAAKixB,eACnBc,GAAoB5nB,EAAWC,IAAI,oBAAqBnD,GAAQkD,EAAWC,IAAI,2BAA4BnD,IAAS6qB,EAAc3S,IAAQ,iBAAe0P,MAAQ+C,IAGtKf,EAAqB5a,EAAW,CAAC,qBAAoB4a,GArKvD,CAuKE/Y,GAGEka,GAAQ,IAAM,mBACdC,GAAwB,UAAOlrB,IAAI0pB,KAAuBA,GAAqBxZ,EAAqB,CAAC,yBAA0B,CAAC,4BAEpI,SAASib,GAAUjrB,GACjB,IAAIkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjBuS,EAAStU,EAAMsU,OACf4W,EAAYroB,EAAMY,iBAAmB1B,EACzCgpB,GAAM,YAAaG,GAEnB,IAOIhc,EAAOrM,EAAMC,SAASf,GAAUgB,SAAS,YAAUkb,MACvD,IAAKiN,GAAahoB,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC3EnD,MAAOqS,EAAKrS,SACT,OAAO,KACZ,IAAIsuB,EAAajoB,EAAWC,IAAI,wBAAyBnD,GACrDorB,EAAc9W,EAAO6D,GAAOC,kBAC5Bxa,EAAQ,CACVytB,SAAU,QACVC,UAAW,SAGb,GAAIF,EAAa,CACf,IAAIG,EAAQH,EAAYxP,wBACxBhe,EAAMytB,SAAyB,GAAdE,EAAM5Z,MAAc,KACrC/T,EAAM0tB,UAA2B,GAAfC,EAAMzZ,OAAe,KAGzC,IAUI1I,EAAe,CACjB9G,WAAW,EACX9E,QAZmB,wBAAcwtB,GAAuB,CACxDlmB,QAAS4D,GACT8iB,UAAW,UAAQC,gBACnB7tB,MAAOA,GACNutB,GASDtqB,OARS,wBAAcsI,GAAgB,CACvCrE,QA9BY,SAAiBzE,GAC7BA,EAAEC,kBACF4C,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAOwZ,uBA4BjB7T,UAAWC,GAAc2N,GAASI,OAClC9N,UAAW,IAMXI,gBAAiB,yBAAuBqiB,MACxCliB,eAAgB,KAGlB,OADe0F,EAAKrS,OAAS,wBAAc,UAASqC,EAAQ,GAAIkK,IAKlE,IAmEIuiB,GAsIAC,GAqFAC,GAAoBC,GAAoBC,GAiJxCC,GAAoBC,GAAoBC,GAyCxCC,GAxdAC,GAAoB,UAAOxK,IAAI+J,KAAuBA,GAAqB3b,EAAqB,CAAC,6HAA8H,CAAC,gIAEhOqc,GAEJ,SAAUvzB,GAGR,SAASuzB,IACP,IAAInsB,EAAmB,OAAXpH,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAKhE,OAHAmH,EAAMC,MAAQ,CACZ3C,QAAS,MAEJ0C,EAmDT,OA3DApB,EAAUutB,EAAgBvzB,GAW1BuzB,EAAeptB,UAAU6iB,OAAS,WAChC,IAAI1gB,EAAKrI,KAAKiH,MACVsU,EAASlT,EAAGkT,OACZzR,EAAQzB,EAAGyB,MACXvE,EAAa8C,EAAG9C,WAChBH,EAAW0E,EAAM1E,SACjBC,EAAYyE,EAAMzE,UAEtB,GAAKD,GAAYC,IAAc,YAAU4X,gBAAzC,CAOA,IAAIxY,EAAU8W,EAAOqD,GAAcxZ,IAC/B6T,EAAUsC,EAAO6D,GAAOE,wBAAwBrG,QAChD4P,EAAMtN,EAAO6D,GAAOG,mBAEpBrG,EAAcuJ,GAAiBhe,EAASwU,EAAS1T,GAEjD0jB,EAAUxG,GAAiBoG,EAAK5P,EAAS1T,GAGzC8c,EAAInJ,EAAYY,KAAOmP,EAAQnP,KADrB,EAEVyI,EAAIrJ,EAAYa,IAAMkP,EAAQlP,IAFpB,EAGVnB,EAAQM,EAAYN,MAAQ,EAC5BG,EAASG,EAAYH,OAAS,EAClC/Y,KAAKsI,SAAS,CACZ7D,QAAS,wBAAc,OAAQ,CAC7B4d,EAAGA,EACHE,EAAGA,EACH3J,MAAOA,EACPG,OAAQA,EACR/F,KAAM,OACNkW,OAAQpf,EAAM7E,OAAO5D,MAAMI,eAC3B2nB,YAAa,WA3BfppB,KAAKsI,SAAS,CACZ7D,QAAS,QA+Bf6uB,EAAeptB,UAAU6C,OAAS,WAChC,IAAId,EAAUjI,KAAKiH,MAAMgB,QACzB,OAAO,wBAAcorB,GAAmB,CACtCnrB,IAAKD,EAAQmX,GAAOG,oBACnBvf,KAAKoH,MAAM3C,UAGT6uB,EA5DT,CA6DExb,GAGEyb,GAAgB,UAAO1K,IAAIgK,KAAuBA,GAAqB5b,EAAqB,CAAC,6HAA8H,CAAC,gIAC5Nuc,GAAQ,IAAM,wBAEdC,GAEJ,SAAU1zB,GAGR,SAAS0zB,IACP,IAAItsB,EAAmB,OAAXpH,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAKhE,OAHAmH,EAAMC,MAAQ,CACZymB,OAAQ,IAEH1mB,EAoHT,OA5HApB,EAAU0tB,EAAe1zB,GAWzB0zB,EAAcvtB,UAAU6iB,OAAS,WAC/B,IAuBI5G,EAAIC,EAAIsR,EAvBRzsB,EAAQjH,KAAKiH,MACb6C,EAAQ7C,EAAM6C,MACdyR,EAAStU,EAAMsU,OACfvS,EAAW/B,EAAM+B,SACjBmW,EAAMlY,EAAMkY,IACZhV,EAAalD,EAAMkD,WACnBwpB,EAAIxpB,EAAWC,IAAI,gBAAiBnD,GACpC8K,EAAQjI,EAAMC,SAASf,GACvBvE,EAAU8W,EAAOqD,GAAc5V,IAC/B6f,EAAMtN,EAAOyD,GAAehW,IAC5B4oB,EAAerW,EAAO0D,GAAejW,IACrCiQ,EAAUsC,EAAO6D,GAAOE,wBAAwBrG,QAEhDgQ,EAAUxG,GAAiBoG,EAAK5P,EAAS0a,GAEzCC,EAAenR,GAAiBmP,EAAc3Y,EAAS0a,GAEvDza,EAAcuJ,GAAiBhe,EAASwU,EAAS0a,GAErDH,GAAMxqB,GACNwqB,GAAM,UAAWvK,GACjBuK,GAAM,eAAgBI,GACtBJ,GAAM,cAAeta,GAGjBiG,IAAQ,iBAAemQ,OACzBnN,EAAK,CACHE,EAAG,EACHE,EAAGR,GAAQ7I,GAAe+P,EAAQlP,KAEpCqI,EAAK,CACHC,EAAGuR,EAAapS,MAAQyH,EAAQnP,KAAO,GACvCyI,EAAGJ,EAAGI,IAECpD,IAAQ,iBAAekP,OAChClM,EAAK,CACHE,EAAG4G,EAAQzH,MAAQyH,EAAQnP,KAC3ByI,EAAGR,GAAQ7I,GAAe+P,EAAQlP,KAEpCqI,EAAK,CACHC,EAAGuR,EAAa9Z,KAAOmP,EAAQnP,KAAO,GACtCyI,EAAGJ,EAAGI,IAIV,IAAIsL,EAAS,GACb9b,EAAM7N,QAAQgJ,SAAQ,SAAU/M,GAC9B,IAAI2tB,EACAhsB,EAAYqI,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzE+B,SAAU7I,KAGR0zB,EAAatY,EAAOqD,GAAcze,IACtC,GAAK0zB,EAAL,CAEA,IAAI7R,EAAOS,GAAiBoR,EAAY5a,EAAS0a,GAE7CxU,IAAQ,iBAAemQ,QACzBoE,EAAK,CACHrR,EAAGL,EAAKlI,KAAOmP,EAAQnP,KACvByI,EAAGR,GAAQC,GAAQiH,EAAQlP,MAI3BoF,IAAQ,iBAAekP,OACzBqF,EAAK,CACHrR,EAAGL,EAAKR,MAAQyH,EAAQnP,KACxByI,EAAGR,GAAQC,GAAQiH,EAAQlP,MAI/B,IAAI/X,EAAWF,EAAUE,SAEzB,GAAiB,UAAbA,EACF8rB,EAAQ,KAAO3L,EAAGE,EAAI,IAAMF,EAAGI,EAAI,MAAQH,EAAGC,EAAI,IAAMD,EAAGG,EAAI,MAAQH,EAAGC,EAAI,IAAMC,GAAaF,EAAIsR,GAAM,IAAMxR,GAAaE,EAAIsR,GAAM,IAAMA,EAAGnR,EAAI,IAAMmR,EAAGrR,EAAI,IAAMqR,EAAGnR,OACtK,GAAiB,UAAbvgB,EAAsB,CAC/B,IAAI+rB,EAAO2F,EAAGnR,EAAIJ,EAAGI,EAAI,GAAK,EAC1ByL,EAAO0F,EAAGrR,EAAIF,EAAGE,EAAI,GAAK,EAC1B4L,EAASnsB,EAAUC,WAGrB+rB,EADyB,IAAvB/b,EAAM7N,QAAQ4L,MAAc1M,KAAK0wB,IAAIJ,EAAGnR,EAAIJ,EAAGI,IAAM,EAC/C,KAAOJ,EAAGE,EAAI,IAAMF,EAAGI,EAAI,MAAQmR,EAAGrR,EAAI,IAAMqR,EAAGnR,EAGnD,KAAOJ,EAAGE,EAAI,IAAMF,EAAGI,EAAI,MAAQH,EAAGC,EAAI,OAASqR,EAAGnR,EAAIwL,EAAOE,GAAU,MAAQA,EAAS,IAAMA,EAAS,SAAWF,EAAOC,IAAS,EAAI,EAAI,GAAK,KAAO5L,EAAGC,EAAI4L,EAASD,GAAQ,IAAM0F,EAAGnR,EAAI,MAAQmR,EAAGrR,MAE9L,SAAbrgB,IACT8rB,EAAQ,KAAO3L,EAAGE,EAAI,IAAMF,EAAGI,EAAI,MAAQH,EAAGC,EAAI,MAAQqR,EAAGrR,EAAI,IAAMqR,EAAGnR,GAG5EsL,EAAOvgB,KAAK,wBAAc,OAAQ,CAChCnN,IAAK,QAAUA,EACfsF,EAAGqoB,EACH1E,YAAatnB,EAAUG,UACvBinB,OAAQpnB,EAAUS,UAClByQ,KAAM,cAGVhT,KAAKsI,SAAS,CACZulB,OAAQA,KAIZ4F,EAAcvtB,UAAU6C,OAAS,WAC/B,IAAIV,EAAKrI,KAAKiH,MACV+B,EAAWX,EAAGW,SACdf,EAAUI,EAAGJ,QACjB,OAAO,wBAAcsrB,GAAe,CAClCrrB,IAAKD,EAAQ+W,GAAehW,KAC3B,wBAAc,IAAK,KAAMhJ,KAAKoH,MAAMymB,UAGlC4F,EA7HT,CA8HE3b,GAGEic,GAAQ,IAAM,qBACdC,GAAO,UAAOjtB,IAAI+rB,KAAuBA,GAAqB7b,EAAqB,CAAC,iEAAkE,OAAQ,CAAC,iEAAkE,UAAU,SAAUhQ,GACvP,OAAOA,EAAMmnB,iBAAmB,iBAAekB,MAAQ,MAAQ,iBAG7D2E,GAAe,UAAOltB,IAAIgsB,KAAuBA,GAAqB9b,EAAqB,CAAC,uCAAwC,OAAQ,CAAC,uCAAwC,UAAU,SAAUhQ,GAC3M,OAAOA,EAAMkY,MAAQ,iBAAemQ,MAAQ,SAAWroB,EAAMvF,QAAU,KAAO,KAAOuF,EAAMvF,QAAU,YAEnGwyB,GAAY,UAAOntB,IAAIisB,KAAuBA,GAAqB/b,EAAqB,CAAC,0FAA2F,OAAQ,CAAC,0FAA2F,UAAU,SAAUhQ,GAC9S,OAAOA,EAAMmnB,iBAAmB,iBAAekB,MAAQ,MAAQ,iBAG7D6E,GAEJ,SAAUp0B,GAGR,SAASo0B,IACP,OAAkB,OAAXp0B,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KA+D7D,OAlEA+F,EAAUouB,EAAap0B,GAMvBo0B,EAAYjuB,UAAUkuB,gBAAkB,WACtC,IAAIntB,EAAQjH,KAAKiH,MACbkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjBmW,EAAMlY,EAAMkY,IACZpa,EAAS+E,EAAMC,SAASf,GAAU9E,QAAQ6I,UAC1CE,EAAM9C,EAAWC,IAAI,kBAAmBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACtElC,OAAQA,KAEV,IAAKkI,EAAK,OAAO,KACjB,IAAIwhB,EAAYxhB,EAAIwhB,UAChB4F,EAAWlqB,EAAWC,IAAI,iBAAkBnD,GAChD,OAAO,wBAAcgtB,GAAc,CACjC9U,IAAKA,EACLzd,QAASoI,EAAM7E,OAAO5D,MAAMK,SAC3B+sB,EAAW,IAAK4F,IAUrBF,EAAYjuB,UAAUouB,YAAc,WAClC,IAAIjsB,EAAKrI,KAAKiH,MACVsU,EAASlT,EAAGkT,OACZvS,EAAWX,EAAGW,SAEd+I,EADQ1J,EAAGyB,MACGC,SAASf,GAC3B,GAA2B,IAAvB+I,EAAM7N,QAAQ4L,OAAciC,EAAM3N,SAAtC,CACA2vB,GAAM,cAAe/qB,GACrB,IAAIurB,EAAQhZ,EAAOwD,GAAY/V,IAC/BurB,GAASA,EAAMxL,WAGjBoL,EAAYjuB,UAAU6C,OAAS,WAC7B,IAAI9B,EAAQjH,KAAKiH,MACbkD,EAAalD,EAAMkD,WACnBnB,EAAW/B,EAAM+B,SACjBmW,EAAMlY,EAAMkY,IACZlX,EAAUhB,EAAMgB,QACpB8rB,GAAM,SAAU/qB,GAChB,IAAI2lB,EAAaxkB,EAAWC,IAAI,uBAAwBnD,GAEpDutB,EAAYruB,EAAQA,EAAQ,GAAIc,GAAQ,CAC1C0nB,WAAYA,IAGVC,EAAezkB,EAAWC,IAAI,qBAAsBoqB,GACxD,OAAO,wBAAcR,GAAM,CACzB5F,eAAgBjP,GACf,wBAAc+U,GAAW,CAC1B9F,eAAgBjP,EAChBjX,IAAKD,EAAQ6W,GAAY9V,KACxB4lB,GAAe5uB,KAAKo0B,oBAGlBD,EAnET,CAoEE,aAGEM,GAAQ,IAAM,yBACdC,GAAa,kBAAOnpB,GAAP,CAAe0nB,KAAuBA,GAAqBhc,EAAqB,CAAC,2KAA4K,CAAC,8KAC3Q0d,GAAQ,kBAAOjY,EAAP,CAAYwW,KAAuBA,GAAqBjc,EAAqB,CAAC,uBAAwB,CAAC,0BAC/G2d,GAAiB,UAAOhY,KAAKuW,KAAuBA,GAAqBlc,EAAqB,CAAC,iEAAkE,CAAC,oEAElK4d,GAAO,SAAc5tB,GACvB,OAAO,wBAAc,UAAS,CAC5BxC,QAASwC,EAAM6tB,QACfjJ,SAAU,WAASkJ,IACnB/kB,UAAW,UAAQglB,MAClB,wBAAcL,GAAO,CACtB5oB,QAAS9E,EAAM8E,QACfmE,UAAW,GACVjJ,EAAMkU,YAGP8Z,GAEJ,SAAUl1B,GAGR,SAASk1B,EAAehuB,GACtB,IAAIE,EAAQpH,EAAO2G,KAAK1G,KAAMiH,IAAUjH,KAuExC,OArEAmH,EAAM+tB,iBAAmB,SAAU3vB,GACjCkvB,GAAM,mBAAoBlvB,GAE1B4B,EAAMmB,SAAS,CACb/C,WAAYA,KAIhB4B,EAAMguB,iBAAmB,SAAU7tB,GACjC,IAAIL,EAAQE,EAAMF,MACDA,EAAMkD,WACZC,IAAI,gBAAiBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC1D1B,WAAY,MAIhB4B,EAAMiuB,eAAiB,SAAU9tB,GAC/B,IAAIL,EAAQE,EAAMF,MACdkD,EAAalD,EAAMkD,WACnB5E,EAAa4E,EAAWC,IAAI,gBAAiBnD,GACjDkD,EAAWC,IAAI,gBAAiBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC1D1B,WAAYA,EAAa,OAI7B4B,EAAMkuB,iBAAmB,SAAU/tB,GACjC,IAAIL,EAAQE,EAAMF,MACdkD,EAAalD,EAAMkD,WACnB5E,EAAa4E,EAAWC,IAAI,gBAAiBnD,GACjDkD,EAAWC,IAAI,gBAAiBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC1D1B,WAAYA,EAAa,OAI7B4B,EAAMmuB,mBAAqB,SAAUhuB,GACnC,IAAIL,EAAQE,EAAMF,MACdkD,EAAalD,EAAMkD,WACvBA,EAAWC,IAAI,mBAAoBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC7D9G,IAAKuf,GAASC,kBACd3D,SAAU7U,EAAMouB,gBAChBhY,MAAM,KAERpT,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAO8T,iBAInBhX,EAAMquB,iBAAmB,SAAUluB,GACjC,IAAIL,EAAQE,EAAMF,MACdkD,EAAalD,EAAMkD,WACvBA,EAAWC,IAAI,mBAAoBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC7D9G,IAAKuf,GAASC,kBACd3D,SAAU7U,EAAMouB,gBAChBhY,MAAM,KAERpT,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAO+T,eAInBjX,EAAMouB,gBAAkB,WACtB,IAAIltB,EAAKlB,EAAMF,MACX6C,EAAQzB,EAAGyB,MACEzB,EAAG8B,WACTC,IAAI,oBAAqBjE,EAAQA,EAAQ,GAAIgB,EAAMF,OAAQ,CACpE+B,SAAUc,EAAM3E,uBAIbgC,EAgDT,OA1HApB,EAAUkvB,EAAgBl1B,GA6E1Bk1B,EAAe/uB,UAAUqC,kBAAoB,WAC3C,IAAItB,EAAQjH,KAAKiH,MACAA,EAAMkD,WACZC,IAAI,mCAAoCjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC7E+U,SAAUhc,KAAKk1B,qBAInBD,EAAe/uB,UAAUwC,qBAAuB,WAC9C,IAAIzB,EAAQjH,KAAKiH,MACAA,EAAMkD,WACZC,IAAI,sCAAuCjE,EAAQA,EAAQ,GAAIc,GAAQ,CAChF+U,SAAUhc,KAAKk1B,qBAInBD,EAAe/uB,UAAU6C,OAAS,WAChC0rB,GAAM,UACN,IAAIxtB,EAAQjH,KAAKiH,MACbkD,EAAalD,EAAMkD,WACnBuB,EAASzE,EAAMyE,OACfnG,EAAa4E,EAAWC,IAAI,gBAAiBnD,GACjD,OAAO,wBAAcytB,GAAY,CAC/BhpB,OAAQA,GACP,wBAAcmpB,GAAM,CACrB9oB,QAAS/L,KAAKs1B,mBACdR,QAAS,gBACR5gB,GAAK0J,GAASO,eAAgB,wBAAc0W,GAAM,CACnD9oB,QAAS/L,KAAKw1B,iBACdV,QAAS,cACR5gB,GAAK0J,GAASQ,aAAc,wBAAcyW,GAAM,CACjD9oB,QAAS/L,KAAKu1B,gBACdT,QAAS,qBACR5gB,GAAK0J,GAASS,SAAU,wBAAcwW,GAAM,CAC7C9oB,QAAS/L,KAAKq1B,iBACdP,QAAS,WACR5gB,GAAK0J,GAASM,QAAS,wBAAc2W,GAAM,CAC5C9oB,QAAS/L,KAAKm1B,iBACdL,QAAS,cACR,wBAAcF,GAAgB,KAAM,QAAUxxB,KAAKqyB,MAAmB,IAAblwB,GAAoB,MAAO,wBAAcsvB,GAAM,CACzG9oB,QAAS/L,KAAKo1B,eACdN,QAAS,YACR5gB,GAAK0J,GAASK,SAGZgX,EA3HT,CA4HEnd,GAGE4d,GAAoB,UAAO3uB,IAAIqsB,KAAuBA,GAAqBnc,EAAqB,CAAC,iFAAkF,CAAC,oFAExL,SAAS0e,GAAa1uB,GACpB,IAAIkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SAErB,GAAIc,EAAMzE,YAAc,YAAU8f,aAAc,CAC9C,IAeIiN,EAAajoB,EAAWC,IAAI,wBAAyBnD,GACzD,OAAO,wBAAc,SAAQ,CAC3B9G,IAAK,SACL6R,MAAO,aACP7B,KAAM+D,GAAK,QACXzF,QAAQ,EACRmnB,aAAa,EACbC,cAAe,CACbxuB,YAAasI,IAEfmmB,oBAAoB,EACpBjnB,QA1BsB,SAA2BvH,GACjDA,EAAEC,kBACF,IAAIpH,EAAM,mBAAqB6I,EAC3B+sB,EAAW5rB,EAAWC,IAAI,kBAAmB,CAC/CjK,IAAKA,IAEPgK,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAOya,gBACf9b,SAAUA,EACVsB,UAAW,YAAU4a,KACrBnkB,KAAMg1B,EACN1wB,UAAW,YAAU8G,WAgBvB2D,KAAM,OACL,wBAAc4lB,GAAmB,KAAMtD,KAM9C,SAAS4D,GAAM3tB,GACb,IAAIhH,EAAQgH,EAAGhH,MACX8Z,EAAW9S,EAAG8S,SAClB,OACE,uBADK,CACS,gBAAe,CAC3B9Z,MAAOA,GACN,wBAAc,WAAU,KAAM8Z,IAIrC,IA4KI8a,GA5KAC,GAAQ,IAAM,oBAElB,SAASC,KACP,IAGIC,EAHAC,EAAc,UAAOtvB,IAAIkvB,KAAuBA,GAAqBhf,EAAqB,CAAC,0DAA2D,kCAAmC,CAAC,0DAA2D,qCAAqC,SAAUhQ,GACtS,OAAOA,EAAM5F,MAAMG,cAGrB,MAAO,CACL80B,gBAAiB,WACf,OAAOF,GAETG,cAAe,SAAuBtvB,GACpC,IAAI6C,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACvB,OAAO,wBAAcmR,EAAS,MAAM,SAAUrT,EAASsT,EAAQG,GAO7D,OANA0a,EAAejwB,EAAQA,EAAQ,GAAIc,GAAQ,CACzCgB,QAASA,EACTsT,OAAQA,EACRG,UAAWA,IAEbwa,GAAM,gBAAiBpsB,GAChB,wBAAcksB,GAAO,CAC1B30B,MAAOyI,EAAM7E,OAAO5D,OACnB,wBAAcg1B,EAAa,CAC5BnuB,IAAKD,EAAQmX,GAAOC,mBACnB,wBAAciN,GAAsBnmB,EAAQ,GAAIiwB,IAAgBjsB,EAAWC,IAAI,yBAA0BgsB,SAGhHT,aAAcA,GACdliB,uBAAwB,SAAgCxM,GACtD,IAAIkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACd4B,EAASvB,EAAWkE,SAASC,GAAQwG,gCAErC0hB,EAASrwB,EAAQA,EAAQ,GAAIc,GAAQ,CACvCyE,OAAQA,EACR1C,SAAUc,EAAM1E,WAalB,MAAO,CAVW+E,EAAWC,IAAI,8BAA+BosB,GAE5CrsB,EAAWC,IAAI,sBAAuBosB,GAC7CrsB,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIqwB,GAAS,CACvE9qB,OAAQA,EAAS,KAENvB,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIqwB,GAAS,CACvE9qB,OAAQA,EAAS,KAEEvB,EAAWC,IAAI,uBAAwBosB,KAG9DC,4BAA6B,SAAqCxvB,GAChE,OAAO,wBAAcwkB,GAAuBtlB,EAAQ,CAClDhG,IAAK,yBACJ8G,KAELyvB,aAAc,SAAsBzvB,GAClC,OAAO,wBAAckmB,GAAQhnB,EAAQ,CACnChG,IAAK,UACJ8G,KAEL0vB,YAAa,SAAqB1vB,GAChC,OAAO,MAET2vB,oBAAqB,SAA6B3vB,GAChD,OAAO,MAET4vB,UAAW,SAAmBxuB,GAE5B,OADeA,EAAG8S,UAGpB2b,iBAAkB,SAA0B7vB,GAC1C,OAAO,wBAAcqnB,GAAYnoB,EAAQ,GAAIc,KAE/C8vB,kBAAmB,SAA2B9vB,GAC5C,OAAO,wBAAcktB,GAAahuB,EAAQ,GAAIc,KAEhD+vB,mBAAoB,SAA4B/vB,GAC9C,OAAO,wBAAc4pB,GAAoB1qB,EAAQ,GAAIc,KAEvDgwB,wBAAyB,SAAiChwB,GACxD,OAAO,wBAAcsoB,GAAmBppB,EAAQ,GAAIc,KAEtD+N,yBAA0B,SAAkC/N,GAC1D,MAAO,IAETiwB,kBAAmB,SAA2BjwB,GAC5C,IAAI6C,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjBmB,EAAalD,EAAMkD,WAEnBxG,EADQmG,EAAMC,SAASf,GACRrF,OACfsJ,EAAM,GACN1G,EAAI,EAcR,OAbA5C,EAAOuJ,SAAQ,SAAUpJ,GACvB,IAAID,EAAIsG,EAAWC,IAAI,mBAAoBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACrEnD,MAAOA,EACPqzB,SAAU,SAAW5wB,KAGnB1C,IACFoJ,EAAIK,KAAK,wBAAc,WAAU,CAC/BnN,IAAK,SAAWoG,GACf1C,IACH0C,QAGG0G,GAETmqB,iBAAkB,SAA0BnwB,GAC1C,IAAIkD,EAAalD,EAAMkD,WAGvB,OAFYlD,EAAMnD,MAEJhD,MACZ,KAAK,YAAUu2B,QACb,OAAOltB,EAAWC,IAAI,0BAA2BnD,GAEnD,KAAK,YAAUie,KACb,OAAO/a,EAAWC,IAAI,uBAAwBnD,GAGlD,OAAO,MAETqwB,wBAAyB,SAAiCrwB,GACxD,OAAO,wBAAc+oB,GAAc7pB,EAAQ,GAAIc,KAEjDswB,qBAAsB,SAA8BtwB,GAClD,OAAO,wBAAcirB,GAAW/rB,EAAQ,GAAIc,KAE9CuwB,eAAgB,SAAwBvwB,GACtC,IAAIgB,EAAUhB,EAAMgB,QAChBe,EAAW/B,EAAM+B,SAEjB+I,EADQ9K,EAAM6C,MACAC,SAASf,GAC3B,OAA2B,IAAvB+I,EAAM7N,QAAQ4L,MAAciC,EAAM3N,SAAiB,KAChD,wBAAcqvB,GAAettB,EAAQ,CAC1C+B,IAAKD,EAAQ8W,GAAY/V,KACxB/B,KAELwwB,mBAAoB,SAA4BxwB,GAE9C,IAAIgB,EAAUhB,EAAMgB,QAChBe,EAAW/B,EAAM+B,SAIrB,OAAO,wBAAc4kB,GAAcznB,EAAQ,CACzC+B,IAAKD,EAAQ8W,GAAY/V,KACxB/B,KAELywB,yBAA0B,SAAkCzwB,GAC1D,IAAIgB,EAAUhB,EAAMgB,QACpB,OAAO,wBAAcqrB,GAAgBntB,EAAQ,CAC3C+B,IAAKD,EAAQmX,GAAOI,sBACnBvY,KAEL0wB,8BAA+B,SAAuC1wB,GACpE,IAAIkD,EAAalD,EAAMkD,WACnB5E,EAAa4E,EAAWC,IAAI,gBAAiBnD,GAIjD,OAHAA,EAAQd,EAAQA,EAAQ,GAAIc,GAAQ,CAClC1B,WAAYA,IAEP,wBAAc,WAAU,KAAM4E,EAAWC,IAAI,qBAAsBnD,GAAQkD,EAAWC,IAAI,2BAA4BnD,GAAQkD,EAAWC,IAAI,0BAA2BnD,KAEjL2wB,qBAAsB,SAA8B3wB,GAClD,OAAO,wBAAcguB,GAAgB9uB,EAAQ,CAC3ChG,IAAK,oBACJ8G,MAMT,IAsCI4wB,GAAoBC,GAtCpBC,GAAY,kBAAOxsB,GAAP,CAAessB,KAAuBA,GAAqB5gB,EAAqB,CAAC,8HAA+H,CAAC,iIAC7N+gB,GAAa,kBAAO,OAAP,CAAaF,KAAuBA,GAAqB7gB,EAAqB,CAAC,4BAA6B,CAAC,+BAE9H,SAASghB,GAAchxB,GACrB,IAAIkD,EAAalD,EAAMkD,WACnBuB,EAASzE,EAAMyE,OACfwsB,EAAgBjxB,EAAMixB,cACtBC,EAAoBlxB,EAAMkxB,kBAE1B9vB,EAAKwO,EAAO,oBAAS,GAAQ,GAC7BuhB,EAAS/vB,EAAG,GACZgwB,EAAYhwB,EAAG,GAEnB,OAAK+vB,EAYE,wBAAcL,GAAW,CAC9BrsB,OAAQA,GACP,wBAAcF,GAAO,KAAM,wBAAcmR,EAAW,CACrD3M,UAAWC,GAAc2N,GAASE,OAClC/R,QAAS,WACP,OAAOssB,GAAU,OAEhB,wBAAcL,GAAY,CAC7BM,GAAIJ,EACJ9vB,SAAU+vB,GACThuB,EAAWC,IAAI,0BAA2BnD,KArBpC,wBAAc8wB,GAAW,CAC9BrsB,OAAQA,GACP,wBAAc+Q,EAAQ,CACvB1Q,QAAS,WACP,OAAOssB,GAAU,KAElB,wBAAc7b,EAAc,CAC7BxM,UAAWC,GAAc2N,GAASC,eAkBxC,IASI0a,GAAoBC,GAAoBC,GAAoBC,GAAoBC,GAAoBC,GAAoBC,GATxHC,GAAe,UAAO/xB,IAAIwxB,KAAuBA,GAAqBthB,EAAqB,CAAC,wEAAyE,CAAC,2EACtK8hB,GAAc,UAAOnc,KAAK4b,KAAuBA,GAAqBvhB,EAAqB,CAAC,mCAAoC,CAAC,sCACjI+hB,GAAsB,UAAOjyB,IAAI0xB,KAAuBA,GAAqBxhB,EAAqB,CAAC,mHAAoH,CAAC,sHACxNgiB,GAAe,kBAAOF,GAAP,CAAoBL,KAAuBA,GAAqBzhB,EAAqB,CAAC,IAAK,CAAC,OAC3GiiB,GAAa,UAAOnyB,IAAI4xB,KAAuBA,GAAqB1hB,EAAqB,CAAC,gGAAiG,CAAC,mGAC5LkiB,GAAW,UAAOpyB,IAAI6xB,KAAuBA,GAAqB3hB,EAAqB,CAAC,oHAAqH,OAAQ,CAAC,oHAAqH,UAAU,SAAUhQ,GACjW,OAAOA,EAAMmyB,SAEXC,GAAa,UAAOtyB,IAAI8xB,KAAuBA,GAAqB5hB,EAAqB,CAAC,2EAA4E,CAAC,8EAG3K,SAASqiB,GAAaryB,GACpB,OAAO,wBAAc,MAAO,KAAMA,EAAMkU,SAAU,wBAAc,UAAS,CACvEtW,MAAO,CACL0X,OAAQ,aAKd,SAASgd,GAAuBtyB,GAC9B,IAAImyB,EAAQnyB,EAAMmyB,MACdI,EAAoBvyB,EAAMuyB,kBAC9B,OAAO,wBAAcT,GAAa,KAAM,wBAAc,UAAS,KAAM,wBAAcM,GAAY,KAAM,wBAAc,MAAO,CACxHrpB,UAAWC,GAAc2N,GAASG,gBAChC,wBAAcob,GAAU,CAC1BC,MAAOA,KACJ,wBAAc,MAAO,KAAM,wBAAc,eAAc,CAC1DA,MAAOA,EACPK,iBAAkB,SAA0BL,GAC1C,OAAOI,EAAkBJ,EAAMM,WAKrC,SAASC,GAAkB1yB,GACzB,IAAI+K,EAAQ/K,EAAM+K,MACd4nB,EAAc3yB,EAAM2yB,YACxB,OAAO,wBAAcb,GAAa,KAAM,wBAAc,SAAQ,CAC5DhtB,QAAS6tB,GACR5nB,IAGL,SAAS6nB,GAAwB5yB,GAC/B,IAAIoB,EAAKpB,EAAM8hB,OACXA,OAAgB,IAAP1gB,EAAgB,IAAMA,EAC/B2J,EAAQ/K,EAAM+K,MACd8nB,EAAYhkB,EAAO7O,EAAO,CAAC,SAAU,UAErC8yB,EAAY,CACd3d,cAA0B,MAAX2M,EAAiB,MAAQ,SACxC1M,WAAY,UAEd,OAAO,wBAAc0c,GAAa,KAAM,wBAAcntB,EAAMzF,EAAQ,GAAI4zB,GAAY,wBAAczd,EAAQ,CACxGC,OAAQ,aACPvK,GAAQ,wBAAc,eAAc7L,EAAQ,GAAI2zB,MAGrD,SAASE,GAAkB/yB,GACzB,IAAI4D,EAAO5D,EAAM4D,KACbwH,EAAQpL,EAAMoL,MACdI,EAAexL,EAAMwL,aACrBwnB,EAAehzB,EAAMgzB,aACrBC,EAAW,IAAO7oB,SAClB8oB,EAAU,CACZ9nB,MAAOA,EACPI,aAAcA,EACdwnB,aAAcA,EACdG,YAAY,GAEd,OAAO,wBAAcrB,GAAa,KAAM,wBAAcmB,EAAU/zB,EAAQ,GAAIg0B,GAAU,wBAAc,SAAQ,CAC1GtvB,KAAMA,MAIV,IAAIwvB,GAAa,SAAoBC,GACnC,OAAO,SAAU1hB,EAAOvQ,GACtB,IAAIuxB,EAAcvxB,EAAGuxB,YACrB,OAAO,wBAAc,WAAU,CAC7B/uB,KAAM,GAAK+N,EAAQ0hB,EACnBn6B,IAAKyY,EACL7M,QAAS6tB,MAOXW,IAFW,IAAOlpB,SAEC2F,EAASxW,MAAM,GAAGg6B,SAErCC,GAAqBzjB,EAASxW,MAAM,GAAGg6B,QAEvCE,GAAoB,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,IAC/CC,GAAmB,CAAC,OAAQ,QAAS,SAAU,SAAU,UAE7D,SAASC,GAAkB3zB,GACzB,IAAIrF,EAAeqF,EAAMrF,aACrBi5B,EAAkB5zB,EAAM4zB,gBA4B5B,OAAO,wBAAcvB,GAAc,KAAM,wBAAcR,GAAc,KAAM,UAAW,wBAAc,MAAO,KAAM,wBAAckB,GAAmB,CAChJnvB,KAAM,WAAajJ,EAAaa,YAAcb,EAAaa,YAAc,OACzE4P,MAAOooB,GACPhoB,aAAc4nB,GAAW,MACzBJ,aA9B4B,SAAiC55B,GAE7Dw6B,EAAgB,CACdp4B,YAAapC,EAAQ,UA4BrB,wBAAc25B,GAAmB,CACnCnvB,KAAM,WAAajJ,EAAac,YAAcd,EAAac,YAAc,QACzE2P,MAAOsoB,GACPloB,aAAc4nB,GAAW,IACzBJ,aA5B4B,SAAiC55B,GAC7Dw6B,EAAgB,CACdn4B,YAAarC,OA2Bb,wBAAc25B,GAAmB,CACnCnvB,KAAM,WAAajJ,EAAaQ,aAChCiQ,MAAOqoB,GACPjoB,aAAc4nB,GAAW,MACzBJ,aA3B6B,SAAkC55B,GAE/Dw6B,EAAgB,CACdz4B,aAAc/B,EAAQ,UAyBtB,wBAAck5B,GAAwB,CACxCH,MAAOx3B,EAAak5B,YACpBtB,kBAvB4B,SAAiCJ,GAC7DyB,EAAgB,CACdC,YAAa1B,SAqCnB,IAAI2B,GAAY,CAAC,QAAS,QAAS,QAE/BC,GAAqB,SAA4Bh5B,EAAUqG,GAC7D,IAAIuxB,EAAcvxB,EAAGuxB,YACLvxB,EAAG4yB,UACP5yB,EAAG+J,MACf,OAAO,wBAAc,WAAU,CAC7BvH,KAAM,GAAK7I,EACX7B,IAAK6B,EACL+J,QAAS6tB,KAIb,SAASsB,GAAgBj0B,GACvB,IAAIoB,EAAKpB,EAAMk0B,cACXA,OAAuB,IAAP9yB,GAAuBA,EACvCY,EAAKhC,EAAMm0B,iBACXA,OAA0B,IAAPnyB,GAAuBA,EAC1CwY,EAAKxa,EAAMnF,UACXA,OAAmB,IAAP2f,EAAgB,GAAKA,EACjCE,EAAK1a,EAAM3E,aACXA,OAAsB,IAAPqf,EAAgB,GAAKA,EACpC0Z,EAAep0B,EAAMo0B,aACrBC,EAAkBr0B,EAAMq0B,gBAsC5B,OAAO,wBAAchC,GAAc,KAAM,wBAAcR,GAAc,KAAM,QAASqC,GAAiB,wBAAcjC,GAAY,CAC7H7c,WAAY,UACX,wBAAcC,EAAQ,CACvBC,OAAQ,aACP,kBAAmB,wBAAcyd,GAAmB,CACrDnvB,KAAM,WAAa/I,EAAYA,EAAUG,UAAY,OACrDoQ,MAAOkoB,GACP9nB,aAAc4nB,GAAW,MACzBJ,aA5C0B,SAA+B55B,GACzDg7B,EAAa,CACXp5B,UAAW5B,EAAQ,UA2CnB,wBAAc25B,GAAmB,CACnCnvB,KAAM,aAAe/I,EAAUE,SAC/BqQ,MAAO0oB,GACPtoB,aAAcuoB,GACdf,aA3CyB,SAA8B55B,GACvDg7B,EAAa,CACXr5B,SAAU3B,OA0CV,wBAAck5B,GAAwB,CACxCH,MAAOt3B,EAAUS,UACjBi3B,kBAxC0B,SAA+BJ,GACzDiC,EAAa,CACX94B,UAAW62B,QAuCVgC,GAAoB,wBAAclC,GAAY,CACjD7c,WAAY,UACX,wBAAcC,EAAQ,CACvBC,OAAQ,aACP,cAAe,wBAAcyd,GAAmB,CACjDnvB,KAAM,WAAavI,EAAeA,EAAaL,UAAY,OAC3DoQ,MAAOkoB,GACP9nB,aAAc4nB,GAAW,MACzBJ,aA3C6B,SAAkC55B,GAC/Di7B,EAAgB,CACdr5B,UAAW5B,EAAQ,UA0CnB,wBAAc25B,GAAmB,CACnCnvB,KAAM,aAAevI,EAAaN,SAClCqQ,MAAO0oB,GACPtoB,aAAcuoB,GACdf,aA1C4B,SAAiC55B,GAC7Di7B,EAAgB,CACdt5B,SAAU3B,OAyCV,wBAAck5B,GAAwB,CACxCH,MAAO92B,EAAaC,UACpBi3B,kBAvC6B,SAAkCJ,GAC/DkC,EAAgB,CACd/4B,UAAW62B,SAyCjB,SAASmC,GAAgBt0B,GACvB,IAAIrF,EAAeqF,EAAMrF,aACrBi5B,EAAkB5zB,EAAM4zB,gBAsBxBW,EAAwB,CAC1BxpB,MAAO,YACPypB,IAAK,GACLC,IAAK,IACLr7B,MAAOs7B,SAAS/5B,EAAaO,UAC7B0C,MAAO,CACL+T,MAAO,IAETgjB,cA5ByB,SAA8Bv7B,GAEvDw6B,EAAgB,CACd14B,SAAU9B,MA2BVw7B,EAAuB,CACzBh3B,MAAO,CACL+T,MAAO,IAETvY,MAAOuB,EAAaC,YAAc,GAClCuG,SA5B2B,SAAgCd,GAE3DuzB,EAAgB,CACdh5B,WAAYyF,EAAEQ,OAAOzH,UA2BzB,OAAO,wBAAci5B,GAAc,KAAM,wBAAcR,GAAc,KAAM,eAAgB,wBAAcltB,EAAM,KAAM,wBAAciuB,GAAyB1zB,EAAQ,GAAIq1B,IAAyB,wBAAczC,GAAa,KAAM,wBAAcntB,EAAM,CACpPyQ,WAAY,UACX,wBAAcC,EAAQ,CACvBC,OAAQ,aACP,gBAAiB,wBAAc,aAAYpW,EAAQ,GAAI01B,MAA0B,wBAActC,GAAwB,CACxHH,MAAOx3B,EAAaw3B,MACpBI,kBA7BsB,SAA2BJ,GACjDyB,EAAgB,CACdzB,MAAOA,SA+Bb,IACI0C,GADAC,GAAQ,IAAM,qBAGlB,SAASC,GAAY/0B,GACnB,IAAIkD,EAAalD,EAAMkD,WACnBL,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjB+I,EAAQjI,EAAMC,SAASf,GAEvB6xB,EAAkB,SAAyBh2B,GAC7CsF,EAAWC,IAAI,uBAAwBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACjEpC,MAAOA,MAiCX,IAAKiF,EAAM1E,SAAU,OAAO,KAC5B,IAAIxD,EAAeuI,EAAWC,IAAI,uBAAwBnD,GAgBtDg1B,EAAuB,CACzBn6B,UAhBcqI,EAAWC,IAAI,eAAgBnD,GAiB7C3E,aAhBiB6H,EAAWC,IAAI,kBAAmBnD,GAiBnDo0B,aAfiB,SAAsBv5B,GACvCqI,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzDnF,UAAWA,MAcbw5B,gBAVoB,SAAyBh5B,GAC7C6H,EAAWC,IAAI,kBAAmBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC5D3E,aAAcA,OAUd45B,EAAyB,CAC3Bt6B,aAAcA,EACdi5B,gBAAiBA,GAEnB,OAAO,wBAAche,GAAc,KAAM,wBAAc+d,GAAmBz0B,EAAQ,GAAI+1B,IAA0B,wBAAcX,GAAiBp1B,EAAQ,GAAI+1B,IAA0B,wBAAc5C,GAAc,KAAM,wBAAcR,GAAc,KAAM,cAAe,wBAAcS,GAAwB,CAC5SH,MAAOx3B,EAAaJ,WACpBg4B,kBA1DgC,SAAqCJ,GACrEyB,EAAgB,CACdr5B,WAAY43B,QAyDX,wBAAc8B,GAAiB/0B,EAAQ,GAAI81B,IAAwB,wBAAc3C,GAAc,KAAM,wBAAcK,GAAmB,CACzI3nB,MAAO,oBACP4nB,YAvDqB,WACjB7nB,EAAMlN,OACRsF,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAOqa,UACf7f,MAAO,WAoDT,wBAAc80B,GAAmB,CACnC3nB,MAAO,aACP4nB,YAjDoB,WACpBkC,GAAc3xB,EAAWC,IAAI,gBAAiBnD,GAC9C80B,GAAMD,OAgDJ,wBAAcnC,GAAmB,CACnC3nB,MAAO,cACP4nB,YA/CqB,WACjBkC,IACF3xB,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAOqa,UACf7f,MAAOs3B,KAAKC,UAAUN,WAxM9B,SAA6B70B,GAC3B,IAAIkD,EAAalD,EAAMkD,WAMvB,OAAO,wBAAcmvB,GAAc,KAAM,wBAAcP,GAAa,KAAM,wBAAc,SAAQ,CAC9FhtB,QAL8B,SAAmCzE,GACjE6C,EAAWC,IAAI,sBAAuBnD,KAKrC,6BA2OEo1B,CAAoBp1B,IAW3B,IAAImxB,GAAS,EAAQ,KAErB,SAASkE,GAAmBr1B,GAC1B,IAAIrF,EAAeqF,EAAMrF,aACrBi5B,EAAkB5zB,EAAM4zB,gBACxBx4B,EAAU+1B,GAAO,UAAWx2B,EAAaS,SAAW,KACpDk6B,EAAc,CAChBxT,OAAQ,IACR0S,IAAK,EACLC,IAAK,GACL72B,MAAO,CACL+T,MAAO,KAGPmB,EAAM4hB,SAASt5B,EAAQ,gBACvBmf,EAAQma,SAASt5B,EAAQ,kBACzBqf,EAASia,SAASt5B,EAAQ,mBAC1ByX,EAAO6hB,SAASt5B,EAAQ,iBACxBwD,EAAI,CACNkU,IAAKA,EACLyH,MAAOA,EACPE,OAAQA,EACR5H,KAAMA,GAGJ0iB,EAAa,SAAoBrd,GACnC,OAAO,SAAUhS,GACf,IAAI9E,EAEJwyB,EAAgB,CACdx4B,QAASkf,GAAWpb,EAAQA,EAAQ,GAAIN,IAAKwC,EAAK,GAAIA,EAAG8W,GAAOhS,EAAG9E,SAKrEo0B,EAAWt2B,EAAQA,EAAQ,GAAIo2B,GAAc,CAC/CvqB,MAAO,MACP3R,MAAO0Z,EACP6hB,cAAeY,EAAW,SAGxBE,EAAav2B,EAAQA,EAAQ,GAAIo2B,GAAc,CACjDvqB,MAAO,QACP3R,MAAOmhB,EACPoa,cAAeY,EAAW,WAGxBG,EAAcx2B,EAAQA,EAAQ,GAAIo2B,GAAc,CAClDvqB,MAAO,SACP3R,MAAOqhB,EACPka,cAAeY,EAAW,YAGxBI,EAAYz2B,EAAQA,EAAQ,GAAIo2B,GAAc,CAChDvqB,MAAO,OACP3R,MAAOyZ,EACP8hB,cAAeY,EAAW,UAG5B,OAAO,wBAAclD,GAAc,KAAM,wBAAcR,GAAc,KAAM,WAAY,wBAAcI,GAAY,KAAM,wBAAcW,GAAyB1zB,EAAQ,GAAIs2B,IAAY,wBAAc5C,GAAyB1zB,EAAQ,GAAIu2B,IAAc,wBAAc7C,GAAyB1zB,EAAQ,GAAIw2B,IAAe,wBAAc9C,GAAyB1zB,EAAQ,GAAIy2B,MAG9W,IAoDIC,GApDAC,GAAuB,UAAO/1B,IAAI81B,KAAuBA,GAAqB5lB,EAAqB,CAAC,2CAA4C,CAAC,8CAErJ,SAAS8lB,GAAiB91B,GACxB,IAAI0nB,EAAa1nB,EAAM0nB,WACnBqO,EAAgB/1B,EAAM+1B,cACtB30B,EAAKsmB,EAAW/sB,aAChBA,OAAsB,IAAPyG,EAAgB,GAAKA,EACpCY,EAAK0lB,EAAW7sB,UAChBA,OAAmB,IAAPmH,EAAgB,GAAKA,EACjCwY,EAAKkN,EAAWrsB,aAGhBu4B,EAAkB,SAAyBj5B,GAC7Co7B,EAAc,CACZp7B,aAAcA,KAId40B,EAAS,CACX50B,aAAcA,EACdi5B,gBAAiBA,GAefoB,EAAuB,CACzBd,eAAe,EACfr5B,UAAWA,EACXQ,kBA5BwB,IAAPmf,EAAgB,GAAKA,EA6BtC4Z,aAhBiB,SAAsBv5B,GACvCk7B,EAAc,CACZl7B,UAAWA,KAebw5B,gBAXoB,SAAyBh5B,GAC7C06B,EAAc,CACZ16B,aAAcA,MAWlB,OAAO,wBAAcw6B,GAAsB,KAAM,wBAAclC,GAAmBz0B,EAAQ,GAAIqwB,IAAU,wBAAc8F,GAAoBn2B,EAAQ,GAAIqwB,IAAU,wBAAc+E,GAAiBp1B,EAAQ,GAAIqwB,IAAU,wBAAc8C,GAAc,KAAM,wBAAcR,GAAc,KAAM,cAAe,wBAAcS,GAAwB,CAC5UH,MAAOx3B,EAAaJ,WACpBg4B,kBAAmB,SAA2BJ,GAC5CyB,EAAgB,CACdr5B,WAAY43B,QAGb,wBAAc8B,GAAiB/0B,EAAQ,GAAI81B,KAIlD,IAAIgB,GAAQ,SAEZ,SAASC,GAAYj2B,GACnB,IA5H2Bk2B,EA4HvB90B,EAAKwO,EAAO,oBAAS,GAAQ,GAI7B5N,GAHmBZ,EAAG,GACAA,EAAG,GAEpBwO,EAAO,oBAAS,GAAQ,IAC7BumB,EAAkBn0B,EAAG,GACrBo0B,EAAqBp0B,EAAG,GAExBa,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACnB9I,EAAQyI,EAAM7E,OAAO5D,MACrBa,EAAYb,EAAMa,UAClBM,EAAenB,EAAMmB,aACrBG,EAActB,EAAMsB,YAEpBkiB,EAAW,SAAkBxjB,GAC/B8I,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAOua,UACfvjB,MAAO,gBAAMA,OAgBbi8B,GA9JuBH,EA8JuB,SAAU57B,GAC1DsjB,EAAS,gBAAMxjB,EAAO,CACpBE,YAAaA,MA/JV,SAAUoG,GACf,OAAOw1B,EAAQx1B,EAAMG,OAAOgJ,WAoL1BysB,EAAuB,CACzB5O,WAAYzsB,EACZ86B,cApBsB,SAA2Bn4B,GACjDggB,EAAS,gBAAMxjB,EAAO,CACpBa,UAAW2C,OAoBX24B,EAAkB,wBAAcT,GAAkB52B,EAAQ,GAAIo3B,IAC9DE,EAA0B,CAC5B9O,WAAYnsB,EACZw6B,cAnByB,SAA8Bn4B,GACvDggB,EAAS,gBAAMxjB,EAAO,CACpBmB,aAAcqC,OAmBd64B,EAAqB,wBAAcX,GAAkB52B,EAAQ,GAAIs3B,IACjEE,EAAyB,CAC3BhP,WAAYhsB,EACZq6B,cAlBwB,SAA6Bn4B,GACrDggB,EAAS,gBAAMxjB,EAAO,CACpBsB,YAAakC,OAkBb+4B,EAAoB,wBAAcb,GAAkB52B,EAAQ,GAAIw3B,IAChEE,EAAY,CACdvF,GAAI2E,GACJ9E,kBAAmB,SAA2BG,GAC5C2E,GAAQ3E,IAGRwF,EAAc,wBAAc9E,GAAqB,KAAM,wBAAc,OAAM7yB,EAAQ,GAAI03B,GAAY,wBAAc,MAAK,CACxHvF,GAAI,SACJtmB,MAAO,cACP+rB,MAAOH,IACL,wBAAc,MAAK,CACrBtF,GAAI,UACJtmB,MAAO,eACP+rB,MAAOL,IACL,wBAAc,MAAK,CACrBpF,GAAI,OACJtmB,MAAO,YACP+rB,MAAOP,MAsBLQ,EAAa,CACfvvB,OAAQ2uB,EACRvuB,QAAS,SAAiBvH,GACxB+1B,GAAmB,KAGnBY,EAAQ,wBAAc,QAAO93B,EAAQ,GAAI63B,GAAa,wBAAc,IAAK,KAAM,sBACnF,OAAO,wBAAcnhB,GAAc,KAAM,wBAAcyc,GAAc,KAAM,wBAAcR,GAAc,KAAM,UAAW,wBAAcI,GAAY,KAAM,wBAAcD,GAAc,KAAM,eAAgB,wBAAcM,GAAwB,CAC9OH,MAAO/3B,EAAMG,WACbg4B,kBAnGgC,SAAqCh4B,GACrEqjB,EAAS,gBAAMxjB,EAAO,CACpBG,WAAYA,QAkGZ,wBAAcy3B,GAAc,KAAM,cAAe,wBAAcM,GAAwB,CACzFH,MAAO/3B,EAAMI,eACb+3B,kBAhG+B,SAAoC/3B,GACnEojB,EAAS,gBAAMxjB,EAAO,CACpBI,eAAgBA,QA+FhB,wBAAcw3B,GAAc,KAAM,iBAAkB,wBAAc/nB,EAAgB,CACpFJ,QAASzP,EAAME,YACf6G,SAAUk1B,MACNQ,EAAa,wBAAcxE,GAAc,KAAM,wBAAcK,GAAmB,CACpF3nB,MAAO,eACP4nB,YArCsB,SAA2BtyB,GAGjD+Y,GADW8b,KAAKC,UAAU/6B,GACA,4BAmCxB,wBAAcs4B,GAAmB,CACnC3nB,MAAO,eACP4nB,YAlCsB,SAA2BtyB,GACjDiZ,GAAgB,cAAc2d,MAAK,SAAU/c,GAC3C,IAAI9a,EAAI81B,KAAKgC,MAAMhd,GAEd,sBAAY9a,GAKjBwe,EAASxe,GAJPg3B,GAAmB,UA8BpBY,GAGP,SAASG,KACP,IAAIlG,EAAgB,cAEhBC,EAAoB,SAA2B8E,GACjD/E,EAAgB+E,GAGlB,MAAO,CACLoB,oBAAqB,SAA6Bp3B,GAChD,IAAIuvB,EAASrwB,EAAQA,EAAQ,GAAIc,GAAQ,CACvC9G,IAAK,kBACL+3B,cAAeA,EACfC,kBAAmBA,IAGrB,OAAO,wBAAcF,GAAe9xB,EAAQ,GAAIqwB,KAElD8H,wBAAyB,SAAiCr3B,GACxD,IAAIkD,EAAalD,EAAMkD,WAGvB,MAAO,CAFcA,EAAWC,IAAI,yBAA0BnD,GACzCkD,EAAWC,IAAI,oBAAqBnD,KAG3Ds3B,uBAAwB,SAAgCt3B,GACtD,IAAIu3B,EAAS,CACXlG,GAAI,cACJn4B,IAAK,cACL6R,MAAO,aACP+rB,MAAO,wBAAc/B,GAAa71B,EAAQ,GAAIc,KAEhD,OAAO,wBAAc,MAAKd,EAAQ,GAAIq4B,KAExCC,kBAAmB,SAA2Bx3B,GAC5C,IAAIu3B,EAAS,CACXlG,GAAI,eACJn4B,IAAK,eACL6R,MAAO,QACP+rB,MAAO,wBAAcb,GAAa/2B,EAAQ,GAAIc,KAEhD,OAAO,wBAAc,MAAKd,EAAQ,GAAIq4B,MAK5C,IAAIE,GAAQ,IAAM,gBAElB,SAASC,KACP,IAAIC,EAAe,IAAInyB,IACnBoyB,EAAmB,IAAIpyB,IAC3B,MAAO,CACLqyB,2BAA4B,SAAoC73B,GAC9D,IAAI9G,EAAM8G,EAAM9G,IACZ6b,EAAW/U,EAAM+U,SAEhB6iB,EAAiB/xB,IAAI3M,IACxB0+B,EAAiBjxB,IAAIzN,EAAK,IAG5B0+B,EAAiBz+B,IAAID,GAAKmN,KAAK0O,IAEjC+iB,8BAA+B,SAAuC93B,GACpE,IAAI9G,EAAM8G,EAAM9G,IACZ6b,EAAW/U,EAAM+U,SAEjB6iB,EAAiB/xB,IAAI3M,KACvB0+B,EAAiB1+B,GAAO0+B,EAAiBz+B,IAAID,GAAKmS,QAAO,SAAU0sB,GACjE,OAAOA,IAAMhjB,OAInBijB,aAAc,SAAsBh4B,GAClC,IAAI9G,EAAM8G,EAAM9G,IAEhB,OADAu+B,GAAM,eAAgBv+B,GACfy+B,EAAax+B,IAAID,IAE1B++B,aAAc,SAAsBj4B,GAClC,IAAI2U,EAAKvT,EAELlI,EAAM8G,EAAM9G,IACZE,EAAQ4G,EAAM5G,MAIlB,GAHAq+B,GAAM,eAAgBv+B,GACtBy+B,EAAahxB,IAAIzN,EAAKE,GAElBw+B,EAAiB/xB,IAAI3M,GAAM,CAC7B,IAAI0b,EAAYgjB,EAAiBz+B,IAAID,GAErC,IACE,IAAK,IAAI2b,EAAcvF,EAASsF,GAAYE,EAAgBD,EAAY5Q,QAAS6Q,EAAcnF,KAAMmF,EAAgBD,EAAY5Q,OAAQ,EAEvI8Q,EADeD,EAAc1b,OACpBA,IAEX,MAAO4b,GACPL,EAAM,CACJ7E,MAAOkF,GAET,QACA,IACMF,IAAkBA,EAAcnF,OAASvO,EAAKyT,EAAYI,SAAS7T,EAAG3B,KAAKoV,GAC/E,QACA,GAAIF,EAAK,MAAMA,EAAI7E,UAK3BooB,gBAAiB,SAAyBl4B,GACxC,IAAI9G,EAAM8G,EAAM9G,IAChBu+B,GAAM,kBAAmBv+B,GACzB,IAAIE,EAAQu+B,EAAax+B,IAAID,GAE7B,OADAy+B,EAAatvB,OAAOnP,GACbE,IASb,IAAI++B,GAAQ,IAAM,sBAElB,SAASC,KACP,IAAIC,EAAW,IAAI7yB,IACf8yB,EAAa,EACjB,MAAO,CACLC,cAAe,SAAuBv4B,GACpC,IAAIkD,EAAalD,EAAMkD,WACvB,MAAO,CACLvI,aAAcuI,EAAWC,IAAI,uBAAwBnD,GACrDnF,UAAWqI,EAAWC,IAAI,eAAgBnD,GAC1C3E,aAAc6H,EAAWC,IAAI,kBAAmBnD,KAGpDw4B,qBAAsB,SAA8Bx4B,GAClD,IAAI+B,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACvBi1B,GAAM,wBAAyBp2B,EAAUc,GACzC,IAEI41B,EAFAC,EAAc71B,EAAM81B,oBAAoB52B,GACxC3H,EAAQyI,EAAM7E,OAAO5D,MAKzB,GAH2Cq+B,EAAvCC,IAAgB,mBAAiBE,KAAmBx+B,EAAMa,UAAmBy9B,IAAgB,mBAAiBG,QAAsBz+B,EAAMmB,aAA+BnB,EAAMsB,YACnL+8B,EAAav5B,EAAQA,EAAQ,GAAI9E,EAAMO,cAAe89B,EAAW99B,cAE7DP,EAAME,YAAa,CACrB,IAAIA,EAAc4I,EAAWC,IAAI,iBAAkBnD,GACnDy4B,EAAav5B,EAAQA,EAAQ,GAAIu5B,GAAa,CAC5Cl+B,WAAYD,EACZu5B,YAAav5B,EACbe,aAAc6D,EAAQA,EAAQ,GAAIu5B,EAAWp9B,cAAe,CAC1DC,UAAWhB,MAKjB,IAAIwQ,EAAQjI,EAAMC,SAASf,GAE3B,IAAK+I,EAAMlN,MACT,OAAO66B,EAGT,IAAIK,EAAc5D,KAAKgC,MAAMpsB,EAAMlN,OACnC,OAAOsB,EAAQA,EAAQ,GAAIu5B,GAAaK,EAAYn+B,eAEtDo+B,aAAc,SAAsB/4B,GAClC,IAAI+B,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACvBi1B,GAAM,eAAgBp2B,GACtB,IAGIi3B,EAHAN,EAAc71B,EAAM81B,oBAAoB52B,GACxC3H,EAAQyI,EAAM7E,OAAO5D,MACrBS,EAAYT,EAAMS,UAEqBm+B,EAAvCN,IAAgB,mBAAiBE,KAAoBx+B,EAAMa,UAAUJ,UAAmB69B,IAAgB,mBAAiBG,QAAuBz+B,EAAMmB,aAAaV,UAA6BT,EAAMsB,YAAYb,UACtNA,EAAYqE,EAAQA,EAAQ,GAAIrE,GAAYm+B,GAC5C,IAAIluB,EAAQjI,EAAMC,SAASf,GAE3B,GAAuB,MAAnB+I,EAAM/N,UAAmB,CAC3B,IAAIk8B,EAAqB/1B,EAAWC,IAAI,kBAAmBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACrF+B,SAAU+I,EAAM/N,aAElBlC,EAAYqE,EAAQA,EAAQ,GAAIrE,GAAYo+B,GAG9C,IAAKnuB,EAAMlN,MACT,OAAO/C,EAGT,IAAIi+B,EAAc5D,KAAKgC,MAAMpsB,EAAMlN,OACnC,OAAOsB,EAAQA,EAAQ,GAAIrE,GAAYi+B,EAAYj+B,YAErDq+B,gBAAiB,SAAyBl5B,GACxC,IAAI+B,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACvBi1B,GAAM,eAAgBp2B,GACtB,IAGIi3B,EAHAN,EAAc71B,EAAM81B,oBAAoB52B,GACxC3H,EAAQyI,EAAM7E,OAAO5D,MACrBiB,EAAejB,EAAMS,UAEkBm+B,EAAvCN,IAAgB,mBAAiBE,KAAoBx+B,EAAMa,UAAUI,aAAsBq9B,IAAgB,mBAAiBG,QAAuBz+B,EAAMmB,aAAaF,aAAgCjB,EAAMsB,YAAYL,aAC5NA,EAAe6D,EAAQA,EAAQ,GAAI7D,GAAe29B,GAClD,IAAIluB,EAAQjI,EAAMC,SAASf,GAE3B,GAAI3H,EAAME,YAAa,CACrB,IAAIA,EAAc4I,EAAWC,IAAI,iBAAkBnD,GACnDm4B,GAAM79B,GACNe,EAAe6D,EAAQA,EAAQ,GAAI7D,GAAe,CAChDC,UAAWhB,IAIf,IAAKwQ,EAAMlN,MACT,OAAOvC,EAGT,IAAIy9B,EAAc5D,KAAKgC,MAAMpsB,EAAMlN,OAKnC,OAHUsB,EAAQA,EAAQ,GAAI7D,GAAey9B,EAAYz9B,eAK3D89B,qBAAsB,SAA8Bn5B,GAClD,IAAI+B,EAAW/B,EAAM+B,SACjBmB,EAAalD,EAAMkD,WACnBtF,EAAQoC,EAAMpC,MAGd8pB,EAFQ1nB,EAAM6C,MACAC,SAASf,GACJnE,MACnBw7B,EAAW1R,EAAawN,KAAKgC,MAAMxP,GAAc,GAEjD2R,EAAcn6B,EAAQA,EAAQ,GAAIk6B,GAAW,CAC/Cz+B,aAAcuE,EAAQA,EAAQ,GAAIk6B,EAASz+B,cAAeiD,KAG5D,IAAK,kBAAQw7B,EAAUC,GAAc,CACnC,IAAIC,EAAcpE,KAAKC,UAAUkE,GACjCn2B,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAOqa,UACf7f,MAAO07B,OAIblF,aAAc,SAAsBp0B,GAClC,IAAI+B,EAAW/B,EAAM+B,SACjBmB,EAAalD,EAAMkD,WACnBrI,EAAYmF,EAAMnF,UAGlB+C,EAFQoC,EAAM6C,MACAC,SAASf,GACTnE,MACdw7B,EAAWx7B,EAAQs3B,KAAKgC,MAAMt5B,GAAS,GAEvCy7B,EAAcn6B,EAAQA,EAAQ,GAAIk6B,GAAW,CAC/Cv+B,UAAWqE,EAAQA,EAAQ,GAAIk6B,EAASv+B,WAAYA,KAGtD,IAAK,kBAAQu+B,EAAUC,GAAc,CACnC,IAAIC,EAAcpE,KAAKC,UAAUkE,GACjCn2B,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAOqa,UACf7f,MAAO07B,OAIbjF,gBAAiB,SAAyBr0B,GACxC,IAAI+B,EAAW/B,EAAM+B,SACjBmB,EAAalD,EAAMkD,WACnB7H,EAAe2E,EAAM3E,aAGrBuC,EAFQoC,EAAM6C,MACAC,SAASf,GACTnE,MACdw7B,EAAWx7B,EAAQs3B,KAAKgC,MAAMt5B,GAAS,GAEvCy7B,EAAcn6B,EAAQA,EAAQ,GAAIk6B,GAAW,CAC/C/9B,aAAc6D,EAAQA,EAAQ,GAAIk6B,EAAS/9B,cAAeA,KAG5D,IAAK,kBAAQ+9B,EAAUC,GAAc,CACnC,IAAIC,EAAcpE,KAAKC,UAAUkE,GACjCn2B,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAOqa,UACf7f,MAAO07B,OAIbC,mBAAoB,SAA4Bv5B,GAC9C,IAAI+B,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MACd61B,EAAc71B,EAAM81B,oBAAoB52B,GACxC3H,EAAQyI,EAAM7E,OAAO5D,MACzB,OAAIs+B,IAAgB,mBAAiBE,KAAax+B,EAAMa,UACpDy9B,IAAgB,mBAAiBG,QAAgBz+B,EAAMmB,aACpDnB,EAAMsB,aAEf89B,eAAgB,SAAwBx5B,GACtC,IAAI+B,EAAW/B,EAAM+B,SACrB,GAAIs2B,EAASxyB,IAAI9D,GAAW,OAAOs2B,EAASl/B,IAAI4I,GAChD,IAAI03B,EAAS,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAC9ItH,EAAQsH,IAASnB,EAAamB,EAAOj6B,QAGzC,OAFA64B,EAAS1xB,IAAI5E,EAAUowB,GACvBgG,GAAM,iBAAkBp2B,EAAUowB,GAC3BA,GAETuH,oBAAqB,SAA6B15B,GAChD,IAAI6C,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACnB+c,EAAWpd,EAAM8K,eAAc,SAAU9K,GAC3CA,EAAM/E,OAAO67B,SAAS1zB,SAAQ,SAAU/M,GACtC2J,EAAM+D,MAAM,CAAC,SAAU1N,EAAK,SAAU,YAG1CgK,EAAWkd,OAAOH,KAKxB,SAAS2Z,KACP,MAAO,CA1MA,CAAC1K,KAAmBwI,KA39EpB,CACLmC,uBAAwB,SAAgC75B,GACtD,OAAO,wBAAcqhB,GAAkBniB,EAAQ,GAAIc,KAErD8M,0BAA2B,SAAmC9M,GAC5D,IAAI+B,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACnBqkB,EAASxlB,IAAac,EAAM3E,mBAEhC,SAAS47B,EAAYxuB,GACnB,OAAO,SAAUjL,GACfiL,EAAKlI,QAAUF,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACrEoD,OAAQkI,EAAKlI,WAKnB,OAAOgI,GAAM3R,KAAI,SAAU6R,GACzB,OAAOic,IAAWjc,EAAKiW,WAAa,KAAO,wBAAc,WAAU,CACjEroB,IAAKoS,EAAKgB,MACVpD,KAAM+D,GAAK3B,EAAKpC,MAChBtF,KAAM0H,EAAKgB,MACXytB,aAAc,wBAAc,MAAO,KAAMzuB,EAAKgW,UAC9Cxc,QAASg1B,EAAYxuB,UAm8EkC6rB,KAAuB7U,MA9jG/E,CACL0X,cAAe,SAAuB54B,GACpC,IAAI0gB,EAAS1gB,EAAG0gB,OACZjf,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACd+I,EAAQjI,EAAMC,SAASf,GACvBk4B,EAAgBnvB,EAAM7N,QAAQ4L,KAC9B/K,EAASgN,EAAM7N,QAAQ6I,UAE3B,OAAQgc,GACN,KAAK,oBAAkBkG,cACrB,MAAO,CACLD,EAAGjqB,GAGP,KAAK,oBAAkBmqB,cACrB,MAAO,CACLH,EAAGhqB,GAGP,KAAK,oBAAkB3D,eACrB,MAAO,CACL2tB,EAAGhqB,EAAOo8B,MAAM/9B,KAAKg+B,KAAKF,EAAgB,GAAIA,GAC9ClS,EAAGjqB,EAAOo8B,MAAM,EAAG/9B,KAAKg+B,KAAKF,EAAgB,KAGjD,KAAK,oBAAkB/R,cACrB,MAAO,CACLC,EAAGrqB,KAIXs8B,gBAAiB,SAAyBp6B,GACxC,IAAI6C,EAAQ7C,EAAM6C,MACdd,EAAW/B,EAAM+B,SACjBmB,EAAalD,EAAMkD,WACnBpF,EAASkC,EAAMlC,OACfkD,EAAUhB,EAAMgB,QAChB8J,EAAQjI,EAAMC,SAASf,GAC3B,GAAoB,IAAhBjE,EAAO+K,MAAciC,EAAM3N,SAAU,OAAO,KAChD,IAAIqqB,EAAY,GAUhB,OATA1pB,EAAOmI,SAAQ,SAAUo0B,GACvB,IAAIC,EAAap7B,EAAQA,EAAQ,GAAIc,GAAQ,CAC3C+B,SAAUs4B,EACVnhC,IAAKmhC,EACLp5B,IAAKD,EAAQ4W,GAAkByiB,MAGjC7S,EAAUnhB,KAAKnD,EAAWC,IAAI,oBAAqBm3B,OAE9C,CACL9S,UAAWA,IAGf1F,OAAQ,SAAgB9hB,GACtB,IAAIsU,EAAStU,EAAMsU,OACfzR,EAAQ7C,EAAM6C,MACdyqB,EAAQhZ,EAAOwD,GAAYjV,EAAM3E,qBACjCq8B,EAAYjmB,EAAO6D,GAAOI,qBAC1BiiB,EAAalmB,EAAO6D,GAAOK,iBAC/B8U,GAASA,EAAMxL,SACfyY,GAAaA,EAAUzY,SACvB0Y,GAAcA,EAAW1Y,SAIzB,SAAS2Y,EAAY3vB,GACnB,IAAI6J,EAAKvT,EAET,GAAI0J,EAAM5R,MAAQ2J,EAAM3E,mBAAoB,CAC1C,IAAIw8B,EAAcpmB,EAAOsD,GAAkB9M,EAAM5R,MACjDwhC,GAAeA,EAAYrN,cAG7B,IAAKviB,EAAM3N,SACT,IACE,IAAK,IAAI6E,EAAKsN,EAASxE,EAAM7N,SAAUud,EAAKxY,EAAGiC,QAASuW,EAAG7K,KAAM6K,EAAKxY,EAAGiC,OAAQ,CAC/E,IAAI02B,EAASngB,EAAGphB,MAChBqhC,EAAY53B,EAAMC,SAAS63B,KAE7B,MAAO3lB,GACPL,EAAM,CACJ7E,MAAOkF,GAET,QACA,IACMwF,IAAOA,EAAG7K,OAASvO,EAAKY,EAAGiT,SAAS7T,EAAG3B,KAAKuC,GAChD,QACA,GAAI2S,EAAK,MAAMA,EAAI7E,QAxB3B2qB,CADsB53B,EAAMC,SAASD,EAAM3E,sBA+B7C08B,aAAc,SAAsB56B,GAClC,IAAI9F,EAAY8F,EAAM9F,UAClB2I,EAAQ7C,EAAM6C,MACD7C,EAAMkD,WACZkd,OAAO,gBAAcwa,aAAa,CAC3C/3B,MAAOA,EACP3I,UAAWA,MAGf2gC,gBAAiB,SAAyB76B,GACxC,IAAI86B,EAAU96B,EAAM86B,QAChB53B,EAAalD,EAAMkD,WACnBoR,EAAStU,EAAMsU,OACfhW,EAAa4E,EAAWC,IAAI,gBAAiBnD,GAEjD,OAAOwb,GAAiBsf,EADVxmB,EAAO6D,GAAOE,wBAAwBrG,QACV1T,IAE5Cy8B,4BAA6B,SAAqC/6B,GAChE,IAAI86B,EAAU96B,EAAM86B,QAChB53B,EAAalD,EAAMkD,WACnBoR,EAAStU,EAAMsU,OACfhW,EAAa4E,EAAWC,IAAI,gBAAiBnD,GAEjD,OAAOwb,GAAiBsf,EADVxmB,EAAO6D,GAAOE,wBAAwBxG,QACVvT,IAE5C08B,8BAA+B,SAAuCh7B,GAIpE,OAAO+b,GAHO/b,EAAM86B,SAENxmB,EADDtU,EAAMsU,QACE6D,GAAOE,wBAAwBxG,UAGtDopB,iCAAkC,SAA0Cj7B,GACzDA,EAAMkD,WACZC,IAAI,6BAA8BjE,EAAQ,CACnDhG,IAAK,cACJ8G,KAELk7B,oCAAqC,SAA6Cl7B,GAC/DA,EAAMkD,WACZC,IAAI,gCAAiCjE,EAAQ,CACtDhG,IAAK,cACJ8G,KAEL+T,cAAe,SAAuB/T,GACpC,IAAIkD,EAAalD,EAAMkD,WACnB5E,EAAa0B,EAAM1B,WACvB,OAAO4E,EAAWC,IAAI,eAAgB,CACpCjK,IAAK,aACLE,MAAOkF,KAGX68B,cAAe,SAAuBn7B,GAEpC,OADiBA,EAAMkD,WACLC,IAAI,eAAgB,CACpCjK,IAAK,gBArJO,GAwJhBkiC,kBAAmB,SAA2Bp7B,GAC5C,IAAIsU,EAAStU,EAAMsU,OACfvS,EAAW/B,EAAM+B,SACjBc,EAAQ7C,EAAM6C,MAElB,GAAIA,EAAM3E,qBAAuB6D,GAAY,0BAAgBc,EAAOd,EAAUc,EAAM3E,sBAAwB,oBAAkBm9B,WAC5H,MAAM,IAAI1hC,MAAM,qCAAuCoI,EAAW,+CAGpE,IAAI+I,EAAQwJ,EAAOuD,GAAY9V,IAC3Bu5B,EAAahnB,EAAO6D,GAAOE,wBAC3BxG,EAAUypB,EAAWzpB,QAEzB,IAAK/G,IAAU+G,EACb,MAAM,IAAIlY,MAAM,qDAGlB,IAAI8wB,EAAS1O,GAAkBjR,EAAO+G,GAEtCypB,EAAWroB,sBAAsBwX,EAAO,GAAIA,EAAO,KAErD8Q,0BAA2B,SAAmCv7B,GAC5D,IAAIkD,EAAalD,EAAMkD,WACnBnB,EAAW/B,EAAM+B,SACrBmB,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDgF,QAAS,CAAC,CACR5B,OAAQ,SAAO6B,YACflD,SAAUA,EACV3D,UAAW,YAAU8G,QACpB,CACD9B,OAAQ,SAAO+Z,UACfpb,SAAUA,IAEZue,SAAU,WACRpd,EAAWC,IAAI,oBAAqBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC9D+B,SAAUA,WA8kGmB+a,KAAmBsb,KAAeviB,KAAeyG,KAp2GjF,CACLlV,SAAU,SAAkBpH,EAAOiE,GACjC,IAAIu3B,EAAUx7B,EAAMw7B,QAChBt4B,EAAalD,EAAMkD,WAEvB,OAAQs4B,GACN,KAAKn0B,GAAQwG,+BACX,OAAO,EAET,KAAKxG,GAAQsR,2BACX,OAAOzV,EAAWC,IAAI,qBAAsBnD,GAE9C,KAAKqH,GAAQC,YACX,OAAOpE,EAAWC,IAAI,gBAAiBnD,GAG3C,OAAOiE,MAo1G+G,qBAGhH,IAAM,gBAAlB,IAEIw3B,GAEJ,SAAU3iC,GAGR,SAAS2iC,IACP,IAAIv7B,EAAmB,OAAXpH,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAchE,OAZAmH,EAAMw7B,kBAAoB,mBAAW,SAAUC,EAASC,QACtC,IAAZD,IACFA,EAAU,IAGZ,IAAIE,EAAgBD,IACpB17B,EAAMgD,WAAa,IAAI,aAAW,CAChCy4B,QAAS,CAACA,EAASE,GACnBC,WAAW,EACX36B,SAAUjB,EAAMF,MAAMmB,cAGnBjB,EAwCT,OAzDApB,EAAU28B,EAAS3iC,GAoBnB2iC,EAAQx8B,UAAUowB,gBAAkB,WAClC,OAAOt2B,KAAKmK,WAAWC,IAAI,oBAG7Bs4B,EAAQx8B,UAAU88B,aAAe,SAAU9b,GACzC,IAAI/f,EAAQnH,KAERiH,EAAQjH,KAAKs2B,kBACbxsB,EAAQ7C,EAAM6C,MACdK,EAAalD,EAAMkD,WACvBA,EAAWC,IAAI,eAAgBjE,EAAQA,EAAQ,GAAIc,GAAQ,CACzD+B,SAAUc,EAAM5E,gBAElBiF,EAAWC,IAAI,YAAajE,EAAQA,EAAQ,GAAIc,GAAQ,CACtDoD,OAAQ,SAAO+Z,UACfpb,SAAUke,EAAS9hB,SACnB0E,MAAOod,EACPK,SAAU,WACR,IAAItgB,EAAQE,EAAMmvB,kBAEdxsB,EAAQ7C,EAAM6C,MAClBK,EAAWC,IAAI,oBAAqBjE,EAAQA,EAAQ,GAAIc,GAAQ,CAC9D+B,SAAUc,EAAM1E,iBAMxBs9B,EAAQx8B,UAAU6C,OAAS,WACzB,IAAI65B,EAAU5iC,KAAKiH,MAAM27B,QAKzB,OAJA5iC,KAAK2iC,kBAAkBC,EAAS/B,IAChC7gC,KAAKo2B,aAAejwB,EAAQA,EAAQ,GAAInG,KAAKiH,OAAQ,CACnDkD,WAAYnK,KAAKmK,aAEZnK,KAAKmK,WAAWC,IAAI,gBAAiBpK,KAAKo2B,eAG5CsM,EA1DT,CA2DE,c,4mECpoIA,WAAYz7B,G,OACV,YAAMA,IAAM,KAiBhB,OAnBUg8B,OAKR,YAAAlrB,UAAA,SAAU1N,EAAgB2N,GACxBhY,KAAKiH,MAAMkD,WAAWC,IAAI,YAAW,GACnCC,OAAM,GACH2N,KAIP,YAAA5N,IAAA,SAAI9I,EAAc0W,GAChBhY,KAAKiH,MAAMkD,WAAWC,IAAI9I,EAAM0W,IAGlC,sBAAI,oBAAK,C,IAAT,WACE,OAAOhY,KAAKiH,MAAM6C,MAAMC,SAAS/J,KAAKiH,MAAM+B,W,gCAEhD,E,CAnBUi6B,EAAMA,eCFV9qB,EAAM+qB,EAAM,2BAEZ9qB,EAAiB9M,EAAOvE,IAAG,mLAO3BsR,EAAoB/M,EAAOvE,IAAG,qHAKpC,cAkBE,WAAYE,GAAZ,MACE,YAAMA,IAAM,K,OAcd,EAAAsR,sBAAwB,SACtBC,EACAC,GAEA,GAAI,EAAKC,eAAgB,CACvB,IAAMC,EAAc,CAClBC,MAAO,EAAKnU,QAAQoU,YAAyC,EAA3B,EAAKC,QAAQD,YAC/CE,OAAQ,EAAKtU,QAAQuU,aAA2C,EAA5B,EAAKF,QAAQE,cAEnD,EAAKC,QAAQpU,MAAM+T,MAAQD,EAAYC,MAAQ,KAC/C,EAAKK,QAAQpU,MAAMkU,OAASJ,EAAYI,OAAS,KAEnD,EAAKL,eAAiBF,EAAQ,GAAGU,aAGnC,EAAAC,sBAAwB,IAAIgqB,EAAe,EAAK5qB,uBAIhD,EAAAa,WAAa,SAAAlR,GACPA,IACF,EAAKzD,QAAUyD,EACf,EAAKiR,sBAAsBE,QAAQ,EAAK5U,WAK5C,EAAA6U,WAAa,SAAApR,GACPA,IACF,EAAK4Q,QAAU5Q,EACV,EAAKjB,MAAMsS,mBACdpB,EAAI,4BACJ,EAAKW,QAAQrQ,iBACX,SACA,SAASnB,GACP6Q,EAAI,YACH7Q,EAAEqC,SAAWrC,EAAEkS,SAAWlS,EAAEmS,mBAE/B,CACEC,SAAS,KAIf,EAAKC,iBACH,EAAKb,QAAQD,YACb,EAAKC,QAAQE,gBAMnB,EAAAY,WAAa,SAAA1R,GACPA,IACF,EAAK+Q,QAAU/Q,IAInB,EAAA2R,eAAiB,WACX,EAAKpV,SAAW,EAAKqU,SAAW,EAAKG,UACvC,EAAKA,QAAQpU,MAAM+T,MACuC,GAAvD,EAAKnU,QAAQoU,YAAc,EAAKC,QAAQD,aAAmB,KAC9D,EAAKI,QAAQpU,MAAMkU,OACyC,GAAzD,EAAKtU,QAAQuU,aAAe,EAAKF,QAAQE,cAAoB,KAEhE,EAAKvU,QAAQI,MAAMiV,KAAO,EAAKhB,QAAQD,YAAc,KACrD,EAAKpU,QAAQI,MAAMkV,IAAM,EAAKjB,QAAQE,aAAe,OAIzD,EAAAW,iBAAmB,SAACG,EAAcC,GAChC5B,EAAI,oBAAoB2B,EAAI,IAAIC,GAC5B,EAAKjB,UACP,EAAKA,QAAQkB,WAAaF,EAC1B,EAAKhB,QAAQmB,UAAYF,IAI7B,EAAAG,sBAAwB,SAACC,EAAmBC,GAC1CjC,EAAI,yBAAyBgC,EAAS,IAAIC,GACtC,EAAKtB,UACP,EAAKA,QAAQkB,YAAcG,EAC3B,EAAKrB,QAAQmB,WAAaG,IAI9B,EAAA/S,YAAc,SAAAC,GAON,cAAE+S,EAAA,EAAAA,SAAUC,EAAA,EAAAA,eAAgBC,EAAA,EAAAA,YAClC,KAAIA,GAAgBA,OAEJ,IAAbjT,EAAEkT,QAA6B,SAAbH,GACL,IAAb/S,EAAEkT,QAA6B,UAAbH,GACnB,CACA,GAAIC,IACGhT,EAAEqC,QAAS,OAElB,EAAK8Q,YAAc,EAAK3B,QAAQkB,WAAa1S,EAAEoC,YAAYgR,QAC3D,EAAKC,YAAc,EAAK7B,QAAQmB,UAAY3S,EAAEoC,YAAYkR,QAE1D,IAAMC,EAAmC,EAAK/B,QAC9C+B,EAAIpS,iBAAiB,YAAa,EAAKjB,aACvCqT,EAAIpS,iBAAiB,UAAW,EAAKqS,aAIzC,EAAAA,UAAY,SAAAxT,GACV,IAAMuT,EAAmC,EAAK/B,QAC9C+B,EAAIlS,oBAAoB,YAAa,EAAKnB,aAC1CqT,EAAIlS,oBAAoB,UAAW,EAAKmS,YAQ1C,EAAAtT,YAAc,SAACF,GACb,EAAKwR,QAAQkB,WAAa,EAAKS,YAAcnT,EAAEoT,QAC/C,EAAK5B,QAAQmB,UAAY,EAAKU,YAAcrT,EAAEsT,SAIhD,EAAAG,kBAAoB,SAAAzT,GAClBA,EAAEmS,kBA7IF,EAAKrS,MAAQ,CACXuR,YAAa,CACXC,MAAO,UACPG,OAAQ,Y,EAkLhB,OA3LsCqqB,OAsJpC,YAAA76B,kBAAA,WACEvI,KAAK6Z,iBACLrR,SAASC,iBAAiB,cAAezI,KAAK+a,oBAGhD,YAAArS,qBAAA,WACEF,SAASG,oBAAoB,cAAe3I,KAAK+a,oBAGnD,YAAAC,cAAA,SAAczV,GACZvF,KAAKiZ,QAAQpU,MAAMoW,UAAY,SAAS1V,EAAU,IAClDvF,KAAKiZ,QAAQpU,MAAMqW,gBAAkB,WAGvC,YAAAnS,OAAA,WACE,IAAMlE,EAAK,KACN7E,KAAKoH,MAAMuR,aAKhB,OACEhN,gBAACyM,EAAc,CAAClQ,IAAKlI,KAAKsZ,WAAYjS,YAAarH,KAAKqH,aACtDsE,uBAAK9G,MAAOA,EAAOqD,IAAKlI,KAAK4Z,YAC3BjO,gBAAC0M,EAAiB,CAChBnQ,IAAKlI,KAAKoZ,WACVvU,MAAO7E,KAAKoH,MAAMxF,cAEjB5B,KAAKiH,MAAMkU,SACVnb,KAAK2Z,iBACL3Z,KAAKka,2BAtKV,EAAAkB,aAAe,CACpBf,SAAU,OACVC,gBAAgB,GA2KpB,EAzMA,CAcsC8oB,EAAMA,WC9BtCjrB,EAAM+qB,EAAM,iBAclB,yE,OACE,EAAA3nB,OAAS,SAAAja,GAEP,OADA6W,EAAI,GACG,EAAK7W,IAGd,EAAA2G,QAAU,SAAA3G,GACR,OAAO,SAAAka,GACDA,IACF,EAAKla,GAAQka,EACb,EAAKC,aAAana,EAAMka,MAK9B,EAAAE,UAAY,SAAApa,GACV6W,EAAI,aAAc7W,UACX,EAAKA,IAGd,EAAAqa,UAAwC,IAAIlP,IAE5C,EAAAgP,aAAe,SAACna,EAAc4G,G,QAC5B,GAAI,EAAKyT,UAAU7O,IAAIxL,GAAO,CAC5B,IAAMua,EAAY,EAAKF,UAAUvb,IAAIkB,G,IACrC,IAAuB,QAAAua,GAAS,8BAAE,EAChCG,EADiB,SACR1a,EAAM4G,I,oGAKrB,EAAAiU,oBAAsB,SAAC7a,EAAM0a,GACtB,EAAKL,UAAU7O,IAAIxL,GAGtB,EAAKqa,UAAUvb,IAAIkB,GAAMgM,KAAK0O,GAF9B,EAAKL,UAAU/N,IAAItM,EAAM,CAAC0a,K,EAchC,OA/C6BonB,OAuC3B,YAAAr6B,OAAA,WACE,OAAO/I,KAAKiH,MAAMkU,SAChBnb,KAAKiI,QACLjI,KAAKub,OACLvb,KAAK0b,UACL1b,KAAKmc,oBAAoB9S,KAAKrJ,QAGpC,EA/CA,CAA6BojC,EAAMA,WCdtBx3B,EAAON,EAAOvE,IAAG,iJAGuB,qBACX,yBACQ,UAH9B,SAAAE,GAChB,OAAAA,EAAMmV,cAAgBnV,EAAMmV,cAAgB,SAC/B,SAAAnV,GAAS,OAAAA,EAAMoV,cACX,SAAApV,GAAS,OAAAA,EAAM4E,kBAGvByQ,EAAShR,EAAOvE,IAAG,+CACC,UAArB,SAAAE,GAAS,OAAAA,EAAMsV,UAGdC,EAAelR,EAAOuF,EAAC,uFAIvB4L,EAASnR,EAAOvE,IAAG,mGAKnB2V,EAAMpR,EAAOvE,IAAG,+IAOhBmK,EAAiB5F,EAAO+3B,WAAP/3B,CAAgB,6FAIjCqR,EAAYrR,EAAOoR,EAAPpR,CAAW,qKAOvBE,GAAQF,EAAOvE,IAAG,2DAIlBqJ,GAAiB9E,EAAOsR,KAAI,6JAO5BrR,GAASD,EAAOvE,IAAG,iDACE,UAArB,SAAAE,GAAS,OAAAA,EAAMyE,UAGfmR,GAAevR,EAAOvE,IAAG,qJCrDhCoR,GAAM+qB,EAAM,gBAElB,SAAgBpmB,KACd,IAAMC,EAAiB,GACvB,MAAO,CACLC,iBAAgB,SAAC/V,GACfkR,GAAI,oBACI,IAAAhO,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAC3BmP,GAAIrO,EAAMvE,YAEmB,OAAzBuE,EAAMY,gBACNZ,EAAMI,oBAAsBlB,IAE9Bc,EAAM1E,WAAa4D,GACnBc,EAAMzE,YAAc1F,YAAUsd,iBAGhC9S,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOsM,YACf7G,UAAW1F,YAAUwM,YAIzB+Q,uBAAsB,SAACjW,GACb,IAAAkD,EAAA,EAAAA,WACqB,OADT,EAAAL,MACVY,gBACVP,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOsM,YACf7G,UAAW1F,YAAUsd,oBAIzBE,uBAAsB,SAAClW,GACb,EAAAkD,WACGC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOsM,YACf7G,UAAW1F,YAAUyd,eAIzBC,uBAAsB,SAACpW,GACb,IAAAkD,EAAA,EAAAA,WACFmT,EAAmBnT,EAAWC,IAAI,sBAAuBnD,GAC/D,OAAwB,MAApBqW,EAAiC,KACP,cAA1BA,EAAiBhc,KACZ,WACL6I,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACR5B,UAAW1F,YAAUwM,OACrB9B,OAAQzK,SAAOsM,qBALrB,GAWFzD,iBAAgB,SAACxB,GACP,IAAA9G,EAAA,EAAAA,IAAK6b,EAAA,EAAAA,SAAUuB,EAAA,EAAAA,KAAMpT,EAAA,EAAAA,WAS7B,SAASqT,IACPxB,IACA7R,EAAWC,IAAI,sBAAuB,CACpCjK,IAAG,EACH6b,SAAQ,IAZPe,EAAe5c,KAAM4c,EAAe5c,GAAO,IAC5Cod,GACFC,EAAKC,OAASzB,EACde,EAAe5c,GAAKmN,KAAKkQ,IAEzBT,EAAe5c,GAAKmN,KAAK0O,IAY7BrT,oBAAmB,SAAC1B,GACV,IAAA9G,EAAA,EAAAA,IAAK6b,EAAA,EAAAA,SACTe,EAAe5c,KACjB4c,EAAe5c,GAAO4c,EAAe5c,GAAKmS,QAAO,SAAAoL,GAC/C,OAAOA,IAAO1B,GAAY0B,EAAGD,SAAWzB,OAK9C2B,UAAS,SAAC1W,GACA,IAAA9G,EAAA,EAAAA,IACJ4c,EAAe5c,IACjB4c,EAAe5c,GAAK+M,SAAQ,SAAAwQ,GAAM,OAAAA,S,IC5F7BE,GAAW,CACtBC,UAAW,YACXC,MAAO,QACPC,aAAc,eACdC,MAAO,QACPC,KAAM,OACNC,MAAO,QACPC,aAAc,WACdC,WAAY,SACZC,OAAQ,SACRC,MAAO,QACPC,OAAQ,SACRC,MAAO,QACPC,OAAQ,SACRC,UAAW,YAGb,SAAgBzO,GAAc3O,GAC5B,MAAO,oBAAoBA,EAG7B,SAAgB4S,GAAKyK,GACnB,OAAOhT,wBAAMqE,UAAWC,GAAc0O,K,SCvBxBC,GAAcze,GAC5B,MAAO,WAAWA,EAGpB,SAAgBqJ,GAAoBrJ,GAClC,MAAO,kBAAkBA,EAG3B,SAAgBqK,GAAiBrK,GAC/B,MAAO,eAAeA,EAGxB,SAAgB0e,GAAkB1e,GAChC,MAAO,gBAAgBA,EAGzB,SAAgB2e,GAAY3e,GAC1B,MAAO,SAASA,EAGlB,SAAgB4e,GAAY5e,GAC1B,MAAO,SAASA,EAGlB,SAAgB6e,GAAe7e,GAC7B,MAAO,aAAaA,EAGtB,SAAgB8e,GAAe9e,GAC7B,MAAO,YAAYA,EAGrB,SAAgB+e,GAAe/e,EAAKgf,GAClC,MAAO,YAAYA,EAAG,IAAIhf,EAG5B,IAAaif,GAAS,CACpBC,iBAAkB,eAClBC,uBAAwB,mBACxBC,kBAAmB,gBACnBC,oBAAqB,kBACrBC,gBAAiB,eAENC,GAAW,CACtBC,kBAAmB,qBAGRrR,GAAU,CACrBwG,+BAAgC,iCAChC8K,2BAA4B,6BAC5BrR,YAAa,eClDFoB,GAAc,SAAArI,GACzBA,EAAEC,mB,SCDYsY,GAAoBC,EAAaC,GAC/C,IAAMC,EAAOxX,SAASyX,cAAc,KACpCD,EAAKE,KAAOJ,EACZE,EAAKG,SAAWJ,EAChBC,EAAKI,QAGP,SAAgBC,GAAoBxV,EAAckV,GAEhDF,GADY,mBAAmBS,mBAAmBzV,GACzBkV,GAG3B,SAAgBQ,GAAgBC,GAC9B,IAAMC,EAAQjY,SAASyX,cAAc,SAIrC,OAHAQ,EAAM3f,KAAO,OACb2f,EAAMD,OAASA,EAER,IAAIE,SAAgB,SAACC,EAASC,GACnCH,EAAMhY,iBAAiB,UAAU,SAAAoY,GAE/B,IAAMC,EAAOD,EAAI/Y,OAAOiZ,MAAM,GACxBC,EAAK,IAAIC,WAEfD,EAAGE,OAAS,SAACL,GACX,IAAMM,EAAMN,EAAI/Y,OAAOsZ,OAEvBT,EAAQQ,IAEVH,EAAGK,QAAU,SAACR,GACZD,EAAOC,EAAI/Y,OAAOiP,QAEpBiK,EAAGM,WAAWR,MAEhBL,EAAML,W,SCjCMmB,GAAWvJ,GAMjB,QAAA+B,WAAA,UAAS,IAAAyH,aAAA,UAAW,IAAAE,cAAA,UAAY,IAAA5H,KACxC,OAAUC,EAAG,MAAMyH,EAAK,MAAME,EAAM,YADI,WACM,KCIhD,SAAgB,GAAQ,GACtB,OAAQ,EAAK,IAAM,EAAK,QAAU,EAGpC,SAAgB,GAAQ,GACtB,OAAQ,EAAK,KAAO,EAAK,OAAS,EAGpC,SAAgB,GAAa,EAAI,GAC/B,OAAQ,EAAG,EAAI,EAAG,GAAK,EAGzB,SAAgB,GAAa,EAAI,GAC/B,OAAQ,EAAG,EAAI,EAAG,GAAK,EAGzB,SAAgB,GAAO,GACrB,MAAO,EAAE,EAAK,KAAO,EAAK,OAAS,GAAI,EAAK,IAAM,EAAK,QAAU,GAEnE,SAAgB,GACd,EACA,EACA,qBAEA,IAAM,EAAO,EAAG,wBAGV,EAAY,GAFF,EAAI,yBAGd,EAAW,GAAO,GACxB,EAAS,IAAM,EAAS,GAAK,EAAU,IAAM,EAC7C,EAAS,IAAM,EAAS,GAAK,EAAU,IAAM,EAC7C,IAAM,EAAQ,EAAK,MAAQ,EACrB,EAAS,EAAK,OAAS,EAC7B,MAAO,CACL,KAAM,EAAS,GAAK,EAAQ,EAC5B,MAAO,EAAS,GAAK,EAAQ,EAC7B,IAAK,EAAS,GAAK,EAAS,EAC5B,OAAQ,EAAS,GAAK,EAAS,EAC/B,MAAK,EACL,OAAM,GAIV,SAAgB,GAAkB,EAAiB,GACjD,IAAM,EAAO,EAAG,wBAEV,EAAY,GADF,EAAI,yBAEd,EAAW,GAAO,GACxB,MAAO,CAAC,EAAS,GAAK,EAAU,GAAI,EAAS,GAAK,EAAU,I,IC5CjDuB,GAAa,CACxBC,UAAW,YACXC,YAAa,cACb3O,aAAc,eACd4O,aAAc,eACdC,WAAY,aACZC,gBAAiB,mBAWnB,SAAgBC,KACd,MAAO,CACLnQ,iBAAA,SAAiBnM,GACf,IAAMuc,EAAgB,SAAAnZ,GAAU,gBAAA/C,IAXtC,SAAY+C,EAAgBpD,GAClB,IAAA+B,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MAAOK,EAAA,EAAAA,gBACRsZ,IAAbza,IACF/B,EAAK,OAAQA,GAAK,CAAE+B,SAAUc,EAAM1E,YAEtC+E,EAAWC,IAAI,YAAW,OAAOnD,GAAK,CAAEoD,OAAM,KAQxCqZ,CAAGrZ,EAAQpD,KAqDb,MAAO,CACL0c,aApDmB,IAAIlX,IAAwB,CAC/C,CACEwW,GAAWC,UACX,CACE3P,MAAO,YACPC,MAAO,MACP/L,UAAW+b,EAAc5jB,SAAOsjB,aAGpC,CACED,GAAWE,YACX,CACE5P,MAAO,cACPC,MAAO,QACP/L,UAAW+b,EAAc5jB,SAAOujB,eAGpC,CACEF,GAAWzO,aACX,CACEjB,MAAO,eACPC,MAAO,MACP/L,UAAW+b,EAAc5jB,SAAO4U,gBAGpC,CACEyO,GAAWG,aACX,CACE7P,MAAO,eACPC,MAAO,QACP/L,UAAW+b,EAAc5jB,SAAOgkB,yBAGpC,CACEX,GAAWI,WACX,CACE9P,MAAO,aACPC,MAAO,UACP/L,UAAW+b,EAAc5jB,SAAOikB,sBAGpC,CACEZ,GAAWK,gBACX,CACE/P,MAAO,kBACPC,MAAO,kBACP/L,UAAW+b,EAAc5jB,SAAO0jB,qBAOpChQ,cAHoB,IAAI7G,OCnEhC,IAAM0L,GAAM+qB,EAAM,oBAElB,SAAgBnf,KA6Fd,IAAMC,EAAQ,IAAIvX,IAAI,CACpB,CAAC7M,SAAOwU,gBAAiBP,gBAAcoQ,gBACvC,CAACrkB,SAAOue,aAActK,gBAAcqQ,aACpC,CAACtkB,SAAOwe,WAAYvK,gBAAcsQ,WAClC,CAACvkB,SAAOwkB,UAAWvQ,gBAAcwQ,UACjC,CAACzkB,SAAOsjB,UAAWrP,gBAAcyQ,UACjC,CAAC1kB,SAAOujB,YAAatP,gBAAc0Q,YACnC,CAAC3kB,SAAO4U,aAAcX,gBAAc2Q,aACpC,CAAC5kB,SAAOsM,YAAa2H,gBAAcC,YACnC,CAAClU,SAAOwM,eAAgByH,gBAAc4Q,cACtC,CAAC7kB,SAAO8kB,UAAW7Q,gBAAc8Q,UACjC,CAAC/kB,SAAOglB,UAAW/Q,gBAAcgR,UACjC,CAACjlB,SAAOklB,gBAAiBjR,gBAAckR,cACvC,CAACnlB,SAAOolB,mBAAoBnR,gBAAcoR,aAC1C,CAACrlB,SAAOgkB,sBA1GkB,SAAC,G,IAAE9Z,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SACpC,OAAO6K,gBAAcC,WAAW,CAC9BhK,MAAK,EACLd,SAAQ,EACR3D,UAAW1F,YAAUsd,oBAuGvB,CAACrd,SAAOikB,mBApGe,SAAC,G,IAAE/Z,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAE3BmN,EADQrM,EAAMC,SAASf,GACVgB,SAAStK,YAAUwlB,MActC,OAbkB,MAAd/O,EAAKrS,OAAoC,MAAnBqS,EAAKrS,MAAM/C,OACnC+I,EAAQ+J,gBAAckR,aAAa,CACjCjb,MAAK,EACLd,SAAQ,EACRsB,UAAW5K,YAAUwlB,KACrBnkB,KAAM,MAGV+I,EAAQ+J,gBAAcC,WAAW,CAC/BhK,MAAK,EACLd,SAAQ,EACR3D,UAAW1F,YAAUwlB,iBAuFvB,CAACvlB,SAAOwlB,cAlFV,SAAqBne,GACX,IAAAoe,EAAA,EAAAA,OAAQC,EAAA,EAAAA,OAAQC,EAAA,EAAAA,QAClBzb,EAAA,EAAAA,MACA0b,EAAW1b,EAAMC,SAASsb,GAC1BI,EAAW3b,EAAMC,SAASub,GAE1BI,EAAeF,EAASxhB,UAE1B2hB,EADmB7b,EAAMC,SAAS2b,GACAxhB,QAChC0hB,EAAWD,EAAiBpW,QAAQ8V,GAI1C,GAFAM,EAAmBA,EAAiBrW,OAAOsW,GAE3B,OAAZL,EAAkB,CACpB,IAAI,EAAaE,EAASvhB,QAC1B,EAAa,EAAWoJ,KAAK+X,GAC7Bvb,EAAQA,EAAM8K,eAAc,SAAA6B,GAC1BA,EAAE5I,MAAM,CAAC,SAAU6X,EAAc,WAAYC,GAC1C9X,MAAM,CAAC,SAAUwX,EAAQ,aAAcC,GACvCzX,MAAM,CAAC,SAAUyX,EAAQ,WAAY,GACrCzX,MAAM,CAAC,SAAUyX,EAAQ,aAAa,UAEtC,CACL,IAAM,EAAeG,EAASzhB,UAE1B,EADkB8F,EAAMC,SAAS,GACA7F,QAC/B8hB,EAAW,EAAiBzW,QAAQ+V,GAE1C,GAAII,IAAiB,EAAc,CACjC,IAAI,EAAsBnZ,SAC1B,EAAiBW,SAAQ,SAAA/M,GACnBA,IAAQklB,IAGN,EAFAllB,IAAQmlB,EACM,SAAZC,EACoB,EACnBjY,KAAK+X,GACL/X,KAAKnN,GAEc,EACnBmN,KAAKnN,GACLmN,KAAK+X,GAGY,EAAoB/X,KAAKnN,OAIrD2J,EAAQA,EAAM8K,eAAc,SAAA6B,GAC1BA,EAAE5I,MAAM,CAAC,SAAU,EAAc,WAAY,UAG/B,SAAZ0X,EACF,EAAmB,EAAiBW,OAAOF,EAAUX,GAChC,SAAZE,IACT,EAAmB,EAAiBW,OAAOF,EAAW,EAAGX,IAE3Dvb,EAAQA,EAAM8K,eAAc,SAAA6B,GAC1BA,EAAE5I,MAAM,CAAC,SAAU6X,EAAc,WAAYC,GAC1C9X,MAAM,CAAC,SAAUwX,EAAQ,aAAc,GACvCxX,MAAM,CAAC,SAAU,EAAc,WAAY,GAC3CA,MAAM,CAAC,SAAU,EAAc,aAAa,MAIrD,OAAO/D,IAmBP,CAAClK,SAAO0jB,gBAAiBzP,gBAAcsS,yBAGrCC,EAAYkd,UACZjd,EAAYid,UAEZhd,GAAU,EACVC,EAAqB,IAAI5S,IAE7B,MAAO,CACL6S,mBAAkB,SAACvf,GACjB,OAAOqf,GAGTG,gBAAe,WACbH,GAAU,GAGZI,iBAAgB,SAAC,G,IAAEvS,EAAA,EAAAA,UACjBmS,GAAU,EACNnS,EAAWoS,EAAqB,IAAI5S,IAAIQ,GACvCoS,EAAmBjR,SAY1BjB,SAAQ,SAACpN,GACP,OAAO+c,GAET2C,aAAY,SAAC1f,GACH,IAAA6C,EAAA,EAAAA,MAAOO,EAAA,EAAAA,OACf,GAAIA,EACF,OAAQA,GACN,KAAKzK,SAAOsM,YACZ,KAAKtM,SAAOgkB,sBACZ,KAAKhkB,SAAOikB,mBACV,OAAO,EAKb,OAAQ/Z,EAAMzE,WACZ,IAAK,eACL,IAAK,kBACH,OAAO,EAEX,OAAOyE,EAAM7E,OAAO/D,WAGtB0lB,iBAAgB,WACd,MAAO,CACLR,UAAS,EACTC,UAAS,IAIbQ,aAAY,SAAC5f,GACXkR,GAAI,eAAgBlR,EAAMmf,WAC1BA,EAAYnf,EAAMmf,WAGpBU,aAAY,SAAC7f,GACXkR,GAAI,eAAgBlR,EAAMof,WAC1BA,EAAYpf,EAAMof,WAGpBU,QAAO,SAAC9f,GACE,IAAAkD,EAAA,EAAAA,WACAic,EAAA,4BAAAA,UACFllB,EAAYiJ,EAAWC,IAAI,eAAgBnD,GACjD,OAAOmf,EAAUtW,KAAO,GAAK5O,GAG/B8lB,QAAO,SAAC/f,GACE,IAAAkD,EAAA,EAAAA,WACAkc,EAAA,4BAAAA,UACFnlB,EAAYiJ,EAAWC,IAAI,eAAgBnD,GACjD,OAAOof,EAAUvW,KAAO,GAAK5O,GAG/B+lB,KAAI,SAAChgB,GACK,IAAAkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MACpB,GAAKK,EAAWC,IAAI,eAAgBnD,GAApC,CAGM,kCAAEmf,EAAA,EAAAA,UAAWC,EAAA,EAAAA,UAIba,EAAWd,EAAUe,OACtBD,IACL/c,EAAWC,IAAI,eAAc,OACxBnD,GAAK,CACRmf,UAAWA,EAAUgB,WAEvBjd,EAAWC,IAAI,eAAc,OACxBnD,GAAK,CACRof,UAAWA,EAAU/Y,KAAKxD,MAE5BqO,GAAI+O,GACJ/c,EAAWkd,OAAOH,MAGpBI,KAAI,SAACrgB,GACK,IAAAkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MACpB,GAAKK,EAAWC,IAAI,eAAgBnD,GAApC,CAGM,kCAAEmf,EAAA,EAAAA,UAAWC,EAAA,EAAAA,UAIba,EAAWb,EAAUc,OACtBD,IACL/c,EAAWC,IAAI,eAAc,OACxBnD,GAAK,CACRmf,UAAWA,EAAU9Y,KAAKxD,MAE5BK,EAAWC,IAAI,eAAc,OACxBnD,GAAK,CACRof,UAAWA,EAAUe,WAEvBjd,EAAWkd,OAAOH,MAIpBnP,UAAS,SAAC9Q,GACA,IAAAkD,EAAA,EAAAA,WAAYE,EAAA,EAAAA,OAAQP,EAAA,EAAAA,MAAOmC,EAAA,EAAAA,QAASsb,EAAA,EAAAA,SAC5C,GAAe,MAAXtb,IAAoBzL,MAAMC,QAAQwL,GACpC,MAAM,IAAIrL,MAAM,iDAElB,GAAc,MAAVyJ,GAA6B,MAAX4B,EACpB,MAAM,IAAIrL,MAAM,2CAGlB,IAD2BuJ,EAAWC,IAAI,qBAAsBnD,GACvC,CAKvB,GAAgC,IAA5Bsf,EAAmBzW,KAAY,OAEnC,GAAe,MAAX7D,EAAiB,CACnB,IAAMub,EAAmBvb,EAAQqG,QAC/B,SAAAoR,GAAM,OAAC6C,EAAmBzZ,IAAI4W,EAAGrZ,WAEnC,GAAImd,GAAoBA,EAAiB/gB,OAAS,EAChD,YAEG,IAAK8f,EAAmBzZ,IAAIzC,GACjC,OAIJ8N,GAAI,aAAc9N,GAClB8N,GAAI,aAAcrO,GAClBqO,GAAI,aAAclR,GAElB,IASIigB,EATE5S,EAAQnK,EAAWC,IAAI,WAAYnD,GAEzC,GADAkD,EAAWC,IAAI,kBAAmBnD,GAC9BkD,EAAWC,IAAI,eAAgBnD,GAAQ,CACjC,kCAAAmf,UACRjc,EAAWC,IAAI,eAAc,OACxBnD,GAAK,CACRmf,UAAW,EAAU9Y,KAAKxD,MAK9B,GAAe,MAAXmC,EACFib,EAAWjb,EAAQyb,QAAO,SAACC,EAAKC,GACtB,IAAAvd,EAAA,EAAAA,OACR,IAAKiK,EAAMxH,IAAIzC,GACb,MAAM,IAAIzJ,MAAM,UAAUyJ,EAAM,eAClC,IAAMwd,EAASvT,EAAMlU,IAAIiK,GACnByd,EAAW,KAAK3d,WAAU,GAAKyd,GAAG,CAAE9d,MAAO6d,IAC7C1a,EAAM9C,EAAWC,IAAI,mBAAoB0d,GAM7C,OALA7a,EAAM4a,EAAO,EAAD,KAAMC,GAAW,CAAEhe,MAAOmD,KACtCA,EAAM9C,EAAWC,IAAI,kBAAiB,OACjC0d,GAAW,CACdhe,MAAOmD,OAGRnD,OACE,CACL,IAAKwK,EAAMxH,IAAIzC,GAAS,MAAM,IAAIzJ,MAAM,UAAUyJ,EAAM,eACxD,IAAMwd,EAASvT,EAAMlU,IAAIiK,GACzB6c,EAAW/c,EAAWC,IAAI,mBAAoBnD,GAC9CigB,EAAWW,EAAO,EAAD,KAAM5gB,GAAK,CAAE6C,MAAOod,KACrCA,EAAW/c,EAAWC,IAAI,kBAAiB,OACtCnD,GAAK,CACR6C,MAAOod,KAGX/O,GAAI,YAAa+O,GACjB/c,EAAWkd,OAAOH,EAAUK,GAC5Bpd,EAAWC,IAAI,iBAAkBnD,IAGnC8gB,aAAY,SAAC9gB,G,QACH6C,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAU0S,EAAA,EAAAA,UACnBsM,EAAatT,qBAAmB5K,EAAOd,GAC7Cgf,EAAW1a,KAAKtE,G,IAChB,IAAkB,QAAAgf,GAAU,8BAAE,CAAzB,IAAM7nB,EAAG,QACZub,EAAUqD,GAAY5e,IACtBub,EAAUsD,GAAe7e,IACzBub,EAAUkD,GAAcze,IACxBub,EAAUlS,GAAoBrJ,IAC9Bub,EAAUlR,GAAiBrK,IAC3Bub,EAAUmD,GAAkB1e,IAC5Bub,EAAUoD,GAAY3e,IACtBub,EAAUuD,GAAe9e,IACzBub,EAAUwD,GAAe/e,EAAK,SAC9Bub,EAAUwD,GAAe/e,EAAK,U,mGAKlCgoB,gBAAe,SAAClhB,KAChBmhB,eAAc,SAACnhB,KAGfsN,iBAAgB,SAACtN,GACP,IAAAkD,EAAA,EAAAA,WAAYE,EAAA,EAAAA,OAAQP,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAOnC,OALEqB,IAAWzK,SAAO4U,cAClBxL,IAAac,EAAM3E,oBAEnBgF,EAAWC,IAAI,eAAgBnD,GAE1B6C,GAGTue,gBAAe,SAACphB,GACd,OAAOA,EAAM6C,QCnXnB,gC,+CAOA,OAPsC,OACpC,YAAAf,OAAA,WACU,IAAAoB,EAAA,WAAAA,WACR,OACEwB,gBAAC43B,OAAI,KAAEp5B,EAAWC,IAAI,4BAA6BpK,KAAKiH,SAG9D,EAPA,CAAsC6Q,GCWhCzF,GAAsC,CAC1C,CACElC,KAAM,OACNoD,MAAO,OACPgV,SAAU,QACVC,YAAY,EACZne,OAAQzK,SAAOgkB,uBAEjB,CACEzT,KAAM,cACNoD,MAAO,cACPgV,SAAU,QACVle,OAAQzK,SAAOujB,aAEjB,CACEhT,KAAM,YACNoD,MAAO,YACPgV,SAAU,MACVC,YAAY,EACZne,OAAQzK,SAAOsjB,WAEjB,CACE/S,KAAM,QACNoD,MAAO,aACPgV,SAAU,UACVC,YAAY,EACZne,OAAQzK,SAAOikB,oBAEjB,CACE1T,KAAM,cACNoD,MAAO,cACPgV,SAAU,MACVle,OAAQzK,SAAO4U,cAEjB,CACErE,KAAM,OACNoD,MAAO,qBACPgV,SAAU,kBACVle,OAAQzK,SAAO0jB,kBC1CnB,I,MAAMnL,GAAM+qB,EAAM,0BAEZta,GAAgBtd,EAAOud,IAAG,yQAchC,0E,OACE,EAAAzhB,MAAQ,CACN3C,QAAS,M,EA2Db,OA7DqC,OAKnC,YAAAskB,OAAA,WACE,IAAM9hB,EAAQjH,KAAKiH,MACb,aAAEsU,EAAA,EAAAA,OAAQzR,EAAA,EAAAA,MAAOvE,EAAA,EAAAA,WACjByjB,EAD6B,EAAA7e,WACJC,IAAI,qBAAsBnD,GACjD9G,EAAA,EAAAA,IAAKolB,EAAA,EAAAA,QAGb,GAFApN,GAAI,SAAUoN,GAEF,OAARplB,EAAJ,CAMA,IAMMsE,EAAU8W,EALA,OAAZgK,EACO3G,GAAcze,GAEd+e,GAAe/e,EAAKolB,IAGzBsD,EAAMtN,EAAO,mBACbtC,EAAUsC,EAAO6D,GAAOE,wBAAwBrG,QAChDC,EAAc4oB,GAAgBr9B,EAASwU,EAAS1T,GAChD0jB,EAAU6Y,GAAgBjZ,EAAK5P,EAAS1T,GAExC8c,EAAInJ,EAAYY,KAAOmP,EAAQnP,KADrB,EAEVyI,EAAIrJ,EAAYa,IAAMkP,EAAQlP,IAFpB,EAGVnB,EAAQM,EAAYN,MAAQ,EAC5BG,EAASG,EAAYH,OAAS,EAEpC/Y,KAAKsI,SAAS,CACZ7D,QACEkH,yBACEA,wBACE0W,EAAGA,EACHE,EAAGA,EACH3J,MAAOA,EACPG,OAAQA,EACR/F,KAAK,OACLkW,OAAQpf,EAAM7E,OAAO5D,MAAMI,eAC3B0nB,gBAAgB,MAChBC,YAAa,YAjCnBppB,KAAKsI,SAAS,CACZ7D,QAAS,QAuCf,YAAAsE,OAAA,WACU,IAAAd,EAAA,WAAAA,QACR,OACE0D,gBAACid,GAAa,CAAC1gB,IAAKD,EAAQ,oBACzBjI,KAAKoH,MAAM3C,UAIpB,EA7DA,CAAqCqT,GChB/BK,GAAM+qB,EAAM,wBACZ5Z,GAAWhe,EAAOvE,IAAG,qFACa,8CAA5B,SAAAE,GAAS,OAAGA,EAAM8R,OAAM,QAKpC,SAAgBwQ,KACd,IAAIC,EAAyB,KACzBC,EAAwB,KAE5B,MAAO,CACLC,oBAAmB,SAACziB,GACV,IAAA+B,EAAA,EAAAA,SAAUuc,EAAA,EAAAA,QAAStd,EAAA,EAAAA,QAASkC,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAgB1C6f,EAAgB,CACpBC,YAhBkB,SAAAC,GAClB1R,GAAI,cAAenP,EAAUuc,GAC7Bpb,EAAWC,IAAI,uBAAsB,OAAOnD,GAAK,CAAE4iB,GAAE,EAAEtE,QAAO,MAe9DuE,YAbkB,SAAAD,GAClB1R,GAAI,cAAenP,EAAUuc,GAC7Bpb,EAAWC,IAAI,uBAAsB,OAAOnD,GAAK,CAAE4iB,GAAE,EAAEtE,QAAO,MAY9DwE,WAViB,SAAAF,GACjBA,EAAGpQ,kBAUHuQ,OARa,SAAAH,GACb1R,GAAI,SAAUnP,EAAUuc,GACxBpb,EAAWC,IAAI,kBAAiB,OAAOnD,GAAK,CAAE4iB,GAAE,EAAEtE,QAAO,OAQ3D,OACE5Z,gBAAC2d,GAAQ,GACPvQ,OAAQjP,EAAM7E,OAAO5D,MAAMM,QAAU,EACrCuG,IAAKD,EAAQiX,GAAelW,EAAUuc,KAClCoE,KAKVM,wBAAuB,SAAChjB,GACtBkR,GAAI,2BACI,IAAAlQ,EAAA,EAAAA,QACR,OACE0D,gBAACmd,GAAe,GACd5gB,IAAKD,EAAQmX,GAAOK,kBAChBxY,KAKVijB,mBAAkB,SAACjjB,GACjB,MAAO,CACL9G,IAAKqpB,EACLjE,QAASkE,IAIbU,qBAAoB,SAACljB,GACX,IAAAkD,EAAA,EAAAA,WAAY,EAAA0f,GACjBtiB,kBACH4C,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOsM,YACf7G,UAAW1F,YAAUyqB,aAIzBC,QAAO,SAACpjB,GACE,IAAAoe,EAAA,EAAAA,OAAQC,EAAA,EAAAA,OAAQxb,EAAA,EAAAA,MAAOyb,EAAA,EAAAA,QAC/B,OACEF,IAAWvb,EAAM3E,oBACjBkgB,IAAWC,GACXke,kBAAgB15B,EAAOub,EAAQC,KAAYme,oBAAkBnZ,YAG3DhF,IAAWxb,EAAM3E,oBAAkC,OAAZogB,KAE1Bzb,EAAMC,SAASsb,GACnBrhB,YAAcshB,GAAsB,OAAZC,KAIvCgF,qBAAoB,SAACtjB,GACX,IAAAse,EAAA,EAAAA,QAASvc,EAAA,EAAAA,SAAUmB,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MACvCqO,GAAI,wBAAyBnP,EAAUuc,GACvBpb,EAAWC,IAAI,UAAS,OACnCnD,GAAK,CACRoe,OAAQvb,EAAM1E,SACdkgB,OAAQtc,OAGRwgB,EAAgBxgB,EAChBygB,EAAgBlE,EAChBpb,EAAWkd,OAAOvd,KAItB0gB,qBAAoB,SAACvjB,GACX,IAAAkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUuc,EAAA,EAAAA,QAAShK,EAAA,EAAAA,OACxCkP,EADgD,EAAAZ,GAC7BngB,YAAY+gB,cACrCtS,GAAI,wBAAyBnP,EAAUuc,GACvC,IAAM9gB,EAAU8W,EAAOqD,GAAc5V,IACjCvE,GAAWgmB,GAAiBhmB,EAAQoD,SAAS4iB,KAGjDjB,EAAgB,KAChBC,EAAgB,KAChBtf,EAAWkd,OAAOvd,KAGpB4gB,gBAAe,SAACzjB,GACdkR,GAAI,mBACI,IAAAhO,EAAA,EAAAA,WAAYnB,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MAC9B7C,EAAK,OAAQA,GAAK,CAAEoe,OAAQvb,EAAM1E,SAAUkgB,OAAQtc,IAEpDwgB,EAAgB,KAChBC,EAAgB,KACZtf,EAAWC,IAAI,UAAWnD,IAC5BkD,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOwlB,mBC5HzB,I,iCAAMkG,GAA4BhgB,EAAOC,GAAPD,CAAc,iSAU1CigB,GAAiBjgB,EAAOvE,IAAG,qEAI3BykB,GAAkBlgB,EAAOsR,KAAI,uBAEnC,eACE,WAAY3V,GAAZ,MACE,YAAMA,IAAM,K,OAMd,EAAAkf,sBAAwB,SAAAnd,GAAY,kBAC5B,cAAEc,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACXL,EAAM3E,qBAAuB6D,GAC/BmB,EAAWkd,OACTxT,gBAAcsS,sBAAsB,CAClCrc,MAAK,EACLd,SAAQ,OAMhB,EAAA0iB,mBAAqB,SAAAzkB,GACX,IAAA4D,EAAA,EAAAA,KAAM,gBACR+gB,EAAc/gB,EAAKpE,OAAS,EAC5BuL,EAAQ4Z,EAAc/gB,EAAKC,OAAO,EAAG,GAAK,MAAQD,EAIlDwF,EAAe,CACnB5L,QAFckH,gBAAC4f,GAAc,KAAE1gB,GAG/BghB,SAAU6X,kBAAgB5X,cAEtBC,EACJpgB,gBAACg4B,aAAU,KAAKhY,GACdhgB,gBAAC6f,GAAe,KAAExZ,IAGtB,OAAO4Z,EACLjgB,gBAACi4B,UAAO,KAAKvzB,GAAe0b,GAE5BA,GApCF,EAAK3kB,MAAQ,CACX4kB,MAAM,G,EA0EZ,OA9E2C,OAiDzC,YAAAjjB,OAAA,WACE,IAAM9B,EAAQjH,KAAKiH,MACX6C,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WAAYuB,EAAA,EAAAA,OACrBugB,EAAiBniB,EAAM3E,mBAC7B,GAAI8mB,IAAmBniB,EAAM5E,aAAc,OAAO,KAIlD,IAFA,IAAMmN,EAAQ,GACVN,EAAQjI,EAAMC,SAASkiB,GACX,MAATla,GAAe,CACpB,IAAMC,EAAQ7H,EAAWkE,SAASC,GAAQC,YAAW,OAChDtH,GAAK,CACR+B,SAAU+I,EAAM5R,OAElBkS,EAAM6Z,QAAQ,CACZrhB,KAAMmH,EACNjG,QAAS/L,KAAKmmB,sBAAsBpU,EAAM5R,OAE5C4R,EAAQjI,EAAMC,SAASgI,EAAM/N,WAE/B,IAAMmoB,EAAkB,CACtB9Z,MAAK,EACLqZ,mBAAoB1rB,KAAK0rB,oBAE3B,OACE/f,gBAAC2f,GAAyB,CAAC5f,OAAQA,GACjCC,gBAACk4B,cAAW,KAAK1X,MAIzB,EA9EA,CAA2CrU,GCrBrCsU,GAAY9gB,EAAOvE,IAAG,+LAOtBslB,GAAM/gB,EAAOvE,IAAG,2HAGyB,UAA/B,SAAAE,GAAS,OAAAA,EAAM5F,MAAMG,cAWrC,eAGE,WAAYyF,GAAZ,MACE,YAAMA,IAAM,K,OAgFd,EAAA+T,cAAgB,SAAAzV,GACd,EAAKgnB,iBAAiBvR,cAAczV,IAGtC,EAAAinB,QAAU,SAAAllB,GACR,GAAIA,EAAEkS,QAAUlS,EAAEqC,QAAS,CACjB,IAAAQ,EAAA,QAAAA,WACJ5E,EAAa4E,EAAWC,IAAI,gBAAiB,EAAKnD,QACtD1B,GAA2B+B,EAAEoC,YAAY+iB,OAAS,EAAI,IAAO,IAC5C,KAAKlnB,EAAa,IAC/BA,EAAa,IAAGA,EAAa,GAEjC4E,EAAWC,IAAI,gBAAe,OAAO,EAAKnD,OAAK,CAAE1B,WAAU,O,EAmCjE,OAjIU69B,OAKR,YAAA1W,cAAA,WACE,IAAMzlB,EAAQjH,KAAKiH,MACXkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MACduJ,EAAyBlJ,EAAWC,IAAI,mBAAoBnD,GAClE,GAAgB,OAAZoM,EAAkB,OAAO,KAC7B,KAEIA,EAAQsQ,wBAAwBlX,KAChC4G,EAAQC,yBAAyB7G,KAGnC,MAAM,IAAIkgB,UAAU,gDAEtB,IAAMxR,EAAW,GAYjB,OAVErR,EAAMzE,YAAc1F,YAAUwM,QAC9BrC,EAAMzE,YAAc1F,YAAUyd,YAE9B/J,EAAQsQ,aAAazW,SAAQ,SAACC,EAAGC,GAC/B+N,EAAS7N,KAAK3B,gBAACm4B,SAAM,GAAC3jC,IAAKiN,GAAOD,EAAC,CAAEyf,QAAM,SAG/CvZ,EAAQC,cAAcpG,SAAQ,SAACC,EAAGC,GAChC+N,EAAS7N,KAAK3B,gBAACm4B,SAAM,GAAC3jC,IAAKiN,GAAOD,EAAC,CAAEyf,QAAM,SAEtCjhB,gBAACo4B,UAAO,KAAE5oB,IAGnB,YAAA5S,kBAAA,WACQ,iBAAEgT,EAAA,EAAAA,OAAQzR,EAAA,EAAAA,MAAO,EAAAK,WACZC,IAAI,mCAAkC,OAC5CpK,KAAKiH,OAAK,CACb+U,SAAUhc,KAAKgb,iBAEjB,IAAM9Y,EAAyBqZ,EAC7BuD,GAAYhV,EAAM3E,qBAGd0nB,EAAyBtR,EAAO,cAChCuR,EAAgB5qB,EAAU2gB,wBAC1BkK,EAAgBF,EAAUhK,wBAChC7iB,KAAKusB,iBAAiBrS,sBACpB,EACA4S,EAAc/S,IACZgT,EAAchT,IACd/Z,KAAKusB,iBAAiBzT,QAAQ+J,wBAAwB9J,OAAS,EAC/D+T,EAAc/T,QAElB/Y,KAAK+oB,UAGP,YAAArgB,qBAAA,WACU,WAAAyB,WACGC,IAAI,sCAAqC,OAC/CpK,KAAKiH,OAAK,CACb+U,SAAUhc,KAAKgb,kBAInB,sBAAI,+BAAgB,C,IAApB,WACE,OAAOhb,KAAKiH,MAAMsU,OAAO6D,GAAOE,yB,gCAGlC,YAAA0N,mBAAA,WACU,WAAA7iB,WACGC,IAAI,YAAW,OACrBpK,KAAKiH,OAAK,CACb9G,IAAKuf,GAASC,qBAEhB3f,KAAK+oB,UAGP,YAAAA,OAAA,WACU,WAAA5e,WACGC,IAAI,SAAUpK,KAAKiH,QAmBhC,YAAA8B,OAAA,sBACQ,aAAEd,EAAA,EAAAA,QAAS6B,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WAClB8iB,EAAUnjB,EAAM3E,mBACtB,OACEwG,gBAAC0gB,GAAG,CAACG,QAASxsB,KAAKwsB,SACjB7gB,gBAAC2M,EAAgB,KACXtY,KAAKoH,MAAK,CACdmS,kBAAkB,EAClBhU,WAAYuE,EAAMvE,WAClB2C,IAAKD,EAAQmX,GAAOE,2BAEnB,SACC3F,EACAO,GAEA,IAAMgT,EAAe,OAChB,EAAKjmB,OAAK,CACb+B,SAAUikB,EACVtT,iBAAgB,EAChBO,sBAAqB,IAEvB,OACEvO,gBAACygB,GAAS,CAAClkB,IAAKD,EAAQ,eACrBkC,EAAWC,IAAI,mBAAoB8iB,SA3HvCZ,EAAoB,GADhC0X,iBACY1X,GAAb,CAEU8W,EAAMA,WCrBhB,0E,OACE,EAAAhW,YAAc,WACJ,IACF/P,EADE,QAAAlT,WACkCC,IACxC,yBACA,EAAKnD,OAGPoW,GAA0BA,K,EAuB9B,OA/B4B,OAW1B,YAAAtU,OAAA,WACU,IAAAoB,EAAA,WAAAA,WACFkjB,EAAcljB,EAAWC,IAAI,cAAepK,KAAKiH,OACjDqW,EAAmBnT,EAAWC,IAAI,sBAAuBpK,KAAKiH,OACpE,OACE0E,gBAACs4B,SAAM,CACLp1B,QAAS7O,KAAKotB,YACd3e,OAAwB,OAAhB4e,EACR9jB,WAAS,EACT+jB,cAAY,EACZC,WAAS,EACTvb,MAAOsL,GAAoBA,EAAiBtL,MAC5CnN,MAAOyY,GAAoBA,EAAiBzY,OAE5C8G,uBAAKqE,UAAWk0B,UAAQ1W,YAAa3oB,MAAO,CAAE4oB,UAAW,IACtDJ,KAKX,EA/BA,CAA4BvV,GCOtB4V,GAAepiB,EAAOud,IAAG,yQAUzB1Q,GAAM+qB,EAAM,uBAQlB,0E,OACE,EAAA97B,MAAQ,CACNymB,OAAQ,I,EA0FZ,OA5FkC,OAKhC,YAAA9E,OAAA,WACE,IAQI5G,EAAWC,EARTnb,EAAQjH,KAAKiH,MACX6C,EAAA,EAAAA,MAAOyR,EAAA,EAAAA,OAAQvS,EAAA,EAAAA,SAAUzD,EAAA,EAAAA,WAAY4E,EAAA,EAAAA,WACvC4H,EAAQjI,EAAMC,SAASf,GACvBvE,EAAU8W,EAAOqD,GAAc5V,IAC/B6f,EAAMtN,EAAOyD,GAAehW,IAC5BiQ,EAAUsC,EAAO6D,GAAOE,wBAAwBrG,QAChDC,EAAc4oB,GAAgBr9B,EAASwU,EAAS1T,GAChD0jB,EAAU6Y,GAAgBjZ,EAAK5P,EAAS1T,GAG9C4c,EAAK,CACHE,EAAGJ,GAAQ/I,GAAe+P,EAAQnP,KAClCyI,EAAGR,GAAQ7I,GAAe+P,EAAQlP,KAEpC,IAAM8T,EAAS,GACf9b,EAAM7N,QAAQgJ,SAAQ,SAAA/M,GACpB,IAmBI2tB,EAnBEhsB,EAAYqI,EAAWC,IAAI,eAAc,OAC1CnD,GAAK,CACR+B,SAAU7I,KAEN6B,EAAWF,EAAUE,SAErBggB,EAAO8f,GADWvmB,EAAOqD,GAAcze,IACC8Y,EAAS1T,GAcvD,GAFA6c,EAAK,CAAEC,GAVLD,EADEJ,EAAKlI,KAAOZ,EAAYsI,MACrB,CACHa,EAAGL,EAAKlI,KACRyI,EAAGR,GAAQC,IAGR,CACHK,EAAGL,EAAKR,MACRe,EAAGR,GAAQC,KAGFK,EAAI4G,EAAQnP,KAAMyI,EAAGH,EAAGG,EAAI0G,EAAQlP,KAEhC,UAAb/X,EACF8rB,EAAQ,KAAK3L,EAAGE,EAAC,IAAIF,EAAGI,EAAC,MAAMJ,EAAGE,EAAC,IAAIC,GACrCH,EACAC,GACD,IAAIF,GAAaC,EAAIC,GAAG,IAAIA,EAAGG,EAAC,IAAIH,EAAGC,EAAC,IAAID,EAAGG,OAC3C,GAAiB,SAAbvgB,EACT8rB,EAAQ,KAAK3L,EAAGE,EAAC,IAAIF,EAAGI,EAAC,MAAMH,EAAGC,EAAC,IAAID,EAAGG,OACrC,GAAiB,UAAbvgB,EAAsB,CAC/B,IAAM+rB,EAAO3L,EAAGG,EAAIJ,EAAGI,EAAI,GAAK,EAC1ByL,EAAO5L,EAAGC,EAAIF,EAAGE,EAAI,GAAK,EAC1B4L,EAASnsB,EAAUC,WACzB,GAAc,MAAVksB,EACF,MAAM,IAAIrtB,MACR,4DAIFktB,EADE1L,EAAGG,IAAMJ,EAAGI,EACN,KAAKJ,EAAGE,EAAC,IAAIF,EAAGI,EAAC,MAAMH,EAAGC,EAG1B,KAAKF,EAAGE,EAAC,IAAIF,EAAGI,EAAC,QAAOH,EAAGG,EACjCwL,EAAOE,GAAM,MAAMA,EAAM,IAAIA,EAAM,SACnCF,EAAOC,IAAS,EAAI,EAAI,GAAC,KACvB7L,EAAGE,EAAI4L,EAASD,GAAI,IAAI5L,EAAGG,EAAC,MAAMH,EAAGC,EAG7CwL,EAAOvgB,KACL3B,wBACExL,IAAK,QAAQA,EACbsF,EAAGqoB,EACH1E,YAAatnB,EAAUG,UACvBinB,OAAQpnB,EAAUS,UAClByQ,KAAK,aAIXhT,KAAKsI,SAAS,CACZulB,OAAM,KAIV,YAAA9kB,OAAA,WACEoP,GAAI,UACE,iBAAEnP,EAAA,EAAAA,SAAUf,EAAA,EAAAA,QAClB,OACE0D,gBAAC+hB,GAAY,CAACxlB,IAAKD,EAAQ+W,GAAehW,KACxC2C,yBAAI3L,KAAKoH,MAAMymB,UAIvB,EA5FA,CAAkC/V,GC3B5BK,GAAM+qB,EAAM,YAEZ/U,GAAY7iB,EAAOvE,IAAG,+LAMgD,8CAOhD,UATX,SAAAE,GAEb,OAAAA,EAAMmnB,iBAAmB+V,iBAAe9V,KAAO,WAAa,gBAGnD,SAAApnB,GAET,OAAAA,EAAMmnB,iBAAmB+V,iBAAe9V,KACpC,qBACA,wBAGF7qB,GAAQ8H,EAAOvE,IAAG,2LAYxB,4B,+CA6EA,OA7EgCq8B,OAC9B,YAAA7U,iBAAA,SAAiBxpB,EAAmBoa,GAC5B,iBAAEhV,EAAA,EAAAA,WAAYlC,EAAA,EAAAA,QACdgF,EAAM9C,EAAWC,IAAI,kBAAiB,OACvCpK,KAAKiH,OAAK,CACbkY,IAAG,EACHqP,QAAQ,EACRzpB,OAAM,KAER,IAAKkI,EAAK,OAAO,KACT,IAAAwhB,EAAA,EAAAA,UACFC,EAAS,aAAYvP,IAAQglB,iBAAe9V,KAAO,OAAS,SAClE,OAEE1iB,gBAACwiB,GAAS,CAACC,eAAgBjP,EAAKjX,IAAKD,EAAQymB,IAC1CD,IAKP,YAAA1lB,OAAA,WACEoP,GAAI,UACJ,IAAMlR,EAAQjH,KAAKiH,MACX6C,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUf,EAAA,EAAAA,QAASkC,EAAA,EAAAA,WAC5BwkB,EAAaxkB,EAAWC,IAAI,uBAAwBnD,GACpDhC,EAAS6E,EAAM7E,OACf2pB,EAAezkB,EAAWC,IAAI,qBAAoB,OACnDnD,GAAK,CACR0nB,WAAU,EACVxP,IAAKglB,iBAAetV,QAEhBC,EAAa3kB,EAAWC,IAAI,gBAAiB,CACjD2e,OAAQ9jB,EAAO9D,UACf2I,MAAK,EACLd,SAAQ,IAEJ9G,EACJyJ,gBAACnI,GAAK,CAAC0E,IAAKD,EAAQ6W,GAAY9V,KAAa4lB,GAEzCzT,EAAWhR,EAAWC,IAAI,gCAAiCnD,GACjE,OAAQhC,EAAO9D,WACb,KAAK1B,oBAAkB2B,eACrB,OACEuK,gCACG3L,KAAKuuB,iBAAiBO,EAAWC,EAAG,KACpC7sB,EACAlC,KAAKuuB,iBAAiBO,EAAWE,EAAG,KACpC7T,GAGP,KAAK1b,oBAAkBwvB,cACrB,OACEtjB,gCACGzJ,EACAlC,KAAKuuB,iBAAiBO,EAAWE,EAAG,KACpC7T,GAGP,KAAK1b,oBAAkByvB,cACrB,OACEvjB,gCACG3L,KAAKuuB,iBAAiBO,EAAWC,EAAG,KACpC7sB,EACAiZ,GAGP,KAAK1b,oBAAkB0vB,cACrB,OACExjB,gCACGzJ,EACAlC,KAAKuuB,iBAAiBO,EAAWM,EAAG,KACpCjU,GAIT,OAAO,MAEX,EA7EA,CAAgCioB,EAAMA,WC/BhClvB,GAAO5I,EAAOvE,IAAG,gWAYpB,mHAMsC,oHAfrC,SAAC,G,IAAEoY,EAAA,EAAAA,IACH,OAAIA,IAAQglB,iBAAe7U,MAClB8U,MAAG,qFAGRjlB,IAAQglB,iBAAe9V,KAClB+V,MAAG,wFADZ,KAUY,SAAAn9B,GAAS,OAAAA,EAAMzF,cAS/B,SAAgB+tB,GAAkBtoB,G,MACxB6C,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAU2lB,EAAA,EAAAA,WAAYxP,EAAA,EAAAA,IAAKlX,EAAA,EAAAA,QAASunB,EAAA,EAAAA,gBAC7Czd,EAAQjI,EAAMC,SAASf,GAC7B,OAAO+I,EAAM7N,QAAQ4L,KAAO,EAC1BnE,gBAACuI,GAAI,CACHhM,IAAKD,EAAQgX,GAAejW,IAC5B+C,QAASyjB,EACThuB,WAAYmtB,EAAWntB,WACvB2d,IAAKA,EACLnP,UAAWq0B,GAAE,GACXl0B,MAAM,EACNsf,UAAU,GACV,EAAC,OAAM1d,EAAM3N,SAAW,OAAS,WAAY,EAC7C,MAEF,KC5CN,I,MAAM+T,GAAM+qB,EAAM,uBAEZrT,GAAcvkB,EAAOvE,IAAG,yEAIxB+oB,GAAiBxkB,EAAOvE,IAAG,yNAQ3B4I,GAAc,SAAArI,GAClB6Q,GAAI,eACJ7Q,EAAEmS,iBACFnS,EAAEC,mBAEJ,SAAgByoB,GAAa/oB,GACnB,IAMJgpB,EANI9lB,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUuS,EAAA,EAAAA,OAC/Bta,EAAW6I,EAAMI,oBAAsBlB,EACvCknB,EAAS/lB,EAAWC,IAAI,2BAA0B,OACnDnD,GAAK,CACRhG,SAAQ,KAGV,GAAIA,EACFgvB,EAAQC,MACH,CACL,IAAI,EAOA,EAAO,CAAEtX,MAAO,GAAIG,OAAQ,IAC1BsX,EAAY9U,EAAO,kBAAkBvS,GACvCqnB,IAAW,EAAOA,EAAUxN,yBAChC,IAQM,EAAwB,IAAIsgB,GARJ,SAC5B3qB,EACAC,GAEA,IAAMtV,EAAIqV,EAAQ,GAAGU,YACrB,EAAQrU,MAAMiV,MAAQ,EAAKlB,MAAQzV,EAAEyV,OAAS,EAAI,KAClD,EAAQ/T,MAAMkV,KAAO,EAAKhB,OAAS5V,EAAE4V,QAAU,EAAI,QAGrDZ,GAAI,GACJ8X,EACEtkB,gCACEA,uBAAK9G,MAAO,CAAE+T,MAAO,EAAKA,MAAOG,OAAQ,EAAKA,UAE9CpN,gBAACmkB,GAAc,CAAC5nB,IAvBD,SAAAA,GACbA,IACF,EAAUA,EACV,EAAsBmR,QAAQ,MAoBI6W,IAIxC,OACEvkB,gBAACkkB,GAAW,CAACjG,YAAaja,GAAaoa,WAAYpa,IAChDsgB,GCvDP,I,SAAM9X,GAAM+qB,EAAM,6BAMZlT,GAAe1kB,EAAOvE,IAAG,8HAAmB,qHAQ5C6pB,GAA2BtlB,EAAOvE,IAAG,yEAa3C,eACE,WAAYE,GAAZ,MACE,YAAMA,IAAM,K,OAMd,EAAA6pB,YAAc,SAAAjH,GACZ,EAAKzf,IAAI,uBAAsB,OAAO,EAAKnD,OAAK,CAAE4iB,GAAE,MAGtD,EAAAE,WAAa,SAAAF,GAEXA,EAAGpQ,kBAGL,EAAAmQ,YAAc,SAAAC,GACZ1R,GAAI,cAAe,EAAKlR,MAAM+B,UAC9B,EAAKoB,IAAI,uBAAsB,OAAO,EAAKnD,OAAK,CAAE4iB,GAAE,EAAEtE,QAAS,SAGjE,EAAAuE,YAAc,SAAAD,GACZ,EAAKzf,IAAI,uBAAsB,OAAO,EAAKnD,OAAK,CAAE4iB,GAAE,EAAEtE,QAAS,SAGjE,EAAAyE,OAAS,SAAAH,GACP1R,GAAI,UACJ,EAAK/N,IAAI,kBAAiB,OAAO,EAAKnD,OAAK,CAAE4iB,GAAE,EAAEtE,QAAS,SAyB5D,EAAAxZ,QAAU,SAAA8d,GACR,IACQ1f,EADM,EAAKlD,MACXkD,WAER,EAAK4mB,wBAA0BC,YAAW,WAIxC7mB,EAAWC,IAAI,mBAAkB,OAAO,EAAKnD,OAAK,CAAE4iB,GAAE,OACrD,MAGL,EAAAoH,cAAgB,SAAApH,GACdqH,aAAa,EAAKH,yBACV,QAAA5mB,WACGC,IAAI,yBAAwB,OAAO,EAAKnD,OAAK,CAAE4iB,GAAE,MAG9D,EAAAsH,gBAA0B,EA6B1B,EAAA3B,gBAAkB,SAAAloB,GAChBA,EAAEC,kBACI,cAAEyB,EAAA,EAAAA,SAAUuS,EAAA,EAAAA,OAClB,EAAK4V,gBAAiB,EACtB,IACMnP,EADezG,EAAO0D,GAAejW,IACjB6Z,wBAC1B1K,GAAI,UAAW6J,GACf,EAAKoP,sBAAwB,CAC3BpP,EAAKlI,KAAOkI,EAAKpJ,MAAQ,EACzBoJ,EAAKjI,IAAMiI,EAAKjJ,OAAS,GAE3BZ,GAAI,wBAAyB,EAAKiZ,uBAKlC,EAAKrZ,UAAUnY,SAAOwU,gBAAiB,EAAKnN,QAjH5C,EAAKG,MAAQ,CACXiqB,WAAW,G,EAiKjB,OArKwC,OA+B/B,YAAAC,kBAAP,WACU,IAAAnnB,EAAA,WAAAA,WACR,GACGA,EAAWkE,SAASC,GAAQsR,2BAA0B,KAClD5f,KAAKiH,QASZ,OAJAjH,KAAK+X,UAAUnY,SAAOsM,YAAW,OAC5BlM,KAAKiH,OAAK,CACb5B,UAAW1F,YAAUyd,cAEhBjT,EAAWC,IAAI,yBAA0BpK,KAAKiH,QAGhD,YAAAsqB,mBAAP,aA2BA,YAAAvE,mBAAA,WACE,GAAIhtB,KAAKmxB,eAAgB,CACjB,iBAAE5V,EAAA,EAAAA,OAAQvS,EAAA,EAAAA,SAAUkR,EAAA,EAAAA,sBAEpBsX,EADUjW,EAAO0D,GAAejW,IACd6Z,wBAKlB4O,EAAY,CAChBD,EAAQ1X,KAAO0X,EAAQ5Y,MAAQ,EAC/B4Y,EAAQzX,IAAMyX,EAAQzY,OAAS,GAEjCZ,GAAI,aAAcsZ,GAClBtZ,GAAI,aAAcnY,KAAKoxB,uBAEvB,IAAMM,EAAS,CACbD,EAAU,GAAKzxB,KAAKoxB,sBAAsB,GAC1CK,EAAU,GAAKzxB,KAAKoxB,sBAAsB,IAE5CjZ,GAAI,SAAUuZ,GACdxX,EAAsBwX,EAAO,GAAIA,EAAO,IACxC1xB,KAAKmxB,gBAAiB,IAuB1B,YAAApoB,OAAA,WACE,IAAM9B,EAAQjH,KAAKiH,MACXgB,EAAA,EAAAA,QAASe,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WAAYwkB,EAAA,EAAAA,WAAYxP,EAAA,EAAAA,IAC1DhH,GAAI,SAAUnP,EAAUc,EAAMzE,WAC9B,IAAMssB,EACJxnB,EAAWC,IAAI,qBAAsBnD,IACrC6C,EAAMI,oBAAsBlB,EACxB4oB,EAAeznB,EAAWC,IAAI,0BAAyB,OACxDnD,GAAK,CACRuoB,gBAAiBxvB,KAAKwvB,gBAAgBnmB,KAAKrJ,SAEvC6xB,EAAe1nB,EAAWC,IAAI,sBAAqB,OACpDnD,GAAK,CACRse,QAAS,UAELuM,EAAe3nB,EAAWC,IAAI,sBAAqB,OACpDnD,GAAK,CACRse,QAAS,UAELwM,EAAoB,CACxBnI,YAAa5pB,KAAK4pB,YAClBE,YAAa9pB,KAAK8pB,YAClBC,WAAY/pB,KAAK+pB,WACjBC,OAAQhqB,KAAKgqB,QAGf,OACEre,gBAACilB,GAAwB,KACtBiB,EACDlmB,gBAACqkB,GAAY,GACXnrB,MAAO8pB,EACPgD,UAAWA,EACXzpB,IAAKD,EAAQ2W,GAAc5V,IAC3B8nB,YAAa9wB,KAAK8wB,YAClB/kB,QAAS/L,KAAK+L,QACdklB,cAAejxB,KAAKixB,eAChBc,GAEH5nB,EAAWC,IAAI,oBAAqBnD,GACpCkD,EAAWC,IAAI,2BAA4BnD,IAE7C6qB,EACA3S,IAAQglB,iBAAetV,MAAQ+C,IAjK3Bf,EAAkB,GAD9ByT,qBACYzT,GAAb,CAAwC/Y,GC5BlCK,GAAM+qB,EAAM,mBAEZjR,GAAwB3mB,EAAOvE,IAAG,iEAIxC,SAAgBmrB,GAAUjrB,GAChB,IAAAkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUuS,EAAA,EAAAA,OAC/B4W,EAAYroB,EAAMY,iBAAmB1B,EAC3CmP,GAAI,YAAaga,GACjB,IAQMhc,EAAOrM,EAAMC,SAASf,GAAUgB,SAAStK,YAAUwlB,MACzD,IACGiN,GACDhoB,EAAWC,IAAI,eAAc,OAAOnD,GAAK,CAAEnD,MAAOqS,EAAKrS,SAEvD,OAAO,KACT,IAAMsuB,EAAajoB,EAAWC,IAAI,wBAAyBnD,GACrDorB,EAAc9W,EAAO6D,GAAOC,kBAC5Bxa,EAAQ,CACZytB,SAAU,QACVC,UAAW,SAEb,GAAIF,EAAa,CACf,IAAMG,EAAQH,EAAYxP,wBAC1Bhe,EAAMytB,SAA4B,GAAdE,EAAM5Z,MAAW,KACrC/T,EAAM0tB,UAA8B,GAAfC,EAAMzZ,OAAY,KAEzC,IAgBM1I,EAAe,CACnB9G,WAAW,EACX9E,QAjBAkH,gBAACsmB,GAAqB,CACpBlmB,QAAS4D,GACT8iB,UAAWyR,UAAQxR,gBACnB7tB,MAAOA,GAENutB,GAaHtqB,OATA6D,gBAACyE,GAAc,CACbrE,QApCY,SAAAzE,GACdA,EAAEC,kBACF4C,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOikB,uBAiCf7T,UAAWC,GAAc2N,GAASI,OAClC9N,UAAW,IAObI,gBAAiBC,yBAAuBoiB,MACxCliB,eAAgB,KAIlB,OADiB0F,EAAKrS,OAAS6H,gBAAC+E,UAAO,KAAKL,IC5D9C,I,2BAAMgjB,GAAoB/nB,EAAOud,IAAG,yQAcpC,0E,OACE,EAAAzhB,MAAQ,CACN3C,QAAS,M,EA8Cb,OAhDoC,OAKlC,YAAAskB,OAAA,WACQ,iBAAExN,EAAA,EAAAA,OAAQzR,EAAA,EAAAA,MAAOvE,EAAA,EAAAA,WACjBH,EAAW0E,EAAM1E,SACjBC,EAAYyE,EAAMzE,UACxB,GAAKD,GAAYC,IAAc1F,YAAUsd,gBAAzC,CAMA,IAAMxY,EAAU8W,EAAOqD,GAAcxZ,IAC/B6T,EAAUsC,EAAO6D,GAAOE,wBAAwBrG,QAChD4P,EAAMtN,EAAO6D,GAAOG,mBACpBrG,EAAc4oB,GAAgBr9B,EAASwU,EAAS1T,GAChD0jB,EAAU6Y,GAAgBjZ,EAAK5P,EAAS1T,GAExC8c,EAAInJ,EAAYY,KAAOmP,EAAQnP,KADrB,EAEVyI,EAAIrJ,EAAYa,IAAMkP,EAAQlP,IAFpB,EAGVnB,EAAQM,EAAYN,MAAQ,EAC5BG,EAASG,EAAYH,OAAS,EACpC/Y,KAAKsI,SAAS,CACZ7D,QACEkH,wBACE0W,EAAGA,EACHE,EAAGA,EACH3J,MAAOA,EACPG,OAAQA,EACR/F,KAAK,OACLkW,OAAQpf,EAAM7E,OAAO5D,MAAMI,eAC3B2nB,YAAa,WAxBjBppB,KAAKsI,SAAS,CACZ7D,QAAS,QA6Bf,YAAAsE,OAAA,WACU,IAAAd,EAAA,WAAAA,QACR,OACE0D,gBAAC0nB,GAAiB,CAACnrB,IAAKD,EAAQmX,GAAOG,oBACpCvf,KAAKoH,MAAM3C,UAIpB,EAhDA,CAAoCqT,GCJ9Byb,GAAgBjoB,EAAOud,IAAG,yQAU1B1Q,GAAM+qB,EAAM,wBAQlB,0E,OACE,EAAA97B,MAAQ,CACNymB,OAAQ,I,EAgHZ,OAlHmC,OAIjC,YAAA9E,OAAA,WACE,IAeI5G,EAAWC,EAAWsR,EAfpBzsB,EAAQjH,KAAKiH,MACX6C,EAAA,EAAAA,MAAOyR,EAAA,EAAAA,OAAQvS,EAAA,EAAAA,SAAUmW,EAAA,EAAAA,IAAKhV,EAAA,EAAAA,WAChCwpB,EAAIxpB,EAAWC,IAAI,gBAAiBnD,GACpC8K,EAAQjI,EAAMC,SAASf,GACvBvE,EAAU8W,EAAOqD,GAAc5V,IAC/B6f,EAAMtN,EAAOyD,GAAehW,IAC5B4oB,EAAerW,EAAO0D,GAAejW,IACrCiQ,EAAUsC,EAAO6D,GAAOE,wBAAwBrG,QAChDgQ,EAAU6Y,GAAgBjZ,EAAK5P,EAAS0a,GACxCC,EAAekO,GAAgBlQ,EAAc3Y,EAAS0a,GACtDza,EAAc4oB,GAAgBr9B,EAASwU,EAAS0a,GACtDxb,GAAInP,GACJmP,GAAI,UAAW8Q,GACf9Q,GAAI,eAAgByb,GACpBzb,GAAI,cAAee,GAGfiG,IAAQglB,iBAAe7U,OACzBnN,EAAK,CACHE,EAAG,EACHE,EAAGR,GAAQ7I,GAAe+P,EAAQlP,KAEpCqI,EAAK,CACHC,EAAGuR,EAAapS,MAAQyH,EAAQnP,KAAO,GACvCyI,EAAGJ,EAAGI,IAECpD,IAAQglB,iBAAe9V,OAChClM,EAAK,CACHE,EAAG4G,EAAQzH,MAAQyH,EAAQnP,KAC3ByI,EAAGR,GAAQ7I,GAAe+P,EAAQlP,KAEpCqI,EAAK,CACHC,EAAGuR,EAAa9Z,KAAOmP,EAAQnP,KAAO,GACtCyI,EAAGJ,EAAGI,IAGV,IAAMsL,EAAS,GAEf9b,EAAM7N,QAAQgJ,SAAQ,SAAA/M,GACpB,IAAI2tB,EACEhsB,EAAYqI,EAAWC,IAAI,eAAc,OAC1CnD,GAAK,CACR+B,SAAU7I,KAGN0zB,EAAatY,EAAOqD,GAAcze,IACxC,GAAK0zB,EAAL,CACA,IAAM7R,EAAO8f,GAAgBjO,EAAY5a,EAAS0a,GAE9CxU,IAAQglB,iBAAe7U,QACzBoE,EAAK,CACHrR,EAAGL,EAAKlI,KAAOmP,EAAQnP,KACvByI,EAAGR,GAAQC,GAAQiH,EAAQlP,MAG3BoF,IAAQglB,iBAAe9V,OACzBqF,EAAK,CACHrR,EAAGL,EAAKR,MAAQyH,EAAQnP,KACxByI,EAAGR,GAAQC,GAAQiH,EAAQlP,MAGvB,IAAA/X,EAAA,EAAAA,SAER,GAAiB,UAAbA,EACF8rB,EAAQ,KAAK3L,EAAGE,EAAC,IAAIF,EAAGI,EAAC,MAAMH,EAAGC,EAAC,IAAID,EAAGG,EAAC,MAAMH,EAAGC,EAAC,IAAIC,GACvDF,EACAsR,GACD,IAAIxR,GAAaE,EAAIsR,GAAG,IAAIA,EAAGnR,EAAC,IAAImR,EAAGrR,EAAC,IAAIqR,EAAGnR,OAC3C,GAAiB,UAAbvgB,EAAsB,CAC/B,IAAM+rB,EAAO2F,EAAGnR,EAAIJ,EAAGI,EAAI,GAAK,EAC1ByL,EAAO0F,EAAGrR,EAAIF,EAAGE,EAAI,GAAK,EAC1B4L,EAASnsB,EAAUC,WAGvB+rB,EADyB,IAAvB/b,EAAM7N,QAAQ4L,MAAc1M,KAAK0wB,IAAIJ,EAAGnR,EAAIJ,EAAGI,IAAM,EAC/C,KAAKJ,EAAGE,EAAC,IAAIF,EAAGI,EAAC,MAAMmR,EAAGrR,EAAC,IAAIqR,EAAGnR,EAGlC,KAAKJ,EAAGE,EAAC,IAAIF,EAAGI,EAAC,MAAMH,EAAGC,EAAC,OAAMqR,EAAGnR,EAC1CwL,EAAOE,GAAM,MAAMA,EAAM,IAAIA,EAAM,SACnCF,EAAOC,IAAS,EAAI,EAAI,GAAC,KACvB5L,EAAGC,EAAI4L,EAASD,GAAI,IAAI0F,EAAGnR,EAAC,MAAMmR,EAAGrR,MAErB,SAAbrgB,IACT8rB,EAAQ,KAAK3L,EAAGE,EAAC,IAAIF,EAAGI,EAAC,MAAMH,EAAGC,EAAC,MAAMqR,EAAGrR,EAAC,IAAIqR,EAAGnR,GAGtDsL,EAAOvgB,KACL3B,wBACExL,IAAK,QAAQA,EACbsF,EAAGqoB,EACH1E,YAAatnB,EAAUG,UACvBinB,OAAQpnB,EAAUS,UAClByQ,KAAK,cAIXhT,KAAKsI,SAAS,CACZulB,OAAM,KAIV,YAAA9kB,OAAA,WACQ,iBAAEC,EAAA,EAAAA,SAAUf,EAAA,EAAAA,QAClB,OACE0D,gBAAC4nB,GAAa,CAACrrB,IAAKD,EAAQ+W,GAAehW,KACzC2C,yBAAI3L,KAAKoH,MAAMymB,UAIvB,EAlHA,CAAmC/V,GC3B7BK,GAAM+qB,EAAM,qBAMZlP,GAAO1oB,EAAOvE,IAAG,oFAAW,iEAIuC,UADrD,SAAAE,GAChB,OAAAA,EAAMmnB,iBAAmB+V,iBAAe7U,MAAQ,MAAQ,iBAStD2E,GAAe3oB,EAAOvE,IAAG,0DAAmB,uCAKhB,UAHrB,SAAAE,GACT,OAAAA,EAAMkY,MAAQglB,iBAAe7U,MACzB,SAASroB,EAAMvF,QAAO,KACtB,KAAKuF,EAAMvF,QAAO,YAOpBwyB,GAAY5oB,EAAOvE,IAAG,6GAAgB,0FAM6B,UADrD,SAAAE,GAChB,OAAAA,EAAMmnB,iBAAmB+V,iBAAe7U,MAAQ,MAAQ,iBAQ5D,4B,+CAqDA,OArDiC8T,OAC/B,YAAAhP,gBAAA,WACE,IAAMntB,EAAQjH,KAAKiH,MACXkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUmW,EAAA,EAAAA,IAC/Bpa,EAAS+E,EAAMC,SAASf,GAAU9E,QAAQ6I,UAC1CE,EAAM9C,EAAWC,IAAI,kBAAiB,OAAOnD,GAAK,CAAElC,OAAM,KAChE,IAAKkI,EAAK,OAAO,KACT,IAAAwhB,EAAA,EAAAA,UACF4F,EAAWlqB,EAAWC,IAAI,iBAAkBnD,GAClD,OACE0E,gBAACsoB,GAAY,CAAC9U,IAAKA,EAAKzd,QAASoI,EAAM7E,OAAO5D,MAAMK,SACjD+sB,E,IAAY4F,IAanB,YAAAC,YAAA,WACQ,iBAAE/Y,EAAA,EAAAA,OAAQvS,EAAA,EAAAA,SACV+I,EADoB,EAAAjI,MACNC,SAASf,GAC7B,GAA2B,IAAvB+I,EAAM7N,QAAQ4L,OAAciC,EAAM3N,SAAtC,CACA+T,GAAI,cAAenP,GACnB,IAAMurB,EAAuBhZ,EAAOwD,GAAY/V,IAChDurB,GAASA,EAAMxL,WAGjB,YAAAhgB,OAAA,WACE,IAAM9B,EAAQjH,KAAKiH,MACXkD,EAAA,EAAAA,WAAYnB,EAAA,EAAAA,SAAUmW,EAAA,EAAAA,IAAKlX,EAAA,EAAAA,QACnCkQ,GAAI,SAAUnP,GACd,IAAM2lB,EAAaxkB,EAAWC,IAAI,uBAAwBnD,GACpDutB,EAAS,OACVvtB,GAAK,CACR0nB,WAAU,IAENC,EAAezkB,EAAWC,IAAI,qBAAsBoqB,GAE1D,OACE7oB,gBAACqoB,GAAI,CAAC5F,eAAgBjP,GACpBxT,gBAACuoB,GAAS,CAAC9F,eAAgBjP,EAAKjX,IAAKD,EAAQ6W,GAAY9V,KACtD4lB,GAEF5uB,KAAKo0B,oBAId,EArDA,CAAiCgP,EAAMA,WC7CjCjrB,GAAM+qB,EAAM,yBAEZxO,GAAappB,EAAOC,GAAPD,CAAc,qWAW3BqpB,GAAQrpB,EAAOoR,EAAPpR,CAAW,6DAInBspB,GAAiBtpB,EAAOsR,KAAI,iJAM5BiY,GAAO,SAAA5tB,GACX,OACE0E,gBAACi4B,UAAO,CACNn/B,QAASwC,EAAM6tB,QACfjJ,SAAU0Y,WAASxP,IACnB/kB,UAAWk0B,UAAQlP,MAEnBrpB,gBAACgpB,GAAK,CAAC5oB,QAAS9E,EAAM8E,QAASmE,UAAW,GACvCjJ,EAAMkU,YAMf,eACE,WAAYlU,GAAZ,MACE,YAAMA,IAAM,K,OAqBd,EAAAiuB,iBAAmB,SAAA3vB,GACjB4S,GAAI,mBAAoB5S,GACxB,EAAK+C,SAAS,CAAE/C,WAAU,KAG5B,EAAA4vB,iBAAmB,SAAA7tB,GACjB,IAAML,EAAQ,EAAKA,MACX,EAAAkD,WACGC,IAAI,gBAAe,OACzBnD,GAAK,CACR1B,WAAY,MAIhB,EAAA6vB,eAAiB,SAAA9tB,GACf,IAAML,EAAQ,EAAKA,MACXkD,EAAA,EAAAA,WACF5E,EAAa4E,EAAWC,IAAI,gBAAiBnD,GACnDkD,EAAWC,IAAI,gBAAe,OACzBnD,GAAK,CACR1B,WAAYA,EAAa,OAI7B,EAAA8vB,iBAAmB,SAAA/tB,GACjB,IAAML,EAAQ,EAAKA,MACXkD,EAAA,EAAAA,WACF5E,EAAa4E,EAAWC,IAAI,gBAAiBnD,GACnDkD,EAAWC,IAAI,gBAAe,OACzBnD,GAAK,CACR1B,WAAYA,EAAa,OAI7B,EAAA+vB,mBAAqB,SAAAhuB,GACnB,IAAML,EAAQ,EAAKA,MACXkD,EAAA,EAAAA,WACRA,EAAWC,IAAI,mBAAkB,OAC5BnD,GAAK,CACR9G,IAAKuf,GAASC,kBACd3D,SAAU,EAAKuZ,gBACfhY,MAAM,KAERpT,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOue,iBAInB,EAAAqX,iBAAmB,SAAAluB,GACjB,IAAML,EAAQ,EAAKA,MACXkD,EAAA,EAAAA,WACRA,EAAWC,IAAI,mBAAkB,OAC5BnD,GAAK,CACR9G,IAAKuf,GAASC,kBACd3D,SAAU,EAAKuZ,gBACfhY,MAAM,KAERpT,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOwe,eAInB,EAAAmX,gBAAkB,WACV,cAAEzrB,EAAA,EAAAA,MAAO,EAAAK,WACJC,IAAI,oBAAmB,OAC7B,EAAKnD,OAAK,CACb+B,SAAUc,EAAM3E,uB,EAkCtB,OA7HoC,OAKlC,YAAAoD,kBAAA,WACE,IAAMtB,EAAQjH,KAAKiH,MACX,EAAAkD,WACGC,IAAI,mCAAkC,OAC5CnD,GAAK,CACR+U,SAAUhc,KAAKk1B,qBAInB,YAAAxsB,qBAAA,WACE,IAAMzB,EAAQjH,KAAKiH,MACX,EAAAkD,WACGC,IAAI,sCAAqC,OAC/CnD,GAAK,CACR+U,SAAUhc,KAAKk1B,qBA4EnB,YAAAnsB,OAAA,WACEoP,GAAI,UACJ,IAAMlR,EAAQjH,KAAKiH,MACXkD,EAAA,EAAAA,WAAYuB,EAAA,EAAAA,OACdnG,EAAa4E,EAAWC,IAAI,gBAAiBnD,GACnD,OACE0E,gBAAC+oB,GAAU,CAAChpB,OAAQA,GAClBC,gBAACkpB,GAAI,CAAC9oB,QAAS/L,KAAKs1B,mBAAoBR,QAAQ,gBAC7C5gB,GAAK0J,GAASO,eAEjBxS,gBAACkpB,GAAI,CAAC9oB,QAAS/L,KAAKw1B,iBAAkBV,QAAQ,cAC3C5gB,GAAK0J,GAASQ,aAEjBzS,gBAACkpB,GAAI,CAAC9oB,QAAS/L,KAAKu1B,gBAAiBT,QAAQ,qBAC1C5gB,GAAK0J,GAASS,SAEjB1S,gBAACkpB,GAAI,CAAC9oB,QAAS/L,KAAKq1B,iBAAkBP,QAAQ,WAC3C5gB,GAAK0J,GAASM,QAEjBvS,gBAACkpB,GAAI,CAAC9oB,QAAS/L,KAAKm1B,iBAAkBL,QAAQ,cAC5CnpB,gBAACipB,GAAc,KAAE,QAAQxxB,KAAKqyB,MACf,IAAblwB,GACD,MAEHoG,gBAACkpB,GAAI,CAAC9oB,QAAS/L,KAAKo1B,eAAgBN,QAAQ,YACzC5gB,GAAK0J,GAASK,SAKzB,EA7HA,CAAoCnG,GCxC9B4d,GAAoBpqB,EAAOvE,IAAG,iLAMpC,SAAgB4uB,GAAa1uB,GACnB,IAAAkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAC3B,GAAIc,EAAMzE,YAAc1F,YAAUwlB,aAAc,CAC9C,IAaMiN,EAAajoB,EAAWC,IAAI,wBAAyBnD,GAC3D,OACE0E,gBAAC64B,SAAM,CACLrkC,IAAI,SACJ6R,MAAM,aACN7B,KAAM+D,GAAK,QACXzF,QAAM,EACNmnB,aAAW,EACXC,cAAe,CAAExuB,YAAasI,IAC9BmmB,oBAAoB,EACpBjnB,QAvBsB,SAAAvH,GACxBA,EAAEC,kBACF,IAAMpH,EAAM,mBAAmB6I,EACzB+sB,EAAW5rB,EAAWC,IAAI,kBAAmB,CAAEjK,IAAG,IACxDgK,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOklB,gBACf9b,SAAQ,EACRsB,UAAW5K,YAAUwlB,KACrBnkB,KAAMg1B,EACN1wB,UAAW1F,YAAUwM,WAcrB2D,KAAK,OAELnE,gBAAC+pB,GAAiB,KAAEtD,KCpC5B,SAAwB4D,GAAM,G,IAAE30B,EAAA,EAAAA,MAAO8Z,EAAA,EAAAA,SACrC,OAEExP,gBAAC84B,gBAAa,CAACpjC,MAAOA,GACpBsK,gBAAC+4B,EAAMA,SAAQ,KAAEvpB,ICavB,I,GAAMhD,GAAM+qB,EAAM,oBAElB,SAAgB/M,KACd,IAMIC,EANEC,EAAc/qB,EAAOvE,IAAG,kKAGiB,qCAA/B,SAAAE,GAAS,OAAAA,EAAM5F,MAAMG,cAIrC,MAAO,CACL80B,gBAAe,WACb,OAAOF,GAETG,cAAa,SAACtvB,GACJ,IAAA6C,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACf,OACEwB,gBAAC2P,EAAO,MACL,SAACrT,EAASsT,EAAQG,GASjB,OARA0a,EAAY,OACPnvB,GAAK,CACRgB,QAAO,EACPsT,OAAM,EACNG,UAAS,IAGXvD,GAAI,gBAAiBrO,GAEnB6B,gBAACqqB,GAAK,CAAC30B,MAAOyI,EAAM7E,OAAO5D,OACzBsK,gBAAC0qB,EAAW,CAACnuB,IAAKD,EAAQmX,GAAOC,mBAC/B1T,gBAAC2gB,GAAoB,KAAK8J,IACzBjsB,EAAWC,IAAI,yBAA0BgsB,SAQxDT,aAAY,GAEZliB,uBAAsB,SAACxM,GACb,IAAAkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MACd4B,EAASvB,EAAWkE,SACxBC,GAAQwG,gCAEJ0hB,EAAM,OACPvvB,GAAK,CACRyE,OAAM,EACN1C,SAAUc,EAAM1E,WAclB,MAAO,CAZa+E,EAAWC,IAAI,8BAA+BosB,GAE5CrsB,EAAWC,IAAI,sBAAuBosB,GAC7CrsB,EAAWC,IAAI,eAAc,OACvCosB,GAAM,CACT9qB,OAAQA,EAAS,KAEJvB,EAAWC,IAAI,eAAc,OACvCosB,GAAM,CACT9qB,OAAQA,EAAS,KAEIvB,EAAWC,IAAI,uBAAwBosB,KAIhEC,4BAA2B,SAACxvB,GAC1B,OAAO0E,gBAAC8f,GAAqB,GAACtrB,IAAI,yBAA4B8G,KAGhEyvB,aAAY,SAACzvB,GACX,OAAO0E,gBAACwhB,GAAM,GAAChtB,IAAI,UAAa8G,KAGlC0vB,YAAW,SAAC1vB,GACV,OAAO,MAGT2vB,oBAAmB,SAAC3vB,GAClB,OAAO,MAGT4vB,UAAS,SAAC,GACR,OADU,EAAA1b,UAIZ2b,iBAAgB,SAAC7vB,GACf,OAAO0E,gBAAC2iB,GAAU,KAAKrnB,KAGzB8vB,kBAAiB,SAAC9vB,GAChB,OAAO0E,gBAACwoB,GAAW,KAAKltB,KAG1B+vB,mBAAkB,SAAC/vB,GACjB,OAAO0E,gBAACklB,GAAkB,KAAK5pB,KAGjCgwB,wBAAuB,SAAChwB,GACtB,OAAO0E,gBAAC4jB,GAAiB,KAAKtoB,KAGhC+N,yBAAwB,SAAC/N,GACvB,MAAO,IAGTiwB,kBAAiB,SAACjwB,GACR,IAAA6C,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUmB,EAAA,EAAAA,WAEnBxG,EADQmG,EAAMC,SAASf,GACRrF,OACfsJ,EAAM,GACR1G,EAAI,EAYR,OAXA5C,EAAOuJ,SAAQ,SAAApJ,GACb,IAAMD,EAAIsG,EAAWC,IAAI,mBAAkB,OACtCnD,GAAK,CACRnD,MAAK,EACLqzB,SAAU,SAAS5wB,KAEjB1C,IACFoJ,EAAIK,KAAK3B,gBAAC+4B,EAAMA,SAAQ,CAACvkC,IAAK,SAASoG,GAAM1C,IAC7C0C,QAGG0G,GAGTmqB,iBAAgB,SAACnwB,GACP,IAAAkD,EAAA,EAAAA,WACR,OADoB,EAAArG,MACNhD,MACZ,KAAKpB,YAAU23B,QACb,OAAOltB,EAAWC,IAAI,0BAA2BnD,GACnD,KAAKvH,YAAUwlB,KACb,OAAO/a,EAAWC,IAAI,uBAAwBnD,GAIlD,OAAO,MAGTqwB,wBAAuB,SAACrwB,GACtB,OAAO0E,gBAACqkB,GAAY,KAAK/oB,KAG3BswB,qBAAoB,SAACtwB,GACnB,OAAO0E,gBAACumB,GAAS,KAAKjrB,KAGxBuwB,eAAc,SAACvwB,GACL,IAAAgB,EAAA,EAAAA,QAASe,EAAA,EAAAA,SACX+I,EADqB,EAAAjI,MACPC,SAASf,GAC7B,OAA2B,IAAvB+I,EAAM7N,QAAQ4L,MAAciC,EAAM3N,SAAiB,KAChDuH,gBAAC8nB,GAAa,GAACvrB,IAAKD,EAAQ8W,GAAY/V,KAAgB/B,KAGjEwwB,mBAAkB,SAACxwB,GAET,IAAAgB,EAAA,EAAAA,QAASe,EAAA,EAAAA,SAIjB,OAAO2C,gBAACiiB,GAAY,GAAC1lB,IAAKD,EAAQ8W,GAAY/V,KAAgB/B,KAGhEywB,yBAAwB,SAACzwB,GACf,IAAAgB,EAAA,EAAAA,QACR,OACE0D,gBAAC2nB,GAAc,GAACprB,IAAKD,EAAQmX,GAAOI,sBAA0BvY,KAIlE0wB,8BAA6B,SAAC1wB,GACpB,IAAAkD,EAAA,EAAAA,WACF5E,EAAa4E,EAAWC,IAAI,gBAAiBnD,GAEnD,OADAA,EAAK,OAAQA,GAAK,CAAE1B,WAAU,IAE5BoG,gCACGxB,EAAWC,IAAI,qBAAsBnD,GACrCkD,EAAWC,IAAI,2BAA4BnD,GAC3CkD,EAAWC,IAAI,0BAA2BnD,KAKjD2wB,qBAAoB,SAAC3wB,GACnB,OAAO0E,gBAACspB,GAAc,GAAC90B,IAAI,oBAAuB8G,MC/LxD,I,MAAM8wB,GAAYzsB,EAAOC,GAAPD,CAAc,2QAS1B0sB,GAAa1sB,EAAOq5B,OAAPr5B,CAAY,uEAU/B,SAAgB2sB,GAAchxB,GACpB,IAAAkD,EAAA,EAAAA,WAAYuB,EAAA,EAAAA,OAAQwsB,EAAA,EAAAA,cAAeC,EAAA,EAAAA,kBACrC,sBAACC,EAAA,KAAQC,EAAA,KAEf,OAAKD,EAWHzsB,gBAACosB,GAAS,CAACrsB,OAAQA,GACjBC,gBAACH,GAAK,KACJG,gBAACgR,EAAS,CACR3M,UAAWC,GAAc2N,GAASE,OAClC/R,QAAS,WAAM,OAAAssB,GAAU,OAG7B1sB,gBAACqsB,GAAU,CAACM,GAAIJ,EAAe9vB,SAAU+vB,GACtChuB,EAAWC,IAAI,0BAA2BnD,KAjB7C0E,gBAACosB,GAAS,CAACrsB,OAAQA,GACjBC,gBAAC8Q,EAAM,CAAC1Q,QAAS,WAAM,OAAAssB,GAAU,KAC/B1sB,gBAAC6Q,EAAY,CAACxM,UAAWC,GAAc2N,GAASC,eCvCnD,I,qBAAMib,GAAextB,EAAOvE,IAAG,+JAMzBgyB,GAAcztB,EAAOsR,KAAI,qFAIzBoc,GAAsB1tB,EAAOvE,IAAG,qPAOhCkyB,GAAe3tB,EAAOytB,GAAPztB,CAAmB,uBAElC4tB,GAAa5tB,EAAOvE,IAAG,+MAOvBoyB,GAAW7tB,EAAOvE,IAAG,2PAME,UAApB,SAAAE,GAAS,OAAAA,EAAMmyB,SAGlBC,GAAa/tB,EAAOvE,IAAG,qK,SCvBpBuyB,GAAaryB,GAC3B,OACE0E,2BACG1E,EAAMkU,SACPxP,gBAACi5B,UAAO,CAAC//B,MAAO,CAAE0X,OAAQ,aAKhC,SAAgBgd,GAAuBtyB,GAI7B,IAAAmyB,EAAA,EAAAA,MAAOI,EAAA,EAAAA,kBACf,OACE7tB,gBAACotB,GAAW,KACVptB,gBAAC+E,UAAO,KACN/E,gBAAC0tB,GAAU,KACT1tB,uBAAKqE,UAAWC,GAAc2N,GAASG,gBACvCpS,gBAACwtB,GAAQ,CAACC,MAAOA,KAEnBztB,2BACEA,gBAACk5B,eAAY,CACXzL,MAAOA,EACPK,iBAAkB,SAAAL,GAAS,OAAAI,EAAkBJ,EAAMM,WAQ/D,SAAgBC,GAAkB1yB,GAIxB,IAAA+K,EAAA,EAAAA,MAAO4nB,EAAA,EAAAA,YACf,OACEjuB,gBAACotB,GAAW,KACVptB,gBAACG,SAAM,CAACC,QAAS6tB,GAAc5nB,IAcrC,SAAgB6nB,GAAwB5yB,GAC9B,QAAA8hB,cAAA,YAAc/W,EAAA,EAAAA,MAAO,0BACvB+nB,EAAY,CAChB3d,cAA0B,MAAX2M,EAAiB,MAAQ,SACxC1M,WAAY,UAEd,OACE1Q,gBAACotB,GAAW,KACVptB,gBAACC,EAAI,KAAKmuB,GACRpuB,gBAAC2Q,EAAM,CAACC,OAAO,aAAavK,GAC5BrG,gBAACm5B,eAAY,KAAKhL,MAM1B,SAAgBE,GAAqB/yB,GAM3B,IAAA4D,EAAA,EAAAA,KAAMwH,EAAA,EAAAA,MAAOI,EAAA,EAAAA,aAAcwnB,EAAA,EAAAA,aAC7BC,EAAW6K,SAAO1zB,SAClB8oB,EAAU,CACd9nB,MAAK,EACLI,aAAY,EACZwnB,aAAY,EACZG,YAAY,GAEd,OACEzuB,gBAACotB,GAAW,KACVptB,gBAACuuB,EAAQ,KAAKC,GACZxuB,gBAACG,SAAM,CAACjB,KAAMA,MAMf,IAAMwvB,GAAa,SAAAC,GAAQ,gBAAC1hB,EAAO,G,IAAEghB,EAAA,EAAAA,YAC1C,OACEjuB,gBAACsI,WAAQ,CAACpJ,KAAM,GAAG+N,EAAQ0hB,EAAQn6B,IAAKyY,EAAO7M,QAAS6tB,MAM/CW,IAFWwK,SAAO1zB,SAEF,EAAO7Q,MAAM,GAAGg6B,SCxGvCD,GAAgB,EAAO/5B,MAAM,GAAGg6B,QAChCE,GAAoB,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,IAC/CC,GAAmB,CAAC,OAAQ,QAAS,SAAU,SAAU,UAE/D,SAAgBC,GAAkB3zB,GACxB,IAAArF,EAAA,EAAAA,aAAci5B,EAAA,EAAAA,gBAmBtB,OACElvB,gBAAC2tB,GAAY,KACX3tB,gBAACmtB,GAAY,eACbntB,2BACEA,gBAACquB,GAAiB,CAChBnvB,KAAM,WACJjJ,EAAaa,YAAcb,EAAaa,YAAc,OAExD4P,MAAOkoB,GACP9nB,aAAc4nB,GAAW,MACzBJ,aA5BwB,SAAA55B,GAE9Bw6B,EAAgB,CAAEp4B,YAAgBpC,EAAK,UA4BnCsL,gBAACquB,GAAiB,CAChBnvB,KAAM,WACJjJ,EAAac,YAAcd,EAAac,YAAc,QAExD2P,MAAOsoB,GACPloB,aAAc4nB,GAAW,IACzBJ,aA/BwB,SAAA55B,GAC9Bw6B,EAAgB,CAAEn4B,YAAarC,OAgC3BsL,gBAACquB,GAAiB,CAChBnvB,KAAM,WAAWjJ,EAAaQ,aAC9BiQ,MAAOqoB,GACPjoB,aAAc4nB,GAAW,MACzBJ,aAjCyB,SAAA55B,GAE/Bw6B,EAAgB,CAAEz4B,aAAiB/B,EAAK,UAiCpCsL,gBAAC4tB,GAAsB,CACrBH,MAAOx3B,EAAak5B,YACpBtB,kBAhCwB,SAAAJ,GAC9ByB,EAAgB,CAAEC,YAAa1B,SCjBnC,IAAM2B,GAAY,CAAC,QAAS,QAAS,QAE/BC,GAAqB,SAACh5B,EAAU,G,IAAE43B,EAAA,EAAAA,YAAa,EAAAqB,UAAW,EAAA7oB,MAC9D,OAAOzG,gBAACsI,WAAQ,CAACpJ,KAAM,GAAG7I,EAAY7B,IAAK6B,EAAU+J,QAAS6tB,KAYhE,SAAgBsB,GAAgBj0B,GAE5B,QAAAk0B,qBAAA,SACA,IAAAC,wBAAA,SACA,IAAAt5B,iBAAA,WACA,IAAAQ,oBAAA,WACA+4B,EAAA,EAAAA,aACAC,EAAA,EAAAA,gBA0BF,OACE3vB,gBAAC2tB,GAAY,KACX3tB,gBAACmtB,GAAY,aACZqC,GACCxvB,gBAACutB,GAAU,CAAC7c,WAAW,UACrB1Q,gBAAC2Q,EAAM,CAACC,OAAO,aAAW,kBAC1B5Q,gBAACquB,GAAiB,CAChBnvB,KAAM,WAAU/I,EAAYA,EAAUG,UAAY,OAClDoQ,MAAOkoB,GACP9nB,aAAc4nB,GAAW,MACzBJ,aAjCoB,SAAA55B,GAC5Bg7B,EAAa,CAAEp5B,UAAc5B,EAAK,UAkC5BsL,gBAACquB,GAAiB,CAChBnvB,KAAM,aAAa/I,EAAUE,SAC7BqQ,MAAO0oB,GACPtoB,aAAcuoB,GACdf,aAnCmB,SAAA55B,GAC3Bg7B,EAAa,CAAEr5B,SAAU3B,OAoCnBsL,gBAAC4tB,GAAsB,CACrBH,MAAOt3B,EAAUS,UACjBi3B,kBAnCoB,SAAAJ,GAC5BiC,EAAa,CAAE94B,UAAW62B,QAsCvBgC,GACCzvB,gBAACutB,GAAU,CAAC7c,WAAW,UACrB1Q,gBAAC2Q,EAAM,CAACC,OAAO,aAAW,cAC1B5Q,gBAACquB,GAAiB,CAChBnvB,KAAM,WAAUvI,EAAeA,EAAaL,UAAY,OACxDoQ,MAAOkoB,GACP9nB,aAAc4nB,GAAW,MACzBJ,aA1CuB,SAAA55B,GAC/Bi7B,EAAgB,CAAEr5B,UAAc5B,EAAK,UA2C/BsL,gBAACquB,GAAiB,CAChBnvB,KAAM,aAAavI,EAAaN,SAChCqQ,MAAO0oB,GACPtoB,aAAcuoB,GACdf,aA5CsB,SAAA55B,GAC9Bi7B,EAAgB,CAAEt5B,SAAU3B,OA6CtBsL,gBAAC4tB,GAAsB,CACrBH,MAAO92B,EAAaC,UACpBi3B,kBA5CuB,SAAAJ,GAC/BkC,EAAgB,CAAE/4B,UAAW62B,S,SChDjBmC,GAAgBt0B,GACtB,IAAArF,EAAA,EAAAA,aAAci5B,EAAA,EAAAA,gBAehBW,EAAwB,CAC5BxpB,MAAO,YACPypB,IAAK,GACLC,IAAK,IACLr7B,MAAOs7B,SAAS/5B,EAAaO,UAC7B0C,MAAO,CACL+T,MAAO,IAETgjB,cAtB2B,SAAAv7B,GAE3Bw6B,EAAgB,CAAE14B,SAAU9B,MAsBxBw7B,EAAuB,CAC3Bh3B,MAAO,CACL+T,MAAO,IAETvY,MAAOuB,EAAaC,YAAc,GAClCuG,SAxB6B,SAAAd,GAE7BuzB,EAAgB,CAAEh5B,WAAYyF,EAAEQ,OAAOzH,UAwBzC,OACEsL,gBAAC2tB,GAAY,KACX3tB,gBAACmtB,GAAY,oBACbntB,gBAACC,EAAI,KACHD,gBAACkuB,GAAuB,KAAK2B,IAC7B7vB,gBAACotB,GAAW,KACVptB,gBAACC,EAAI,CAACyQ,WAAW,UACf1Q,gBAAC2Q,EAAM,CAACC,OAAO,aAAW,gBAC1B5Q,gBAACq5B,aAAU,KAAKnJ,MAGpBlwB,gBAAC4tB,GAAsB,CACrBH,MAAOx3B,EAAaw3B,MACpBI,kBAlCkB,SAAAJ,GACxByB,EAAgB,CAAEzB,MAAK,SCT3B,IAEI0C,GAFE3jB,GAAM+qB,EAAM,qBAIlB,SAAgBlH,GAAY/0B,GAClB,IAAAkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SACrB+I,EAAQjI,EAAMC,SAASf,GACvB6xB,EAAkB,SAAAh2B,GACtBsF,EAAWC,IAAI,uBAAsB,OAAOnD,GAAK,CAAEpC,MAAK,MAgC1D,IAAKiF,EAAM1E,SAAU,OAAO,KAC5B,IAAMxD,EAAkCuI,EAAWC,IACjD,uBACAnD,GAmBIg1B,EAA6C,CACjDn6B,UAjB2BqI,EAAWC,IAAI,eAAgBnD,GAkB1D3E,aAjB8B6H,EAAWC,IAAI,kBAAmBnD,GAkBhEo0B,aAjBmB,SAAAv5B,GACnBqI,EAAWC,IAAI,eAAc,OACxBnD,GAAK,CACRnF,UAAS,MAeXw5B,gBAXsB,SAAAh5B,GACtB6H,EAAWC,IAAI,kBAAiB,OAC3BnD,GAAK,CACR3E,aAAY,OAWV45B,EAAkD,CACtDt6B,aAAY,EACZi5B,gBAAe,GAGjB,OACElvB,gBAACkR,GAAY,KACXlR,gBAACivB,GAAiB,KAAKsB,IACvBvwB,gBAAC4vB,GAAe,KAAKW,IACrBvwB,gBAAC2tB,GAAY,KACX3tB,gBAACmtB,GAAY,mBACbntB,gBAAC4tB,GAAsB,CACrBH,MAAOx3B,EAAaJ,WACpBg4B,kBAvE4B,SAAAJ,GAClCyB,EAAgB,CAAEr5B,WAAY43B,QAyE5BztB,gBAACuvB,GAAe,KAAKe,IACrBtwB,gBAAC2tB,GAAY,KACX3tB,gBAACguB,GAAiB,CAChB3nB,MAAM,oBACN4nB,YA1EiB,WACnB7nB,EAAMlN,OACRsF,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAO8kB,UACf7f,MAAO,WAuEP8G,gBAACguB,GAAiB,CAAC3nB,MAAM,aAAa4nB,YAlEpB,WACtBkC,GAAc3xB,EAAWC,IAAI,gBAAiBnD,GAC9CkR,GAAI2jB,OAiEAnwB,gBAACguB,GAAiB,CAAC3nB,MAAM,cAAc4nB,YA9DpB,WACnBkC,IACF3xB,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAO8kB,UACf7f,MAAOs3B,KAAKC,UAAUN,W,SC/CM70B,GAC1B,IAAAkD,EAAA,EAAAA,WAKR,OACEwB,gBAAC2tB,GAAY,KACX3tB,gBAACotB,GAAW,KACVptB,gBAACG,SAAM,CAACC,QAPoB,SAAAzE,GAChC6C,EAAWC,IAAI,sBAAuBnD,KAMQ,6BDiG3Co1B,CAAoBp1B,IEpG3B,IAAMmxB,GAAS,EAAQ,KAEvB,SAAgBkE,GAAmBr1B,GACzB,IAAArF,EAAA,EAAAA,aAAci5B,EAAA,EAAAA,gBAChBx4B,EAAU+1B,GAAO,UAAWx2B,EAAaS,SAAW,KACpDk6B,EAAc,CAClBxT,OAAQ,IACR0S,IAAK,EACLC,IAAK,GACL72B,MAAO,CACL+T,MAAO,KAGLmB,EAAM4hB,SAASt5B,EAAQ,gBACvBmf,EAAQma,SAASt5B,EAAQ,kBACzBqf,EAASia,SAASt5B,EAAQ,mBAC1ByX,EAAO6hB,SAASt5B,EAAQ,iBACxBwD,EAAI,CACRkU,IAAG,EACHyH,MAAK,EACLE,OAAM,EACN5H,KAAI,GAGA0iB,EAAa,SAAArd,GAAO,gBAAAhS,G,MACxB0tB,EAAgB,CAAEx4B,QAASkf,GAAW,EAAD,KAAM1b,IAAC,OAAGsZ,GAAMhS,EAAC,SAElDsvB,EAAQ,OACTF,GAAW,CACdvqB,MAAO,MACP3R,MAAO0Z,EACP6hB,cAAeY,EAAW,SAEtBE,EAAU,OACXH,GAAW,CACdvqB,MAAO,QACP3R,MAAOmhB,EACPoa,cAAeY,EAAW,WAEtBG,EAAW,OACZJ,GAAW,CACdvqB,MAAO,SACP3R,MAAOqhB,EACPka,cAAeY,EAAW,YAEtBI,EAAS,OACVL,GAAW,CACdvqB,MAAO,OACP3R,MAAOyZ,EACP8hB,cAAeY,EAAW,UAE5B,OACE7wB,gBAAC2tB,GAAY,KACX3tB,gBAACmtB,GAAY,gBACbntB,gBAACutB,GAAU,KACTvtB,gBAACkuB,GAAuB,KAAK4C,IAC7B9wB,gBAACkuB,GAAuB,KAAK6C,IAC7B/wB,gBAACkuB,GAAuB,KAAK8C,IAC7BhxB,gBAACkuB,GAAuB,KAAK+C,MCtDrC,I,GAAME,GAAuBxxB,EAAOvE,IAAG,qGAUvC,SAAgBg2B,GAAiB91B,GACvB,IAAA0nB,EAAA,EAAAA,WAAYqO,EAAA,EAAAA,cACZ,IAAAp7B,oBAAA,WAAmB,IAAAE,iBAAA,WAAgB,IAAAQ,aAErCu4B,EAAkB,SAACj5B,GACvBo7B,EAAc,CAAEp7B,aAAY,KAGxB40B,EAAkC,CACtC50B,aAAY,EACZi5B,gBAAe,GAWXoB,EAAuB,CAC3Bd,eAAe,EACfr5B,UAAS,EACTQ,kBAtByC,WAuBzC+4B,aAZmB,SAACv5B,GACpBk7B,EAAc,CAAEl7B,UAAS,KAYzBw5B,gBATsB,SAACh5B,GACvB06B,EAAc,CAAE16B,aAAY,MAU9B,OACEqJ,gBAACmxB,GAAoB,KACnBnxB,gBAACivB,GAAiB,KAAKpE,IACvB7qB,gBAAC2wB,GAAkB,KAAK9F,IACxB7qB,gBAAC4vB,GAAe,KAAK/E,IACrB7qB,gBAAC2tB,GAAY,KACX3tB,gBAACmtB,GAAY,mBACbntB,gBAAC4tB,GAAsB,CACrBH,MAAOx3B,EAAaJ,WACpBg4B,kBAAmB,SAAAJ,GACjByB,EAAgB,CAAEr5B,WAAY43B,QAIpCztB,gBAACuvB,GAAe,KAAKe,KC3C3B,IAAIgB,GAAQ,SAEZ,SAAgBC,GAAYj2B,GACpB,ICxB4Bk2B,EDwB5B,sBACA,GADC,KAAkB,KACnB,qBAACC,EAAA,KAAiBC,EAAA,KAChBvzB,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACT9I,EAAmByI,EAAM7E,OAAO5D,MAE9Ba,EAAA,EAAAA,UAAWM,EAAA,EAAAA,aAAcG,EAAA,EAAAA,YAE3BkiB,EAAW,SAAAxjB,GACf8I,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOglB,UACfvjB,MAAO4jC,QAAM5jC,OAYXi8B,GC/C4BH,ED+CkB,SAAA57B,GAClDsjB,EAASqgB,QAAM7jC,EAAO,CAAEE,YAAW,MC/C9B,SAACoG,GACN,OAAAw1B,EAASx1B,EAAMG,OAA4BgJ,WD6DvCysB,EAA8C,CAClD5O,WAAYzsB,EACZ86B,cAdwB,SAACn4B,GACzBggB,EAASqgB,QAAM7jC,EAAO,CAAEa,UAAW2C,OAgB/B24B,EAAkB7xB,gBAACoxB,GAAgB,KAAKQ,IAExCE,EAAiD,CACrD9O,WAAYnsB,EACZw6B,cAjB2B,SAACn4B,GAC5BggB,EAASqgB,QAAM7jC,EAAO,CAAEmB,aAAcqC,OAmBlC64B,EAAqB/xB,gBAACoxB,GAAgB,KAAKU,IAE3CE,EAAgD,CACpDhP,WAAYhsB,EACZq6B,cApB0B,SAACn4B,GAC3BggB,EAASqgB,QAAM7jC,EAAO,CAAEsB,YAAakC,OAsBjC+4B,EAAoBjyB,gBAACoxB,GAAgB,KAAKY,IAE1CE,EAAY,CAChBvF,GAAI2E,GACJ9E,kBAAmB,SAAAG,GACjB2E,GAAQ3E,IAINwF,EACJnyB,gBAACqtB,GAAmB,KAClBrtB,gBAACg5B,OAAI,KAAK9G,GACRlyB,gBAACw5B,MAAG,CAAC7M,GAAG,SAAStmB,MAAM,cAAc+rB,MAAOH,IAC5CjyB,gBAACw5B,MAAG,CAAC7M,GAAG,UAAUtmB,MAAM,eAAe+rB,MAAOL,IAC9C/xB,gBAACw5B,MAAG,CAAC7M,GAAG,OAAOtmB,MAAM,YAAY+rB,MAAOP,MAoBxCQ,EAAa,CACjBvvB,OAAQ2uB,EACRvuB,QAAS,SAAAvH,GACP+1B,GAAmB,KAGjBY,EACJtyB,gBAACmD,QAAK,KAAKkvB,GACTryB,+CAIJ,OACEA,gBAACkR,GAAY,KACXlR,gBAAC2tB,GAAY,KACX3tB,gBAACmtB,GAAY,eACbntB,gBAACutB,GAAU,KACTvtB,gBAACstB,GAAY,oBACbttB,gBAAC4tB,GAAsB,CACrBH,MAAO/3B,EAAMG,WACbg4B,kBAjG0B,SAAAh4B,GAClCqjB,EAASqgB,QAAM7jC,EAAO,CAAEG,WAAU,QAkG5BmK,gBAACstB,GAAY,mBACbttB,gBAAC4tB,GAAsB,CACrBH,MAAO/3B,EAAMI,eACb+3B,kBAlGyB,SAAA/3B,GACjCojB,EAASqgB,QAAM7jC,EAAO,CAAEI,eAAc,QAmGhCkK,gBAACstB,GAAY,sBACbttB,gBAACuF,EAAc,CACbJ,QAASzP,EAAME,YACf6G,SAAUk1B,MAIfQ,EAEDnyB,gBAAC2tB,GAAY,KACX3tB,gBAACguB,GAAiB,CAChB3nB,MAAM,eACN4nB,YAtDkB,SAAAtyB,GAGxB+Y,GADa8b,KAAKC,UAAU/6B,GACF,4BAqDtBsK,gBAACguB,GAAiB,CAChB3nB,MAAM,eACN4nB,YArDkB,SAAAtyB,GACxBiZ,GAAgB,cAAc2d,MAAK,SAAA/c,GACjC,IAAM9a,EAAe81B,KAAKgC,MAAMhd,GAC3BikB,cAAY/+B,GAIjBwe,EAASxe,GAHPg3B,GAAmB,UA+DpBY,G,SEtKSG,KACd,IAAIlG,EAAgB,cACdC,EAAoB,SAAA8E,GACxB/E,EAAgB+E,GAElB,MAAO,CACLoB,oBAAA,SAAoBp3B,GAClB,IAAMuvB,EAAM,OACPvvB,GAAK,CACR9G,IAAK,kBACL+3B,cAAa,EACbC,kBAAiB,IAEnB,OAAOxsB,gBAACssB,GAAa,KAAKzB,KAG5B8H,wBAAuB,SAACr3B,GACd,IAAAkD,EAAA,EAAAA,WAIR,MAAO,CAHgBA,EAAWC,IAAI,yBAA0BnD,GACzCkD,EAAWC,IAAI,oBAAqBnD,KAK7Ds3B,uBAAsB,SAACt3B,GACrB,IAAMu3B,EAAS,CACblG,GAAI,cACJn4B,IAAK,cACL6R,MAAO,aACP+rB,MAAOpyB,gBAACqwB,GAAW,KAAK/0B,KAE1B,OAAO0E,gBAACw5B,MAAG,KAAK3G,KAGlBC,kBAAiB,SAACx3B,GAChB,IAAMu3B,EAAS,CACblG,GAAI,eACJn4B,IAAK,eACL6R,MAAO,QACP+rB,MAAOpyB,gBAACuxB,GAAW,KAAKj2B,KAE1B,OAAO0E,gBAACw5B,MAAG,KAAK3G,MCjDtB,IAAMrmB,GAAM+qB,EAAM,gBAClB,SAAgBvE,KACd,IAAMC,EAAe,IAAInyB,IACnBoyB,EAAmB,IAAIpyB,IAC7B,MAAO,CACLqyB,2BAA0B,SAAC73B,GACjB,IAAA9G,EAAA,EAAAA,IAAK6b,EAAA,EAAAA,SACR6iB,EAAiB/xB,IAAI3M,IACxB0+B,EAAiBjxB,IAAIzN,EAAK,IAE5B0+B,EAAiBz+B,IAAID,GAAKmN,KAAK0O,IAGjC+iB,8BAA6B,SAAC93B,GACpB,IAAA9G,EAAA,EAAAA,IAAK6b,EAAA,EAAAA,SACT6iB,EAAiB/xB,IAAI3M,KACvB0+B,EAAiB1+B,GAAO0+B,EACrBz+B,IAAID,GACJmS,QAAO,SAAA0sB,GAAK,OAAAA,IAAMhjB,OAIzBijB,aAAY,SAACh4B,GACH,IAAA9G,EAAA,EAAAA,IAER,OADAgY,GAAI,eAAgBhY,GACby+B,EAAax+B,IAAID,IAG1B++B,aAAY,SAACj4B,G,QACH9G,EAAA,EAAAA,IAAKE,EAAA,EAAAA,MAGb,GAFA8X,GAAI,eAAgBhY,GACpBy+B,EAAahxB,IAAIzN,EAAKE,GAClBw+B,EAAiB/xB,IAAI3M,GAAM,CAC7B,IAAM0b,EAAYgjB,EAAiBz+B,IAAID,G,IACvC,IAAuB,QAAA0b,GAAS,8BAAE,EAChCG,EADiB,SACR3b,I,oGAKf8+B,gBAAe,SAACl4B,GACN,IAAA9G,EAAA,EAAAA,IACRgY,GAAI,kBAAmBhY,GACvB,IAAME,EAAQu+B,EAAax+B,IAAID,GAE/B,OADAy+B,EAAatvB,OAAOnP,GACbE,ICpCb,IAAM8X,GAAM+qB,EAAM,sBAElB,SAAgB7D,KACd,IAAMC,EAAW,IAAI7yB,IACjB8yB,EAAa,EACjB,MAAO,CACLC,cAAA,SAAcv4B,GACJ,IAAAkD,EAAA,EAAAA,WACR,MAAO,CACLvI,aAAcuI,EAAWC,IAAI,uBAAwBnD,GACrDnF,UAAWqI,EAAWC,IAAI,eAAgBnD,GAC1C3E,aAAc6H,EAAWC,IAAI,kBAAmBnD,KAIpDw4B,qBAAA,SAAqBx4B,GACX,IAAA+B,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACzBgO,GAAI,wBAAyBnP,EAAUc,GACvC,IAEI41B,EAFEC,EAAc71B,EAAM81B,oBAAoB52B,GACxC3H,EAAQyI,EAAM7E,OAAO5D,MAS3B,GAP2Cq+B,EAAvCC,IAAgB0F,mBAAiBxF,KAAmBx+B,EAAMa,UACrDy9B,IAAgB0F,mBAAiBvF,QAC3Bz+B,EAAMmB,aACHnB,EAAMsB,YAExB+8B,EAAU,OAAQr+B,EAAMO,cAAiB89B,EAAW99B,cAEhDP,EAAME,YAAa,CACrB,IAAMA,EAAc4I,EAAWC,IAAI,iBAAkBnD,GACrDy4B,EAAU,OACLA,GAAU,CACbl+B,WAAYD,EACZu5B,YAAav5B,EACbe,aAAa,EAAD,KACPo9B,EAAWp9B,cAAY,CAC1BC,UAAWhB,MAIjB,IAAMwQ,EAAQjI,EAAMC,SAASf,GAC7B,IAAK+I,EAAMlN,MACT,OAAO66B,EAET,IAAMK,EAAc5D,KAAKgC,MAAMpsB,EAAMlN,OAErC,OAAO,EAAP,KACK66B,GACAK,EAAYn+B,eAInBo+B,aAAA,SAAa/4B,GACH,IAAA+B,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACzBgO,GAAI,eAAgBnP,GACpB,IAGIi3B,EAHEN,EAAc71B,EAAM81B,oBAAoB52B,GACxC3H,EAAmByI,EAAM7E,OAAO5D,MAClCS,EAAuBT,EAAMS,UAG/Bm+B,EADEN,IAAgB0F,mBAAiBxF,KACrBx+B,EAAMa,UAAUJ,UACvB69B,IAAgB0F,mBAAiBvF,QAC1Bz+B,EAAMmB,aAAaV,UAChBT,EAAMsB,YAAYb,UAErCA,EAAS,OAAQA,GAAcm+B,GAE/B,IAAMluB,EAAQjI,EAAMC,SAASf,GAE7B,GAAuB,MAAnB+I,EAAM/N,UAAmB,CAC3B,IAAMk8B,EAAqB/1B,EAAWC,IAAI,kBAAiB,OACtDnD,GAAK,CACR+B,SAAU+I,EAAM/N,aAGlBlC,EAAS,OACJA,GACAo+B,GAIP,IAAKnuB,EAAMlN,MACT,OAAO/C,EAET,IAAMi+B,EAAc5D,KAAKgC,MAAMpsB,EAAMlN,OAErC,OAAO,EAAP,KACK/C,GACAi+B,EAAYj+B,YAInBq+B,gBAAA,SAAgBl5B,GACN,IAAA+B,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACzBgO,GAAI,eAAgBnP,GACpB,IAGIi3B,EAHEN,EAAc71B,EAAM81B,oBAAoB52B,GACxC3H,EAAQyI,EAAM7E,OAAO5D,MACvBiB,EAAejB,EAAMS,UAGvBm+B,EADEN,IAAgB0F,mBAAiBxF,KACrBx+B,EAAMa,UAAUI,aACvBq9B,IAAgB0F,mBAAiBvF,QAC1Bz+B,EAAMmB,aAAaF,aAChBjB,EAAMsB,YAAYL,aAErCA,EAAY,OAAQA,GAAiB29B,GAErC,IAAMluB,EAAQjI,EAAMC,SAASf,GAE7B,GAAI3H,EAAME,YAAa,CACrB,IAAMA,EAAc4I,EAAWC,IAAI,iBAAkBnD,GACrDkR,GAAI5W,GACJe,EAAY,OACPA,GAAY,CACfC,UAAWhB,IAIf,IAAKwQ,EAAMlN,MACT,OAAOvC,EAET,IAAMy9B,EAAc5D,KAAKgC,MAAMpsB,EAAMlN,OAOrC,OALS,OACJvC,GACAy9B,EAAYz9B,eAMnB89B,qBAAoB,SAACn5B,GACX,IAAA+B,EAAA,EAAAA,SAAUmB,EAAA,EAAAA,WAAYtF,EAAA,EAAAA,MAExB8pB,EAF+B,EAAA7kB,MACjBC,SAASf,GACJnE,MACnBw7B,EAAW1R,EAAawN,KAAKgC,MAAMxP,GAAc,GACjD2R,EAAW,OACZD,GAAQ,CACXz+B,aAAa,EAAD,KACPy+B,EAASz+B,cACTiD,KAGP,IAAKygC,UAAQjF,EAAUC,GAAc,CACnC,IAAMC,EAAcpE,KAAKC,UAAUkE,GACnCn2B,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAO8kB,UACf7f,MAAO07B,OAKblF,aAAY,SAACp0B,GACH,IAAA+B,EAAA,EAAAA,SAAUmB,EAAA,EAAAA,WAAYrI,EAAA,EAAAA,UAExB+C,EAFmC,EAAAiF,MACrBC,SAASf,GACTnE,MACdw7B,EAAWx7B,EAAQs3B,KAAKgC,MAAMt5B,GAAS,GACvCy7B,EAAW,OACZD,GAAQ,CACXv+B,UAAU,EAAD,KACJu+B,EAASv+B,WACTA,KAGP,IAAKwjC,UAAQjF,EAAUC,GAAc,CACnC,IAAMC,EAAcpE,KAAKC,UAAUkE,GACnCn2B,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAO8kB,UACf7f,MAAO07B,OAKbjF,gBAAe,SAACr0B,GACN,IAAA+B,EAAA,EAAAA,SAAUmB,EAAA,EAAAA,WAAY7H,EAAA,EAAAA,aAExBuC,EAFsC,EAAAiF,MACxBC,SAASf,GACTnE,MACdw7B,EAAWx7B,EAAQs3B,KAAKgC,MAAMt5B,GAAS,GACvCy7B,EAAW,OACZD,GAAQ,CACX/9B,aAAa,EAAD,KACP+9B,EAAS/9B,cACTA,KAGP,IAAKgjC,UAAQjF,EAAUC,GAAc,CACnC,IAAMC,EAAcpE,KAAKC,UAAUkE,GACnCn2B,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAO8kB,UACf7f,MAAO07B,OAKbC,mBAAA,SAAmBv5B,GACT,IAAA+B,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MACZ61B,EAAc71B,EAAM81B,oBAAoB52B,GACxC3H,EAAQyI,EAAM7E,OAAO5D,MAC3B,OAAIs+B,IAAgB0F,mBAAiBxF,KAAax+B,EAAMa,UACpDy9B,IAAgB0F,mBAAiBvF,QAAgBz+B,EAAMmB,aACpDnB,EAAMsB,aAGf89B,eAAc,SAACx5B,GACL,IAAA+B,EAAA,EAAAA,SACR,GAAIs2B,EAASxyB,IAAI9D,GAAW,OAAOs2B,EAASl/B,IAAI4I,GAChD,IAAM03B,EAAS,CACb,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEItH,EAAQsH,IAASnB,EAAamB,EAAOj6B,QAG3C,OAFA64B,EAAS1xB,IAAI5E,EAAUowB,GACvBjhB,GAAI,iBAAkBnP,EAAUowB,GACzBA,GAGTuH,oBAAmB,SAAC15B,GACV,IAAA6C,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACT+c,EAAWpd,EAAM8K,eAAc,SAAA9K,GACnCA,EAAM/E,OAAO67B,SAAS1zB,SAAQ,SAAA/M,GAC5B2J,EAAM+D,MAAM,CAAC,SAAU1N,EAAK,SAAU,YAG1CgK,EAAWkd,OAAOH,K,SC5OR2Z,KACd,MAAO,CCLA,CACL1K,KACAwI,KnCiDK,CACLmC,uBAAsB,SAAC75B,GACrB,OAAO0E,gBAAC2c,GAAgB,KAAKrhB,KAE/B8M,0BAAyB,SAAC9M,GAChB,IAAA+B,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACnBqkB,EAASxlB,IAAac,EAAM3E,mBAClC,SAAS47B,EAAYxuB,GACnB,OAAO,SAASjL,GACdiL,EAAKlI,QACHF,EAAWC,IAAI,YAAW,OAAOnD,GAAK,CAAEoD,OAAQkI,EAAKlI,WAG3D,OAAOgI,GAAM3R,KAAI,SAAA6R,GACf,OAAAic,IAAWjc,EAAKiW,WAAa,KAC3B7c,gBAACsI,WAAQ,CACP9T,IAAKoS,EAAKgB,MACVpD,KAAM+D,GAAK3B,EAAKpC,MAChBtF,KAAM0H,EAAKgB,MACXytB,aAAcr1B,2BAAM4G,EAAKgW,UACzBxc,QAASg1B,EAAYxuB,UmCnE7B6rB,KACA7U,MCuBK,CACL0X,cAAA,SAAc,G,IACZlY,EAAA,EAAAA,OACAjf,EAAA,EAAAA,MACAd,EAAA,EAAAA,SAEM+I,EAAQjI,EAAMC,SAASf,GACvBk4B,EAAgBnvB,EAAM7N,QAAQ4L,KAC9B/K,EAASgN,EAAM7N,QAAQ6I,UAC7B,OAAQgc,GACN,KAAKtpB,oBAAkBwvB,cACrB,MAAO,CAAED,EAAGjqB,GACd,KAAKtF,oBAAkByvB,cACrB,MAAO,CAAEH,EAAGhqB,GACd,KAAKtF,oBAAkB2B,eACrB,MAAO,CACL2tB,EAAGhqB,EAAOo8B,MAAM/9B,KAAKg+B,KAAKF,EAAgB,GAAIA,GAC9ClS,EAAGjqB,EAAOo8B,MAAM,EAAG/9B,KAAKg+B,KAAKF,EAAgB,KAEjD,KAAKzhC,oBAAkB0vB,cACrB,MAAO,CACLC,EAAGrqB,KAKXs8B,gBAAe,SAACp6B,GACN,IAAA6C,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUmB,EAAA,EAAAA,WAAYpF,EAAA,EAAAA,OAAQkD,EAAA,EAAAA,QACvC8J,EAAQjI,EAAMC,SAASf,GAC7B,GAAoB,IAAhBjE,EAAO+K,MAAciC,EAAM3N,SAAU,OAAO,KAChD,IAAMqqB,EAAY,GAUlB,OATA1pB,EAAOmI,SAAQ,SAAAo0B,GACb,IAAMC,EAAU,OACXt6B,GAAK,CACR+B,SAAUs4B,EACVnhC,IAAKmhC,EACLp5B,IAAKD,EAAQ4W,GAAkByiB,MAEjC7S,EAAUnhB,KAAKnD,EAAWC,IAAI,oBAAqBm3B,OAE9C,CAAE9S,UAAS,IAGpB1F,OAAA,SAAO9hB,GACG,IAAAsU,EAAA,EAAAA,OAAQzR,EAAA,EAAAA,MACVyqB,EAAQhZ,EACZwD,GAAYjV,EAAM3E,qBAEdq8B,EAAYjmB,EAAO6D,GAAOI,qBAC1BiiB,EAAalmB,EAAO6D,GAAOK,iBACjC8U,GAASA,EAAMxL,SACfyY,GAAaA,EAAUzY,SACvB0Y,GAAcA,EAAW1Y,SAKzB,SAAS2Y,EAAY3vB,G,QACnB,GAAIA,EAAM5R,MAAQ2J,EAAM3E,mBAAoB,CAC1C,IAAMw8B,EAAcpmB,EAClBsD,GAAkB9M,EAAM5R,MAE1BwhC,GAAeA,EAAYrN,cAE7B,IAAKviB,EAAM3N,S,IACT,IAAqB,QAAA2N,EAAM7N,SAAO,8BAAE,CAA/B,IAAM09B,EAAM,QACfF,EAAY53B,EAAMC,SAAS63B,K,kGAXjCF,CADwB53B,EAAMC,SAASD,EAAM3E,sBAkB/C08B,aAAY,SAAC56B,GACH,IAAA9F,EAAA,EAAAA,UAAW2I,EAAA,EAAAA,MAAO,EAAAK,WACfkd,OAAOxT,gBAAcguB,aAAa,CAAE/3B,MAAK,EAAE3I,UAAS,MAGjE2gC,gBAAe,SAAC76B,GACN,IAAA86B,EAAA,EAAAA,QAAS53B,EAAA,EAAAA,WAAYoR,EAAA,EAAAA,OACvBhW,EAAa4E,EAAWC,IAAI,gBAAiBnD,GAEnD,OAAO66B,GAAgBC,EADPxmB,EAAO6D,GAAOE,wBAAwBrG,QACb1T,IAG3Cy8B,4BAA2B,SAAC/6B,GAClB,IAAA86B,EAAA,EAAAA,QAAS53B,EAAA,EAAAA,WAAYoR,EAAA,EAAAA,OACvBhW,EAAa4E,EAAWC,IAAI,gBAAiBnD,GAEnD,OAAO66B,GAAgBC,EADPxmB,EAAO6D,GAAOE,wBAAwBxG,QACbvT,IAE3C08B,8BAA6B,SAACh7B,GAG5B,OAAO+b,GAFC,EAAA+e,SACQxmB,EADC,EAAAA,QACM6D,GAAOE,wBAAwBxG,UAIxDopB,iCAAgC,SAACj7B,GACvB,EAAAkD,WACGC,IAAI,6BAA4B,GACzCjK,IAAK,cACF8G,KAIPk7B,oCAAmC,SAACl7B,GAC1B,EAAAkD,WACGC,IAAI,gCAA+B,GAC5CjK,IAAK,cACF8G,KAIP+T,cAAa,SAAC/T,GACJ,IAAAkD,EAAA,EAAAA,WAAY5E,EAAA,EAAAA,WACpB,OAAO4E,EAAWC,IAAI,eAAgB,CACpCjK,IAAK,aACLE,MAAOkF,KAIX68B,cAAa,SAACn7B,GAEZ,OADQ,EAAAkD,WAEKC,IAAI,eAAgB,CAAEjK,IAAK,gBA5HxB,GAgIlBkiC,kBAAiB,SAACp7B,GACR,IAAAsU,EAAA,EAAAA,OAAQvS,EAAA,EAAAA,SAAUc,EAAA,EAAAA,MAC1B,GACEA,EAAM3E,qBAAuB6D,GAC7Bw6B,kBAAgB15B,EAAOd,EAAUc,EAAM3E,sBACrCs+B,oBAAkBnB,WAEpB,MAAM,IAAI1hC,MACR,qCAAqCoI,EAAQ,+CAGjD,IAAM+I,EAAQwJ,EAAOuD,GAAY9V,IAC3Bu5B,EAAahnB,EAAO6D,GAAOE,wBAC3BxG,EAAUypB,EAAWzpB,QAC3B,IAAK/G,IAAU+G,EACb,MAAM,IAAIlY,MAAM,qDAElB,IAAM8wB,EAAS1O,GAAkBjR,EAAO+G,GAExCypB,EAAWroB,sBAAsBwX,EAAO,GAAIA,EAAO,KAGrD8Q,0BAAyB,SAACv7B,GAChB,IAAAkD,EAAA,EAAAA,WAAYnB,EAAA,EAAAA,SACpBmB,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRgF,QAAS,CACP,CACE5B,OAAQzK,SAAOsM,YACflD,SAAQ,EACR3D,UAAW1F,YAAUwM,QAEvB,CACE9B,OAAQzK,SAAOwkB,UACfpb,SAAQ,IAGZue,SAAU,WACRpd,EAAWC,IAAI,oBAAmB,OAAOnD,GAAK,CAAE+B,SAAQ,WFzL9D+a,KACAsb,KACAviB,KACAyG,KGfK,CACLlV,SAAQ,SAACpH,EAAOiE,GACN,IAAAu3B,EAAA,EAAAA,QAASt4B,EAAA,EAAAA,WACjB,OAAQs4B,GACN,KAAKn0B,GAAQwG,+BACX,OAAO,EACT,KAAKxG,GAAQsR,2BACX,OAAOzV,EAAWC,IAAI,qBAAsBnD,GAC9C,KAAKqH,GAAQC,YACX,OAAOpE,EAAWC,IAAI,gBAAiBnD,GAE3C,OAAOiE,MHMTq6B,KIHQrC,EAAM,gBAAlB,IASA,0E,OAgCU,EAAAP,kBAAoB6C,GAAW,SAAC5C,EAAcC,QAAd,IAAAD,MAAA,IACtC,IAAME,EAAgBD,IACtB,EAAK14B,WAAa,IAAIs7B,aAAW,CAC/B7C,QAAS,CAACA,EAASE,GACnBC,WAAW,EACX36B,SAAU,EAAKnB,MAAMmB,c,EAc3B,OAnD6Bg7B,OAGpB,YAAA9M,gBAAP,WACE,OAAOt2B,KAAKmK,WAAWC,IAAI,oBAGtB,YAAA44B,aAAP,SAAoB9b,GAApB,WACQjgB,EAAQjH,KAAKs2B,kBACXxsB,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WACfA,EAAWC,IAAI,eAAc,OACxBnD,GAAK,CACR+B,SAAUc,EAAM5E,gBAElBiF,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOwkB,UACfpb,SAAUke,EAAS9hB,SACnB0E,MAAOod,EACPK,SAAU,WACR,IAAMtgB,EAAQ,EAAKqvB,kBACXxsB,EAAA,EAAAA,MACRK,EAAWC,IAAI,oBAAmB,OAC7BnD,GAAK,CACR+B,SAAUc,EAAM1E,iBAkBxB,YAAA2D,OAAA,WACU,IAAA65B,EAAA,WAAAA,QAMR,OALA5iC,KAAK2iC,kBAAkBC,EAAS/B,IAChC7gC,KAAKo2B,aAAY,OACZp2B,KAAKiH,OAAK,CACbkD,WAAYnK,KAAKmK,aAEZnK,KAAKmK,WAAWC,IAAI,gBAAiBpK,KAAKo2B,eAErD,EAnDA,CAA6BgN,EAAMA,W,ymB1CxBR,EAAkB,GAC3C,MAAO,QAAQ,EAAO,IAAI,G,k4B2CG5B,I,MAAMjrB,EAAM+qB,EAAM,6BAEZwC,EAAcp6B,EAAOvE,IAAG,I,EAAA,e,EAAA,QAO3B,O,uEAP2B,E,IAC1B,SAAAE,GACA,OAACA,EAAMhG,UACP,mFCPJ,2B,+CA+BA,OA/BqC,OACnC,YAAAkH,UAAA,WACE,YAAMA,UAAS,WACT,iBAAEgC,EAAA,EAAAA,WACFhK,EAAM,mBADQ,EAAA6I,SAEd3I,EAAQL,KAAKoH,MAAM3C,QACzB0F,EAAWC,IAAI,eAAgB,CAAEjK,IAAG,EAAEE,MAAK,KAG7C,YAAAuI,kBAAA,WACQ,iBAAEkB,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAKf,MAAO,CACLlF,MALYgG,EAAMC,SAASf,GAAUgB,SAAStK,YAAUwlB,MAAMphB,MAM9D7C,SALe6I,EAAMY,iBAAmB1B,EAMxCE,cAJoBsB,mBAKpBrB,YAAa,2BAIjB,YAAAf,SAAA,SAAS/H,GACD,iBAAE8J,EAAA,EAAAA,WACFhK,EAAM,mBADQ,EAAA6I,SAEpBmB,EAAWC,IAAI,eAAgB,CAAEjK,IAAG,EAAEE,MAAK,IAC3CL,KAAKsI,SAAS,CACZ7D,QAASpE,KAGf,EA/BA,CDyBA,YACE,WAAY4G,GAAZ,MACE,YAAMA,IAAM,K,OAed,EAAAI,YAAc,SAAAC,GACZA,EAAEC,mBAGJ,EAAAC,YAAc,SAAAF,GACZA,EAAEC,mBAsBJ,EAAAS,QAAU,SAAAC,GAAW,gBAAAC,GACnBD,EAAQC,GACR,EAAKN,KAAOM,IAGd,EAAAR,aAAe,SAAAC,IACO,EAAKC,KAAKC,SAASF,EAAMG,SAC/B,EAAKC,eAAeJ,IAhDlC,EAAKQ,Y,EAiFT,OApFoC2P,OAMlC,YAAA3P,UAAA,WACEnI,KAAKoH,MAAQ,CACX3C,QAASzE,KAAK6I,eAIlB,YAAAA,WAAA,WAEE,OADQ,yBAAA/E,MACK/C,MAUf,YAAAqH,SAAA,SAAS/H,GACPL,KAAKsI,SAAS,CACZ7D,QAASpE,KAIb,YAAAuI,kBAAA,WACE,OAAO,MAGT,YAAAL,kBAAA,WACEC,SAASC,iBAAiB,QAASzI,KAAK0H,eAG1C,YAAAgB,qBAAA,WACEF,SAASG,oBAAoB,QAAS3I,KAAK0H,eAe7C,YAAAK,eAAA,SAAeT,KAEf,YAAAyB,OAAA,WACQ,iBAAEC,EAAA,EAAAA,SAAUf,EAAA,EAAAA,QACZ,2BAAEhH,EAAA,EAAAA,SAAUiI,EAAA,EAAAA,cAAeC,EAAA,EAAAA,YACjCgP,EAAI,YAAalX,GACjB,IAAMwD,EAAUxD,EAAWjB,KAAK6I,aAAe7I,KAAKoH,MAAM3C,QAC1D,GAAe,MAAXA,EAAiB,OAAO,KAC5B,IAAMtE,EAAM+I,EAAcF,GAClB3B,EAAF,KAAEA,YAAaG,EAAf,KAAeA,YACfm+B,EAAkB,CACtBC,YAAanhC,EACbxD,SAAQ,EACRmH,SAAUpI,KAAKoI,SAASiB,KAAKrJ,MAC7BmJ,YAAW,GAGP08B,EAAmB,CACvB1lC,IAAG,EACH+H,IAAKlI,KAAKgI,QAAQC,EAAQ9H,IAC1Bc,SAAQ,EACRoG,YAAW,EACXG,YAAW,GAEb,OACEmE,gBAAC+5B,EAAW,KAAKG,GACfl6B,gBAACm6B,EAAkB,KAAKH,MAIhC,EApFA,CAAoC7tB,eE5BpC,EAAe,IAAIiuB,E,qBCIjB,MAAO,CACL/6B,sBAAqB,SAAC/D,GACpB,OAAO0E,gBAAClB,EAAe,KAAKxD,KAG9BgE,aAAY,SAAChE,EAAOiE,GACV,IAAApH,EAAA,EAAAA,MAAOqG,EAAA,EAAAA,WACf,OAAIrG,EAAMhD,OAASpB,YAAU23B,SAAWvzB,EAAMhD,OAASpB,YAAUwlB,KAE/C,MAAdphB,EAAM/C,MAC0C,KAAhDoJ,EAAWC,IAAI,qBAAsBnD,GAGlCiE,KAGTC,mBAAkB,SAAClE,EAAOiE,GAChB,IAAApH,EAAA,EAAAA,MACR,OAAIA,EAAMhD,OAASpB,YAAUwlB,KACE,kBAAfphB,EAAM/C,KAChB+C,EAAM/C,KACNilC,EAAmB56B,UAAUtH,EAAM/C,MAElCmK,Q,iXChBPiN,EAAM+qB,EAAM,0B,uBAElB,WACE,MAAO,CACL+C,eAAA,SAAeh/B,EAA8BiE,GAC3C,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAp8B,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WAmBf,MAlBY,CACVjF,aAAc4E,EAAM5E,aACpBC,mBAAoB2E,EAAM3E,mBAC1BC,SAAU0E,EAAM1E,SAChBJ,QAASmF,EAAWC,IAAI,mBAAkB,OACrCnD,GAAK,CACRjC,QAAS8E,EAAM9E,WAEjBD,OAAQ+E,EAAM/E,OACXohC,WACAp5B,UACArM,KAAI,SAAAqR,GAAS,OAAA5H,EAAWC,IAAI,iBAAgB,OAAOnD,GAAK,CAAE8K,MAAK,QAClE9M,OAAQkF,EAAWC,IAAI,kBAAiB,OACnCnD,GAAK,CACRhC,OAAQ6E,EAAM7E,UAEhBK,cAAewE,EAAMxE,gBAKzB8gC,iBAAgB,SAACn/B,EAAOiE,GACtB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAA5lC,EAAA,EAAAA,IAAK6J,EAAA,EAAAA,WACY,MAArB7J,EAAIgF,gBACNhF,EAAIgF,cAAgB,OAGpB,IAAAJ,EAAA,EAAAA,aACAC,EAAA,EAAAA,mBACAC,EAAA,EAAAA,SACAL,EAAA,EAAAA,OACAE,EAAA,EAAAA,OACAD,EAAA,EAAAA,QACAM,EAAA,EAAAA,cAEE2H,EAAM,IAAIo5B,QA8Bd,OAPoB,OAtBpBp5B,EAAMA,EAAIi4B,MAAM,CACdhgC,aAAY,EACZC,mBACwB,MAAtBA,EAA6BD,EAAeC,EAC9CC,SAAQ,EACRJ,QAASmF,EAAWC,IAAI,qBAAoB,OACvCnD,GAAK,CACRjC,QAAO,EACPM,cAAa,KAEfL,OAAQkF,EAAWC,IAAI,oBAAmB,OACrCnD,GAAK,CACRhC,OAAM,EACNK,cAAa,KAEfP,OAAQoF,EAAWC,IAAI,oBAAmB,OACrCnD,GAAK,CACRlC,OAAM,EACNO,cAAa,KAEfA,cAAehF,EAAIgF,iBAEbF,WACN6H,EAAMA,EAAIW,IAAI,WAAYX,EAAI/H,eAEX,MAAjB+H,EAAI5H,YACN4H,EAAMA,EAAIW,IAAI,YAAajO,YAAUwM,SAEvCgM,EAAI,mBAAoBlL,GACjBA,GAGTq5B,iBAAA,SACEr/B,EACAiE,GAEA,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAlhC,EAAA,EAAAA,QAASmF,EAAA,EAAAA,WACX8C,EAAM,GAQZ,OAPAjI,EAAQkI,SAAQ,SAACC,EAAGC,GAClBH,EAAIG,GAAKjD,EAAWC,IAAI,uBAAwB,CAC9CnD,MAAK,EACLyO,WAAYtI,EACZuI,YAAaxI,OAGVF,GAGTs5B,mBAAkB,SAACt/B,EAAOiE,GACxB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAlhC,EAAA,EAAAA,QAASmF,EAAA,EAAAA,WACb8C,EAAMR,QACV,IAAK,IAAMiJ,KAAc1Q,EACvBiI,EAAMA,EAAIW,IACR8H,EACAvL,EAAWC,IAAI,yBAAwB,OAClCnD,GAAK,CACRyO,WAAU,EACVC,YAAa3Q,EAAQ0Q,OAI3B,OAAOzI,GAGTu5B,qBAAoB,SAACv/B,EAAOiE,GAC1B,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAvwB,EAAA,EAAAA,YACR,OAAI8wB,cAAY9wB,GACPA,EAAY+wB,OAEd/wB,GAGTF,uBAAsB,SAACxO,EAAOiE,GAC5B,IAAMg7B,EAAUh7B,IAChB,OAAe,MAAXg7B,EAAwBA,EACpB,EAAAvwB,aAIVgxB,gBAAe,SAAC1/B,EAAOiE,GACrB,IAAMg7B,EAAUh7B,IAChB,OAAe,MAAXg7B,EAAwBA,EACpB,EAAAjhC,OACMyhC,QAGhBE,kBAAiB,SAAC3/B,EAAOiE,GACvB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAjhC,EAAA,EAAAA,OACR,OAAO,IAAInC,SAAOmC,IAGpB4hC,eAAc,SAAC5/B,EAAOiE,GACpB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAn0B,EAAA,EAAAA,MAAO5H,EAAA,EAAAA,WACf,MAAO,CACLhK,IAAK4R,EAAM5R,IACX6D,UAAW+N,EAAM/N,UACjBE,QAAS6N,EAAM7N,QAAQ6I,UACvB3I,SAAU2N,EAAM3N,SAChBS,MAAOkN,EAAMlN,MACblB,OAAQoO,EAAMpO,OAAOjD,KAAI,SAAAoD,GACvB,OAAAqG,EAAWC,IAAI,iBAAgB,OAAOnD,GAAK,CAAEnD,MAAK,UAKxDgjC,iBAAgB,SAAC7/B,EAAOiE,GACtB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAn0B,EAAA,EAAAA,MAAO5H,EAAA,EAAAA,WACPhK,EAAA,EAAAA,IAAK6D,EAAA,EAAAA,UAAWE,EAAA,EAAAA,QAASP,EAAA,EAAAA,OAAQkB,EAAA,EAAAA,MAAOT,EAAA,EAAAA,SAC5C6I,EAAM,IAAIzJ,QASd,OARAyJ,EAAMA,EAAIi4B,MAAM,CACd/kC,IAAG,EACH6D,UAAS,EACTE,QAASqI,OAAKrI,GACdW,MAAK,EACLT,SAAQ,EACRT,OAAQwG,EAAWC,IAAI,oBAAmB,OAAOnD,GAAK,CAAEtD,OAAM,QAKlEojC,kBAAiB,SAAC9/B,EAAOiE,GACvB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAnhC,EAAA,EAAAA,OAAQoF,EAAA,EAAAA,WACZ8C,EAAMR,QASV,OARAQ,EAAMA,EAAI2H,eAAc,SAAAzR,GACtB4B,EAAOmI,SAAQ,SAAA6E,GACb,OAAA5O,EAAEyK,IACAmE,EAAM5R,IACNgK,EAAWC,IAAI,mBAAkB,OAAOnD,GAAK,CAAE8K,MAAK,aAO5Di1B,eAAc,SAAC//B,EAAOiE,GACpB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAApiC,EAAA,EAAAA,MAAOqG,EAAA,EAAAA,WAKf,MAJY,CACVrJ,KAAMgD,EAAMhD,KACZC,KAAMoJ,EAAWC,IAAI,qBAAoB,KAAOnD,MAKpDkE,mBAAkB,SAAClE,EAAOiE,GACxB,IAAMg7B,EAAUh7B,IAChB,OAAe,MAAXg7B,EAAwBA,EACpB,EAAApiC,MACK/C,MAGfkmC,iBAAgB,SAAChgC,EAAOiE,GACtB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAApiC,EAAA,EAAAA,MAAOqG,EAAA,EAAAA,WACPrJ,EAAA,EAAAA,KAER,OAAO,IAAIhB,QAAM,CACfgB,KAAI,EACJC,KAAMoJ,EAAWC,IAAI,uBAAsB,OAAOnD,GAAK,CAAEnD,MAAK,QAIlEojC,qBAAoB,SAACjgC,EAAOiE,GAC1B,IAAMg7B,EAAUh7B,IAChB,OAAe,MAAXg7B,EAAwBA,EACpB,EAAApiC,MACK/C,MAGfomC,kBAAiB,SAAClgC,EAAOiE,GACvB,IAAMg7B,EAAUh7B,IAChB,GAAe,MAAXg7B,EAAiB,OAAOA,EACpB,IAAAviC,EAAA,EAAAA,OAAQwG,EAAA,EAAAA,WACZ8C,EAAMV,SAMV,OALAU,EAAMA,EAAI2H,eAAc,SAAA3H,GACtBtJ,EAAOuJ,SAAQ,SAAApJ,GACb,OAAAmJ,EAAIK,KAAKnD,EAAWC,IAAI,mBAAkB,OAAOnD,GAAK,CAAEnD,MAAK,gB,6FCxP1DsjC,EAAoC,CAC/C9lC,KAAM,UACNC,aAAa,EACbC,WAAY,gBACZC,eAAgB,UAChBC,QAAS,GACTC,QAAS,GAETC,aAAc,CACZC,WAAY,MACZM,SAAU,QAGZL,UAAW,CACTC,WAAY,EACZC,SAAU,QACVC,UAAW,OAGbC,UAAW,CACTN,aAAc,CACZO,SAAU,QAEZG,aAAc,CACZN,SAAU,QACVC,UAAW,QAGfO,aAAc,CACZZ,aAAc,CACZO,SAAU,QAEZG,aAAc,CACZN,SAAU,QACVC,UAAW,QAIfU,YAAa,CACXL,aAAc,CACZN,SAAU,QACVC,UAAW,SCzCJolC,EAAoB,CAC/B/lC,KAAM,SACNC,aAAa,EACbC,WAAY,mBACZC,eAAgB,UAChBC,QAAS,GACTC,QAAS,GAETC,aAAc,CACZC,WAAY,OAGdC,UAAW,CACTC,WAAY,GAEdG,UAAW,CACTN,aAAc,CACZJ,WAAY,oBACZ43B,MAAO,OACPj3B,SAAU,OACVC,aAAc,MACdC,QAAS,uBAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,sBAGfC,aAAc,CACZZ,aAAc,CACZJ,WAAY,UACZiB,YAAa,MACbC,YAAa,QACbo4B,YAAa,oBACb14B,aAAc,MACdD,SAAU,OACVE,QAAS,uBAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,sBAIfI,YAAa,CACXf,aAAc,CACZJ,WAAY,OACZoB,OAAQ,oBACRR,aAAc,OACdg3B,MAAO,oBACPj3B,SAAU,OACVE,QAAS,YAEXC,aAAc,CACZN,SAAU,QACVD,WAAY,EACZE,UAAW,MACXM,UAAW,uBC3DJ+kC,EAAoB,CAC/BhmC,KAAM,SACNC,aAAa,EACbC,WAAY,UACZC,eAAgB,UAChBC,QAAS,GACTC,QAAS,GACTC,aAAc,CACZC,WAAY,OAEdC,UAAW,CACTC,WAAY,GAEdG,UAAW,CACTN,aAAc,CACZJ,WAAY,UACZ43B,MAAO,OACPj3B,SAAU,OACVC,aAAc,MACdC,QAAS,uBAGXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,YAGfC,aAAc,CACZZ,aAAc,CACZJ,WAAY,UACZiB,YAAa,MACbC,YAAa,QACbo4B,YAAa,oBACb14B,aAAc,MACdg3B,MAAO,mBACPj3B,SAAU,OACVE,QAAS,qBAGXC,aAAc,CACZN,SAAU,QACVD,WAAY,EACZE,UAAW,MACXM,UAAW,YAIfI,YAAa,CACXf,aAAc,CACZJ,WAAY,OACZY,aAAc,MACdg3B,MAAO,mBACPj3B,SAAU,OACVE,QAAS,cACTklC,UAAW,oBAGbjlC,aAAc,CACZN,SAAU,QACVD,WAAY,EACZE,UAAW,MACXM,UAAW,aC9DJilC,EAAoB,CAC/BlmC,KAAM,SACNC,aAAa,EACbC,WAAY,UACZC,eAAgB,UAChBC,QAAS,GACTC,QAAS,GACTC,aAAc,CACZC,WAAY,OAGdC,UAAW,CACTC,WAAY,GAGdG,UAAW,CACTN,aAAc,CACZJ,WAAY,UACZ43B,MAAO,OACPj3B,SAAU,OACVC,aAAc,MACdC,QAAS,uBAGXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,YAGfC,aAAc,CACZZ,aAAc,CACZJ,WAAY,UACZiB,YAAa,MACbC,YAAa,QACbo4B,YAAa,UACb14B,aAAc,MACdg3B,MAAO,mBACPj3B,SAAU,OACVE,QAAS,qBAGXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,YAIfI,YAAa,CACXf,aAAc,CACZJ,WAAY,UACZY,aAAc,MACdg3B,MAAO,mBACPj3B,SAAU,OACVE,QAAS,cACTklC,UAAW,oBAGbjlC,aAAc,CACZN,SAAU,QACVD,WAAY,EACZE,UAAW,MACXM,UAAW,aC/DJklC,EAAoB,CAC/BnmC,KAAM,SACNC,aAAa,EACbC,WAAY,UACZC,eAAgB,UAChBC,QAAS,GACTC,QAAS,GAETC,aAAc,CACZC,WAAY,OAGdC,UAAW,CACTC,WAAY,GAGdG,UAAW,CACTN,aAAc,CACZJ,WAAY,UACZ43B,MAAO,OACPj3B,SAAU,OACVC,aAAc,MACdC,QAAS,uBAGXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,YAGfC,aAAc,CACZZ,aAAc,CACZJ,WAAY,UACZiB,YAAa,MACbC,YAAa,QACbo4B,YAAa,UACb14B,aAAc,MACdg3B,MAAO,mBACPj3B,SAAU,OACVE,QAAS,qBAGXC,aAAc,CACZN,SAAU,OACVC,UAAW,MACXM,UAAW,YAIfI,YAAa,CACXf,aAAc,CACZJ,WAAY,UACZY,aAAc,MACdg3B,MAAO,mBACPj3B,SAAU,OACVE,QAAS,cACTklC,UAAW,oBAGbjlC,aAAc,CACZN,SAAU,OACVD,WAAY,EACZE,UAAW,MACXM,UAAW,a,iCC1Df,IAAMmlC,EAAW,IAAIj7B,IAAuB,CAC1C,CAAC,UAAWk7B,gBACZ,CAAC,sBAAuBP,GACxB,CAAC,SAAUC,GACX,CAAC,SAAUC,GACX,CAAC,SAAUE,GACX,CAAC,SAAUC,KAGb,MAAO,CACLG,aAAY,SAAC3gC,GACX,OAAOygC,GAGT7iB,SAAQ,SAAC5d,GACC,IAAA6C,EAAA,EAAAA,MAAOK,EAAA,EAAAA,WAAY09B,EAAA,EAAAA,SAErBC,EAAW39B,EAAWC,IAAI,eAAgBnD,GAChD,IAAK6gC,EAASh7B,IAAI+6B,GAChB,MAAM,IAAIjnC,MAAM,2CAElB,IAAMS,EAAQymC,EAAS1nC,IAAIynC,GACrB3gB,EAAWrT,gBAAcgR,SAAS,CAAE/a,MAAK,EAAEzI,MAAK,IACtD8I,EAAWkd,OAAOH,M,s6BCtBR6gB,EAAmB9gC,GACzB,IAAAkD,EAAA,EAAAA,WAAYL,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAQrBmpB,EACJroB,EAAM1E,WAAa4D,GCnBoB,gCDoBvCc,EAAMzE,UAEAvB,EAAA,uBCpByB,YDoBzBA,MAER,IAAKquB,IAAcruB,EAAO,OAAO,KACjC,IAAMiM,EAAY,CAChBC,UAAWC,gBAAc,YACzBlE,QAhBc,SAAAzE,GACdA,EAAEC,kBACF4C,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OCdwC,qCD2B1C6F,UAAW,GAGb,OAAOvE,gBAACyE,iBAAc,KAAKL,IE/BtB,I,oBAAMi4B,EAAc,CACzB,CACEC,MAAO,QACP9sB,SAAU,CACR,CACE7Z,KAAM,YACN6O,KAAM,YACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVmvB,YAAa,GACbC,aAAc,GACdC,WAAY,GACZC,cAAe,GACf/mC,KAAM,YACN6O,KAAM,SACNm4B,WAAY,WACZC,UAAW,YAGf,CACEjnC,KAAM,YACN6O,KAAM,iBACNpP,KAAM,CACJ8J,KAAM,YACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVmvB,YAAa,GACbC,aAAc,GACdC,WAAY,GACZC,cAAe,GACfjmC,aAAc,GACdd,KAAM,cAGV,CACEA,KAAM,SACN6O,KAAM,cACNpP,KAAM,CACJ8J,KAAM,SACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,SACNknC,YAAa,IAGjB,CACElnC,KAAM,WACN6O,KAAM,gBACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,aAGV,CACEA,KAAM,UACN6O,KAAM,eACNpP,KAAM,CACJ8J,KAAM,UACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,YAGV,CACEA,KAAM,WACN6O,KAAM,gBACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,aAGV,CACEA,KAAM,UACN6O,KAAM,eACNpP,KAAM,CACJ8J,KAAM,UACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVqvB,WAAY,GACZC,cAAe,GACf/mC,KAAM,YAGV,CACEA,KAAM,YACN6O,KAAM,iBACNpP,KAAM,CACJ8J,KAAM,YACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,cAGV,CACEA,KAAM,aACN6O,KAAM,kBACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,cAGV,CACEA,KAAM,cACN6O,KAAM,mBACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,eAGV,CACEA,KAAM,sBACN6O,KAAM,oBACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,gBAGV,CACEA,KAAM,OACN6O,KAAM,YACNpP,KAAM,CACJ8J,KAAM,OACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,SAGV,CACEA,KAAM,QACN6O,KAAM,aACNpP,KAAM,CACJ8J,KAAM,QACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,UAGV,CACEA,KAAM,UACN6O,KAAM,WACNpP,KAAM,CACJ8J,KAAM,UACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVmvB,YAAa,GACbC,aAAc,GACdC,WAAY,GACZC,cAAe,GACf/mC,KAAM,YAGV,CACEA,KAAM,OACN6O,KAAM,YACNpP,KAAM,CACJ8J,KAAM,OACNmX,KAAM,CACJpJ,MAAO,GACPG,OAAQ,KAEVmvB,YAAa,GACbC,aAAc,GACdC,WAAY,GACZC,cAAe,GACf/mC,KAAM,SAGV,CACEA,KAAM,OACN6O,KAAM,YACNpP,KAAM,CACJ8J,KAAM,OACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,SAGV,CACEA,KAAM,QACN6O,KAAM,aACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,QACNmnC,MAAO,yBAGX,CACEnnC,KAAM,OACN6O,KAAM,YACNpP,KAAM,CACJihB,KAAM,CACJpJ,MAAO,GACPG,OAAQ,IAEV2vB,MAAM,EACN/U,EAAG,GACHgV,QAAS,GACTC,UAAW,OACXtnC,KAAM,OACN6O,KAAM,SACNm4B,WAAY,WACZC,UAAW,OACXM,SAAU,KAGd,CACEvnC,KAAM,SACN6O,KAAM,cACNpP,KAAM,CACJihB,KAAM,CACJpJ,MAAO,GACPG,OAAQ,KAEVzX,KAAM,WAGV,CACEA,KAAM,cACN6O,KAAM,UACNpP,KAAM,CACJ8J,KAAM,cACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVmvB,YAAa,GACbC,aAAc,GACdC,WAAY,GACZC,cAAe,GAEf/mC,KAAM,UAKd,CACE2mC,MAAO,aACP9sB,SAAU,CACR,CACE7Z,KAAM,YACN6O,KAAM,kBACNpP,KAAM,CACJ8J,KAAM,QACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEV3W,aAAc,GACdd,KAAM,cAGV,CACEA,KAAM,OACN6O,KAAM,iBACNpP,KAAM,CACJ8J,KAAM,OACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,cAGV,CACEA,KAAM,YACN6O,KAAM,eACNpP,KAAM,CACJ8J,KAAM,YACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,YAGV,CACEA,KAAM,OACN6O,KAAM,iBACNpP,KAAM,CACJ8J,KAAM,OACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,aAGV,CACEA,KAAM,UACN6O,KAAM,kBACNpP,KAAM,CACJ8J,KAAM,UACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,YAGV,CACEA,KAAM,WACN6O,KAAM,uBACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,mBAGV,CACEA,KAAM,WACN6O,KAAM,UACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,GACPG,OAAQ,KAEVzX,KAAM,WAGV,CACEA,KAAM,WACN6O,KAAM,qBACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,iBAGV,CACEA,KAAM,mBACN6O,KAAM,wBACNpP,KAAM,CACJ8J,KAAM,mBACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,wBAGV,CACEA,KAAM,mBACN6O,KAAM,sBACNpP,KAAM,CACJ8J,KAAM,mBACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,sBAGV,CACEA,KAAM,QACN6O,KAAM,kBACNpP,KAAM,CACJ8J,KAAM,QACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,cAGV,CACEA,KAAM,iBACN6O,KAAM,qBACNpP,KAAM,CACJ8J,KAAM,iBACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,iBAGV,CACEA,KAAM,UACN6O,KAAM,oBACNpP,KAAM,CACJ8J,KAAM,UACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,gBAGV,CACEA,KAAM,WACN6O,KAAM,qBACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,iBAGV,CACEA,KAAM,UACN6O,KAAM,oBACNpP,KAAM,CACJ8J,KAAM,UACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,kBAKd,CACE2mC,MAAO,mBACP9sB,SAAU,CACR,CACE7Z,KAAM,QACN6O,KAAM,cACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,GACPG,OAAQ,IAEVzX,KAAM,SACNsnC,UAAW,OACXE,YAAa,gBAGjB,CACExnC,KAAM,MACN6O,KAAM,aACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,GACPG,OAAQ,IAEVzX,KAAM,kBAGV,CACEA,KAAM,SACN6O,KAAM,cACNpP,KAAM,CACJ8J,KAAM,SACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEV3W,aAAc,IACdd,KAAM,cAGV,CACEA,KAAM,iBACN6O,KAAM,eACNpP,KAAM,CACJ8J,KAAM,eACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,YAGV,CACEA,KAAM,yBACN6O,KAAM,kBACNpP,KAAM,CACJ8J,KAAM,yBACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,cAGV,CACEA,KAAM,2BACN6O,KAAM,kBACNpP,KAAM,CACJ8J,KAAM,2BACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,cAGV,CACEA,KAAM,sBACN6O,KAAM,cACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,GACPG,OAAQ,KAEVzX,KAAM,QACNsnC,UAAW,OACXE,YAAa,gBAGjB,CACExnC,KAAM,wBACN6O,KAAM,YACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,IAEVzX,KAAM,QACNsnC,UAAW,OACXE,YAAa,kBAKrB,CACEb,MAAO,oCACP9sB,SAAU,CACR,CACE7Z,KAAM,WACN6O,KAAM,gBACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVzX,KAAM,aAGV,CACEA,KAAM,aACN6O,KAAM,aACNpP,KAAM,CACJ8J,KAAM,GACNmX,KAAM,CACJpJ,MAAO,GACPG,OAAQ,KAEVzX,KAAM,kBAGV,CACEA,KAAM,eACN6O,KAAM,oBACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVqvB,WAAY,GACZW,KAAM,CACJC,WAAY,QACZ5P,MAAO,OACP6P,WAAY,QAEdL,UAAW,UACXE,YAAa,UACbxnC,KAAM,cACN6Z,SAAU,CACR,CACEtQ,KAAM,gDACNvJ,KAAM,OACN4mC,YAAa,GACbC,aAAc,GACdC,WAAY,GACZC,cAAe,GACfa,aAAc,CACZ7mB,EAAG,EACHE,EAAG,EACH3J,MAAO,OACPG,OAAQ,OACRowB,OAAQ,GAEVJ,KAAM,CACJC,WAAY,QACZ5P,MAAO,OACPgQ,UAAW,OACXC,aAAc,WAMxB,CACE/nC,KAAM,QACN6O,KAAM,aACNpP,KAAM,CACJ8J,KAAM,WACNmX,KAAM,CACJpJ,MAAO,IACPG,OAAQ,KAEVqvB,WAAY,GACZW,KAAM,CACJC,WAAY,QACZ5P,MAAO,OACP6P,WAAY,QAEdL,UAAW,UACXE,YAAa,UACbxnC,KAAM,iBACN6Z,SAAU,CACR,CACEtQ,KAAM,iBACNvJ,KAAM,OACN4mC,YAAa,GACbC,aAAc,GACdC,WAAY,GACZC,cAAe,GACfa,aAAc,CACZ7mB,EAAG,EACHE,EAAG,EACH3J,MAAO,OACPG,OAAQ,MACRowB,OAAQ,GAEVJ,KAAM,CACJC,WAAY,QACZ5P,MAAO,OACPgQ,UAAW,OACXC,aAAc,QAGlB,CACEx+B,KAAM,gCACNvJ,KAAM,OACN4mC,YAAa,GACbC,aAAc,GACdC,WAAY,GACZC,cAAe,GACfa,aAAc,CACZ7mB,EAAG,EACHE,EAAG,MACH3J,MAAO,OACPG,OAAQ,MACRowB,OAAQ,GAEVJ,KAAM,CACJC,WAAY,QACZ5P,MAAO,OACPgQ,UAAW,OACXC,aAAc,cC1mBxBh+B,EAAOC,EAAOvE,IAAG,6KAOjBuiC,EAASh+B,EAAOvE,IAAG,qNAQnBwiC,EAAQj+B,EAAOvE,IAAG,mRAQlByiC,EAAYl+B,EAAOvE,IAAG,qaAatB0iC,EAAiBn+B,EAAOvE,IAAG,6iBAiBjC,yE,OACE,EAAAK,MAAQ,CACNkxB,GAAI,GACJv3B,KAAM,KACN2oC,YAAa1B,EACbvY,SAAU,CAAEttB,SAAU,YAIxB,EAAAwnC,cAAyB,GAyHzB,EAAA5uB,kBAAoB,SAAAzT,GAClBA,EAAEmS,iBACFnS,EAAEC,mBAGJ,EAAAqiC,UAAY,SAACjiC,EAAO5G,GACV,IACF8oC,GAAoCtuB,EADlC,QAAAA,QF9QiC,yBEkRzC,OAAQ5T,GACN,IAAK,SACL,IAAK,QACL,IAAK,SACC,EAAKmiC,UAAYD,GACnBA,EAAYE,cAAc,EAAKD,SAAS/oC,Q,EA4ElD,OA7NqC+W,OAWnC,YAAAkyB,eAAA,WACEC,eACE,WACAC,WACAC,kBACAC,mBACAC,oBAEFJ,eACE,iBACAK,iBACA,KACAC,yBACAC,0BAEFP,eAAa,SAAUQ,SAAQ,KAAMC,iBAAgBC,kBACrDV,eACE,eACAW,eACAC,sBACAC,uBACAC,wBAEFd,eACE,sBACAe,sBACA,KACAC,8BACAC,+BAEFjB,eACE,oBACAkB,oBACAC,2BACAC,4BACAC,6BAEFrB,eACE,YACAsB,YACA,KACAC,oBACAC,qBAEFxB,eACE,eACAyB,eACAC,sBACAC,uBACAC,wBAEF5B,eACE,cACA6B,cACAC,qBACAC,sBACAC,uBAEFhC,eAAa,eAAgBiC,eAAcC,sBAAqB,KAAM,MACtElC,eAAa,cAAemC,cAAaC,qBAAoB,KAAM,MAGnEpC,eACE,gBACAqC,gBACA,KACAC,wBACAC,yBAEFvC,eACE,YACAwC,YACA,KACAC,oBACAC,qBAEF1C,eACE,YACA2C,YACA,KACAC,oBACAC,qBAEF7C,eAAa,QAAS8C,OAAMC,eAAcC,eAAcC,gBACxDjD,eAAa,QAAS8C,OAAMI,eAAcF,eAAcC,gBAGxDjD,eACE,cACAmD,cACA,KACAC,sBACAC,uBAEFrD,eACE,iBACAsD,iBACA,KACAC,yBACAC,0BAIFxD,eACE,WACAyD,WACAC,kBACAC,mBACAC,oBAEF5D,eACE,gBACA6D,gBACAC,uBACAC,wBACAC,0BAyBJ,YAAA1lC,kBAAA,WACEvI,KAAKgqC,iBACLhqC,KAAK2pC,cAAcuE,GAAKluC,KAAK4pC,UAC7B5pC,KAAK8pC,SAAW,IAAIqE,WAAS,kBAAmBnuC,KAAK2pC,eACrD3pC,KAAKouC,YAGP,YAAAphB,mBAAA,WACEhtB,KAAKouC,YAGP,YAAAA,SAAA,WACQ,iBAAEtkC,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAEPlF,EADMgG,EAAMC,SAASf,GACrB,SF7SuB,YE6SvBlF,MACJA,GAASA,EAAM/C,MAAuB,KAAf+C,EAAM/C,OAC/Bf,KAAKsI,SAAS,CACZvH,KAAM+C,EAAM/C,OAEdf,KAAK8pC,SAASuE,KAAKvqC,EAAM/C,QAI7B,YAAAutC,OAAA,SAAO3mC,EAA2C6T,GAChD7T,EAAM4mC,aAAaC,QAAQ,OAAQrS,KAAKC,UAAU5gB,EAAKza,QAGzD,YAAA0tC,YAAA,sBACE,OACE9iC,gBAAC49B,EAAK,KACHvpC,KAAKoH,MAAMsiC,YAAYhpC,KAAI,SAAC6R,EAAM7O,GACjC,OACEiI,uBAAKxL,IAAKuD,GACRiI,gBAAC69B,EAAS,KAAEj3B,EAAK01B,OACjBt8B,gBAAC89B,EAAc,KAGbl3B,EAAK4I,SAASza,KAAI,SAACguC,EAAKnoC,GACtB,OACEoF,qBACExL,IAAKoG,EACLyL,MAAO08B,EAAIptC,KACXqwB,WAAW,EACXb,YAAa,SAAAjH,GACX,EAAKykB,OAAOzkB,EAAI6kB,KAGlB/iC,qBACEqE,UAAW,YAAc0+B,EAAIv+B,KAC7BtL,MAAO,EAAKuC,MAAMqoB,sBAaxC,YAAA1mB,OAAA,WACE,OACE4C,gBAACN,EAAI,KACFrL,KAAKyuC,cACN9iC,gBAAC29B,EAAM,CAAChR,GAAG,kBAAkBqW,cAAe3uC,KAAK+a,sBAIzD,EA7NA,CAAqCjD,cClI/BzM,EAAOC,EAAOvE,IAAG,iYAYjB4tB,EAAQrpB,EAAOoR,MAAPpR,CAAW,2DAInBupB,EAAO,SAAA5tB,GACX,OACE0E,gBAACi4B,UAAO,CACNn/B,QAASwC,EAAM6tB,QACfjJ,SAAU0Y,WAASxP,IACnB/kB,UAAWk0B,UAAQlP,MAEnBrpB,gBAACgpB,EAAK,CAAC5oB,QAAS9E,EAAM8E,SAAU9E,EAAMkU,YAKtCyZ,EAAiBtpB,EAAOsR,KAAI,+IAUlC,cACE,WAAY3V,GAAZ,MACE,YAAMA,IAAM,K,OAOd,EAAA8iC,cAAgB,SAAA6E,GACd,EAAKtmC,SAAS,CAAEsmC,WAAU,KAQ5B,EAAAzZ,iBAAmB,SAAA7tB,GACA,EAAKunC,cACbC,QAAQ,IAjBjB,EAAK1nC,MAAQ,CACX+G,eAAe,EACfygC,WAAY,M,EA0DlB,OA/D0CxL,OAaxC,YAAAyL,YAAA,WAEE,OAAOtzB,EADC,WAAAA,QHzD4B,oBG0DIuuB,UAQ1C,YAAA/gC,OAAA,sBACQ9B,EAAQjH,KAAKiH,MACXkD,EAAA,EAAAA,WAKFqE,EAAmB,CACvBC,OAAQzO,KAAKoH,MAAM+G,cACnBO,iBAAkB,SAClBC,UAAW,SAAArH,GACT6C,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOolB,mBACf1a,UHjFyB,eGoF7BsE,SAAU,SAAAtH,GACR,EAAKgB,SAAS,CAAE6F,eAAe,KAEjCU,QAAS,SAAAvH,GACP,EAAKgB,SAAS,CAAE6F,eAAe,MAG3BygC,EAAA,WAAAA,WACFhsB,EAAQgsB,EAAaA,EAAWhsB,MAAQ,EAC9C,OACEjX,gBAACN,EAAI,KACHM,gBAACkpB,EAAI,CAAC9oB,QAAS/L,KAAKm1B,iBAAkBL,QAAQ,cAC5CnpB,gBAACipB,EAAc,KAAE,QAAQxxB,KAAKqyB,MAAc,IAAR7S,GAAY,MAElDjX,gBAACkpB,EAAI,CAAC9oB,QA3BY,SAAAzE,GACpB,EAAKgB,SAAS,CAAE6F,eAAe,KA0BC2mB,QAAQ,uBACnC5gB,OAAK0J,WAASU,QAEjB3S,gBAACmD,QAAK,KAAKN,GACT7C,gFAKV,EA/DA,CAA0Cy3B,EAAMA,WChC1C2L,EAAiBzjC,EAAOvE,IAAG,6PAQ3ByE,EAAQF,EAAOsR,KAAI,qEAIzB,SAAgBoyB,EAAe/nC,GACrB,IAAAkD,EAAA,EAAAA,WAAYnB,EAAA,EAAAA,SAAUuS,EAAA,EAAAA,OAAQtT,EAAA,EAAAA,QAiBhCmuB,EAAY,OACbnvB,GAAK,CACRiB,IAAKD,EJ3C+B,sBI6ChCgnC,EAAS,OACVhoC,GAAK,CACRiB,IAAKD,EJ9CoC,2BIgD3C,OACE0D,gBAAC64B,SAAM,CACLxyB,MAAOrG,gBAACH,EAAK,gCACb2E,KAAM+D,OAAK,YACXzF,QAAM,EACNmnB,aAAW,EACXsZ,kBAAkB,WAClBrZ,cAAe,CAAExuB,YAAasI,eAC9Bw/B,sBAAsB,EACtBrZ,oBAAoB,EACpBjnB,QAlCmB,SAAAvH,GACrBA,EAAEC,kBAIF,IACM6nC,EAD2B7zB,EJ9BG,oBI+BPuuB,SAAS/oC,KACtCoJ,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OAAQzK,SAAOklB,gBACf9b,SAAQ,EACRsB,UJrC6B,WIsC7BvJ,KAAMquC,EACN/pC,UAAW1F,YAAUwM,WAsBrB2D,KAAK,QAELnE,gBAACojC,EAAc,CAAChjC,QAAS4D,cAAashB,cAAethB,eACnDhE,gBAAC0jC,EAAe,KAAKjZ,IACrBzqB,gBAAC2jC,EAAoB,KAAKL,MCvDlC,SAASM,EAAqB,G,IAAEzlC,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAE7BlF,EADMgG,EAAMC,SAASf,GACrB,SLZyB,YKYzBlF,MAcR,OAba,MAATA,GAA+B,MAAdA,EAAM/C,OACzB+I,EAAQ+J,gBAAckR,aAAa,CACjCjb,MAAK,EACLd,SAAQ,EACRsB,ULjB6B,WKkB7BvJ,KAAM,MAGV+I,EAAQ+J,gBAAcC,WAAW,CAC/BhK,MAAK,EACLd,SAAQ,EACR3D,UL1BuC,gC,UK+B3C,WACE,MAAO,CACL+xB,iBAAgB,SAACnwB,EAAOiE,GACd,IAAAf,EAAA,EAAAA,WACR,MLjC6B,aKgCT,EAAArG,MACVhD,KACDqJ,EAAWC,IAAI,2BAA4BnD,GAE7CiE,KAGTskC,yBAAwB,SAACvoC,GACvB,OAAO0E,gBAACo8B,EAAkB,KAAK9gC,KAGjC0uB,aAAY,SAAC1uB,EAAOiE,GACV,IAAApB,EAAA,EAAAA,MACR,GL/CqC,gCK+CjCA,EAAMzE,UAA2C,CACnD,IAAMoqC,EAAS,OACVxoC,GAAK,CACR+B,SAAUc,EAAM1E,SAChBjF,IAAK,oBAEP,OAAOwL,gBAACqjC,EAAc,KAAKS,IAE7B,OAAOvkC,KAGT6I,0BAAyB,SAAC9M,EAAOiE,GACvB,IAAAf,EAAA,EAAAA,WAOR,OACEwB,gCACGT,IACDS,gBAACqI,cAAW,MACZrI,gBAACsI,WAAQ,CACP9D,KAAM+D,OAAK,YACXrJ,KAAK,wBACLkB,QAbN,SAAsBzE,GACpB6C,EAAWC,IAAI,YAAW,OACrBnD,GAAK,CACRoD,OL9DoC,yCK8E1CgK,SAAQ,SAACpN,EAAOiE,GACd,IAAMoJ,EAAQpJ,IAEd,OADAoJ,EAAM1G,ILhFkC,iCKgFE2hC,GACnCj7B,M,oBClFbo7B,EAAOC,QAAU,IAA0B,qC,oBCA3CD,EAAOC,QAAU,IAA0B,oC,oBCA3CD,EAAOC,QAAU,IAA0B,oC,oBCA3CD,EAAOC,QAAU,IAA0B,oC,oBCA3CD,EAAOC,QAAU,IAA0B,oC,6TCA3C,w6BAsBInqC,EAAiB,SAAuBC,EAAG5B,GAW7C,OAVA2B,EAAiBE,OAAOC,gBAAkB,CACxCC,UAAW,cACApF,OAAS,SAAUiF,EAAG5B,GACjC4B,EAAEG,UAAY/B,IACX,SAAU4B,EAAG5B,GAChB,IAAK,IAAIgC,KAAKhC,EACRA,EAAEiC,eAAeD,KAAIJ,EAAEI,GAAKhC,EAAEgC,MAIhBJ,EAAG5B,IAG3B,SAASkC,EAAUN,EAAG5B,GAGpB,SAASmC,IACPhG,KAAKiG,YAAcR,EAHrBD,EAAeC,EAAG5B,GAMlB4B,EAAES,UAAkB,OAANrC,EAAa6B,OAAO/E,OAAOkD,IAAMmC,EAAGE,UAAYrC,EAAEqC,UAAW,IAAIF,GAGjF,IAAIG,EAAU,WAaZ,OAZAA,EAAUT,OAAOU,QAAU,SAAkBC,GAC3C,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAItG,UAAUuG,OAAQF,EAAIC,EAAGD,IAG9C,IAAK,IAAIV,KAFTS,EAAIpG,UAAUqG,GAGRb,OAAOQ,UAAUJ,eAAeY,KAAKJ,EAAGT,KAAIQ,EAAER,GAAKS,EAAET,IAI7D,OAAOQ,IAGMpG,MAAMD,KAAME,YAkB7B,SAAS2W,EAAOL,EAAGhQ,GACjB,IAAIiQ,EAAsB,oBAAXC,QAAyBF,EAAEE,OAAOC,UACjD,IAAKF,EAAG,OAAOD,EACf,IACIrT,EAEAmE,EAHAf,EAAIkQ,EAAE/P,KAAK8P,GAEXM,EAAK,GAGT,IACE,WAAc,IAANtQ,GAAgBA,KAAM,MAAQrD,EAAIoD,EAAE2E,QAAQ0L,MAClDE,EAAGxJ,KAAKnK,EAAE9C,OAEZ,MAAO0W,GACPzP,EAAI,CACFyP,MAAOA,GAET,QACA,IACM5T,IAAMA,EAAEyT,OAASH,EAAIlQ,EAAU,SAAIkQ,EAAE/P,KAAKH,GAC9C,QACA,GAAIe,EAAG,MAAMA,EAAEyP,OAInB,OAAOD,EAGT,SAASE,IACP,IAAK,IAAIF,EAAK,GAAIvQ,EAAI,EAAGA,EAAIrG,UAAUuG,OAAQF,IAC7CuQ,EAAKA,EAAGjW,OAAOgW,EAAO3W,UAAUqG,KAGlC,OAAOuQ,EAaC,IAAM,mBAsBhB,SAAS84B,EAAQC,GACf,IAAIj0B,EAAKvT,EAET,IAAK7H,MAAMC,QAAQovC,GAAa,MAAM,IAAIljB,UAAU,sCAEpD,IACE,IAAK,IAAImjB,EAxFb,SAAkBt5B,GAChB,IAAIC,EAAsB,oBAAXC,QAAyBF,EAAEE,OAAOC,UAC7CpQ,EAAI,EACR,OAAIkQ,EAAUA,EAAE/P,KAAK8P,GACd,CACLtL,KAAM,WAEJ,OADIsL,GAAKjQ,GAAKiQ,EAAE/P,SAAQ+P,OAAI,GACrB,CACLnW,MAAOmW,GAAKA,EAAEjQ,KACdqQ,MAAOJ,KA+EaD,CAASs5B,GAAaE,EAAiBD,EAAa5kC,QAAS6kC,EAAen5B,KAAMm5B,EAAiBD,EAAa5kC,OAAQ,CAE9I,GAAkB,oBADT6kC,EAAe1vC,MACM,MAAM,IAAIssB,UAAU,8CAEpD,MAAO1Q,GACPL,EAAM,CACJ7E,MAAOkF,GAET,QACA,IACM8zB,IAAmBA,EAAen5B,OAASvO,EAAKynC,EAAa5zB,SAAS7T,EAAG3B,KAAKopC,GAClF,QACA,GAAIl0B,EAAK,MAAMA,EAAI7E,OAIvB,OAAO,SAAUi5B,EAAS9kC,GAExB,IAAIxH,GAAS,EACb,OAEA,SAASusC,EAAS1pC,GAChB,GAAIA,GAAK7C,EAAO,MAAM,IAAI9C,MAAM,gCAChC8C,EAAQ6C,EACR,IAAImX,EAAKmyB,EAAWtpC,GAChBA,IAAMspC,EAAWppC,SAAQiX,EAAKxS,GAClC,IAAKwS,EAAI,OAAO,KAEhB,IACE,OAAOA,EAAGsyB,EAASC,EAAS5mC,KAAK,KAAM9C,EAAI,IAC3C,MAAO2pC,GACP,MAAMA,GAZHD,CAAS,IAkBpB,IAyDIxwC,EAzDAgmC,EAEJ,WACE,SAASA,EAAW0K,QACF,IAAZA,IACFA,EAAU,IAGZ,IAAI9nC,EAAK8nC,EAAQvN,QACbA,OAAiB,IAAPv6B,EAAgB,GAAKA,EAC/BD,EAAW+nC,EAAQ/nC,SACnBnH,EAAWkvC,EAAQlvC,SACvBjB,KAAKiB,SAAWA,EAChBjB,KAAKoI,SAAWA,EAChBpI,KAAK6vC,WAAa,IAAIpjC,IA7E1B,SAAS2jC,EAAejmC,EAAYkmC,GAClC,GAAI7vC,MAAMC,QAAQ4vC,GAChBA,EAAOnjC,SAAQ,SAAUrH,GACvB,OAAOuqC,EAAejmC,EAAYtE,WAKtC,GAAc,MAAVwqC,EAIJ,IAAK,IAAIlwC,KAAOkwC,EAAQ,CACtB,IAAI3yB,EAAK2yB,EAAOlwC,GAChBgK,EAAW0lC,WAAW1vC,GAAOgK,EAAW0lC,WAAW1vC,IAAQ,GAC3DgK,EAAW0lC,WAAW1vC,GAAKmN,KAAKoQ,IAkEhC0yB,CAAepwC,KA7FnB,SAAoBmwC,QACF,IAAZA,IACFA,EAAU,IAGZ,IAAI9nC,EAAK8nC,EAAQvN,QAEjB,OAAO5rB,OADc,IAAP3O,EAAgB,GAAKA,GAoFhBioC,CAAW,CAC1B1N,QAASA,KA+Bb,OA1BA6C,EAAWv/B,UAAUkE,IAAM,SAAUjK,GAGnC,IAFA,IAAIowC,EAAO,GAEFC,EAAK,EAAGA,EAAKtwC,UAAUuG,OAAQ+pC,IACtCD,EAAKC,EAAK,GAAKtwC,UAAUswC,GAG3B,IAAIX,EAAa7vC,KAAK6vC,WAClBY,EAAMZ,EAAW1vC,IAAQ,GAC7B,kBAAuB,IAAfswC,EAAIhqC,OAAc,2BAA6BtG,EAAM,kBAC7D,IAAIuwC,EAAa,kBAAWd,EAAX,CAAoBa,GAErC,OAAOC,EAAWzwC,WAAM,EAAQ+W,EAASu5B,KAG3C9K,EAAWv/B,UAAUmI,SAAW,SAAUo0B,EAASzqB,GACjD,OAAOhY,KAAKoK,IAAI,WAAYjE,EAAQA,EAAQ,GAAI6R,GAAM,CACpDyqB,QAASA,MAIbgD,EAAWv/B,UAAUmhB,OAAS,SAAUvd,EAAOyd,GAC7CvnB,KAAKoI,SAAS0B,EAAOyd,GACrBvnB,KAAK2wC,aAAe7mC,GAGf27B,EA7CT,GAgDItB,EAAiB,CACnB9V,KAAM,IACNiB,MAAO,IACPshB,OAAQ,IACR/hB,KAAM,MAKR,SAAWpvB,GACTA,EAAkBA,EAAiC,cAAI,GAAK,gBAC5DA,EAAkBA,EAAiC,cAAI,GAAK,gBAC5DA,EAAkBA,EAAkC,eAAI,GAAK,iBAC7DA,EAAkBA,EAAiC,cAAI,GAAK,gBAJ9D,CAKGA,IAAsBA,EAAoB,KAE7C,IAAI4lC,EAAmB,CACrBxF,KAAM,EACNC,QAAS,EACT3zB,OAAQ,GAENzM,EAAY,CACd23B,QAAS,UACTnS,KAAM,QAEJvlB,EAAY,CACdwM,OAAQ,SACR8Q,gBAAiB,kBACjBkI,aAAc,eACd/H,WAAY,aACZgN,SAAU,YAERqZ,EAAoB,CACtBnZ,SAAU,WACVgY,WAAY,aACZuO,QAAS,UACTC,KAAM,QAEJlxC,EAAS,CACXwU,gBAAiB,kBACjB+J,aAAc,eACdC,WAAY,aACZgG,UAAW,YACXlB,UAAW,YACXC,YAAa,cACb3O,aAAc,eACdtI,YAAa,cACbE,eAAgB,iBAChBsY,UAAW,YACXE,UAAW,YACXE,gBAAiB,kBACjBE,mBAAoB,qBAGpBpB,sBAAuB,wBACvBC,mBAAoB,qBACpBuB,cAAe,gBACf9B,gBAAiB,mBAGnB,SAAStgB,IACP,MAAO,uCAAuCC,QAAQ,SAAS,SAAUC,GACvE,IAAIC,EAAoB,GAAhBC,KAAKC,SAAgB,EAE7B,OADc,MAANH,EAAYC,EAAQ,EAAJA,EAAU,GACzBG,SAAS,OAItB,IAMIxD,EAEJ,SAAUC,GAGR,SAASD,IACP,OAAkB,OAAXC,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KA+B7D,OAlCA+F,EAAUjG,EAAOC,GAMjB2F,OAAOsB,eAAelH,EAAMoG,UAAW,OAAQ,CAC7C9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,SAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAelH,EAAMoG,UAAW,OAAQ,CAC7C9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,SAElB6X,YAAY,EACZC,cAAc,IAGhBpY,EAAMa,OAAS,SAAUL,GACvB,OAAO,IAAIR,EAAMQ,IAGnBR,EAAMuE,WAAa,SAAU/D,GAC3B,GAAI,OAAKC,OAAOD,IAAQE,MAAMC,QAAQH,GAEpC,OAAO,eAAKA,EAAII,IAAIZ,EAAMa,SAG5B,MAAM,IAAIC,MAAM,mEAAqEN,IAGhFR,EAnCT,CAoCE,iBA5CuB,CACvBgB,KAAM,KACNX,IAAK,KACLY,KAAM,QAqDJyC,EAEJ,SAAUzD,GAGR,SAASyD,IACP,OAAkB,OAAXzD,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KA8G7D,OAjHA+F,EAAUvC,EAAOzD,GAMjB2F,OAAOsB,eAAexD,EAAM0C,UAAW,MAAO,CAC5C9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,QAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAexD,EAAM0C,UAAW,YAAa,CAClD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,cAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAexD,EAAM0C,UAAW,WAAY,CACjD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,aAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAexD,EAAM0C,UAAW,UAAW,CAChD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,YAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAexD,EAAM0C,UAAW,SAAU,CAC/C9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,WAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAexD,EAAM0C,UAAW,YAAa,CAClD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,cAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAexD,EAAM0C,UAAW,QAAS,CAC9C9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,UAElB6X,YAAY,EACZC,cAAc,IAGhB1U,EAAM0C,UAAU8D,SAAW,SAAUlJ,GACnC,IAAI4C,EAAQ1D,KAAK2D,OAAOC,WAAU,SAAUC,GAC1C,OAAOA,EAAE/C,OAASA,KAEpB,OAAe,IAAX4C,EAAqB,CACvBA,MAAOA,EACPI,MAAO,MAEF,CACLJ,MAAOA,EACPI,MAAO9D,KAAK2D,OAAOvD,IAAIsD,KAI3BF,EAAMutC,SAAW,SAAUzwC,GACzB,IAAIH,EAAMG,EAAIH,IACVkI,EAAK/H,EAAI0D,UACTA,OAAmB,IAAPqE,EAAgB,KAAOA,EACnC1E,EAASrD,EAAIqD,OACbsF,EAAK3I,EAAI4D,QACTA,OAAiB,IAAP+E,EAAgB,GAAKA,EAC/BwY,EAAKnhB,EAAI8D,SAEb,OAAO,IAAIZ,EAAM,CACfrD,IAAKA,EACL6D,UAAWA,EACXI,cAJoB,IAAPqd,GAAwBA,EAKrCvd,QAAS,eAAKA,GACdP,OAAQ7D,EAAMuE,WAAWV,MAI7BH,EAAM7C,OAAS,SAAU0H,GACvB,IAAIlI,EAAMkI,EAAGlI,IACT8I,EAAKZ,EAAGrE,UACRA,OAAmB,IAAPiF,EAAgB,KAAOA,EACnCwY,EAAKpZ,EAAG5D,QACRA,OAAiB,IAAPgd,EAAgB,GAAKA,EAC/BE,EAAKtZ,EAAGnE,QACRA,OAAiB,IAAPyd,EAAgB,GAAKA,EAC/BqvB,EAAK3oC,EAAGjE,SACRA,OAAkB,IAAP4sC,GAAwBA,EACnCltC,EAAQhE,EAAMa,OAAO,CACvBG,KAAMpB,EAAU23B,QAChBt2B,KAAM0D,EACNtE,IAAK,OAGP,OAAO,IAAIqD,EAAM,CACfrD,IAAKA,EACL6D,UAAWA,EACXL,OAJW,eAAK,CAACG,IAKjBI,QAAS,eAAKA,GACdE,SAAUA,KAIPZ,EAlHT,CAmHE,iBA/HuB,CACvBrD,IAAK,KACL6D,UAAW,KACXI,UAAU,EACVF,QAAS,KACTP,OAAQ,KACRiB,UAAW,KACXC,MAAO,QA0HT,SAAS6P,EAAmB5K,EAAOd,GACjC,IAAIuJ,EAAOzI,EAAMC,SAASf,GACtBiE,EAAM,GAEV,GAAIsF,EAAKrO,QAAQ4L,KAAO,EAAG,CACzB,IAAI5L,EAAUqO,EAAKrO,QAAQ6I,UAC3BE,EAAIK,KAAKrN,MAAMgN,EAAK+J,EAAS9S,IAC7B+I,EAAM/I,EAAQwjB,QAAO,SAAUC,EAAKxnB,GAElC,OADAwnB,EAAIra,KAAKrN,MAAM0nB,EAAK3Q,EAAStC,EAAmB5K,EAAO3J,KAChDwnB,IACN1a,GAGL,OAAOA,EAGT,SAASgkC,EAAWnnC,EAAOd,EAAUkoC,QACnB,IAAZA,IACFA,GAAU,GAMZ,IAHA,IAAIjkC,EAAM,CAACjE,GACPuJ,EAAOzI,EAAMC,SAASf,GAEnBuJ,EAAKvO,WACVktC,EAAUjkC,EAAIK,KAAKiF,EAAKvO,WAAaiJ,EAAIif,QAAQ3Z,EAAKvO,WACtDuO,EAAOzI,EAAMqnC,eAAe5+B,EAAKpS,KAGnC,OAAO8M,EAGT,SAASu2B,EAAgB15B,EAAOub,EAAQC,GACtC,IAAIE,EAAW1b,EAAMC,SAASsb,GAC1BI,EAAW3b,EAAMC,SAASub,GAE9B,GAAIE,GAAYC,EAAU,CACxB,GAAID,EAASxhB,WAAayhB,EAASzhB,UAAW,OAAOy/B,EAAkBoN,QAGvE,IAFA,IAAIO,EAAS5rB,EAEN4rB,EAAOptC,WAAW,CACvB,GAAIotC,EAAOptC,YAAcyhB,EAAStlB,IAAK,OAAOsjC,EAAkBnB,WAChE8O,EAAStnC,EAAMqnC,eAAeC,EAAOjxC,KAKvC,IAFAixC,EAAS3rB,EAEF2rB,EAAOptC,WAAW,CACvB,GAAIotC,EAAOptC,YAAcwhB,EAASrlB,IAAK,OAAOsjC,EAAkBnZ,SAChE8mB,EAAStnC,EAAMqnC,eAAeC,EAAOjxC,MAIzC,OAAOsjC,EAAkBqN,KAG3B,IAAIz1B,EAAQ,IAAM,YAsElB,SAASvH,EAAWzL,GAClB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACd3D,EAAYgD,EAAGhD,UAInB,OAHAgW,EAAM,eACFrS,IAAac,EAAM1E,WAAU0E,EAAQA,EAAM8D,IAAI,WAAY5E,IAC3D3D,IAAcyE,EAAMzE,YAAWyE,EAAQA,EAAM8D,IAAI,YAAavI,IAC3DyE,EAuNT,IAAImxB,EAAY,CACd3W,SA7MF,SAAkBjc,GAChB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SAClBqS,EAAM,YAAarS,GACnB,IAAI+I,EAAQjI,EAAMC,SAASf,GAE3B,GAAI+I,EAAO,CACT,IAAIs/B,EAAU7tC,EAAM7C,OAAO,CACzBR,IAAK6C,IACLgB,UAAW+N,EAAM5R,MAQnB,OANA4R,EAAQA,EAAMnE,IAAI,YAAY,GAAOiI,OAAO,WAAW,SAAU3R,GAC/D,OAAOA,EAAQoJ,KAAK+jC,EAAQlxC,QAKvB2T,EAAW,CAChBhK,MAJFA,EAAQA,EAAM+L,OAAO,UAAU,SAAU9Q,GACvC,OAAOA,EAAO6I,IAAI5E,EAAU+I,GAAOnE,IAAIyjC,EAAQlxC,IAAKkxC,MAIpDroC,SAAUqoC,EAAQlxC,IAClBkF,UAAW1F,EAAUsd,kBAIzB,OAAOnT,GAsLPya,WAnLF,SAAoBlc,GAClB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SAClB,GAAIA,IAAac,EAAM5E,aAAc,OAAO4E,EAC5C,IAAIiI,EAAQjI,EAAMC,SAASf,GAE3B,GAAI+I,EAAO,CACT,IAAIu/B,EAAQxnC,EAAMC,SAASgI,EAAM/N,WAC7ButC,EAAQD,EAAMptC,QAAQqL,QAAQvG,GAC9BwoC,EAAYhuC,EAAM7C,OAAO,CAC3BR,IAAK6C,IACLgB,UAAWstC,EAAMnxC,MAOnB,OAAO2T,EAAW,CAChBhK,MANFA,EAAQA,EAAM+L,OAAO,UAAU,SAAU9Q,GACvC,OAAOA,EAAO6I,IAAI4jC,EAAUrxC,IAAKqxC,MAChC38B,SAAS,CAAC,SAAUy8B,EAAMnxC,IAAK,YAAY,SAAU+D,GACtD,OAAOA,EAAQgiB,OAAOqrB,EAAQ,EAAGC,EAAUrxC,QAI3C6I,SAAUwoC,EAAUrxC,IACpBkF,UAAW1F,EAAUsd,kBAIzB,OAAOnT,GA2JPma,eArSF,SAAwB5b,GACtB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACd+I,EAAQjI,EAAMC,SAASf,GAgB3B,OAdI+I,GAAgC,IAAvBA,EAAM7N,QAAQ4L,OACzBiC,EAAQA,EAAMmzB,MAAM,CAClB9gC,UAAW2N,EAAM3N,WAEnB0F,EAAQA,EAAM+K,SAAS,CAAC,SAAU9C,EAAM5R,IAAK,aAAa,SAAUiE,GAClE,OAAQA,MAIZ0F,EAAQgK,EAAW,CACjBhK,MAAOA,EACPd,SAAUA,EACV3D,UAAW1F,EAAUwM,UAqRvB+X,YAhRF,SAAqB7b,GACnB,IAAIyB,EAAQzB,EAAGyB,MACfuR,EAAM,eACN,IAAIo2B,EAAY/8B,EAAmB5K,EAAOA,EAAM3E,oBAQhD,OAPAkW,EAAMvR,GACNA,EAAQA,EAAM8K,eAAc,SAAU6B,GACpCg7B,EAAUvkC,SAAQ,SAAUlE,GAC1ByN,EAAE5I,MAAM,CAAC,SAAU7E,EAAU,aAAa,SAG9CqS,EAAMvR,GACCA,GAsQPqa,UAnQF,SAAmB9b,GACjB,IAAIyB,EAAQzB,EAAGyB,MACX2nC,EAAY/8B,EAAmB5K,EAAOA,EAAM3E,oBAQhD,OAPAkW,EAAMvR,GACNA,EAAQA,EAAM8K,eAAc,SAAU6B,GACpCg7B,EAAUvkC,SAAQ,SAAUlE,GAC1ByN,EAAE5I,MAAM,CAAC,SAAU7E,EAAU,aAAa,SAG9CqS,EAAMvR,GACCA,GA0PPua,SAvPF,SAAkBhc,GAChB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACdwxB,EAAOyW,EAAWnnC,EAAOd,GAAUsJ,QAAO,SAAUjM,GACtD,OAAOA,IAAM2C,KAYf,OAJIw6B,EANJ15B,EAAQA,EAAM8K,eAAc,SAAU6B,GACpC+jB,EAAKttB,SAAQ,SAAUlE,GACrByN,EAAE5I,MAAM,CAAC,SAAU7E,EAAU,aAAa,SAInBA,EAAUc,EAAM3E,sBAAwBs+B,EAAkBnB,aACnFx4B,EAAQA,EAAM8D,IAAI,qBAAsB9D,EAAM5E,eAGzC4E,GAwOPgK,WAAYA,EACZ2Q,aA5NF,SAAsBpc,GACpB,IAAIyB,EAAQzB,EAAGyB,MACXzE,EAAYgD,EAAGhD,UAGnB,OAFAgW,EAAM,gBACFhW,IAAcyE,EAAMzE,YAAWyE,EAAQA,EAAM8D,IAAI,YAAavI,IAC3DyE,GAwNP0a,YA9JF,SAAqBnc,GACnB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SAClB,GAAIA,IAAac,EAAM3E,mBAAoB,OAAO2E,EAClD,IAAIyI,EAAOzI,EAAMC,SAASf,GAqB1B,OAnBIuJ,IACFzI,EAAQA,EAAM8K,eAAc,SAAU6B,GACpCA,EAAEZ,OAAO,UAAU,SAAU9Q,GAC3BA,EAASA,EAAOuK,OAAOtG,GACvB,IAAI0oC,EAAah9B,EAAmB5K,EAAOd,GAM3C,OALAjE,EAASA,EAAO6P,eAAc,SAAUvO,GACtCqrC,EAAWxkC,SAAQ,SAAUykC,GAC3BtrC,EAAEiJ,OAAOqiC,YAKfl7B,EAAE5B,SAAS,CAAC,SAAUtC,EAAKvO,UAAW,YAAY,SAAUE,GAC1D,OAAOA,EAAQoL,OAAOpL,EAAQqL,QAAQvG,OAEpCyN,EAAErR,WAAa4D,GAAUyN,EAAE7I,IAAI,WAAY,MAAMA,IAAI,YAAa,UAInE9D,GAsIPib,aA1HF,SAAsB1c,GACpB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACdsB,EAAYjC,EAAGiC,UACfjF,EAAYgD,EAAGhD,UACftE,EAAOsH,EAAGtH,KACVgR,EAAQjI,EAAMC,SAASf,GAE3B,GAAI+I,EAAO,CACT,IAAI9I,EAAK8I,EAAM/H,SAASM,GACpB5G,EAAQuF,EAAGvF,MACXI,EAAQmF,EAAGnF,OAEA,IAAXJ,EACFoG,EAAQA,EAAM+K,SAAS,CAAC,SAAU7L,EAAU,WAAW,SAAUrF,GAC/D,OAAOA,EAAO2J,KAAKxN,EAAMa,OAAO,CAC9BG,KAAMwJ,EACNvJ,KAAMA,QAIN+C,EAAM/C,OAASA,IACjB+I,EAAQA,EAAM+K,SAAS,CAAC,SAAU7L,EAAU,SAAUtF,EAAO,SAAS,SAAUkuC,GAC9E,OAAO7wC,MAKTsE,IACFyE,EAAQgK,EAAW,CACjBhK,MAAOA,EACPd,SAAUA,EACV3D,UAAWA,KAKjB,OAAOyE,GAsFPmb,YAnFF,SAAqB5c,GACnB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACdsB,EAAYjC,EAAGiC,UACfyH,EAAQjI,EAAMC,SAASf,GAE3B,GAAI+I,EAAO,CACT,IAAI8/B,EAAU9/B,EAAM/H,SAASM,GAAW5G,OAEvB,IAAbmuC,IACF/nC,EAAQA,EAAM+K,SAAS,CAAC,SAAU7L,EAAU,WAAW,SAAUrF,GAC/D,OAAOA,EAAO2L,OAAOuiC,OAIzB/nC,EAAQgK,EAAW,CACjBhK,MAAOA,EACPd,SAAU,KACV3D,UAAW,OAIf,OAAOyE,GA8DP6a,SA3DF,SAAkBtc,GAChB,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SACdnE,EAAQwD,EAAGxD,MACXkN,EAAQjI,EAAMC,SAASf,GAU3B,OARI+I,GACElN,IAAUkN,EAAMlN,QAClBiF,EAAQA,EAAM+K,SAAS,CAAC,SAAU7L,EAAU,UAAU,SAAU1C,GAC9D,OAAOzB,MAKNiF,GA8CP+a,SA3CF,SAAkBxc,GAChB,IAAIyB,EAAQzB,EAAGyB,MACXzI,EAAQgH,EAAGhH,MAEf,OADAyI,EAAQA,EAAM+D,MAAM,CAAC,SAAU,SAAUxM,IAyCzCwgC,aArCF,SAAsBx5B,GACpB,IAAIyB,EAAQzB,EAAGyB,MACX3I,EAAYkH,EAAGlH,UACnB,OAAI2I,EAAM7E,OAAO9D,YAAcA,EAAkB2I,EACjDA,EAAQA,EAAM+D,MAAM,CAAC,SAAU,aAAc1M,IAkC7CglB,sBA9BF,SAA+B9d,GAC7B,IAAIyB,EAAQzB,EAAGyB,MACXd,EAAWX,EAAGW,SAGlB,OAFIc,EAAM3E,qBAAuB6D,IAAUc,EAAQA,EAAM8D,IAAI,qBAAsB5E,IAC/Ec,EAAMC,SAASf,GAAU5E,WAAU0F,EAAQA,EAAM+D,MAAM,CAAC,SAAU7E,EAAU,aAAa,IACtFc,GA0BPkR,cAvBF,SAAuB3S,GACrB,IAAIyB,EAAQzB,EAAGyB,MACXvE,EAAa8C,EAAG9C,WAEpB,OADIuE,EAAMvE,aAAeA,IAAYuE,EAAQA,EAAM8D,IAAI,aAAcrI,IAC9DuE,IAsBT,SAASs7B,EAAY9kC,GACnB,OAAmB,MAAZA,EAAIgB,MAAkC,MAAlBhB,EAAIkB,YAA4C,MAAtBlB,EAAImB,eAG3D,IAAIkmC,EAAe,CACjBrmC,KAAM,UACNC,aAAa,EACbC,WAAY,gBACZC,eAAgB,UAChBC,QAAS,GACTC,QAAS,GACTC,aAAc,CACZC,WAAY,OAEdC,UAAW,CACTC,WAAY,EACZC,SAAU,QACVC,UAAW,OAEbC,UAAW,CACTN,aAAc,CACZO,SAAU,OACVC,aAAc,OACdC,QAAS,uBAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,sBAGfC,aAAc,CACZZ,aAAc,CACZa,YAAa,MACbC,YAAa,QACbN,aAAc,OACdD,SAAU,OACVE,QAAS,uBAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,sBAGfI,YAAa,CACXf,aAAc,CACZgB,OAAQ,oBACRR,aAAc,OACdD,SAAU,OACVE,QAAS,YAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,WAIbvB,EAAsB,CACxBC,UAAU,EACVC,WAAW,EACXC,UAAW1B,EAAkB2B,eAC7BC,MAAOsmC,GAGL7kC,EAEJ,SAAU/C,GAGR,SAAS+C,IACP,OAAkB,OAAX/C,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAoC7D,OAvCA+F,EAAUjD,EAAQ/C,GAMlB2F,OAAOsB,eAAelE,EAAOoD,UAAW,YAAa,CACnD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,cAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAelE,EAAOoD,UAAW,WAAY,CAClD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,aAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAelE,EAAOoD,UAAW,YAAa,CACnD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,cAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAelE,EAAOoD,UAAW,QAAS,CAC/C9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,UAElB6X,YAAY,EACZC,cAAc,IAGhBpV,EAAOiuC,SAAW,SAAUzwC,GAC1B,OAAO,IAAIwC,EAAOxC,IAGbwC,EAxCT,CAyCE,iBAAO9B,IAEL8D,EAAqB,CACvBC,OAAQ,gBACRC,QAAS,gBACTC,OAAQ,KACRC,aAAc,KACdC,mBAAoB,KACpBC,SAAU,KACVC,UAAW,KACXC,cAAe,KACfC,WAAY,GAGV8gC,EAEJ,SAAUtmC,GAGR,SAASsmC,IACP,OAAkB,OAAXtmC,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAiM7D,OApMA+F,EAAUsgC,EAAOtmC,GAMjBsmC,EAAMyL,QAAU,SAAUxxC,GACxB,OAAOA,aAAe+lC,GAGxBA,EAAM1lC,OAAS,SAAUoxC,GAKvB,QAJc,IAAVA,IACFA,EAAQ,MAGG,MAATA,EAAe,OAAO1L,EAAM2L,cAChC,IAAI/kC,EAUJ,GARIo5B,EAAMyL,QAAQC,KAChB9kC,EAAM8kC,GAGJ,YAAcA,KAChB9kC,EAAMo5B,EAAM0K,SAASgB,IAGnB9kC,EASF,OARoB,MAAhBA,EAAI7H,WACN6H,EAAMA,EAAIW,IAAI,WAAYX,EAAI/H,eAGX,MAAjB+H,EAAI5H,YACN4H,EAAMA,EAAIW,IAAI,YAAajO,EAAUwM,SAGhCc,EAGT,MAAM,IAAIrM,MAAM,qEAAuEmxC,IAGzF1L,EAAM2L,YAAc,WAClB,IAAIloC,EAAQ,IAAIu8B,EACZnkC,EAAYsB,EAAM7C,OAAO,CAC3BR,IAAK6C,MAEP,OAAO8G,EAAM+L,OAAO,UAAU,SAAU9Q,GACtC,OAAOA,EAAO6I,IAAI1L,EAAU/B,IAAK+B,MAChC0L,IAAI,eAAgB1L,EAAU/B,KAAKyN,IAAI,WAAY1L,EAAU/B,KAAKyN,IAAI,YAAajO,EAAUwM,SAGlGk6B,EAAM0K,SAAW,SAAUkB,GACzB,IAAInoC,EAAQ,IAAIu8B,EACZh+B,EAAK4pC,EAAOltC,OACZA,OAAgB,IAAPsD,EAAgB,GAAKA,EAC9BY,EAAKgpC,EAAOhtC,OACZA,OAAgB,IAAPgE,EAAgB,GAAKA,EAC9B/D,EAAe+sC,EAAO/sC,aACtBC,EAAqB8sC,EAAO9sC,mBAchC,YAb2Bse,IAAvBte,IAAkCA,EAAqBD,GAK3D4E,GAJAA,EAAQA,EAAMo7B,MAAM,CAClBhgC,aAAcA,EACdC,mBAAoBA,KAERyP,eAAc,SAAU9K,GACpC/E,EAAOmI,SAAQ,SAAU6E,GACvBjI,EAAM+L,OAAO,UAAU,SAAU9Q,GAC/B,OAAOA,EAAO6I,IAAImE,EAAM5R,IAAKqD,EAAMutC,SAASh/B,UAGhDjI,EAAM8D,IAAI,SAAU9K,EAAOiuC,SAAS9rC,QAKxCohC,EAAMngC,UAAUwgC,KAAO,WAQrB,MAPU,CACRxhC,aAAclF,KAAKkF,aACnBH,OAAQW,OAAOwsC,OAAOlyC,KAAK+E,OAAO2hC,QAClCzhC,OAAQjF,KAAKiF,OACbD,QAAShF,KAAKgF,QACdO,WAAYvF,KAAKuF,aAKrBG,OAAOsB,eAAeq/B,EAAMngC,UAAW,UAAW,CAChD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,YAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,SAAU,CAC/C9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,WAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,SAAU,CAC/C9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,WAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,gBAAiB,CACtD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,kBAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,eAAgB,CACrD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,iBAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,qBAAsB,CAC3D9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,uBAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,WAAY,CACjD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,aAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,YAAa,CAClD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,cAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,oBAAqB,CAC1D9F,IAAK,WACH,OAAOJ,KAAKqF,YAAc1F,EAAUsd,gBAAkBjd,KAAKoF,SAAW,MAExE6S,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,iBAAkB,CACvD9F,IAAK,WACH,OAAOJ,KAAKqF,YAAc1F,EAAUwlB,aAAenlB,KAAKoF,SAAW,MAErE6S,YAAY,EACZC,cAAc,IAGhBmuB,EAAMngC,UAAU6D,SAAW,SAAU5J,GACnC,OAAOH,KAAK+E,OAAO3E,IAAID,IAGzBkmC,EAAMngC,UAAUsH,eAAiB,SAAUrN,EAAK+C,GAC9C,OAAOlD,KAAKgF,QAAQ5E,IAAID,IAAQ,IAAI+C,GAGtCmjC,EAAMngC,UAAUirC,eAAiB,SAAUhxC,GACzC,IAAI4R,EAAQ/R,KAAK+J,SAAS5J,GAC1B,OAAO4R,EAAM/N,UAAYhE,KAAK+J,SAASgI,EAAM/N,WAAa,MAG5DqiC,EAAMngC,UAAU05B,oBAAsB,SAAUz/B,GAI9C,IAHA,IAAI4R,EAAQ/R,KAAK+J,SAAS5J,GACtBgyC,EAAQ,EAELpgC,GAASA,EAAM5R,MAAQH,KAAKmF,oBACjCgtC,IACApgC,EAAQ/R,KAAKmxC,eAAep/B,EAAM5R,KAGpC,OAAOgyC,GAGTzsC,OAAOsB,eAAeq/B,EAAMngC,UAAW,YAAa,CAClD9F,IAAK,WACH,OAAOJ,KAAK+J,SAAS/J,KAAKkF,eAE5B+S,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAeq/B,EAAMngC,UAAW,aAAc,CACnD9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,eAElB6X,YAAY,EACZC,cAAc,IAETmuB,EArMT,CAsME,iBAAOvhC,K,iCClpCT,e,kuCCQYo+B,EAAM,mBAoBlB,SAAS0M,EAAQC,G,QACf,IAAKrvC,MAAMC,QAAQovC,GACjB,MAAM,IAAIljB,UAAU,sC,IACtB,IAAiB,M,uKAAA,CAAAkjB,GAAU,8BAAE,CAC3B,GAAkB,oBADP,QAET,MAAM,IAAIljB,UAAU,8C,iGAGxB,OAAO,SAASqjB,EAAS9kC,GAEvB,IAAIxH,GAAS,EACb,OACA,SAASusC,EAAS1pC,GAChB,GAAIA,GAAK7C,EAAO,MAAM,IAAI9C,MAAM,gCAChC8C,EAAQ6C,EACR,IAAImX,EAAKmyB,EAAWtpC,GAChBA,IAAMspC,EAAWppC,SAAQiX,EAAKxS,GAClC,IAAKwS,EAAI,OAAO,KAChB,IACE,OAAOA,EAAGsyB,EAASC,EAAS5mC,KAAK,KAAM9C,EAAI,IAC3C,MAAO2pC,GACP,MAAMA,GAVHD,CAAS,IAgBpB,IC1CYxwC,ED0CZ,aAME,WAAY0wC,QAAA,IAAAA,MAAA,IACF,QAAAvN,eAAA,WAAcx6B,EAAA,EAAAA,SAAUnH,EAAA,EAAAA,SAChCjB,KAAKiB,SAAWA,EAChBjB,KAAKoI,SAAWA,EAChBpI,KAAK6vC,WAAa,IAAIpjC,IAvD1B,SAAS2jC,EAAejmC,EAAwBkmC,GAC9C,GAAI7vC,MAAMC,QAAQ4vC,GAChBA,EAAOnjC,SAAQ,SAAArH,GAAK,OAAAuqC,EAAejmC,EAAYtE,WAIjD,GAAc,MAAVwqC,EAIJ,IAAK,IAAMlwC,KAAOkwC,EAAQ,CACxB,IAAM3yB,EAAK2yB,EAAOlwC,GAClBgK,EAAW0lC,WAAW1vC,GAAOgK,EAAW0lC,WAAW1vC,IAAQ,GAC3DgK,EAAW0lC,WAAW1vC,GAAKmN,KAAKoQ,IA4ChC0yB,CAAepwC,K,SEnEQmwC,QAAA,IAAAA,MAAA,IACjB,QAAAvN,QACR,OAAO,OADC,YFiEa0N,CAAW,CAAE1N,QAAO,KAqB3C,OAjBE,YAAAx4B,IAAA,SAAIjK,G,IAAa,wDACP,IAAA0vC,EAAA,KAAAA,WACFY,EAAMZ,EAAW1vC,IAAQ,GAC/BiyC,EAAuB,IAAf3B,EAAIhqC,OAAc,2BAA2BtG,EAAG,kBACxD,IAAMuwC,EAAalL,EAAWoK,EAAXpK,CAAoBiL,GAEvC,OAAOC,EAAU,eAAIH,KAGvB,YAAAliC,SAAA,SAASo0B,EAAiBzqB,GACxB,OAAOhY,KAAKoK,IAAI,WAAU,OAAO4N,GAAG,CAAEyqB,QAAO,MAG/C,YAAApb,OAAA,SAAOvd,EAAcyd,GACnBvnB,KAAKoI,SAAS0B,EAAOyd,GACrBvnB,KAAK2wC,aAAe7mC,GAExB,EAhCA,IC1CYrK,4CAAiB,KAC3B,mCACA,qCACA,uCACA,qCAGF,IAMaC,EAAY,CACvB23B,QAAS,UACTnS,KAAM,QAGKvlB,EAAY,CACvBwM,OAAQ,SACR8Q,gBAAiB,kBACjBkI,aAAc,eACd/H,WAAY,aACZgN,SAAU,YAKCqZ,EAAoB,CAC/BnZ,SAAU,WACVgY,WAAY,aACZuO,QAAS,UACTC,KAAM,Q,SrE7CQ9tC,IACd,MAAO,uCAAuCC,QAAQ,SAAS,SAASC,GACtE,IAAMC,EAAqB,GAAhBC,KAAKC,SAAiB,EAEjC,OADY,MAANH,EAAYC,EAAS,EAAJA,EAAW,GACzBG,SAAS,OuEKtB,IAMA,2B,+CAsBA,OAtB2BoJ,OACzB,sBAAI,mBAAI,C,IAAR,WACE,OAAO1M,KAAKI,IAAI,S,gCAGlB,sBAAI,mBAAI,C,IAAR,WACE,OAAOJ,KAAKI,IAAI,S,gCAGX,EAAAO,OAAP,SAAcL,GACZ,OAAO,IAAIR,EAAMQ,IAGZ,EAAA+D,WAAP,SAAkB/D,GAChB,GAAIiM,OAAKhM,OAAOD,IAAQE,MAAMC,QAAQH,GAEpC,OAAOiM,OAAKjM,EAAII,IAAIZ,EAAMa,SAE5B,MAAM,IAAIC,MACR,mEAAmEN,IAGzE,EAtBA,CAA2BoM,SANiB,CAC1C5L,KAAM,KACNX,IAAK,KACLY,KAAM,QCsBR,2B,+CAmEA,OAnE2B2L,OACzB,sBAAI,kBAAG,C,IAAP,WACE,OAAO1M,KAAKI,IAAI,Q,gCAElB,sBAAI,wBAAS,C,IAAb,WACE,OAAOJ,KAAKI,IAAI,c,gCAElB,sBAAI,uBAAQ,C,IAAZ,WACE,OAAOJ,KAAKI,IAAI,a,gCAElB,sBAAI,sBAAO,C,IAAX,WACE,OAAOJ,KAAKI,IAAI,Y,gCAElB,sBAAI,qBAAM,C,IAAV,WACE,OAAOJ,KAAKI,IAAI,W,gCAElB,sBAAI,wBAAS,C,IAAb,WACE,OAAOJ,KAAKI,IAAI,c,gCAElB,sBAAI,oBAAK,C,IAAT,WACE,OAAOJ,KAAKI,IAAI,U,gCAGlB,YAAA4J,SAAA,SAASlJ,GACP,IAAM4C,EAAQ1D,KAAK2D,OAAOC,WAAU,SAAAC,GAAK,OAAAA,EAAE/C,OAASA,KACpD,OAAe,IAAX4C,EAAqB,CAAEA,MAAK,EAAEI,MAAO,MAClC,CAAEJ,MAAK,EAAEI,MAAO9D,KAAK2D,OAAOvD,IAAIsD,KAGlC,EAAAqtC,SAAP,SAAgBzwC,GAEZ,IAAAH,EAAA,EAAAA,IACA,IAAA6D,iBAAA,aACAL,EAAA,EAAAA,OACA,IAAAO,eAAA,WACA,IAAAE,SAEF,OAAO,IAAIZ,EAAM,CACfrD,IAAG,EACH6D,UAAS,EACTI,cALA,SAMAF,QAASqI,OAAKrI,GACdP,OAAQ7D,EAAMuE,WAAWV,MAItB,EAAAhD,OAAP,SAAc,G,IACZR,EAAA,EAAAA,IACA,IAAA6D,iBAAA,aACA,IAAAS,eAAA,WACA,IAAAP,eAAA,WACA,IAAAE,gBAAA,SAEMN,EAAQhE,EAAMa,OAAO,CACzBG,KAAMpB,EAAU23B,QAChBt2B,KAAM0D,EACNtE,IAAK,OAGP,OAAO,IAAIqD,EAAM,CACfrD,IAAG,EACH6D,UAAS,EACTL,OAJa4I,OAAK,CAACzI,IAKnBI,QAASqI,OAAKrI,GACdE,SAAQ,KAGd,EAnEA,CAA2BsI,SAViB,CAC1CvM,IAAK,KACL6D,UAAW,KACXI,UAAU,EACVF,QAAS,KACTP,OAAQ,KACRiB,UAAW,KACXC,MAAO,Q,SC5BO6P,EAAmB5K,EAAcd,GAC/C,IAAMuJ,EAAOzI,EAAMC,SAASf,GAExBiE,EAAM,GACV,GAAIsF,EAAKrO,QAAQ4L,KAAO,EAAG,CACzB,IAAM5L,EAAUqO,EAAKrO,QAAQ6I,UAC7BE,EAAIK,KAAI,MAARL,EAAG,EAAS/I,IACZ+I,EAAM/I,EAAQwjB,QAAO,SAACC,EAAKxnB,GAEzB,OADAwnB,EAAIra,KAAI,MAARqa,EAAG,EAASjT,EAAmB5K,EAAO3J,KAC/BwnB,IACN1a,GAEL,OAAOA,EAGT,SAAgBgkC,EACdnnC,EACAd,EACAkoC,QAAA,IAAAA,OAAA,GAIA,IAFA,IAAMjkC,EAAM,CAACjE,GACTuJ,EAAOzI,EAAMC,SAASf,GACnBuJ,EAAKvO,WACVktC,EAAUjkC,EAAIK,KAAKiF,EAAKvO,WAAaiJ,EAAIif,QAAQ3Z,EAAKvO,WACtDuO,EAAOzI,EAAMqnC,eAAe5+B,EAAKpS,KAEnC,OAAO8M,EAGT,SAAgBu2B,EACd15B,EACAub,EACAC,GAEA,IAAME,EAAW1b,EAAMC,SAASsb,GAC1BI,EAAW3b,EAAMC,SAASub,GAChC,GAAIE,GAAYC,EAAU,CACxB,GAAID,EAASxhB,WAAayhB,EAASzhB,UACjC,OAAOy/B,EAAkBoN,QAE3B,IADA,IAAIO,EAAS5rB,EACN4rB,EAAOptC,WAAW,CACvB,GAAIotC,EAAOptC,YAAcyhB,EAAStlB,IAChC,OAAOsjC,EAAkBnB,WAC3B8O,EAAStnC,EAAMqnC,eAAeC,EAAOjxC,KAGvC,IADAixC,EAAS3rB,EACF2rB,EAAOptC,WAAW,CACvB,GAAIotC,EAAOptC,YAAcwhB,EAASrlB,IAAK,OAAOsjC,EAAkBnZ,SAChE8mB,EAAStnC,EAAMqnC,eAAeC,EAAOjxC,MAGzC,OAAOsjC,EAAkBqN,KCpC3B,IAAM34B,EAAM+qB,EAAM,YA2DlB,SAASpvB,EAAW,G,IAClBhK,EAAA,EAAAA,MACAd,EAAA,EAAAA,SACA3D,EAAA,EAAAA,UAKA,OAHA8S,EAAI,eACAnP,IAAac,EAAM1E,WAAU0E,EAAQA,EAAM8D,IAAI,WAAY5E,IAC3D3D,IAAcyE,EAAMzE,YAAWyE,EAAQA,EAAM8D,IAAI,YAAavI,IAC3DyE,EAyLT,MAAe,CACbwa,SAjLF,SAAkB,G,IAAExa,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SACzBmP,EAAI,YAAanP,GACjB,IAAI+I,EAAQjI,EAAMC,SAASf,GAC3B,GAAI+I,EAAO,CACT,IAAM,EAAQvO,EAAM7C,OAAO,CAAER,IAAK6C,IAAagB,UAAW+N,EAAM5R,MAOhE,OANA4R,EAAQA,EACLnE,IAAI,YAAY,GAChBiI,OAAO,WAAW,SAAA3R,GAAW,OAAAA,EAAQoJ,KAAK,EAAMnN,QAI5C2T,EAAW,CAChBhK,MAJFA,EAAQA,EAAM+L,OAAO,UAAU,SAAA9Q,GAC7B,OAAAA,EAAO6I,IAAI5E,EAAU+I,GAAOnE,IAAI,EAAMzN,IAAK,MAI3C6I,SAAU,EAAM7I,IAChBkF,UAAW1F,EAAUsd,kBAGzB,OAAOnT,GAiKPya,WA9JF,SAAoB,G,IAAEza,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAC3B,GAAIA,IAAac,EAAM5E,aAAc,OAAO4E,EAC5C,IAAMiI,EAAQjI,EAAMC,SAASf,GAC7B,GAAI+I,EAAO,CACT,IAAMu/B,EAAQxnC,EAAMC,SAASgI,EAAM/N,WAC7B,EAAMstC,EAAMptC,QAAQqL,QAAQvG,GAC5B,EAAUxF,EAAM7C,OAAO,CAAER,IAAK6C,IAAagB,UAAWstC,EAAMnxC,MAMlE,OAAO2T,EAAW,CAChBhK,MANFA,EAAQA,EACL+L,OAAO,UAAU,SAAA9Q,GAAU,OAAAA,EAAO6I,IAAI,EAAQzN,IAAK,MACnD0U,SAAS,CAAC,SAAUy8B,EAAMnxC,IAAK,YAAY,SAAA+D,GAC1C,OAAAA,EAAQgiB,OAAO,EAAM,EAAG,EAAQ/lB,QAIlC6I,SAAU,EAAQ7I,IAClBkF,UAAW1F,EAAUsd,kBAGzB,OAAOnT,GA6IPma,eA7PF,SAAwB,G,IAAEna,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAC3B+I,EAAQjI,EAAMC,SAASf,GAW3B,OAVI+I,GAAgC,IAAvBA,EAAM7N,QAAQ4L,OACzBiC,EAAQA,EAAMmzB,MAAM,CAClB9gC,UAAW2N,EAAM3N,WAEnB0F,EAAQA,EAAM+K,SACZ,CAAC,SAAU9C,EAAM5R,IAAK,aACtB,SAAAiE,GAAY,OAACA,MAGjB0F,EAAQgK,EAAW,CAAEhK,MAAK,EAAEd,SAAQ,EAAE3D,UAAW1F,EAAUwM,UAmP3D+X,YA/OF,SAAqB,G,IAAEpa,EAAA,EAAAA,MACrBqO,EAAI,eACJ,IAAMs5B,EAAY/8B,EAAmB5K,EAAOA,EAAM3E,oBAQlD,OAPAgT,EAAIrO,GACJA,EAAQA,EAAM8K,eAAc,SAAA6B,GAC1Bg7B,EAAUvkC,SAAQ,SAAAlE,GAChByN,EAAE5I,MAAM,CAAC,SAAU7E,EAAU,aAAa,SAG9CmP,EAAIrO,GACGA,GAsOPqa,UAnOF,SAAmB,G,IAAEra,EAAA,EAAAA,MACb2nC,EAAY/8B,EAAmB5K,EAAOA,EAAM3E,oBAQlD,OAPAgT,EAAIrO,GACJA,EAAQA,EAAM8K,eAAc,SAAA6B,GAC1Bg7B,EAAUvkC,SAAQ,SAAAlE,GAChByN,EAAE5I,MAAM,CAAC,SAAU7E,EAAU,aAAa,SAG9CmP,EAAIrO,GACGA,GA2NPua,SAxNF,SAAkB,G,IAAEva,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SACnBwxB,EAAOyW,EAAWnnC,EAAOd,GAAUsJ,QAAO,SAAAjM,GAAK,OAAAA,IAAM2C,KAa3D,OALEw6B,EAPF15B,EAAQA,EAAM8K,eAAc,SAAA6B,GAC1B+jB,EAAKttB,SAAQ,SAAAlE,GACXyN,EAAE5I,MAAM,CAAC,SAAU7E,EAAU,aAAa,SAKrBA,EAAUc,EAAM3E,sBACvCs+B,EAAkBnB,aAElBx4B,EAAQA,EAAM8D,IAAI,qBAAsB9D,EAAM5E,eAEzC4E,GA2MPgK,WAAU,EACV2Q,aA9LF,SAAsB,G,IAAE3a,EAAA,EAAAA,MAAOzE,EAAA,EAAAA,UAG7B,OAFA8S,EAAI,gBACA9S,IAAcyE,EAAMzE,YAAWyE,EAAQA,EAAM8D,IAAI,YAAavI,IAC3DyE,GA4LP0a,YAhJF,SAAqB,G,IAAE1a,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAC5B,GAAIA,IAAac,EAAM3E,mBAAoB,OAAO2E,EAClD,IAAMyI,EAAOzI,EAAMC,SAASf,GAqB5B,OApBIuJ,IACFzI,EAAQA,EAAM8K,eAAc,SAAA6B,GAC1BA,EAAEZ,OAAO,UAAU,SAAA9Q,GACjBA,EAASA,EAAOuK,OAAOtG,GACvB,IAAM0oC,EAAah9B,EAAmB5K,EAAOd,GAM7C,OALAjE,EAASA,EAAO6P,eAAc,SAAAvO,GAC5BqrC,EAAWxkC,SAAQ,SAAAykC,GACjBtrC,EAAEiJ,OAAOqiC,YAKfl7B,EAAE5B,SAAS,CAAC,SAAUtC,EAAKvO,UAAW,YAAY,SAAAE,GAChD,OAAAA,EAAQoL,OAAOpL,EAAQqL,QAAQvG,OAE7ByN,EAAErR,WAAa4D,GACjByN,EAAE7I,IAAI,WAAY,MAAMA,IAAI,YAAa,UAIxC9D,GA0HPib,aA/GF,SAAsB,G,IACpBjb,EAAA,EAAAA,MACAd,EAAA,EAAAA,SACAsB,EAAA,EAAAA,UACAjF,EAAA,EAAAA,UACAtE,EAAA,EAAAA,KAEMgR,EAAQjI,EAAMC,SAASf,GAC7B,GAAI+I,EAAO,CACH,oBAAErO,EAAA,EAAAA,MAAOI,EAAA,EAAAA,OACA,IAAXJ,EACFoG,EAAQA,EAAM+K,SAAS,CAAC,SAAU7L,EAAU,WAAW,SAAArF,GACrD,OAAAA,EAAO2J,KACLxN,EAAMa,OAAO,CACXG,KAAMwJ,EACNvJ,KAAMA,QAKR+C,EAAM/C,OAASA,IACjB+I,EAAQA,EAAM+K,SACZ,CAAC,SAAU7L,EAAU,SAAUtF,EAAO,SACtC,SAAAkuC,GAAM,OAAA7wC,MAIRsE,IACFyE,EAAQgK,EAAW,CACjBhK,MAAK,EACLd,SAAQ,EACR3D,UAAS,KAIf,OAAOyE,GA6EPmb,YA1EF,SAAqB,G,IAAEnb,EAAA,EAAAA,MAAOd,EAAA,EAAAA,SAAUsB,EAAA,EAAAA,UAChCyH,EAAQjI,EAAMC,SAASf,GAC7B,GAAI+I,EAAO,CACD,oBAAArO,OACO,IAAX,IACFoG,EAAQA,EAAM+K,SAAS,CAAC,SAAU7L,EAAU,WAAW,SAAArF,GACrD,OAAAA,EAAO2L,OAAO,OAGlBxF,EAAQgK,EAAW,CACjBhK,MAAK,EACLd,SAAU,KACV3D,UAAW,OAGf,OAAOyE,GA4DP6a,SAzDF,SAAkB,G,IAChB7a,EAAA,EAAAA,MACAd,EAAA,EAAAA,SACAnE,EAAA,EAAAA,MAEMkN,EAAQjI,EAAMC,SAASf,GAM7B,OALI+I,GACElN,IAAUkN,EAAMlN,QAClBiF,EAAQA,EAAM+K,SAAS,CAAC,SAAU7L,EAAU,UAAU,SAAA1C,GAAK,OAAAzB,MAGxDiF,GA+CP+a,SA5CF,SAAkB,G,IAAE/a,EAAA,EAAAA,MAAOzI,EAAA,EAAAA,MAEzB,OADAyI,EAAQA,EAAM+D,MAAM,CAAC,SAAU,SAAUxM,IA4CzCwgC,aAxCF,SAAsB,G,IAAE/3B,EAAA,EAAAA,MAAO3I,EAAA,EAAAA,UAC7B,OAAI2I,EAAM7E,OAAO9D,YAAcA,EAAkB2I,EACjDA,EAAQA,EAAM+D,MAAM,CAAC,SAAU,aAAc1M,IAuC7CglB,sBAnCF,SAA+B,G,IAC7Brc,EAAA,EAAAA,MACAd,EAAA,EAAAA,SAMA,OAJIc,EAAM3E,qBAAuB6D,IAC/Bc,EAAQA,EAAM8D,IAAI,qBAAsB5E,IACtCc,EAAMC,SAASf,GAAU5E,WAC3B0F,EAAQA,EAAM+D,MAAM,CAAC,SAAU7E,EAAU,aAAa,IACjDc,GA4BPkR,cAzBF,SAAuB,G,IACrBlR,EAAA,EAAAA,MACAvE,EAAA,EAAAA,WAIA,OAFIuE,EAAMvE,aAAeA,IACvBuE,EAAQA,EAAM8D,IAAI,aAAcrI,IAC3BuE,I,ICzQI69B,EAA0B,CACrCrmC,KAAM,UACNC,aAAa,EACbC,WAAY,gBACZC,eAAgB,UAChBC,QAAS,GACTC,QAAS,GAETC,aAAc,CACZC,WAAY,OAGdC,UAAW,CACTC,WAAY,EACZC,SAAU,QACVC,UAAW,OAGbC,UAAW,CACTN,aAAc,CACZO,SAAU,OACVC,aAAc,OACdC,QAAS,uBAEXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,sBAGfC,aAAc,CACZZ,aAAc,CACZa,YAAa,MACbC,YAAa,QACbN,aAAc,OACdD,SAAU,OACVE,QAAS,uBAGXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,sBAIfI,YAAa,CACXf,aAAc,CACZgB,OAAQ,oBACRR,aAAc,OACdD,SAAU,OACVE,QAAS,YAGXC,aAAc,CACZN,SAAU,QACVC,UAAW,MACXM,UAAW,WChDXvB,EAAwC,CAC5CC,UAAU,EACVC,WAAW,EACXC,UAAW1B,oBAAkB2B,eAC7BC,MAAOsmC,GAGT,2B,+CAoBA,OApB4Bj7B,OAC1B,sBAAI,wBAAS,C,IAAb,WACE,OAAO1M,KAAKI,IAAI,c,gCAGlB,sBAAI,uBAAQ,C,IAAZ,WACE,OAAOJ,KAAKI,IAAI,a,gCAGlB,sBAAI,wBAAS,C,IAAb,WACE,OAAOJ,KAAKI,IAAI,c,gCAGlB,sBAAI,oBAAK,C,IAAT,WACE,OAAOJ,KAAKI,IAAI,U,gCAGX,EAAA2wC,SAAP,SAAgBzwC,GACd,OAAO,IAAIwC,EAAOxC,IAEtB,EApBA,CAA4BoM,SAAO1L,ICG7B8D,EAAsC,CAC1CC,OAAQ0H,QACRzH,QAASyH,QACTxH,OAAQ,KACRC,aAAc,KACdC,mBAAoB,KACpBC,SAAU,KACVC,UAAW,KACXC,cAAe,KACfC,WAAY,GAGd,2B,+CAgJA,OAhJ2BmH,OAClB,EAAAolC,QAAP,SAAexxC,GACb,OAAOA,aAAe+lC,GAEjB,EAAA1lC,OAAP,SAAcoxC,GACZ,QADY,IAAAA,MAAA,MACC,MAATA,EAAe,OAAO1L,EAAM2L,cAChC,IAAI/kC,EAQJ,GAPIo5B,EAAMyL,QAAQC,KAChB9kC,EAAM8kC,GAGJM,EAAcN,KAChB9kC,EAAMo5B,EAAM0K,SAASgB,IAEnB9kC,EAOF,OANoB,MAAhBA,EAAI7H,WACN6H,EAAMA,EAAIW,IAAI,WAAYX,EAAI/H,eAEX,MAAjB+H,EAAI5H,YACN4H,EAAMA,EAAIW,IAAI,YAAajO,EAAUwM,SAEhCc,EAGT,MAAM,IAAIrM,MACR,qEAAuEmxC,IAIpE,EAAAC,YAAP,WACE,IAAMloC,EAAQ,IAAIu8B,EACZnkC,EAAYsB,EAAM7C,OAAO,CAAER,IAAK6C,MACtC,OAAO8G,EACJ+L,OAAO,UAAU,SAAA9Q,GAAU,OAAAA,EAAO6I,IAAI1L,EAAU/B,IAAK+B,MACrD0L,IAAI,eAAgB1L,EAAU/B,KAC9ByN,IAAI,WAAY1L,EAAU/B,KAC1ByN,IAAI,YAAajO,EAAUwM,SAGzB,EAAA4kC,SAAP,SAAgBkB,GACd,IAAInoC,EAAQ,IAAIu8B,EACR,IAAAthC,cAAA,WAAa,IAAAE,cAAA,WAAaC,EAAA,EAAAA,aAC5BC,EAAA,EAAAA,mBAkBN,YAhB2Bse,IAAvBte,IAAkCA,EAAqBD,GAO3D4E,GALAA,EAAQA,EAAMo7B,MAAM,CAClBhgC,aAAY,EACZC,mBAAkB,KAGNyP,eAAc,SAAA9K,GAC1B/E,EAAOmI,SAAQ,SAAA6E,GACbjI,EAAM+L,OAAO,UAAU,SAAA9Q,GACrB,OAAAA,EAAO6I,IAAImE,EAAM5R,IAAKqD,EAAMutC,SAASh/B,UAGzCjI,EAAM8D,IAAI,SAAU9K,EAAOiuC,SAAS9rC,QAMxC,YAAAyhC,KAAA,WAQE,MAPY,CACVxhC,aAAclF,KAAKkF,aACnBH,OAAQW,OAAOwsC,OAAOlyC,KAAK+E,OAAO2hC,QAClCzhC,OAAQjF,KAAKiF,OACbD,QAAShF,KAAKgF,QACdO,WAAYvF,KAAKuF,aAKrB,sBAAI,sBAAO,C,IAAX,WACE,OAAOvF,KAAKI,IAAI,Y,gCAGlB,sBAAI,qBAAM,C,IAAV,WACE,OAAOJ,KAAKI,IAAI,W,gCAGlB,sBAAI,qBAAM,C,IAAV,WACE,OAAOJ,KAAKI,IAAI,W,gCAGlB,sBAAI,4BAAa,C,IAAjB,WACE,OAAOJ,KAAKI,IAAI,kB,gCAGlB,sBAAI,2BAAY,C,IAAhB,WACE,OAAOJ,KAAKI,IAAI,iB,gCAGlB,sBAAI,iCAAkB,C,IAAtB,WACE,OAAOJ,KAAKI,IAAI,uB,gCAGlB,sBAAI,uBAAQ,C,IAAZ,WACE,OAAOJ,KAAKI,IAAI,a,gCAGlB,sBAAI,wBAAS,C,IAAb,WACE,OAAOJ,KAAKI,IAAI,c,gCAGlB,sBAAI,gCAAiB,C,IAArB,WACE,OAAOJ,KAAKqF,YAAc1F,EAAUsd,gBAAkBjd,KAAKoF,SAAW,M,gCAGxE,sBAAI,6BAAc,C,IAAlB,WACE,OAAOpF,KAAKqF,YAAc1F,EAAUwlB,aAAenlB,KAAKoF,SAAW,M,gCAGrE,YAAA2E,SAAA,SAAS5J,GACP,OAAOH,KAAK+E,OAAO3E,IAAID,IAGzB,YAAAqN,eAAA,SAAkBrN,EAAa+C,GAC7B,OAAOlD,KAAKgF,QAAQ5E,IAAID,IAAQ,IAAI+C,GAGtC,YAAAiuC,eAAA,SAAehxC,GACb,IAAM4R,EAAQ/R,KAAK+J,SAAS5J,GAC5B,OAAO4R,EAAM/N,UAAYhE,KAAK+J,SAASgI,EAAM/N,WAAa,MAG5D,YAAA47B,oBAAA,SAAoBz/B,GAGlB,IAFA,IAAI4R,EAAQ/R,KAAK+J,SAAS5J,GACtBgyC,EAAQ,EACLpgC,GAASA,EAAM5R,MAAQH,KAAKmF,oBACjCgtC,IACApgC,EAAQ/R,KAAKmxC,eAAep/B,EAAM5R,KAEpC,OAAOgyC,GAGT,sBAAI,wBAAS,C,IAAb,WACE,OAAOnyC,KAAK+J,SAAS/J,KAAKkF,e,gCAG5B,sBAAI,yBAAU,C,IAAd,WACE,OAAOlF,KAAKI,IAAI,e,gCAEpB,EAhJA,CAA2BsM,SAAO5H,I,mHReZ,CACpBsP,gBAAiB,kBACjB+J,aAAc,eACdC,WAAY,aACZgG,UAAW,YACXlB,UAAW,YACXC,YAAa,cACb3O,aAAc,eACdtI,YAAa,cACbE,eAAgB,iBAChBsY,UAAW,YACXE,UAAW,YACXE,gBAAiB,kBACjBE,mBAAoB,qBAGpBpB,sBAAuB,wBACvBC,mBAAoB,qBACpBuB,cAAe,gBACf9B,gBAAiB,mB,2BA7DW,CAC5B+K,KAAM,IACNiB,MAAO,IACPshB,OAAQ,IACR/hB,KAAM,K,yCAUwB,CAC9BgR,KAAM,EACNC,QAAS,EACT3zB,OAAQ,G,gHSkBkB7L,GAC1B,OACc,MAAZA,EAAIgB,MAAkC,MAAlBhB,EAAIkB,YAA4C,MAAtBlB,EAAImB,iB,qSCjBzC6wC,EACH,4BADGA,EAEH,CACFC,SAAU,0CACVC,MAAO,wCAJFF,EAMA,CACLG,KAAM,oCACN9xC,OAAQ,2CACR+xC,KAAM,0CATDJ,EAYE,CACPG,KAAM,sCACN9xC,OAAQ,6CACR+xC,KAAM,4CAgBP,IAAMC,EACF,OADEA,EAED,OCrBL,SAASC,IACZ,OAAO,IAAIlyB,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAeI,KAAO,IAAMI,aAAaC,QAAQ,WAAY,CAC/DC,OAAQ,MACRC,QAAS,CACL,cAAiB,UAAYH,aAAaC,QAAQ,SAClD,eAAgB,sBAGnB7U,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAGH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQt7B,IAAI,SAAUpB,GACtB6J,EAAO7J,SAKhB,IAAM28B,EAAyB,SAACpb,GACnC,OAAO,IAAI5X,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAeG,KAAO,IAAMK,aAAaC,QAAQ,WAAa,WAAaza,EAAI,CACjF0a,OAAQ,SACRC,QAAS,CACL,cAAiB,UAAYH,aAAaC,QAAQ,SAClD,eAAgB,sBAGnB7U,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAGH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,U,SCjFV48B,EAAiB,SAACC,EAAWlwC,GAAZ,OAAsB,SAACusC,GACjD,OAAO,IAAIvvB,SAAQ,SAACC,EAASC,IDb1B,SAAoBgzB,GACvB,IAAIC,EAAU,GACdA,EAAQC,QAAUhB,aAAaC,QAAQ,WACvCc,EAAQvyC,KAAOsyC,EACf,IAAI9zB,EAAMwyB,EAAe3xC,OACzB,OAAO,IAAI+f,SAAQ,SAACC,EAASC,GACzBiyB,MAAM/yB,EAAK,CACPkzB,OAAQ,OACRC,QAAS,CACL,cAAiB,UAAYH,aAAaC,QAAQ,SAClD,eAAgB,oBAEpBgB,KAAM5X,KAAKC,UAAUyX,KAEpB3V,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAGH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,UCjBfi9B,CAAWJ,GAAW1V,MAAK,SAACjxB,GACxBwmC,QAAQt7B,IAAI,sBAAuBlL,GACnC,IAAI3M,EAAM,CACNgB,KAAMsyC,EACNK,IAAKhnC,EAAIgnC,IACTvzC,IAAKuM,EAAIvM,IAAMuM,EAAIvM,IAAM,IAE7BuvC,EAfgB,SAAC2D,EAAWlwC,GAAZ,MAAuB,CAC/C5C,KCTyB,gBDUzB8yC,YACAlwC,SAYiBwwC,CAAa5zC,EAAKoD,IAC3Bid,EAAQ1T,MAEPumC,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,KAE5BsT,EAAOtZ,WAUV8sC,EAAkB,SAACC,GAAD,OAAgB,SAACpE,GAC5CA,EANyB,SAACoE,GAAD,MAAiB,CAC1CvzC,KCnC0B,iBDoC1BuzC,cAISC,CAAcD,MAQdE,EAAuB,SAACX,GAAD,OAAe,SAAC3D,GAChDA,EAN8B,SAAC2D,GAAD,MAAgB,CAC9C9yC,KC1CiC,wBD2CjC0zC,gBAAiBZ,GAIRa,CAAmBb,MAQnBc,EAAoB,SAACd,GAAD,OAAe,SAAC3D,GAE7C,OAAO,IAAIvvB,SAAQ,SAACC,EAASC,GACzB8yB,EAAuBE,EAAUK,KAAK/V,MAAK,SAAAjxB,GACvCgjC,EATmB,SAAC2D,GAAD,MAAgB,CAC3C9yC,KCjD4B,mBDkD5B4C,MAAOkwC,EAAUK,KAOAU,CAAgBf,IACzBjzB,EAAQ1T,MAEPumC,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,KAE5BsT,EAAOtZ,WEsCRstC,EAzDX,WAAYC,GAAU,oBAElB,IAAIC,EAAa,CACb9iC,MAAO,CACH+iC,MAAO,KACPC,UAAW,GACXC,aAAc,GACdC,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KAC5B,CAAC,OAAQ,SAAU,cACnBhsC,YAAa,eAEjBisC,YAAa,CACTL,MAAO,KACPC,UAAW,GACXC,aAAc,GACdC,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KAC5B,CAAC,OAAQ,SAAU,cACnBhsC,YAAa,qBAEjBksC,QAAS,CACLN,MAAO,KACPC,UAAW,GACXC,aAAc,GACdC,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KAC5B,CAAC,OAAQ,SAAU,cACnBhsC,YAAa,iBAEjBmsC,OAAQ,CACJP,MAAO,KACPC,UAAW,GACXC,aAAc,GACdC,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KAC5B,CAAC,OAAQ,SAAU,cACnBhsC,YAAa,gBAEjBosC,UAAW,IAAIC,KACfC,QAAS,IAAID,KACbjiC,MAAOo/B,EACPY,OAAQZ,EACR+C,SAAU,GACVC,UAAW,KACXC,SAAU,EACVC,MAAO,GACPC,WAAY,EACZC,KAAM,IAAIP,KACVQ,QAAQ,EACRC,YAAanD,aAAaC,QAAQ,gBAGF,IAAhCrtC,OAAO80B,KAAKqa,GAASpuC,OACrBzG,KAAK60C,QAAUnvC,OAAOU,OAAO,GAAdV,OAAA,IAAAA,CAAA,GAAsBovC,GAAtBpvC,OAAA,IAAAA,CAAA,GAAuCmvC,IAEtD70C,KAAK60C,QAAUnvC,OAAOU,OAAO,GAAdV,OAAA,IAAAA,CAAA,GAAsBmvC,GAAtBnvC,OAAA,IAAAA,CAAA,GAAoCovC,KCxGzDoB,EAAe,CAAC,QAAS,cAAe,UAAW,UAGlD,SAASC,EAAYC,GACxB,GAAIA,EAAQ,CACR,IAAIvC,EAAUnuC,OAAOU,OAAO,GAAIgwC,GAWhC,OATAF,EAAahpC,SAAQ,SAAAmpC,UACVxC,EAAQwC,GAAMtB,aACdlB,EAAQwC,GAAMpB,oBACdpB,EAAQwC,GAAMnB,eACdrB,EAAQwC,GAAMltC,sBAGlB0qC,EAAQ6B,gBACR7B,EAAQ8B,UACR9B,EAEP,MAAO,GCdR,SAASyC,EAAczC,EAAS0C,GACnC1C,EAAQC,QAAUhB,aAAaC,QAAQ,WACvCc,EAAQ0C,aAAeA,EACvB,IAAIz2B,EAAMwyB,EAAaG,KAAO,IAAMK,aAAaC,QAAQ,WAA/C,WAAgEwD,GAAiB,UAC3F,OAAO,IAAI71B,SAAQ,SAACC,EAASC,GACrBiyB,MAAM/yB,EAAK,CACPkzB,OAAQ,OACRC,QAAS,CACL,cAAiB,UAAUH,aAAaC,QAAQ,SAChD,eAAgB,oBAEpBgB,KAAM5X,KAAKC,UAAUyX,KAExB3V,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GACH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,SAKhB,SAASy/B,EAAYD,GACxB,OAAO,IAAI71B,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAaG,KAAK,IAAIK,aAAaC,QAAQ,WAA3C,WAA0DwD,EAA1D,KAA0E,OAAQ,CACpFvD,OAAQ,MACRC,QAAS,CACL,cAAiB,UAAUH,aAAaC,QAAQ,SAChD,eAAgB,sBAGvB7U,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAGH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,S,IC/CJ0/B,EAfX,aAAsB,oBAClB,IAAIC,EAAS,CACT3B,MAAO,KACPC,UAAW,GACXC,aAAc,GACd50C,MAAO,GACP60C,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KAC5B,CAAC,OAAQ,SAAU,cACnBhsC,YAAa,eAGjBnJ,KAAKgS,MAAQtM,OAAOU,OAAO,GAAdV,OAAA,IAAAA,CAAA,GAAsBgxC,K,SCoBpC,SAASC,EAAc9C,EAAS0C,EAAcK,GAIjD,GAHA/C,EAAQC,QAAUhB,aAAaC,QAAQ,WAGnCc,EACA,OAAO,IAAInzB,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAY,YAAcQ,aAAaC,QAAQ,WAAa,IAAMwD,EAAe,WAAaK,EAAY,CAC5G5D,OAAQ,MACRC,QAAS,CACL,cAAiB,UAAYH,aAAaC,QAAQ,SAClD,eAAgB,oBAEpBgB,KAAM5X,KAAKC,UAAUyX,KAEpB3V,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAGH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,SAgBpB,IAAM8/B,EAxEb,SAAkBtvB,EAAUuvB,GACxB,IAAyBvG,EAAMP,EAA3B+G,GAAc,EAqBlB,OAnBA,SAASC,IACL,GAAID,EAGA,OAFAxG,EAAOrwC,eACP8vC,EAAUhwC,MAId+2C,GAAc,EACdxvB,EAAStnB,MAAMD,KAAME,WAErB8wB,YAAW,WACP+lB,GAAc,EACVxG,IACAyG,EAAQ/2C,MAAM+vC,EAASO,GACvBA,EAAOP,EAAU,QAEtB8G,IAqDyBG,EAAS,SAACpD,GAE1C8C,EAAc9C,GACb3V,MAAK,SAAAjxB,GAAG,OAAIwmC,QAAQt7B,IAAI,2DAA4DlL,MACpFumC,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,UAGjC,MAsCI,SAAS4pC,EAAWC,EAAaC,GAEpC,OADA3D,QAAQt7B,IAAI,aAAcg/B,GACnB,IAAIz2B,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAaG,KAAK,IAAIK,aAAaC,QAAQ,WAAW,QAAQoE,EAAY,YAAYC,EAAW,CACnGpE,OAAQ,MACRC,QAAS,CACL,cAAiB,UAAUH,aAAaC,QAAQ,SAChD,eAAgB,sBAGvB7U,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAGH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,SAKZ,SAASsgC,EAAgBC,EAAOzD,GAGnC,GAFAA,EAAQC,QAAUhB,aAAaC,QAAQ,WAEnCc,EACA,OAAO,IAAInzB,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAaG,KAAO,IAAMK,aAAaC,QAAQ,WAAa,IAAMuE,EAAQ,WAAazD,EAAQI,IAAK,CACtGjB,OAAQ,MACRC,QAAS,CACL,cAAiB,UAAYH,aAAaC,QAAQ,SAClD,eAAgB,oBAEpBgB,KAAM5X,KAAKC,UAAUyX,KAEpB3V,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAGH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,S,8BCtLdwgC,EAAa,SAACtD,EAAKuD,EAAK3C,GAAX,MAAwB,CAC9C/zC,KAAM,cACNmzC,MACAuD,MACA3C,YA8CS8B,EAAgB,SAACc,GAAD,oBACzB32C,KAAM,kBACH22C,IAGMC,EAAoB,SAACD,GAAD,oBAC7B32C,KAAM,uBACH22C,IAsLME,EAAkB,SAACF,GAAD,OAAU,SAACxH,EAAU2H,GAAc,IAE1DC,EACAD,IADAC,SAIJ,QAAgBp0B,GAAZg0B,EAAKD,KAWL,GATAvH,EAASyH,EAAkBD,IAE3BhE,QAAQt7B,IAAI,+FACZ0+B,EAAqBiB,IAAOC,UAAUF,EAASnF,KAAK+E,EAAKnf,IAAIud,MAAM4B,EAAKD,OACxD,SAAZC,EAAKt3C,KAGL8vC,EA3FW,SAACwH,GAAD,OAAU,SAACxH,EAAU2H,GAAa,IAIjDC,EACAD,IADAC,SAEAG,EAAkBH,EAASG,gBAG3Bt3C,EAFgBm3C,EAASnF,KAAKsF,GAE9Bt3C,IAGAu3C,EAAKR,EAAKS,IAAIlvC,SAIdmvC,EAAgBz3C,EAAIqE,OAAOuN,QAAO,SAAAjM,GAClC,GAAKA,EAAElG,KAAO83C,EACV,OAAO5xC,KAKA3F,EAAIqE,OAAOuN,QAAO,SAAA8lC,GAC7B,GAAqB,MAAhBA,EAAGp0C,UACJ,OAAOo0C,KAMXD,EAAc1xC,OAAS,IAEvB0xC,EAAc,GAAGx0C,OAAO,GAAG5C,KAAO02C,EAAKS,IAAIlD,UAE3Ct0C,EAAIqE,OAAOmI,SAAQ,SAACqF,GACZA,EAAKpS,KAAOg4C,EAAc,GAAGh4C,MAC7BoS,EAAK5O,OAAO,GAAG5C,KAAOo3C,EAAc,GAAGx0C,OAAO,GAAG5C,SAIzDkvC,EAAS0G,EAAc,CACnBre,GAAImf,EAAKnf,GACTn4B,IAAK,MACL+3C,IAAKx3C,KAET+yC,QAAQt7B,IAAI,uDAEZ0+B,EAAqBiB,IAAOC,UAAUF,EAASnF,KAAKsF,OA2CvCK,CAAeZ,IAEZ,UAAZA,EAAKt3C,IAAiB,CACtB,IAAIG,EAAM,CACVA,IAAU,aACoB,QAA1Bm3C,EAAKS,IAAI1lC,cACTlS,EAAI43C,IAAM,IAAI1C,KAEdl1C,EAAI43C,IAAM,KACd53C,EAAIg4B,GAAKmf,EAAKnf,GACdh4B,EAAIk3C,IAAMC,EAAKD,IACfvH,EAASyH,EAAkBp3C,SAM5B,CAEH,GADA2vC,EAAS0G,EAAcc,IACP,UAAZA,EAAKt3C,IAAiB,CACtB,IAAIG,EAAM,CACVA,IAAU,aACoB,QAA1Bm3C,EAAKS,IAAI1lC,cACTlS,EAAI43C,IAAM,IAAI1C,KAEdl1C,EAAI43C,IAAM,KACd53C,EAAIg4B,GAAKmf,EAAKnf,GACd2X,EAAS0G,EAAcr2C,IAGV,QAAbm3C,EAAKt3C,KACL8vC,GAjOiB,SAACA,EAAU2H,GAAc,IAE9CC,EACAD,IADAC,SAEAG,EAAkBH,EAASG,gBAC3BM,EAAgBT,EAASnF,KAAKsF,GAElCM,EAAc53C,IAAIqE,OAAOmI,SAAQ,SAACqrC,EAAIhyC,GAClC,GAAoB,MAAhBgyC,EAAGv0C,UAGH,GAAkB,MAAdu0C,EAAGC,QAAiB,CACpB,IAAI1D,EAAa,IAAI2B,EAarB3B,EAAW9iC,MAAMgjC,UAAYuD,EAAG50C,OAAO,GAAG5C,KAC1C+zC,EAAW9iC,MAAMhJ,SAAWuvC,EAAGp4C,IAC/B20C,EAAW9iC,MAAMhO,UAAYu0C,EAAGv0C,UAChC,IAAIy0C,EAAoB,IAAI7D,EAAaE,GACzCwB,EAAcmC,EAAkB5D,QAASyD,EAAcrE,KAAK/V,MAAK,SAAAjxB,GAE7DwrC,EAAkB5D,QAAQZ,IAAMhnC,EAAIgnC,IAEpCsE,EAAGC,QAAUvrC,EAAIgnC,IAEjBhE,EAASsH,EAAWS,EAAiB/qC,EAAIgnC,IAAKwE,EAAkB5D,UAEhE5E,EAAS0G,EAAc,CACnBre,GAAI0f,EACJ73C,IAAK,aACL+3C,IAAKL,EAASnF,KAAKmF,EAASG,iBAAiBlC,WAAa,QAGjEtC,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,YAG7B,CAIH,IAEI0E,EAFWsmC,EAAczC,MAAM0C,EAAGC,SAEjBxmC,MAErBA,EAAMgjC,UAAYuD,EAAG50C,OAAO,GAAG5C,KAC3BiR,EAAM+iC,QACN/iC,EAAMijC,aAAejjC,EAAM+iC,MAAM2D,QAAQH,EAAG50C,OAAO,GAAG5C,OAG1DkvC,EAASyH,EAAkB,CACvBpf,GAAI0f,EACJR,IAAKe,EAAGC,QACRr4C,IAAK,QACL+3C,IAAKlmC,KAITyhC,QAAQt7B,IAAI,uDACZ0+B,EAAqBiB,IAAOC,UAAUF,EAASnF,KAAKsF,GAAiBnC,MAAM0C,EAAGC,eAE/E,CAEH,IAEIxmC,EAFWsmC,EAEMtmC,MAErBA,EAAMgjC,UAAYuD,EAAG50C,OAAO,GAAG5C,KAC3BiR,EAAM+iC,QACN/iC,EAAMijC,aAAejjC,EAAM+iC,MAAM2D,QAAQH,EAAG50C,OAAO,GAAG5C,OAG1DkvC,EAAS0G,EAAc,CACnBre,GAAI0f,EACJ73C,IAAK,QACL+3C,IAAKlmC,KAITyhC,QAAQt7B,IAAI,iFACZ0+B,EAAqBiB,IAAOC,UAAUF,EAASnF,KAAKsF,SAI5D/H,EAAS0G,EAAc,CACnBre,GAAI0f,EACJ73C,IAAK,MACL+3C,IAAKI,EAAc53C,aA4Idi4C,EAAqB,SAACrgB,GAAD,OAAQ,SAAC2X,GACvCA,EAN4B,SAAC3X,GAAD,MAAS,CACrCx3B,KAAM,qBACNw3B,MAISsgB,CAAiBtgB,MAQjBugB,EAAgB,SAACpB,GAAD,OAAU,SAACxH,GACpCA,EANuB,SAACwH,GAAD,oBACvB32C,KAAM,gBACH22C,GAIMqB,CAAYrB,MClTnBsB,G,mNACF3xC,MAAQ,CACJ4xC,eAAe,EACfpF,UAAW,GACX7yC,KAAM,GACNk4C,QAAS,GACTC,aAAc,KACdC,aAAc,O,EAGlBC,YAAc,WACV,EAAK9wC,SAAS,CACV0wC,eAAgB,EAAK5xC,MAAM4xC,iB,EAInCK,eAAiB,SAAC/xC,GAEd,GADA,EAAKgB,SAAS,CAAEsrC,UAAWtsC,EAAEQ,OAAOzH,QAChCiH,EAAEQ,OAAOzH,MAAO,CAChBozC,QAAQt7B,IAAI,kBAAmB7Q,EAAEQ,OAAOzH,OAGxC,IAAIiB,EAAOgG,EAAEQ,OAAOzH,MAGhBi5C,EAFU,EAAKlyC,MAAM6xC,QAEC3mC,QAAO,SAAAC,GAC7B,OAAIA,EAAKjR,KAAKkR,cAAcnF,SAAS/L,EAAKkR,eAC/BD,EAEA,QAIf,EAAKjK,SAAS,CAAEvH,KAAMu4C,SAGtB,EAAKhxC,SAAS,CAAEvH,KAAM,EAAKqG,MAAM6xC,W,EAYzCM,cAAgB,SAACC,GACb/F,QAAQt7B,IAAI,OAAQqhC,GACpB,EAAKvyC,MAAMstC,qBAAX,eACOiF,IAEP,EAAKvyC,MAAM4xC,cAAc,IACzBrC,EAAYgD,EAAGvF,KAAK/V,MAAK,SAAAjxB,GAErB,EAAK3E,SAAS,CAAEmxC,SAAS,IACzB,IAAI/G,EAAO,GACPzlC,EAAIylC,MAAQzlC,EAAIylC,KAAKjsC,OAAS,GAC9BwG,EAAIylC,KAAKxlC,SAAQ,SAAA60B,GACb2Q,EAAK3Q,EAAQkS,KAAOlS,KAG5B,EAAK96B,MAAM4xC,cAAc,CAAEnG,SAC3B,IAAIgH,EAAS,GACTzsC,EAAI2mC,WAAa3mC,EAAI2mC,UAAUntC,OAAS,IACxCizC,EAASzsC,EAAI2mC,UAAU,IAE3B,EAAKtrC,SAAS,CACV6wC,aAAcO,IAElB,EAAKzyC,MAAMstC,qBAAX,eACOmF,IAEP,EAAKN,cACL,EAAKnyC,MAAMktC,QAAQ7mC,KAAK,cAAgBksC,EAAGvF,IAAM,iBAEhDT,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,S,EAKxCqsC,gBAAkB,WAAO,IAAD,EAIhB,EAAKvyC,MAFLwsC,EAFgB,EAEhBA,UACAqF,EAHgB,EAGhBA,QAGJ,EAAKhyC,MAAM0sC,eAAeC,GAAW1V,MAAK,SAAA0b,GACtCX,EAAQ3rC,KAAK,CACThM,KAAMsyC,EACNK,IAAK2F,EAAU3F,MAEnB,EAAK3rC,SAAS,CACVsrC,UAAW,GACX7yC,KAAMk4C,EACNA,YACD,WACCxF,QAAQt7B,IAAI,WAAY8gC,SAG/BzF,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,+BAAgC7Q,O,EAIpDqtC,gBAAkB,SAACrtC,EAAGuyC,GAClBvyC,EAAEC,kBACF,EAAKN,MAAMytC,kBAAkBmF,GAFL,IAgBpBn2C,EAHA2wC,EACA,EAAKptC,MADLotC,WAEAyF,EAAUzF,EAAW/hC,QAAO,SAAAknC,GAAE,OAAIA,EAAGvF,KAAO4F,EAAE5F,OAE5B,GAAlB6F,EAAQrzC,SACR/C,EAAQ2wC,EAAW9kC,QAAQuqC,EAAQ,IACnCrG,QAAQt7B,IAAI,gBAAiBzU,IAEjC,EAAK4E,SAAS,CACVvH,KAAK,GAAD,mBACGszC,EAAWlT,MAAM,EAAGz9B,IADvB,YAEG2wC,EAAWlT,MAAMz9B,EAAQ,Q,sDA7FhC6C,GACJvG,KAAKsI,SAAS,CAAE4wC,aAAc3yC,M,+BAGzBA,GACLvG,KAAKsI,SAAS,CAAE4wC,aAAc,S,0CA6Fb,IAAD,OAChBzF,QAAQt7B,IAAI,iCACZ,IAAI4hC,EAAS,GAEbnH,IAAgB1U,MAAK,SAAAjxB,GACjBwmC,QAAQt7B,IAAI,yBAA0BlL,GACtC,EAAKhG,MAAMmtC,gBAAgBnnC,EAAIylC,MAC/B,IAAK,IAAInsC,EAAI,EAAGA,EAAI0G,EAAIylC,KAAKjsC,OAAQF,IAAK,CACtC,IAAIszC,EAAI5sC,EAAIylC,KAAKnsC,GACb,EAAKU,MAAM+yC,MAAMC,OAAO1D,cAAgBsD,EAAE5F,MAI1C8F,EAASF,GAGjB,EAAKvxC,SAAS,CACVvH,KAAMkM,EAAIylC,KACVuG,QAAShsC,EAAIylC,KACbyG,aAAcY,OAGjBvG,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,U,+BAK9B,IAAD,SAMDtN,KAAKoH,MAJL4xC,EAFC,EAEDA,cACApF,EAHC,EAGDA,UACA7yC,EAJC,EAIDA,KACAo4C,EALC,EAKDA,aAGJ,OACI,oCACI,4BAAQnpC,UAAU,SAASjE,QAAS/L,KAAKo5C,aACrC,8BAEQD,EAAa73C,MAGrB,yBAAK0O,UAAU,WAAWkqC,IAAI,kCAAkCC,IAAI,mBAEvEnB,GAAiB,yBAAKhpC,UAAU,YAC7B,yBACIA,UAAU,kBACVkqC,IAAI,oCACJnuC,QAAS/L,KAAKo5C,YACde,IAAI,eAER,6BACI,6BACI,wBAAInqC,UAAU,QAAd,eAEJ,yBAAKA,UAAU,MACX,2BAAOlP,KAAK,OAAOQ,KAAK,YACpB0O,UAAU,SACV7G,YAAY,oBACZf,SAAUpI,KAAKq5C,eACfh5C,MAAOuzC,IACX,4BAAQ5jC,UAAU,SAASjE,QAAS/L,KAAK25C,iBAGpC54C,GAAuB,GAAfA,EAAK0F,QAAe,yBAAKuJ,UAAU,QAAQkqC,IAAI,kCAAkCC,IAAI,eAGtG,yBAAKnqC,UAAU,MACX,4BACKjP,GAAwB,IAAhBA,EAAK0F,OAAe1F,EAAKL,KAAI,SAAC6R,EAAM7O,GAEzC,OAAO,wBACHvD,IAAKoS,EAAK0hC,IACVjkC,UAAWmpC,EAAalF,MAAQ1hC,EAAK0hC,IAAM,SAAW,GACtDmG,aAAc,kBAAM,EAAKC,QAAQ32C,IACjC42C,aAAc,kBAAM,EAAKC,SAAS72C,IAClCqI,QAAS,kBAAM,EAAKwtC,cAAchnC,KAEjCA,EAAKjR,SAMV,qF,GAlOVk5C,cAuPXC,cAAWC,aAPF,SAAAtzC,GACpB,MAAO,CACHotC,gBAAiBptC,EAAMuzC,MAAMnG,gBAC7BH,WAAYjtC,EAAMuzC,MAAMtG,cAM5B,CACIV,iBACAS,kBACAG,uBACAG,oBACAmE,iBAPkB6B,CASxB3B,ICjPa6B,G,OApBA,WACX,OACI,4BAAQC,MAAM,eAEV,yBAAK7qC,UAAU,iBACX,yBAAKA,UAAU,yBACX,yBAAKA,UAAU,cAAckqC,IAAI,8BAA8BC,IAAI,cACnE,0BAAMnqC,UAAU,UAAhB,WAEJ,yBAAKA,UAAU,kBACX,kBAAC,EAAD,OAEJ,yBAAKA,UAAU,aACX,yBAAKA,UAAU,UAAUkqC,IAAI,kCAAkCC,IAAI,sB,QCVjFW,G,yDAEF,WAAa7zC,GAAQ,IAAD,8BAChB,cAAMA,IAIVG,MAAQ,CACJ2zC,gBAAgB,EAChBC,SAAU,GACVj6C,KAAM,GACNm4C,aAAc,MATE,EAwEpB+B,YAAc,SAAC3zC,GACXA,EAAE4zC,UADe,MAOb,EAAKj0C,MAJL+wC,EAHa,EAGbA,gBACAR,EAJa,EAIbA,IACAE,EALa,EAKbA,kBACAf,EANa,EAMbA,cAKJ,QAAYlzB,IAAR+zB,EAAmB,CAOnBE,EAAkB,CAAEpf,GAAI0f,EAAiBR,MAAKr3C,IAJtB,UAApB,EAAK8G,MAAMk0C,KACL,QAEA,SACyCjD,IAAK5wC,EAAEQ,OAAOszC,iBAC9D,QAAwB33B,IAApBu0B,EAA+B,CAMtCrB,EAAc,CAAEre,GAAI0f,EAAiB73C,IAJb,UAApB,EAAK8G,MAAMk0C,KACL,QAEA,SACgCjD,IAAK5wC,EAAEQ,OAAOszC,gBAEhC,UAApB,EAAKn0C,MAAMk0C,KACX,EAAKl0C,MAAMo0C,WAAW/zC,GAEtB,EAAKL,MAAMq0C,YAAYh0C,GAG/B,EAAKgB,SAAS,CAAEyyC,gBAAiB,EAAK3zC,MAAM2zC,iBACxC,EAAK9zC,MAAMs0C,mBACX,EAAKt0C,MAAMs0C,qBAzGf,EAAKC,YAAc,EAAKA,YAAYnyC,KAAjB,gBAFH,E,+DAahBrJ,KAAKsI,SAAS,CAAEyyC,gBAAiB/6C,KAAKoH,MAAM2zC,iBACxC/6C,KAAKiH,MAAMs0C,mBACXv7C,KAAKiH,MAAMs0C,sB,qCAGJj0C,GAEX,GADAtH,KAAKsI,SAAS,CAAE0yC,SAAU1zC,EAAEQ,OAAOzH,QAC/BiH,EAAEQ,OAAOzH,MAAO,CAGhB,IAAIkT,EAAQjM,EAAEQ,OAAOzH,MAEjBi5C,EADOt5C,KAAKoH,MAAMrG,KACCuR,QAAO,SAAAC,GAC1B,OAAIA,EAAKgB,MAAMf,cAAcnF,SAASkG,EAAMf,eACjCD,EAEA,QAIfvS,KAAKsI,SAAS,CAAEvH,KAAMu4C,O,iCAOlB,IAEJ0B,EACAh7C,KAAKoH,MADL4zC,SAGoB,UAApBh7C,KAAKiH,MAAMk0C,KACXn7C,KAAKiH,MAAMw0C,WAAWT,GAGtBh7C,KAAKiH,MAAMy0C,YAAYV,GAE3Bh7C,KAAKsI,SAAS,CAAE0yC,SAAU,O,8BAGtBz0C,GACJvG,KAAKsI,SAAS,CAAE4wC,aAAc3yC,M,+BAGzBA,GACLvG,KAAKsI,SAAS,CAAE4wC,aAAc,S,kCAGtB5xC,EAAGf,GAEXe,EAAEC,kBACsB,UAApBvH,KAAKiH,MAAMk0C,KACXn7C,KAAKiH,MAAM00C,cAAcp1C,GAEzBvG,KAAKiH,MAAM20C,eAAer1C,K,2CA2C9BvG,KAAK67C,QAAU77C,KAAKiH,MAAMlG,KACrBf,KAAKoH,MAAMrG,OAASf,KAAKiH,MAAMlG,KAAK0F,SAAWzG,KAAKoH,MAAMrG,KAAK0F,QAAWzG,KAAKoH,MAAM4zC,WACtFh7C,KAAKsI,SAAS,CAAEvH,KAAMf,KAAKiH,MAAMlG,S,0CAGpB,IAEb+6C,EACA97C,KAAKiH,MADL60C,UAGAC,QAAQD,IACR97C,KAAKsI,SAAS,CAAEyyC,gBAAiB/6C,KAAKoH,MAAM2zC,mB,+BAI1C,IAAD,SAOD/6C,KAAKoH,MAJL2zC,EAHC,EAGDA,eACAC,EAJC,EAIDA,SACAj6C,EALC,EAKDA,KACAm4C,EANC,EAMDA,aANC,EAgBDl5C,KAAKiH,MANL+0C,EAVC,EAUDA,OACAC,EAXC,EAWDA,UACAH,EAZC,EAYDA,UACAI,EAbC,EAaDA,UACAf,EAdC,EAcDA,KACA96C,EAfC,EAeDA,MAKJ,OACI,qCAES47C,GACD,oCAEiB,UAATd,EACI,yBAAKnrC,UAAU,UAAf,UAGA,yBAAKA,UAAU,UAAf,YAOX8rC,GACD,2BAAO/vC,QAAS/L,KAAKm8C,iBAAiB9yC,KAAKrJ,OACvC,4BAAQgQ,UAAWksC,EAAY,qBAAuB,aAClD,0BAAMlsC,UAAU,WACZ,8BAAO3P,GAAgB27C,GACvB,yBAAKhsC,UAAU,WAAWkqC,IAAI,kCAAkCC,IAAI,qBAKnFY,GAAkB,yBAAK/qC,UAAU,YAC9B,yBACIA,UAAU,kBACVkqC,IAAI,oCACJnuC,QAAS/L,KAAKm8C,iBAAiB9yC,KAAKrJ,MACpCm6C,IAAI,eAER,6BAEiB,UAATgB,EACI,wBAAInrC,UAAU,QAAd,UACA,wBAAIA,UAAU,QAAd,UAER,yBAAKA,UAAU,MACX,2BAAOlP,KAAK,OAAOQ,KAAM65C,EACrBnrC,UAAU,SACV7G,YAAY,gBACZf,SAAUpI,KAAKq5C,eAAehwC,KAAKrJ,MACnCK,MAAO26C,IACX,8BACI,yBAAKhrC,UAAU,QAAQjE,QAAS/L,KAAKo8C,SAAS/yC,KAAKrJ,MAAOk6C,IAAI,kCAAkCC,IAAI,eAG5G,yBAAKnqC,UAAU,MACX,4BACKjP,GAAwB,IAAhBA,EAAK0F,OAAe1F,EAAKL,KAAI,SAAC6R,EAAM7O,GACzC,OAAO,wBAEHsM,UAAW3P,IAAUkS,EAAKgB,MAAQ,SAAW,GAC7C6mC,aAAc,kBAAM,EAAKC,QAAQ32C,IACjC42C,aAAc,kBAAM,EAAKC,SAAS72C,IAClCqI,QAAS,EAAKkvC,aAEb1oC,EAAKgB,MACJ2lC,IAAiBx1C,GACf,yBAAKsM,UAAU,QAAQjE,QAAS,SAACswC,GAAD,OAAY,EAAKb,YAAYa,EAAQ34C,IAAQw2C,IAAI,kCAAkCC,IAAI,iBAI/H,iF,GAtNdK,cAkPPE,eAfS,SAACtzC,EAAOk1C,GAE5B,MAAsB,UAAlBA,EAASnB,KACF,CACHp6C,KAAMqG,EAAMm1C,QAAQhpC,MAAMxS,KAC1Bi7C,OAAQ50C,EAAMm1C,QAAQhpC,MAAMyoC,QAGzB,CACHj7C,KAAMqG,EAAMm1C,QAAQhJ,OAAOxyC,KAC3Bi7C,OAAQ50C,EAAMm1C,QAAQhJ,OAAOyI,UAOrC,CACIP,WCxOkB,SAACp7C,GAAD,OAAW,SAAC4vC,GAElCA,EAlBoB,SAAC5vC,GAAD,MAAY,CAChCS,KAAM,YACNyS,MAAOlT,GAgBE+7C,CADG/7C,MDwORs7C,cCpOqB,SAACj4C,GAAD,OAAW,SAACusC,GACrCA,EAjBuB,SAACvsC,GAAD,MAAY,CACnC5C,KAAM,eACN4C,SAeS83C,CAAY93C,MDoOjB23C,WChPkB,SAAC/zC,GAAD,OAAO,SAAC2oC,GAC9B,IAAIsD,EAASjsC,EAAEQ,OAAOszC,UAEtBnL,EAlBgC,CAChCnvC,KAAM,YACN07C,YAgBkBjJ,MD8Od+H,YE3PmB,SAACh0C,GAAD,OAAO,SAAC2oC,GAC/B,IAAIsD,EAEAA,EADa,kBAANjsC,EACEA,EAAEQ,OAAOszC,UAET9zC,EAEb2oC,EAZiC,CACjCnvC,KAAM,aACN27C,aAUmBlJ,MFqPfmI,YE7OmB,SAACr7C,GAAD,OAAW,SAAC4vC,GAEnCA,EAPqB,SAAC5vC,GAAD,MAAY,CACjCS,KAAM,aACNyS,MAAOlT,GAKEq8C,CADGr8C,MF6ORu7C,eEpOsB,SAACl4C,GAAD,OAAW,SAACusC,GACtCA,EANwB,SAACvsC,GAAD,MAAY,CACpC5C,KAAM,gBACN4C,SAISi5C,CAAaj5C,MFoOlBg0C,oBACAf,iBAVO+D,CAYbI,GG9PW8B,I,OAAb,kDAEI,WAAa31C,GAAQ,IAAD,8BAChB,cAAMA,IAWV41C,iBAAmB,WACf,EAAK51C,MAAMktC,QAAQ7mC,KAAK,gBAXxB,EAAKgpC,cAAgB,EAAKA,cAAcjtC,KAAnB,gBAFL,EAFxB,6DAWQyzC,EADI98C,KAAKiH,MADL61C,mBATZ,+BAoBQ,OAAO,yBAAK9sC,UAAU,WAClB,6BACI,4BAAQA,UAAU,SAASjE,QAAS/L,KAAK68C,kBAAzC,SAIJ,6BACI,4BACI7sC,UAAU,gBACVjE,QAAS/L,KAAKs2C,eAFlB,wBA3BhB,GAA6BkE,c,IAoDdC,YAAWC,aAJF,SAAAtzC,GACpB,MAAO,KAKP,GAFsBszC,CAGxBkC,K,OCjDavZ,GAXE,SAAC,GAAD,QAAGviC,YAAH,MAAU,WAAV,EAAsBQ,EAAtB,EAAsBA,KAAtB,IAA4BwP,eAA5B,SAA6C1I,EAA7C,EAA6CA,SAA7C,OACf,2BAAOtH,KAAMA,EAAMQ,KAAMA,EAAMwP,QAASA,EAAS1I,SAAUA,KCIvD20C,I,mNAEF31C,MAAQ,CACJ4K,MAAO,GACPojC,YAAa,GACb4H,YAAa,MACbC,aAAc,IAAIxwC,IAClBywC,aAAc,CAAC,CACX57C,KAAM,UACNnB,IAAK,UACLoT,MAAO,WAET,CACEjS,KAAM,MACNnB,IAAK,MACLoT,MAAO,WAET,CACEjS,KAAM,UACNnB,IAAK,UACLoT,MAAO,WAET,CACEjS,KAAM,YACNnB,IAAK,YACLoT,MAAO,e,EAIf4pC,gBAAkB,SAAC71C,GACf,EAAKgB,SAAL,gBACKhB,EAAEQ,OAAOxG,KAAOgG,EAAEQ,OAAOzH,S,EAIlC+8C,eAAiB,WAAO,IAAD,EAKf,EAAKh2C,MAFL61C,EAHe,EAGfA,aACAC,EAJe,EAIfA,aAGAG,EAAK,MAQT,OANAH,EAAahwC,SAAQ,SAAA7G,GACd42C,EAAa78C,IAAIiG,EAAE/E,OAAoB,QAAX+E,EAAE/E,OAC7B+7C,EAAKA,EAAK,IAAMh3C,EAAE/E,SAInB+7C,G,EAGX/G,cAAgB,WACZ7C,QAAQt7B,IAAI,aAAc,EAAK/Q,OAC/B,IAAI41C,EAAc,EAAKI,iBAFL,EAMd,EAAKh2C,MAUTkvC,EATc,CACVtkC,MAAO,CACHgjC,UATU,EAIdhjC,OAOAojC,YAAa,CACTJ,UAZU,EAKdI,aASA4H,eAEmB,EAAK/1C,MAAM+yC,MAAMC,OAAO1D,cAAcrY,MAAK,SAAAjxB,GAC9D,IAAIlM,EAAI,eAAQkM,UACTlM,EAAKwyC,cACLxyC,EAAKu8C,WACZ,IAAIC,EAAI,gBACHtwC,EAAIgnC,IADD,2BAEGlzC,GAFH,IAGAkzC,IAAKhnC,EAAIgnC,OAGjBR,QAAQt7B,IAAI,qEAAsEolC,GAClF,EAAKt2C,MAAMu2C,eAAc,EAAMD,MAE9B/J,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,S,EAMxCmwC,aAAe,SAACn2C,GACZA,EAAE4zC,UACFzH,QAAQt7B,IAAI,kCAAmC7Q,EAAEQ,OAAOxG,KAAMgG,EAAEQ,OAAOgJ,QAAS,EAAK1J,OACrF,IAAMmL,EAAOjL,EAAEQ,OAAOxG,KAChBo8C,EAAYp2C,EAAEQ,OAAOgJ,QAC3B,EAAKxI,UAAS,SAAAq1C,GAAS,MAAK,CAAEV,aAAcU,EAAUV,aAAarvC,IAAI2E,EAAMmrC,Q,uDAGvE,IAAD,OAGDF,EACAx9C,KAAKiH,MADLu2C,cAHC,EAYDx9C,KAAKoH,MAFL81C,GAVC,EAODlrC,MAPC,EAQDojC,YARC,EASD4H,YATC,EAUDE,cACAD,EAXC,EAWDA,aAGJ,OACI,yBAAK3kB,GAAG,UAAUuiB,MAAM,SACpB,yBAAKA,MAAM,iBACP,yBAAKA,MAAM,gBACP,0BAAMA,MAAM,QAAQ9uC,QAASyxC,GAA7B,QACA,+CAEJ,yBAAK3C,MAAM,cACP,uCACA,2BAAO/5C,KAAK,OAAOQ,KAAK,QAAQ6H,YAAY,yBACxCf,SAAUpI,KAAKm9C,kBAEnB,6CACA,8BAAU77C,KAAK,cAAc6H,YAAY,iCACrCf,SAAUpI,KAAKm9C,kBA8BfD,EAAax8C,KAAI,SAAA6R,GAAI,OACjB,2BAAOpS,IAAKoS,EAAKpS,KAChBoS,EAAKjR,KACN,kBAAC,GAAD,CAAUA,KAAMiR,EAAKjR,KAAMwP,QAASmsC,EAAa78C,IAAImS,EAAKjR,MAAO8G,SAAU,EAAKq1C,oBAK5F,yBAAK5C,MAAM,gBACP,4BAAQ9uC,QAAS/L,KAAKs2C,eAAtB,UAGA,4BAAQvqC,QAASyxC,GAAjB,gB,GAzKGhD,cAmLZC,eAAWC,YAAQ,KAAM,GAAdA,CAAkBqC,KC9KtCa,I,yDAEF,WAAa32C,GAAQ,IAAD,8BAChB,cAAMA,IAOVG,MAAQ,CACJy2C,cAAe,EACfC,eAAe,EACfrE,SAAS,EACTsE,oBAAoB,GAZJ,EA6BpBC,gBAAkB,SAACT,GAKf,GAAIA,EAAK1H,OAASnwC,OAAO80B,KAAK+iB,EAAK1H,OAAOpvC,OAAS,EAAG,CAClD,IAAIu4B,EAAIt5B,OAAO80B,KAAK+iB,EAAK1H,OAAOpvC,OAE5Bw3C,EAAKv4C,OAAO80B,KAAK+iB,EAAK1H,OAAOnuB,QADnB,SAACw2B,EAAaC,GAAd,OAA+BZ,EAAK1H,MAAMsI,GAAc5K,QAA4D,SAAlDgK,EAAK1H,MAAMsI,GAAc5K,OAAO/gC,cAA2B0rC,EAAc,EAAIA,IAC5G,GACjD,OAAO96C,KAAKg+B,KAAM6c,EAAKjf,EAAK,KAE5B,MAAqC,SAA9Bue,EAAKhK,OAAO/gC,cAA2B,IAAM,GAxCxC,EAqDpB4rC,cAAgB,SAAC16C,EAAO4D,GAEpBA,EAAEC,kBACF,EAAKN,MAAMo3C,aAAa36C,EAAO,EAAKuD,MAAM+yC,MAAMC,OAAO1D,cACvD,EAAKjuC,SAAS,CAAEu1C,cAAe,EAAGC,eAAe,KAzDjC,EA4DpBN,cAAgB,SAACc,EAAUC,GAAiB,IAGpC1G,EACA,EAAK5wC,MADL4wC,SAGJ,EAAKvvC,SAAS,CACVy1C,oBAAqB,EAAK32C,MAAM22C,qBAEhCO,IACA7K,QAAQt7B,IAAI,gBAAiB0/B,GAC7B,EAAK5wC,MAAM4xC,cAAc,CAACnG,KAAK,2BAAKmF,GAAa0G,OAvErC,EAsGpBC,kBAAoB,WAAO,IAGnB3G,EACA,EAAK5wC,MADL4wC,SAGArd,EAAO90B,OAAO80B,KAAKqd,GAAsB,IAAK4G,EAAiB,GAOnE,OAJIjkB,EAAK/zB,OAAS,IACdg4C,EAAiBjkB,EAAK95B,KAAI,SAAA6R,GAAI,OAAIslC,EAAStlC,OAGxCksC,GAjHP,EAAKpE,QAAU,EAAKA,QAAQhxC,KAAb,gBACf,EAAKkxC,SAAW,EAAKA,SAASlxC,KAAd,gBAChB,EAAKq1C,WAAa,EAAKA,WAAWr1C,KAAhB,gBAClB,EAAKs1C,gBAAkB,EAAKA,gBAAgBt1C,KAArB,gBALP,E,oDAeZ9C,GACJktC,QAAQt7B,IAAI,MAAO5R,GACnBvG,KAAKsI,SAAS,CAAEu1C,aAAct3C,M,+BAGzBA,GACLvG,KAAKsI,SAAS,CAAEu1C,cAAe,EAAGC,eAAe,M,iCAG1Cx2C,GACPA,EAAEC,kBACFvH,KAAKsI,SAAS,CAAEw1C,eAAgB99C,KAAKoH,MAAM02C,kB,sCAkB/Bp6C,EAAOk7C,EAAUt3C,EAAGiL,GAC5BwpC,QAAQ6C,IACRt3C,EAAEC,kBAGNvH,KAAKiH,MAAMstC,qBAAqBhiC,GAChCvS,KAAKiH,MAAMktC,QAAQ7mC,KAAnB,qBAAsCtN,KAAKiH,MAAM+yC,MAAMC,OAAO1D,aAA9D,oBAAsF7yC,EAAtF,Y,0CAyBiB,IAAD,OAChB8yC,EAAYx2C,KAAKiH,MAAM+yC,MAAMC,OAAO1D,cAAcrY,MAAK,SAAAjxB,GAEnD,EAAK3E,SAAS,CAAEmxC,SAAS,IACzB,IAAI/G,EAAO,GACPzlC,EAAIylC,MAAQzlC,EAAIylC,KAAKjsC,OAAS,GAC9BwG,EAAIylC,KAAKxlC,SAAQ,SAAA60B,GACb2Q,EAAK3Q,EAAQkS,KAAOlS,KAG5B,EAAK96B,MAAM4xC,cAAc,CAACnG,SAC1B,IAAIgH,EAAS,GACTzsC,EAAI2mC,WAAa3mC,EAAI2mC,UAAUntC,OAAS,IACxCizC,EAASzsC,EAAI2mC,UAAU,IAE3B,EAAK3sC,MAAMstC,qBAAX,eACOmF,OAGVlG,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,U,+BAqB1B,IAAD,SAODtN,KAAKoH,MAJLy2C,EAHC,EAGDA,aACAC,EAJC,EAIDA,cACArE,EALC,EAKDA,QACAsE,EANC,EAMDA,mBAIAvJ,EACAx0C,KAAKiH,MADLutC,gBAGAiK,EAAiBz+C,KAAKw+C,oBAE1B,OACI,oCACA,yBAAKxuC,UAAU,QACX,wBAAIA,UAAU,YACTwkC,GAAmBA,EAAgBlzC,KADxC,aAGA,4BAAQ0O,UAAU,KAAKjE,QAAS/L,KAAKw9C,eAArC,mBAEJ,yBAAKxtC,UAAU,MACVypC,EACG,wCACA,oCACI,yBAAKzpC,UAAU,OAEPtK,OAAO80B,KAAKikB,GAAgBh4C,OAAS,EACjCg4C,EAAe/9C,KAAI,SAAC6R,EAAM7O,GAAP,OAAiB,yBAAKsM,UAAU,UAC/CoqC,aAAc,kBAAM,EAAKC,QAAQ9nC,EAAK0hC,MACtCqG,aAAc,kBAAM,EAAKC,SAAShoC,EAAK0hC,MACvCloC,QAAS,kBAAM,EAAK4yC,gBAAgBpsC,EAAK0hC,IAAK,KAAM,KAAM1hC,KAGtDsrC,IAAiBtrC,EAAK0hC,KACtB,yBAAKjkC,UAAU,WACX,yBAAKA,UAAU,WAAWkqC,IAAI,kCAAkCnuC,QAAS,EAAK2yC,WAAYvE,IAAI,kBAE1F2D,GACA,yBAAK9tC,UAAU,kBACX,4BACI,wBAAIjE,QAAS,SAACzE,GAAD,OAAO,EAAKq3C,gBAAgBpsC,EAAK0hC,IAAK,OAAQ3sC,EAAGiL,KAC1D,0BAAMvC,UAAU,cAAhB,SAEJ,wBAAIjE,QAAS,SAACzE,GAAD,OAAO,EAAK82C,cAAc7rC,EAAK0hC,IAAK3sC,KAC7C,0BAAM0I,UAAU,cAAhB,cAOxB,yBAAKA,UAAU,SACX,yBAAKA,UAAU,SACX,4BACKuC,EAAKP,OAASO,EAAKP,MAAMgjC,UACrBziC,EAAKP,MAAMgjC,UAAUvuC,OAAS,GAAK8L,EAAKP,MAAMgjC,UAAYziC,EAAKP,MAAMgjC,UAAU6J,UAAU,EAAG,IAAM,MACnGtsC,EAAKP,MAASO,EAAKP,MAAS,OAGpC,iEAKZ,yBAAKhC,UAAU,mBAAf,wDAOpB+tC,GACA,kBAAC,GAAD,CACIP,cAAex9C,KAAKw9C,qB,GApMbhD,cAmNZC,eAAWC,aAPF,SAAAtzC,GACpB,MAAO,CACHywC,SAAUzwC,EAAMywC,SAASnF,KACzB8B,gBAAiBptC,EAAMuzC,MAAMnG,mBAMjC,CACI6J,aT1MoB,SAAC/lB,EAAIie,GAAL,OAAsB,SAACtG,IDuEf,SAAC3X,EAAIie,GACrC,OAAO,IAAI71B,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAaG,KAAK,IAAIK,aAAaC,QAAQ,WAA3C,WAA0DwD,EAA1D,KAA2E,UAAYje,EAAI,CAC7F0a,OAAQ,SACRC,QAAS,CACL,cAAiB,UAAYH,aAAaC,QAAQ,SAClD,eAAgB,sBAGnB7U,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAGH4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,UChGnB+nC,CAAqBxmB,EAAIie,GAAcrY,MAAK,SAACjxB,GAEzCgjC,EATkB,SAAC3X,EAAIie,GAAL,MAAuB,CAC7Cz1C,KAAM,cACNw3B,KACAie,gBAMawI,CAAWzmB,EAAIie,OAE3B/C,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,USmM5BurC,gBACAtE,wBALkBmG,CAOxBkD,K,8BCvOK,SAASoB,GAAYzJ,EAAWE,GASnC,GAAe,MAAXA,EACA,MAAO,CACHyC,IAAK,oBAIT,IAAI+G,EAAY,IAAIzJ,KAAKC,GAASyJ,UAAY,IAAI1J,KAAKD,GAAW2J,UA+BlE,MARU,CACNhH,IAXO90C,KAAKqyB,MAAMwpB,EAAQ,OAWd,KAVJ77C,KAAKqyB,MAAOwpB,EAAQ,MAAT,MAUQ,KATjB77C,KAAKqyB,MAAOwpB,EAAQ,KAAT,KASuB,KARlC77C,KAAKqyB,MAAOwpB,EAAQ,IAAkB,KAQa,M,IChB1Dla,G,kDApBX,WAAa99B,GAAQ,IAAD,8BAChB,gBACKG,MAAQ,CACT+3C,KAAM,UAHM,E,qDAOhB,OACI,6BACI,4BAAQ7mB,GAAG,OAAOlwB,SAAUpI,KAAKiH,MAAMm4C,wBAAyB/+C,MAAOL,KAAKiH,MAAM+1C,aAC9E,4BAAQ38C,MAAM,UAAd,uBACA,4BAAQA,MAAM,OAAd,OACA,4BAAQA,MAAM,eAAd,iBACA,4BAAQA,MAAM,yBAAd,mC,GAdCm6C,aCkBf6E,I,8EAEF,WAAap4C,GAAQ,IAAD,8BAChB,cAAMA,IAoBVq4C,iBAAmB,SAACh/C,GAGhB,OAFgBw3C,IAAOC,UAAUz3C,IAtBjB,EA0IpBg2C,cAAgB,WACZ7C,QAAQt7B,IAAI,YAAa,EAAKs/B,MAE9BnB,EAAc,EAAKmB,KAAM,KAAM,EAAKxwC,MAAM+yC,MAAMC,OAAO1D,cAAcrY,MAAK,SAAAjxB,GACtEwmC,QAAQt7B,IAAI,8BAA+BlL,GAC3C,EAAKhG,MAAMs4C,aAAatyC,EAAIgnC,IAAK,KAAM,EAAKwD,MAC5C,EAAKxwC,MAAMu4C,qBAEdhM,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,SArJhB,EA0JpB8xC,wBAA0B,SAAC93C,GAIvB,EAAKmwC,KAAKuF,YAAc11C,EAAEQ,OAAOzH,OA3JjC,EAAK+G,MAAQ,CACT80C,WAAW,EACXxG,SAAU,GACV4C,cAAe,IAGnB,EAAKmH,YAAc,EAAKA,YAAYp2C,KAAjB,gBACnB,EAAKq2C,mBAAqB,CAAC,QAAS,cAAe,UAAW,UAC9D,EAAKC,YAAc,EAAKA,YAAYt2C,KAAjB,gBACnB,EAAKmwC,GAAK,KACV,EAAK/B,KAAO,GAbI,E,wDAgBRnwC,GAERtH,KAAKsI,SAAS,CAAE4zC,WAAYl8C,KAAKoH,MAAM80C,c,kCAS/B3pC,EAAMqtC,EAAgBpI,EAAKxuC,EAAUhF,GAC7C47C,EAAe52C,SAAWA,EAC1B42C,EAAe57C,UAAYA,EAE3BhE,KAAKiH,MAAM0wC,gBAAgB,CACvBrf,GAAIt4B,KAAKiH,MAAM+yC,MAAMC,OAAO3hB,GAC5Bkf,MACAr3C,IAAKoS,EACL2lC,IAAKxyC,OAAOU,OAAO,GAAIw5C,O,2CAKVC,GAAc,IAAD,OAE1BC,EAAQC,KAAMC,OAAO,SACzBhgD,KAAK0/C,mBAAmBxyC,SAAQ,SAAAqF,GAC5B,IAAIwiC,EAAQ,IAAIgL,KAAM,IAAMxtC,EAAM,CAC9B0tC,QAAS,CACL/K,QAAS3iC,EAAK2iC,SAElBgL,mBAAoB,uBACpB/2C,YAAa,EAAKsuC,KAAKllC,GAAMpJ,YAC7B9H,MAAO,WAIX,GAFY,EAAKo2C,KAAKllC,GAChBwiC,MAAQA,EACV8K,EAAa,CACb,IAAIp7C,EAAO,eAAQ,EAAKgzC,KAAKllC,GAAM0iC,cACnC,EAAKwC,KAAKllC,GAAMwiC,MAAMoL,YAAY17C,EAAS,OACvC,EAAKgzC,KAAKllC,GAAMyiC,UAAUvuC,QAAU,GACpC,EAAKgxC,KAAKllC,GAAMwiC,MAAM2D,QAAQ,EAAKjB,KAAKllC,GAAMyiC,WAItD,EAAKyC,KAAKllC,GAAMwiC,MAAM7G,GAAG,eAAe,SAACkS,GACrC,IAAI/4B,EAAS,IAAIy4B,EACbO,EAAK,eAAQ,EAAK5I,KAAKllC,IAC3B8tC,EAAMh5B,OAASA,EAAOuoB,QAAQwQ,GAC9B,IAAIR,EAAiB,EAAKnI,KAAKllC,GAC/BqtC,EAAe3K,aAAe2K,EAAe7K,MAAMuL,cACnDV,EAAe5K,UAAY4K,EAAe7K,MAAMwL,UAChDF,EAAMh5B,OAAS,IAAIy4B,QAI3B9/C,KAAKsI,SAAS,CACVgwC,cAAet4C,KAAKy3C,S,mCAIfa,GACTt4C,KAAKsI,SAAS,CAAEotC,SAAUsJ,GAAY,IAAIxJ,KAAK8C,EAAc/C,WAAY,IAAIC,KAAK8C,EAAc7C,UAAUyC,Q,0CAGzF,IAGbnmC,EACA/R,KAAKiH,MADL8K,MAGJ0hC,QAAQt7B,IAAI,oDAAqDpG,GANjD,IASRumB,EAAOt4B,KAAKiH,MAAM+yC,MAAMC,OAAxB3hB,GAEJuc,EAAU,GAUd,GARI9iC,GAASA,EAAMyuC,YAEfzuC,EAAMyuC,WAAWxuC,MAAMgjC,UAAYjjC,EAAMpO,OAAO,GAAG5C,KACnD8zC,EAAU9iC,EAAMyuC,YAEhB3L,EAAU,GAGVkH,QAAQlH,GAAWA,EAAQ7iC,OAAQ,CACnChS,KAAKy3C,KAAO,GACZ,IAAIgB,EAAoB,IAAI7D,EAAaC,GACzC70C,KAAKy3C,KAAOgB,EAAkB5D,QAC9B70C,KAAKygD,sBAAqB,GAC1BzgD,KAAK0gD,aAAa1gD,KAAKy3C,UACpB,CACHz3C,KAAKy3C,KAAO,GACZ,IAAI3C,EAAa,GACjBA,EAAWb,IAAM3b,EAHd,IAKCib,EACAvzC,KAAKiH,MADLssC,OAEAA,IACAuB,EAAWvB,OAASA,GACxB,IAAIkF,EAAoB,IAAI7D,EAAaE,GACzC90C,KAAKy3C,KAAOgB,EAAkB5D,QAC9B70C,KAAKygD,sBAAqB,GAC1BzgD,KAAK0gD,aAAa1gD,KAAKy3C,S,6CAMP,IAAD,OACnBz3C,KAAK0/C,mBAAmBxyC,SAAQ,SAAAqF,GACxB,EAAKklC,KAAKllC,IAAS,EAAKklC,KAAKllC,GAAMwiC,OACnC,EAAK0C,KAAKllC,GAAMwiC,MAAM4L,IAAI,eAAe,SAACP,UAKlDQ,cAAc5gD,KAAK6gD,S,+BA0Bb,IAAD,SAMD7gD,KAAKoH,MAHL80C,EAHC,EAGDA,UACAxG,EAJC,EAIDA,SACA4C,EALC,EAKDA,cALC,EAkBDt4C,KAAKiH,MARL+wC,GAVC,EASDP,KATC,EAUDO,iBACAR,EAXC,EAWDA,IACA2D,EAZC,EAYDA,KACAqE,EAbC,EAaDA,gBACAjM,EAdC,EAcDA,OACAuN,EAfC,EAeDA,cACA/uC,EAhBC,EAgBDA,MACAgvC,EAjBC,EAiBDA,iBAYJ,OACI,yBAAK/wC,UAAoB,UAATmrC,EAAmB,WAAae,EAAc4E,EAAgB,cAAgB,YAAgBA,EAAgB,KAAO,aAEjI,yBAAK9wC,UAAWksC,EAAY,wBAA0B,gBAErC,UAATf,GAAoB,yBAChBnrC,UAAU,qBACVkqC,IAAI,oCACJnuC,QAASyzC,EACTrF,IAAI,eAEZ,yBAAKnqC,UAAU,UAAf,mBAGA,yBAAKA,UAAU,aACX,yBAAKA,UAAU,gBACX,yBAAKA,UAAU,OAAf,SAGA,yBAAKsoB,GAAG,uBACJ,yBAAKA,GAAG,YAOhB,yBAAKtoB,UAAU,cACX,yBAAKA,UAAU,OAAf,UAQA,kBAAC,EAAD,CACImrC,KAAK,SACLc,WAAW,EACXC,UAAWA,EACXX,kBAAmBv7C,KAAK2/C,YACxB3H,gBAAiBA,EACjBR,IAAKA,EACLn3C,MAAOkzC,IAAmB+E,GAAiBA,EAAc/E,OAAS+E,EAAc/E,OAAS,SAGjG,yBAAKvjC,UAAU,cACX,yBAAKA,UAAU,OAAf,SAGA,kBAAC,EAAD,CACImrC,KAAK,QACLc,WAAW,EACXC,UAAWA,EACXX,kBAAmBv7C,KAAK2/C,YACxB3H,gBAAiBA,EACjBR,IAAKA,EACLn3C,MAAOi4C,GAAiBA,EAAc/kC,MAAQ+kC,EAAc/kC,MAAQ,QAG5E,yBAAKvD,UAAU,QACX,yBAAKA,UAAU,OAAf,gBAGA,6BACI,kBAAC,GAAD,CACIovC,wBAAyBp/C,KAAKo/C,wBAC9BpC,YAAah9C,KAAKy3C,KAAKuF,gBAInC,yBAAKhtC,UAAU,QACX,yBAAKA,UAAU,OAAf,cAGA,6BAEI,kBAAC,GAAD,CACIgxC,SAAS,OACTC,YAAY,EACZ5gD,MAAOi4C,EAAgBA,EAAc/C,UAAY,KACjDrjC,WAAY,CAAE/I,YAAa,mBAAoBlI,UAAU,EAAM+O,UAAWksC,EAAY,WAAa,IACnGgF,SAAUhF,EACV9zC,SAAU,SAAC/H,GACP,EAAK4G,MAAM0wC,gBAAgB,CAAErf,GAAI,EAAKrxB,MAAMqxB,GAAIkf,MAAKr3C,IAAK,YAAa+3C,IAAK73C,EAAM8gD,WAClF,EAAKT,aAAL,2BAAuBpI,GAAvB,IAAsC/C,UAAWl1C,EAAM8gD,iBAKvE,yBAAKnxC,UAAU,QACX,yBAAKA,UAAU,OAAf,YAGA,6BAEI,kBAAC,GAAD,CACIgxC,SAAS,OACT3gD,MAAOi4C,EAAgBA,EAAc7C,QAAU,KAC/CvjC,WAAY,CAAE/I,YAAa,iBAAkBlI,UAAU,EAAM+O,UAAWksC,EAAY,WAAa,IACjGlsC,UAAWksC,EAAY,WAAa,GACpCgF,SAAUhF,EACV9zC,SAAU,SAAC/H,GACP,EAAK4G,MAAM0wC,gBAAgB,CAAErf,GAAI,EAAKrxB,MAAMqxB,GAAIkf,MAAKr3C,IAAK,UAAW+3C,IAAK73C,EAAM8gD,WAChF,EAAKT,aAAL,2BAAuBpI,GAAvB,IAAsC7C,QAASp1C,EAAM8gD,iBAKrE,yBAAKnxC,UAAU,QACX,yBAAKA,UAAU,OAAf,YAGA,6BACI,2BAAOA,UAAWksC,EAAY,WAAa,GAAIp7C,KAAK,OAAOT,MAAOq1C,GAAsB,EAAGz0C,UAAU,MAG7G,yBAAK+O,UAAU,sBACX,yBAAKA,UAAU,OAAf,eAGA,6BAMI,yBAAKsoB,GAAG,uBACJ,yBAAKA,GAAG,mBAQpB,yBAAKtoB,UAAU,kBACX,yBAAKA,UAAU,OAAf,WAGA,6BAMI,yBAAKsoB,GAAG,uBACJ,yBAAKA,GAAG,eAQpB,yBAAKtoB,UAAU,iBACX,yBAAKA,UAAU,OAAf,uBAGA,6BAKI,yBAAKsoB,GAAG,uBACJ,yBAAKA,GAAG,cAQpB,yBAAKtoB,UAAU,aAEE,MAAT+B,GAA8C,GAA7BrM,OAAO80B,KAAKzoB,GAAOtL,OACpC,4BAAQuJ,UAAU,iBAAiBjE,QAAS/L,KAAKs2C,eAAjD,UACA,4BAAQtmC,UAAU,iBAAiBjE,QAAS,kBAAMg1C,EAAiBhvC,EAAO,EAAK0lC,QAA/E,UAEJ,4BAAQznC,UAAU,kBAAlB,kB,GAnXAwqC,cAuYbC,eAAWC,aATF,SAAAtzC,GAEpB,MAAO,CACHkxB,GAAIlxB,EAAMywC,SAASG,gBACnBP,KAAMrwC,EAAMywC,SACZG,gBAAiB5wC,EAAMywC,SAASG,mBAMpC,CACIL,kBACAgB,qBACA4G,aZlZoB,SAACjnB,EAAIkf,EAAK3C,GAAV,OAAsB,SAAC5E,GAC/CA,EAASsH,EAAWjf,EAAIkf,EAAK3C,OY4YP6F,CAOxB2E,KChXa+B,I,yDAvCX,WAAan6C,GAAQ,IAAD,8BAChB,cAAMA,IACDG,MAAQ,CACTinC,MAAM,EACNgT,SAAS,GAEb,EAAKC,YAAc,EAAKA,YAAYj4C,KAAjB,gBACnB,EAAKyzC,cAAgB,EAAKA,cAAczzC,KAAnB,gBAPL,E,wDAUR/B,GAERtH,KAAKsI,SAAS,CAAE+lC,MAAOruC,KAAKoH,MAAMinC,S,sCAIlCruC,KAAKsI,SAAS,CACV+4C,SAAUrhD,KAAKoH,MAAMi6C,Y,+BAInB,IAAD,EAMDrhD,KAAKoH,MAHLinC,EAHC,EAGDA,KAHC,EAIDgT,QAJC,EAKD9K,aAGJ,OACI,yBAAKvmC,UAAU,aACX,kBAAC,GAAD,CACI8wC,cAAezS,S,GAnCPmM,cCUb+G,I,8KATP,OACI,oCACI,kBAAC,EAAD,MACA,kBAAC,GAAD,W,GANQ/G,cCsCTC,I,OAAAA,YAAWC,YAAQ,KAAK,CACnC/B,sBADsB+B,EAnCX,SAACzzC,GAAW,IAEnBsvC,EACAtvC,EAAM+yC,MAAMC,OADZ1D,aAGAvkC,EACA/K,EADA+K,MAOJ,OACI,4BAAQ6oC,MAAM,eAEV,yBAAK7qC,UAAU,iBACX,kBAAC,IAAD,CACIwxC,GAAE,qBAAgBjL,EAAhB,cACFxqC,QAVA,SAACzE,GACbL,EAAM0xC,mBAAmB,OAUb3oC,UAAU,YAEN,yBAAKmqC,IAAI,UAAUD,IAAI,8BAE/B,4BAAKloC,GAASA,EAAMgjC,UAAYhjC,EAAMgjC,UAAY,WAClD,yBAAKhlC,UAAU,kBACX,kBAAC,EAAD,OAEJ,yBAAKA,UAAU,aACX,yBAAKA,UAAU,UAAUkqC,IAAI,kCAAkCC,IAAI,yBC7BjFyC,I,mNAEF6E,QAAU,SAACn6C,GACP,EAAKL,MAAM0xC,mBAAmB,O,EAIlCyE,eAAiB,SAACC,GAQd,OAAItB,QAAQsB,GACDA,EAAGqE,MAAM,KAET,I,uDAGL,IAaF1E,EAVAxI,EACAx0C,KAAKiH,MADLutC,gBAKAx0C,KAAKiH,MAAM+yC,MAAMC,OADjB1D,aAaJ,OANI/B,IACAwI,EAAch9C,KAAKo9C,eAAe5I,EAAgBwI,cAGtDvJ,QAAQt7B,IAAI,gBAAiB6kC,EAAa,6BAA8BA,EAAYztC,QAAQ,QAGxF,yBAAKS,UAAU,WAUX,yBAAKA,UAAU,aAE4B,GAAnCgtC,EAAYztC,QAAQ,YACpB,kBAAC,IAAD,CACIiyC,GAAG,UACHG,gBAAgB,kBAChB3xC,UAAU,YACN,yBAAKmqC,IAAI,eAAeD,IAAI,8BAIL,GAA/B8C,EAAYztC,QAAQ,QACpB,kBAAC,IAAD,CACIiyC,GAAG,OACHG,gBAAgB,kBAChB3xC,UAAU,YACN,yBAAKmqC,IAAI,eAAeD,IAAI,mCAID,GAAnC8C,EAAYztC,QAAQ,YACpB,kBAAC,IAAD,CACIiyC,GAAG,SACHG,gBAAgB,kBAChB3xC,WAAagtC,GAAeA,EAAY3vC,SAAS,KAAqB,aAEtE,yBAAK8sC,IAAI,UAAUD,IAAI,iCAIU,GAArC8C,EAAYztC,QAAQ,cACpB,kBAAC,IAAD,CACIiyC,GAAG,YACHG,gBAAgB,kBAChB3xC,WAAagtC,GAAeA,EAAY3vC,SAAS,MAAQ2vC,EAAY3vC,SAAS,KAAqB,aACnG,yBAAK8sC,IAAI,YAAYD,IAAI,qC,GAvF/BM,cAuGPC,eAAWC,aAPF,SAAAtzC,GAEpB,MAAO,CACHotC,gBAAiBptC,EAAMuzC,MAAMnG,mBAMjC,CACImE,sBAHkB+B,CAKxBkC,K,uHCjHK,SAASgF,GAAgB36C,GAW9B,OACE,yBACE+I,UAAS,0BAAqBC,yBAAc,aAC5ClE,QAboB,SAAAzE,GAAM,IACpBu6C,EAAY56C,EAAZ46C,QAEA13C,EADa03C,EAAQvrB,kBACrBnsB,WACRoW,2BAAgB,wBAAwB2d,MAAK,SAAA/c,GAC3C,IAAI7gB,EAAM67B,KAAKgC,MAAMhd,GACjBrX,EAAQK,EAAWC,IAAI,mBAAoB,CAAED,aAAY7J,QAC7DuhD,EAAQ7e,aAAal5B,S,oBCLpB,SAASg4C,GAAkB76C,GAChC,IAAM86C,EAAa,CACjB,CACEtiD,qBAAkB2B,eAClB,iBACA,yBAEF,CAAC3B,qBAAkBwvB,cAAe,aAAc,gBAChD,CAACxvB,qBAAkByvB,cAAe,YAAa,gBAUjD,OACE,yBACElf,UAAWq0B,KAAG,kBAAmBp0B,yBAAc,2BAE/C,kBAAC,WAAD,CAASqd,cAAc,GACrB,yBAAKtd,UAAU,8BACf,kBAAC,QAAD,KACG+xC,EAAWrhD,KAAI,SAAAye,GAAG,OACjB,kBAAC,YAAD,CACEhf,IAAKgf,EAAI,GACThP,KAAM+D,gBAAKiL,EAAI,IACftU,KAAMsU,EAAI,GACVpT,SAnBa5K,EAmBage,EAAI,GAnBJ,SAAA7X,GAAM,IAEpC8uB,EADcnvB,EAAZ46C,QACqBvrB,kBACNF,EAAfjsB,WACGC,IAAI,eAAf,2BAAoCgsB,GAApC,IAAkDj1B,mBAJ3B,IAAAA,Q,6GCPpB,SAAS6gD,GAAiB/6C,GAC/B,IAMMg7C,EAAS,CACb,CAAC,UAAWC,MACZ,CAAC,SAAUC,MACX,CAAC,SAAUC,MACX,CAAC,SAAUC,MACX,CAAC,SAAUC,OAGb,OACE,yBAAKtyC,UAAWq0B,KAAG,kBAAmBp0B,yBAAc,WAClD,kBAAC,WAAD,CAASqd,cAAc,GACrB,yBAAKtd,UAAU,8BACf,yBAAKA,UAAU,oBACZiyC,EAAOvhD,KAAI,SAAAW,GAAK,OACf,yBACElB,IAAKkB,EAAM,GACX2O,UAAU,gBACVjE,SAvBY87B,EAuBaxmC,EAAM,GAvBP,SAAAiG,GAAM,IAElC8uB,EADcnvB,EAAZ46C,QACqBvrB,kBACNF,EAAfjsB,WACGC,IAAI,WAAf,2BAAgCgsB,GAAhC,IAA8CyR,iBAqBpC,yBAAK73B,UAAU,eAAekqC,IAAK74C,EAAM,GAAI84C,IAAK94C,EAAM,MAzB5C,IAAAwmC,Q,oBCLnB,SAAS0a,GAAkBt7C,GAgBhC,OACE,yBAAK+I,UAAWq0B,KAAG,kBAAmBp0B,yBAAc,YAClD,kBAAC,WAAD,CAASqd,cAAc,GACrB,yBAAKtd,UAAU,8BACf,kBAAC,QAAD,KACE,kBAAC,YAAD,CAAUnF,KAAK,cAAckB,QApBX,SAAAzE,GAAM,IAExB8uB,EADcnvB,EAAZ46C,QACqBvrB,kBACrBnsB,EAAsBisB,EAAtBjsB,WAAYL,EAAUssB,EAAVtsB,MAEdspC,EAAOjpC,EAAWC,IAAI,iBAAkBgsB,GACxCosB,EAAUrmB,KAAKC,UAAUgX,GACzBtzB,EAAG,0BAAsBQ,mBAAmBkiC,IAC5CxwC,EAAQ7H,EAAWC,IAAI,gBAAf,2BACTgsB,GADS,IAEZptB,SAAUc,EAAM5E,iBCZM,SAAC4a,EAAKC,GAChC,IAAMC,EAAOxX,SAASyX,cAAc,KACpCD,EAAKE,KAAOJ,EACZE,EAAKG,SAAWJ,EAChBC,EAAKI,QDUHqiC,CAAa3iC,EAAD,UAAS9N,EAAT,kBASN,kBAAC,eAAD,S,+BEJNxM,GAAiB,SAAuBC,EAAG5B,GAW7C,OAVA2B,GAAiBE,OAAOC,gBAAkB,CACxCC,UAAW,cACApF,OAAS,SAAUiF,EAAG5B,GACjC4B,EAAEG,UAAY/B,IACX,SAAU4B,EAAG5B,GAChB,IAAK,IAAIgC,KAAKhC,EACRA,EAAEiC,eAAeD,KAAIJ,EAAEI,GAAKhC,EAAEgC,MAIhBJ,EAAG5B,IAG3B,SAASkC,GAAUN,EAAG5B,GAGpB,SAASmC,IACPhG,KAAKiG,YAAcR,EAHrBD,GAAeC,EAAG5B,GAMlB4B,EAAES,UAAkB,OAANrC,EAAa6B,OAAO/E,OAAOkD,IAAMmC,EAAGE,UAAYrC,EAAEqC,UAAW,IAAIF,GA8CjF,SAASiR,GAAqBtQ,EAAQC,GASpC,OARIlB,OAAOsB,eACTtB,OAAOsB,eAAeL,EAAQ,MAAO,CACnCtG,MAAOuG,IAGTD,EAAOC,IAAMA,EAGRD,EAGT,IAmDIE,GAAkBqQ,GA7CX,mBAAO,UAAP,CAAerQ,KAAqBA,GAAmBoQ,GAAqB,CAAC,sJAAuJ,CAAC,yJACpO,WAAOlQ,IAAImQ,KAAqBA,GAAmBD,GAAqB,CAAC,8BAA+B,CAAC,iCA6CrH,IAAI5K,GAAyB,CAC3BC,QAAS,kBACTE,QAAS,kBA6BPG,IAxBJ,SAAU5M,GAGR,SAAS4N,IACP,OAAkB,OAAX5N,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAH7D+F,GAAU4H,EAAiB5N,GAM3B2F,OAAOsB,eAAe2G,EAAgBzH,UAAW,UAAW,CAC1D9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,YAElB6X,YAAY,EACZC,cAAc,IAEhBxS,OAAOsB,eAAe2G,EAAgBzH,UAAW,UAAW,CAC1D9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,YAElB6X,YAAY,EACZC,cAAc,IAnBlB,CAsBE,kBAAO7L,KAE2B,CAClCO,UAAW,oBAKb,SAAU7M,GAGR,SAAS0N,IACP,OAAkB,OAAX1N,GAAmBA,EAAOE,MAAMD,KAAME,YAAcF,KAH7D+F,GAAU0H,EAAkB1N,GAM5B2F,OAAOsB,eAAeyG,EAAiBvH,UAAW,YAAa,CAC7D9F,IAAK,WACH,OAAOJ,KAAKI,IAAI,cAElB6X,YAAY,EACZC,cAAc,IAGhBzK,EAAiBvH,UAAU2G,iBAAmB,SAAU7D,GACtD,OAAIhJ,KAAK4M,UAAUE,IAAI9D,GACdhJ,KAAK4M,UAAUxM,IAAI4I,GAAUsD,QAAQS,UAGvC,IAGTU,EAAiBvH,UAAU8G,kBAAoB,SAAUhE,GACvD,IAAIiE,EAAM,GAMV,OALAjN,KAAK4M,UAAUM,SAAQ,SAAUC,EAAGC,GAC9BD,EAAEb,QAAQe,SAASrE,IACrBiE,EAAIK,KAAKF,MAGNH,GA9BX,CAkCE,kBAAON,KAeT,IAiDIwK,GAAoBC,GAAoBC,GAjD/B,WAAOtQ,IAAIoQ,KAAuBA,GAAqBF,GAAqB,CAAC,8GAA+G,CAAC,iHAC5L,WAAOlQ,IAAIqQ,KAAuBA,GAAqBH,GAAqB,CAAC,0EAA2E,CAAC,6EACrJ,WAAOlQ,IAAIsQ,KAAqBA,GAAmBJ,GAAqB,CAAC,sBAAuB,CAAC,yBAgDnH,IAgEIwR,GAAoBmC,GAAoBC,GAAoBvT,GAAkBC,GAhErE,WAAOxQ,IAAI0hB,KAAuBA,GAAqBxR,GAAqB,CAAC,IAAK,CAAC,OACpF,WAAOlQ,IAAI6jB,KAAuBA,GAAqB3T,GAAqB,CAAC,wBAAyB,CAAC,2BACnG,WAAOlQ,IAAI8jB,KAAuBA,GAAqB5T,GAAqB,CAAC,+CAAgD,CAAC,kDAC7H,WAAOlQ,IAAIuQ,KAAqBA,GAAmBL,GAAqB,CAAC,6CAA8C,CAAC,gDAC3H,WAAOlQ,IAAIwQ,KAAqBA,GAAmBN,GAAqB,CAAC,4EAA6E,CAAC,+EAyQrK,IA4FIyR,GAAoBqC,GAAoBM,GAAoBqN,GAAoBC,GA5FhF+pB,GAAa,KAAQrxC,SACF,mBAAOqxC,GAAP,CAAmBh6B,KAAuBA,GAAqBzR,GAAqB,CAAC,sEAAuE,CAAC,yEACnK,WAAOlQ,IAAIgkB,KAAuBA,GAAqB9T,GAAqB,CAAC,kJAAmJ,CAAC,qJAC9N,mBAAO,WAAP,CAAgBoU,KAAuBA,GAAqBpU,GAAqB,CAAC,yBAA0B,CAAC,4BACvH,WAAOlQ,IAAI2xB,KAAuBA,GAAqBzhB,GAAqB,CAAC,8GAA+G,CAAC,iHACtL,WAAOlQ,IAAI4xB,KAAuBA,GAAqB1hB,GAAqB,CAAC,oCAAqC,CAAC,uCChjB7H,SAAS0rC,GAAkB17C,GAYhC,OACE,yBACE+I,UAAS,0BAAqBC,yBAAc2N,YAASW,SACrDxS,QAdkB,SAAAzE,GAAM,IAEpB8uB,EADcnvB,EAAZ46C,QACqBvrB,kBACNF,EAAfjsB,WAEGC,IAAI,YAAf,2BACKgsB,GADL,IAEE/rB,OAAQzK,UAAOwM,eACf/G,UDgoBkB,0BEjoBjB,IAAMu9C,GAAb,uKAEI,IAAM37C,EAAQjH,KAAKiH,MAEX47C,EAAqE57C,EAArE47C,YAAaC,EAAwD77C,EAAxD67C,YAAa/7B,EAA2C9f,EAA3C8f,QAASC,EAAkC/f,EAAlC+f,QAAS+7B,EAAyB97C,EAAzB87C,YAAyB97C,EAAZ+7C,QAEjE,OACE,yBAAKhzC,UAAU,cACb,kBAAC4xC,GAAoB36C,GACrB,kBAACs7C,GAAsBt7C,GACvB,kBAAC+6C,GAAqB/6C,GACtB,kBAAC66C,GAAsB76C,GACvB,kBAAC07C,GAAsB17C,GAEvB,yBACE+I,UAAWq0B,KAAG,kBAAmBp0B,yBAAc,QAAS,CACtD,4BAA6B8W,IAE/Bhb,QAAS82C,IAGX,yBACE7yC,UAAWq0B,KAAG,kBAAmBp0B,yBAAc,QAAS,CACtD,4BAA6B+W,IAE/Bjb,QAAS+2C,IAEX,yBAAK9yC,UAAU,2BAA2BjE,QAASg3C,GACjD,4BAAQ/yC,UAAU,YAAlB,cA5BV,GAA6BizC,IAAMC,e,kBCe7BtgB,I,OAFMM,GAAM,OAEF,CACdigB,OACAC,iCACAC,kCACAC,0BACAC,OACAC,oCAgLaC,GA7Kf,kDACE,WAAax8C,GAAQ,IAAD,8BAClB,cAAMA,IASRy8C,SAAW,SAACC,GACVlQ,QAAQt7B,IAAI,wBAAyBwrC,GACrC,IAAM18C,EAAQ,EAAK46C,QAAQvrB,kBACnBnsB,EAAsBlD,EAAtBkD,WACFipC,GADwBnsC,EAAV6C,MACPK,EAAWC,IAAI,iBAAf,2BAAsCnD,GAAtC,IAA6C8K,MAAO4xC,EAAQ75C,MAAMC,SAAS45C,EAAQ36C,cAC1Fw5C,EAAUrmB,KAAKC,UAAUgX,GAC3BwQ,EAAcznB,KAAKgC,MAAMqkB,GAK7B,EAAKv7C,MAAM48C,sBAAsBD,IArBf,EAyBpBE,WAAa,SAAA57C,GACX,EAAK25C,QAAU35C,EACf,EAAKI,SAAS,KA3BI,EAwCpBy7C,iBAAmB,SAAC9L,EAAIl3C,EAAMy9B,GAC5BiV,QAAQt7B,IAAI,wCAAyC8/B,EAAI,SAAUl3C,GACnE,IACQ+I,EADM,EAAK+3C,QAAQvrB,kBACnBxsB,MAGJk6C,EAASnwC,iBAAckR,aAAa,CACtCjb,MAAOA,EACPd,SAAUivC,EACV3tC,UAAW5K,aAAU23B,QACrBt2B,SAIFijD,EAASnwC,iBAAcowC,cAAc,CACnCn6C,MAAOA,EACPd,SAAUivC,EACVuI,WAAYhiB,IAEd,EAAKl2B,SACH,CACEwB,MAAOk6C,KA7DO,EAkEpBnB,YAAc,SAAAv7C,GACZ,IAAML,EAAQ,EAAK46C,QAAQvrB,kBACJrvB,EAAfkD,WACGC,IAAI,OAAQnD,IArEL,EAwEpB67C,YAAc,SAAAx7C,GACZ,IAAML,EAAQ,EAAK46C,QAAQvrB,kBACJrvB,EAAfkD,WACGC,IAAI,OAAQnD,IA3EL,EAyFpB87C,YAAc,WAAO,IAAD,EAId,EAAK97C,MAFPutC,EAFgB,EAEhBA,gBACA0P,EAHgB,EAGhBA,gBAEF1P,EAAgB9zC,IAAM,EAAKyjD,SAC3B1Q,QAAQt7B,IAAI,sBAAuBq8B,EAAgB9zC,KACnD22C,EAAgB6M,EAAiB1P,GAC9BtW,MAAK,SAAAjxB,GACJwmC,QAAQt7B,IAAI,6BAEbq7B,OAAM,SAAAlsC,GACLmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eAC3B,EAAKvL,MAAMktC,QAAQ7mC,KAAK,SAvGZ,EA4GpB01C,QAAU,WACR,EAAK/7C,MAAM+7C,WA7GO,EAiIpB56C,SAAW,SAAC0B,EAAOyd,GACjB,EAAKjf,SACH,CACEwB,SAEFyd,IAtIgB,EA8IpB48B,OAAS,WACP,IAAMl9C,EAAQ,EAAK46C,QAAQvrB,kBAIrB8c,EADFnsC,EADFkD,WAEsBC,IAAI,iBAAkBnD,GACxCu7C,EAAUrmB,KAAKC,UAAUgX,GAE/B,OADUjX,KAAKgC,MAAMqkB,IArJH,EAyJpB4B,gBAAkB,SAAC1jD,EAAK8a,GACtB,IAAK,IAAIjV,EAAI,EAAGA,EAAI7F,EAAIqE,OAAO0B,OAAQF,IAAK,CAC1C,IAAIF,EAAI3F,EAAIqE,OAAOwB,GACnB,GAAIF,EAAElG,KAAOqb,EAAKxS,SAChB,OAAO3C,IA3JX,EAAKg+C,YACLC,OAAM,OAAa,CACjBZ,SAAU,EAAKA,SACfK,iBAAkB,EAAKA,iBACvBI,OAAQ,EAAKA,QANG,EADtB,wDA+Be,IAAD,EAKNnkD,KAAKiH,MAHPotC,EAFQ,EAERA,WAIIvqC,GANI,EAGRo6C,gBJ3DC,SAA6B1P,GAAmC,IAkBjEsF,EAlB+CzF,EAAiB,uDAAJ,GAC1DkQ,EAAUvhD,uBAEZ1C,EAAM,CACR4E,aAAcq/C,EACdx/C,OAAQ,CACN,CACE5E,IAAKokD,EACL5gD,OAAQ,CAAC,CAAE7C,KAAM,UAAWC,KAAM,gBAGtCy/C,WAAY,CACVxuC,MAAO,CACLgjC,UAAW,eAoBjB,MAb8B,iBAAnBR,EAEa,IADtBsF,EAAUzF,EAAW/hC,QAAO,SAAAknC,GAAE,OAAIA,EAAGvF,KAAOO,EAAgBP,QAChDxtC,QACNqzC,EAAQ,IAAMA,EAAQ,GAAGp5C,KAAOgF,OAAO80B,KAAKsf,EAAQ,GAAGp5C,KAAK+F,OAAS,IACvEnG,EAAMw5C,EAAQ,GAAGp5C,KAGc,iBAAnB8zC,GAA+BA,EAAgB9zC,MAC/DJ,EAAMk0C,EAAgB9zC,KAKjB2lC,SAAM1lC,OAAOL,GI6BJkkD,CANJ,EAIRhQ,gBAEiDH,IACnDr0C,KAAKoH,MAAQ,CAAE0C,WAtCnB,sCAgFI,OACE,kBAAC,WAAD,CACE5B,IAAKlI,KAAK8jD,WACVh6C,MAAO9J,KAAKoH,MAAM0C,MAClB1B,SAAUpI,KAAKoI,SACfw6B,QAASA,OArFjB,sCAkHI,IAAM37B,EAAQjH,KAAK6hD,QAAQvrB,kBACnBnsB,EAAelD,EAAfkD,WACF4c,EAAU5c,EAAWC,IAAI,UAAWnD,GACpC+f,EAAU7c,EAAWC,IAAI,UAAWnD,GACpCw9C,EAAe,CACnB5C,QAAS7hD,KAAK6hD,QACdgB,YAAa7iD,KAAK6iD,YAClBC,YAAa9iD,KAAK8iD,YAClB/7B,UACAC,UACA+7B,YAAa/iD,KAAK+iD,YAClBC,QAAShjD,KAAKgjD,SAEhB,OAAO,kBAAC,GAAYyB,KA/HxB,2CA4IIzkD,KAAKqkD,cA5IT,+BAoKI,OACE,yBAAKr0C,UAAU,WACZhQ,KAAK6hD,SAAW7hD,KAAK0kD,gBACrB1kD,KAAKu2B,qBAvKd,GAA6B0sB,IAAMzI,WCpB7BmK,I,mNAEFv9C,MAAQ,CACJw9C,yBAAyB,EACzB7yC,MAAO,I,EAkCXixC,QAAU,WACN,EAAK/7C,MAAMktC,QAAQ7mC,KAAnB,qBAAsC,EAAKrG,MAAM+yC,MAAMC,OAAO1D,aAA9D,gB,EAGJsN,sBAAwB,SAAC9xC,GAErB0hC,QAAQt7B,IAAI,yBAA0BpG,GACtC,EAAKzJ,SAAS,CACVs8C,yBAA0B,EAAKx9C,MAAMw9C,wBACrC7yC,MAAOA,K,EAIfgvC,iBAAmB,SAAChvC,EAAOysB,GAIvB,IADA,IAAI99B,EAAM4jD,OAAM,OAAWH,SAClB59C,EAAE,EAAGA,EAAI7F,EAAIqE,OAAO0B,OAAQF,IAAK,CACtC,IAAIF,EAAI3F,EAAIqE,OAAOwB,GACnB,GAAIF,EAAElG,KAAO4R,EAAM5R,IAAK,CACpBkG,EAAEm6C,WAAarK,EAAY3X,GAC3B,OAGRiV,QAAQt7B,IAAI,oFAAqFzX,GACjG,IAAI8zC,EAAkB,EAAKvtC,MAAMutC,gBACjCA,EAAgB9zC,IAAMA,EACtB,EAAKuG,MAAMstC,qBAAqBC,GAEhC8P,OAAM,OAAWP,iBAAiBhyC,EAAM5R,IAAKq+B,EAAOxsB,MAAMgjC,UAAWxW,GACrE6Y,EAAgB,EAAKpwC,MAAM+yC,MAAMC,OAAO1D,aAAc/B,GACrDtW,MAAK,SAAAjxB,GACFwmC,QAAQt7B,IAAI,6BAEfq7B,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,QAGhC,EAAKhF,SAAS,CACVyJ,W,kEAxEa,IAAD,SAKR/R,KAAKiH,MAAM+yC,MAAMC,OAFjB1D,EAHQ,EAGRA,aACAje,EAJQ,EAIRA,GAERmb,QAAQt7B,IAAI,eAAgBo+B,GANZ,IASZ/B,EACAx0C,KAAKiH,MADLutC,gBAKJf,QAAQt7B,IAAI,yCAA0Cq8B,GACxB,iBAAnBA,GAAsE,GAAvC9uC,OAAO80B,KAAKga,GAAiB/tC,QACnEywC,EAAWX,EAAcje,GAAI4F,MAAK,SAAAjxB,GAC9BwmC,QAAQt7B,IAAI,8BAA+BlL,GACvCA,GAAOA,EAAIylC,MAAQzlC,EAAIylC,KAAK,IAC5B,EAAKzrC,MAAMstC,qBAAqBtnC,EAAIylC,KAAK,OAGhDc,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,U,+BAmD9B,IAAD,EAMDtN,KAAKoH,MAFLw9C,EAJC,EAIDA,wBACA7yC,EALC,EAKDA,MAIAyiC,EACAx0C,KAAKiH,MADLutC,gBAKJ,OAFAf,QAAQt7B,IAAI,yBAA0Bq8B,GAGlC,oCAE+C,GAAvC9uC,OAAO80B,KAAKga,GAAiB/tC,OAE7B,kBAAC,GAAD,CACI4tC,WAAY,GACZ6P,gBAAiBlkD,KAAKiH,MAAM+yC,MAAMC,OAAO1D,aACzC/B,gBAAiBx0C,KAAKiH,MAAMutC,gBAC5B4C,UAAWp3C,KAAKiH,MAAM+yC,MAAMC,OAAO3hB,GACnC0qB,QAAShjD,KAAKgjD,QACda,sBAAuB7jD,KAAK6jD,wBAEhC,yBAAK7zC,UAAU,WAAf,cAIA40C,GACA,kBAAC,GAAD,CACIzJ,KAAK,QACLqE,gBAAiBx/C,KAAK6jD,sBACtB9xC,MAAOA,EACPgvC,iBAAkB/gD,KAAK+gD,wB,GAvHrBvG,cAsIXC,eAAWC,aAPF,SAAAtzC,GAEpB,MAAO,CACHotC,gBAAiBptC,EAAMuzC,MAAMnG,mBAMjC,CACID,wBAHkBmG,CAKxBiK,K,qBCVaE,G,kDA9IX,WAAa59C,GAAQ,IAAD,8BAChB,cAAMA,IAmDV69C,OAAS,SAACC,GACN,IAAI,EAAK39C,MAAM49C,OAAf,CAIA,IAEMhzC,EAAQ+yC,EAQR5U,EAAU,CACZ8U,IAXQzP,KAAK0P,MAYbnR,KATS,QAAU,IAAIyB,KAUvBrlC,KARS,mDASTg1C,KAAM,KACNhmC,IAAK,MACLimC,MAAO,eAEX,EAAK98C,SAAS,CACV0J,MAAOA,EACPm+B,QAASA,MA7EG,EAuFpBqJ,GAAK,KArFD,EAAKpyC,MAAQ,CACT49C,QAAQ,EACRhzC,MAAO,IAJK,E,sEAShByhC,QAAQt7B,IAAI,sBACZnY,KAAKsI,SAAS,CACV08C,QAAQ,M,+CAIZvR,QAAQt7B,IAAI,qBACZnY,KAAKsI,SAAS,CACV08C,QAAQ,M,2CAIZvR,QAAQt7B,IAAI,kCACZnY,KAAKsI,SAAS,CACV08C,QAAQ,M,gDAIU19C,EAAG29C,GACzBxR,QAAQt7B,IAAI7Q,EAAG,4BAA8B29C,K,gDAGvB39C,EAAG29C,GACzBxR,QAAQt7B,IAAI7Q,EAAG,0BAA4B29C,K,gDAGrB39C,EAAG29C,GACzBxR,QAAQt7B,IAAI7Q,EAAG,2BAA6B29C,K,+CAGvB39C,EAAG29C,GACxBjlD,KAAKqlD,YACL5R,QAAQt7B,IAAI7Q,EAAG,0BAA4B29C,K,gCAGrCllC,GACNvX,SAAS88C,eAAe,SAASC,S,0CAIjCvlD,KAAK8kD,OAAO,uB,2CAiCZ9kD,KAAKiH,MAAMu+C,eAAeC,iBAAiB,IAAIvnB,MAAK,SAAUwnB,GAC1DjS,QAAQt7B,IAAIutC,Q,0CAMC,IAAD,OAIhB1lD,KAAKw5C,GAAK,IAAImM,UAAU,uBACxB3lD,KAAKw5C,GAAGoM,OAAS,SAACj+C,GACd8rC,QAAQt7B,IAAI,mGACZ,IAAI0tC,EAAY,CACZ/R,QAAShB,aAAaC,QAAQ,WAC9B6D,WAAY,EAAK3vC,MAAMqxB,IAE3B,EAAKkhB,GAAGsM,KAAK3pB,KAAKC,UAAUypB,KAEhC7lD,KAAKw5C,GAAGuM,UAAY,SAACp+C,GACjB8rC,QAAQt7B,IAAI,+FAAgGxQ,EAAM5G,MAClH,EAAK+jD,OAAO,sG,6CAKhB9kD,KAAKw5C,GAAGsM,KAAK,SACb9lD,KAAKw5C,GAAGwM,U,+BAIR,OACI,6BACI,4BAAQj6C,QAAS/L,KAAKimD,kBAAkB58C,KAAKrJ,OAA7C,UACoB,cAAnBwI,SAASwJ,OAAyB,4BAAQjG,QAAS/L,KAAKkmD,mBAAmB78C,KAAKrJ,OAA9C,mCACnC,kBAAC,KAAD,CACIglD,OAAQhlD,KAAKoH,MAAM49C,QAA+B,KAArBhlD,KAAKoH,MAAM4K,MACxCm0C,aAAcnmD,KAAKomD,mBAAmB/8C,KAAKrJ,MAC3CqmD,oBAAqBrmD,KAAKsmD,wBAAwBj9C,KAAKrJ,MACvDumD,mBAAoBvmD,KAAKwmD,uBAAuBn9C,KAAKrJ,MACrDymD,OAAQzmD,KAAK0mD,yBAAyBr9C,KAAKrJ,MAC3C+L,QAAS/L,KAAK2mD,0BAA0Bt9C,KAAKrJ,MAC7C6O,QAAS7O,KAAK4mD,0BAA0Bv9C,KAAKrJ,MAC7C6mD,QAAS7mD,KAAK8mD,0BAA0Bz9C,KAAKrJ,MAC7C+mD,QAAS,IACT/0C,MAAOhS,KAAKoH,MAAM4K,MAClBm+B,QAASnwC,KAAKoH,MAAM+oC,QACpBqV,eAAgBxlD,KAAKiH,MAAMu+C,iBAE/B,2BAAOltB,GAAG,QAAQ0uB,QAAQ,QACtB,4BAAQ9M,IAAI,6BAA6Bp5C,KAAK,eAC9C,4BAAQo5C,IAAI,6BAA6Bp5C,KAAK,cAC9C,2BAAOmmD,QAAQ,EAAMC,UAAU,QAAQC,MAAM,EAAOjN,IAAI,sB,GAxIvDM,aCSf4M,I,mNAEF5N,GAAK,K,EAWL6N,WAAa,SAAC5hD,GACV,IAAI6hD,EAA8C,GAApC7hD,EAAE8hD,aAAajkD,WAAWmD,OAAc,IAAMhB,EAAE8hD,aAAe9hD,EAAE8hD,aAC3EC,EAA0C,GAAlC/hD,EAAEgiD,WAAWnkD,WAAWmD,OAAc,IAAMhB,EAAEgiD,WAAahiD,EAAEgiD,WACrEC,EAAOjiD,EAAEgiD,YAAc,GAAK,KAAO,KAGvC,MADW,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAC1ChiD,EAAEkiD,UAAY,IAFb,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAEpDliD,EAAEmiD,YAAc,IAAMniD,EAAEoiD,UAAY,IAAMpiD,EAAEqiD,cAAgB,IAAMN,EAAQ,IAAMF,EAAUI,G,mEATjI/O,EAHI34C,KAAKiH,MADL0xC,oBAGW34C,KAAKiH,MAAM+yC,MAAMC,OAAxB3hB,M,mCAaCggB,GACTt4C,KAAKsI,SAAS,CAAEotC,SAAUsJ,GAAY1G,EAAc/C,UAAW+C,EAAc7C,SAASyC,Q,+BAGhF,IAAD,SAMDl4C,KAAKiH,MAJL65C,EAFC,EAEDA,cACAjJ,EAHC,EAGDA,SACAG,EAJC,EAIDA,gBACAL,EALC,EAKDA,gBAEA9B,EAAQgC,EAASG,GAAiBnC,MAClCkS,EAAWriD,OAAO80B,KAAKqd,EAASG,GAAiBnC,OACrD,OACI,oCAGI,yBAAK7lC,UAAW8wC,EAAgB,KAAO,aACnC,yBAAK9wC,UAAU,aACX,+BACI,4BACI,oCACA,0CACA,wCACA,wCACA,6CAGA+3C,EAASrnD,KAAI,SAACP,GAAD,OAAS,4BACd,wBAAI6P,UAAU,mBAAmB6lC,EAAM11C,GAAK6R,MAAMgjC,WAClD,4BAEI,kBAAC,GAAD,CACIgM,SAAS,OACTC,YAAY,EACZ5gD,MAAOw1C,EAAM11C,GAAKo1C,UAClBrjC,WAAY,CAAE/I,YAAa,mBAAoBlI,UAAU,GACzDmH,SAAU,SAAC/H,GACPs3C,EAAgB,CAAErf,GAAI,EAAKrxB,MAAM+yC,MAAMC,OAAO3hB,GAAIkf,IAAK3B,EAAM11C,GAAKm4B,GAAIn4B,IAAK,YAAa+3C,IAAK73C,EAAM8gD,eAI/G,4BAEI,kBAAC,GAAD,CACIH,SAAS,OACTC,YAAY,EACZ5gD,MAAOw1C,EAAM11C,GAAKs1C,QAClBvjC,WAAY,CAAE/I,YAAa,iBAAkBlI,UAAU,GACvDmH,SAAU,SAAC/H,GACPs3C,EAAgB,CAAErf,GAAI,EAAKrxB,MAAM+yC,MAAMC,OAAO3hB,GAAIkf,IAAK3B,EAAM11C,GAAKm4B,GAAIn4B,IAAK,UAAW+3C,IAAK73C,EAAM8gD,eAI7G,4BAAKnC,GAAYnJ,EAAM11C,GAAKo1C,UAAWM,EAAM11C,GAAKs1C,SAASyC,KAC3D,4BAEI,kBAAC,GAAD,CACI8I,SAAS,OACTC,YAAY,EACZ5gD,MAAOw1C,EAAM11C,GAAKs1C,QAClBvjC,WAAY,CAAE/I,YAAa,mBAAoBlI,UAAU,EAAMigD,UAAU,WAWjG,kBAAC,GAAD,CACI5oB,GAAIt4B,KAAKiH,MAAM+yC,MAAMC,OAAO3hB,Y,GA/FhCkiB,cAoHTC,eAAWC,aARF,SAAAtzC,GACpB,MAAO,CACHywC,SAAUzwC,EAAMywC,SAASnF,KACzBsF,gBAAiB5wC,EAAMywC,SAASG,gBAChClC,WAAY1uC,EAAMywC,SAASnF,KAAKtrC,EAAMywC,SAASG,iBAAiBlC,cAMpE,CACI6C,qBACAhB,mBAJkB+C,CAMxB0M,KC9HIY,I,yLAEmB,IAAD,SAKZhoD,KAAKiH,MAAM+yC,MAAMC,OAFjB1D,EAHY,EAGZA,aACAje,EAJY,EAIZA,GAEJmb,QAAQt7B,IAAI,eAAgBo+B,GANZ,IASZ/B,EACAx0C,KAAKiH,MADLutC,gBAKJf,QAAQt7B,IAAI,yCAA0Cq8B,GACxB,iBAAnBA,GAAsE,GAAvC9uC,OAAO80B,KAAKga,GAAiB/tC,QACnEywC,EAAWX,EAAcje,GAAI4F,MAAK,SAAAjxB,GAC9BwmC,QAAQt7B,IAAI,8BAA+BlL,GACvCA,GAAOA,EAAIylC,MAAQzlC,EAAIylC,KAAK,IAC5B,EAAKzrC,MAAMstC,qBAAqBtnC,EAAIylC,KAAK,OAG5Cc,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,U,+BAMlC,IAWFvI,EARAyvC,EACAx0C,KAAKiH,MADLutC,gBAIAxiC,EAEAwiC,EAFAxiC,MACAtR,EACA8zC,EADA9zC,IAWJ,OANW,MAAPA,GAAeA,EAAIqE,SACnBA,EAASrE,EAAIqE,QAGjB0uC,QAAQt7B,IAAI,UAAWpT,GAGnB,yBAAKiL,UAAU,aAEgC,GAAvCtK,OAAO80B,KAAKga,GAAiB/tC,OACzB,yBAAKuJ,UAAU,oBACX,4BACKgC,GAASA,EAAMgjC,WAEpB,yBAAKhlC,UAAU,2BACX,+BACI,4BACI,qCACA,sCACA,0CACA,wCACA,wCACA,uCAIAjL,GAAUA,EAAOrE,KAAI,SAAA2F,GAAC,OAClB,4BACI,4BACKA,EAAE1C,OAAO,GAAG5C,MAEjB,iCAGA,iCAGA,iCAGA,wCAGA,wCAQxB,gD,GAjGHy5C,cAgHNC,eAAWC,aANF,SAAAtzC,GACpB,MAAO,CACHotC,gBAAiBptC,EAAMuzC,MAAMnG,mBAMjC,CACID,wBAHkBmG,CAKxBsN,K,SCzHmBC,I,yDAEnB,WAAahhD,GAAQ,IAAD,8BAClB,cAAMA,IAKRihD,cAAgB,KANI,EAoEpBC,eAAiB,WAEf,IACIC,EAAa,CAAEtnD,KAAM,OAAQunD,OAAQ,aAAc5sB,IAAK,IAAI+Z,KAAK,KAAM,EAAG,IAG9E8S,SAAMrjD,OAAOsjD,QAAU,CAKrB,CAACjnD,KAAK,OAAciS,MAAM,YAAci1C,MAAK,EAAM5vC,MAAM,IAAKsX,OAT/C,CAAEpvB,KAAM,OAAQunD,OAAQ,SAUvC,CAAC/mD,KAAK,aAAciS,MAAM,aAAcqF,MAAO,IAAK6vC,MAAM,SAAUv4B,OAAQk4B,GAE5E,CAAE9mD,KAAM,WAAYiS,MAAO,WAAYk1C,MAAO,SAAUv4B,OAVrC,CAAEpvB,KAAM,SAAUunD,OAAQ,WAAY5sB,IAAK,EAAGC,IAAK,MAYtE,CAAEp6B,KAAM,MAAOsX,MAAO,KAIxB0vC,SAAMrjD,OAAOyjD,aAAe,MAxFV,EA2FpBC,eAAiB,WACfL,SAAMrjD,OAAO2jD,kBAAkB,CAAC,cAAc,YAAa,gBAC3DN,SAAMO,OAAOC,OAAb,aAAsC,eAGtCR,SAAMS,OAAOC,QAAQC,aAAa,SAAS3wB,GAEzC,OADA2F,MAAM,mCACC,IAhGT,EAAKirB,WAFa,E,uDASlBZ,SAAMa,IAAIC,KAAKC,KAAK,CAClBC,OAAQ,CACN,CACEhoD,KAAM,QACNioD,aAAc,GACdC,iBAAkB,GAClBC,OAAQ,CACN,CAAEnvB,KAAM,MAAOovB,KAAM,EAAGC,OAAQ,SAChC,CAAErvB,KAAM,OAAQovB,KAAM,EAAGC,OAAQ,QAGrC,CACEroD,KAAM,OACNioD,aAAc,GACdC,iBAAkB,GAClBC,OAAQ,CACN,CAAEnvB,KAAM,OAAQovB,KAAM,EAAGC,OAAQ,YACjC,CAAErvB,KAAM,MAAOovB,KAAM,EAAGC,OAAQ,WAGpC,CACEroD,KAAM,SACNioD,aAAc,GACdC,iBAAkB,GAClBC,OAAQ,CACN,CAAEnvB,KAAM,QAASovB,KAAM,EAAGC,OAAQ,MAClC,CAAErvB,KAAM,OAAQovB,KAAM,EAAGC,OAAQ,SAGrC,CACEroD,KAAM,UACNyX,OAAQ,GACRywC,iBAAkB,GAClBC,OAAQ,CACN,CAAEnvB,KAAM,QAASovB,KAAM,EAAGC,OAAQ,MAClC,CACErvB,KAAM,UAAWovB,KAAM,EAAGC,OAAQ,SAAU5T,GAC1C,IAAI6T,EAAYtB,SAAMvS,KAAK8T,YAAY,MACnCC,EAAUxB,SAAMvS,KAAK9kC,IAAIq3C,SAAMvS,KAAK9kC,IAAI8kC,EAAM,EAAG,UAAW,EAAG,OACnE,OAAO6T,EAAU7T,GAAQ,MAAQ6T,EAAUE,OAInD,CACExoD,KAAM,OACNioD,aAAc,GACdC,iBAAkB,GAClBC,OAAO,CACL,CAACnvB,KAAM,OAAQovB,KAAM,EAAGC,OAAQ,a,8BAOlCtpD,GACNioD,SAAMa,IAAIC,KAAKW,SAAS1pD,K,+CA2CxB,IAAM2pD,EAAgBhqD,KAAKiH,MAAM+iD,cACjChqD,KAAKkoD,cAAgBI,SAAM2B,qBAAoB,SAACnpD,EAAMopD,EAAQ33C,EAAM+lB,GAClE,OAAO,IAAI5X,SAAQ,SAACC,EAASC,GAO3B,OANIopC,GACFA,EAAclpD,EAAMopD,EAAQ33C,EAAM+lB,GAK7B3X,Y,4CAKSwpC,GACpB,OAAOnqD,KAAKiH,MAAMmiD,OAASe,EAAUf,O,0CAIrCd,SAAMrjD,OAAOmlD,SAAW,iBADN,IAEVvU,EAAU71C,KAAKiH,MAAf4uC,MACRpC,QAAQt7B,IAAI,SAAUmwC,UACtBA,SAAM1lB,QAAQ,CAEZ9N,SAAS,EACTu1B,YAAY,IAEdrqD,KAAKmoD,iBACLnoD,KAAK2oD,iBACLL,SAAMe,KAAKrpD,KAAKsqD,gBAChBhC,SAAMiC,UAAUC,aAAe,SAASC,EAAMC,EAAIC,GAChD,MAAO,gBAAgBA,EAAK9/C,KAAK,2BACjCy9C,SAAMiC,UAAUK,oBAAoBH,GACpC,yBAAyBnC,SAAMiC,UAAUK,oBAAoBF,IAE/DpC,SAAMrjD,OAAO4lD,SAAS/4C,SAAS,CAC7B,CAACxQ,KAAK,cAAeyX,OAAO,GAAIsvC,OAAO,OAAQvnD,KAAK,WAAWgqD,OAAM,GACrE,CAACxpD,KAAK,SAAeyX,OAAO,GAAIsvC,OAAO,OAAQvnD,KAAK,OAAQiqD,YAAY,CAAC,QAAQ,KAAK,KAAK,QAE7FzC,SAAMO,OAAOC,OAAOkC,eAAiB,cAGrChrD,KAAKirD,yBACL3C,SAAMnqB,MAAM0X,K,6CAIR71C,KAAKkoD,gBACPloD,KAAKkoD,cAAcgD,aACnBlrD,KAAKkoD,cAAgB,Q,+BAIf,IAAD,OACCkB,EAASppD,KAAKiH,MAAdmiD,KAER,OADAppD,KAAKmrD,QAAQ/B,GAEX,yBACElhD,IAAK,SAACuY,GAAY,EAAK6pC,eAAiB7pC,GACxC5b,MAAO,CAAE+T,MAAO,OAAQG,OAAQ,c,GAzKLyhC,cCFpByN,I,OAAAA,ICDMrF,G,4MACnBwI,iBAAmB,SAAC9jD,GACd,EAAKL,MAAMokD,cACb,EAAKpkD,MAAMokD,aAAa/jD,EAAEQ,OAAOzH,Q,uDAG3B,IAAD,OACDirD,EAAa,CAAC,QAAS,OAAQ,SAAU,UAAW,QAAQ5qD,KAAI,SAACL,GACrE,IAAMkrD,EAAW,EAAKtkD,MAAMmiD,OAAS/oD,EACrC,OACE,2BAAOF,IAAME,EAAQ2P,UAAS,sBAAkBu7C,EAAW,qBAAsB,KAC/E,2BAAOzqD,KAAK,QACVgQ,QAAUy6C,EACVnjD,SAAW,EAAKgjD,iBAChB/qD,MAAQA,IACRA,MAKR,OACE,yBAAK2P,UAAU,YACb,qCACIs7C,O,GAvByB9Q,aCCtBoI,I,OAAAA,ICAT4I,G,uKAEF,IAAMC,EAAWzrD,KAAKiH,MAAMwkD,SAAS/qD,KAAI,YAAkB,IAAfgrD,EAAc,EAAdA,QAC1C,OAAO,wBAAIvrD,IAAMiD,KAAKC,UAAYqoD,MAGpC,OACE,yBAAK17C,UAAU,gBACb,yCACA,4BACGy7C,Q,GAVejR,aAiB1BgR,GAAYpwC,aAAe,CACzBqwC,SAAU,I,cAGGD,ICSTG,G,4MACJvkD,MAAQ,CACNwkD,YAAa,OACbH,SAAU,GACVI,QAAS,CACP9qD,KAAM,GAYNwzB,MAAO,K,EAkBXu3B,cAAgB,SAAChrD,EAAMopD,EAAQ33C,EAAM+lB,GAAQ,IAEzCuzB,EACE,EAAKzkD,MADPykD,QAEF,GAAY,QAAR/qD,EACF,GAAc,UAAVopD,EAAoB,CACtB,IAAInpD,EAAI,eACHwR,GAELs5C,EAAQ9qD,KAAKuM,KAAKvM,QACb,GAAc,UAAVmpD,EACT,IAAK,IAAI3jD,EAAI,EAAGA,EAAIslD,EAAQ9qD,KAAK0F,OAAQF,IAEvC,GAAI+xB,GAAMuzB,EAAQ9qD,KAAKwF,GAAG+xB,GAAI,CAC5BuzB,EAAQ9qD,KAAKwF,GAAKgM,EAClB,MAOR,EAAKjK,SAAS,CACZujD,YACC,WAAO,IAAD,EACsB,EAAK5kD,MAAM+yC,MAAMC,OAAtC1D,EADD,EACCA,aAAcje,EADf,EACeA,GACtBqe,EAAc,CAACkV,WAAUtV,EAAcje,O,EAI3CyzB,cAAgB,SAACjrD,EAAMopD,EAAQ33C,EAAM+lB,GACnCmb,QAAQt7B,IAAI,QAASrX,EAAM,UAAWopD,EAAQ,QAAS33C,EAAM,MAAO+lB,UAO7D4xB,EAAO,wBACd,EAAK4B,cAAchrD,EAAMopD,EAAQ33C,EAAM+lB,I,EAGzC8yB,iBAAmB,SAAChC,GAClB,EAAK9gD,SAAS,CACZsjD,YAAaxC,K,EAIjB4C,wBAA0B,SAACH,GACrBA,GAAWnmD,OAAO80B,KAAKqxB,GAASx+C,SAAS,UAC3C,EAAK/E,SAAS,CACZujD,YAEFvD,SAAMnqB,MAAM0tB,K,kEAIK,IAAD,SAKV7rD,KAAKiH,MAAM+yC,MAAMC,OAFjB1D,EAHU,EAGVA,aACAje,EAJU,EAIVA,GAERmb,QAAQt7B,IAAI,eAAgBo+B,GANV,IASd/B,EACAx0C,KAAKiH,MADLutC,gBAKJf,QAAQt7B,IAAI,yCAA0Cq8B,GACxB,iBAAnBA,GAAsE,GAAvC9uC,OAAO80B,KAAKga,GAAiB/tC,OACnEywC,EAAWX,EAAcje,GAAI4F,MAAK,SAAAjxB,GAC9BwmC,QAAQt7B,IAAI,8BAA+BlL,GACvCA,GAAOA,EAAIylC,MAAQzlC,EAAIylC,KAAK,KAC5B,EAAKzrC,MAAMstC,qBAAqBtnC,EAAIylC,KAAK,IACzC,EAAKsZ,wBAAwB/+C,EAAIylC,KAAK,GAAGmZ,aAGhDrY,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,QAIlCtN,KAAKgsD,wBAAwBxX,EAAgBqX,W,+BAIvC,IAAD,EACoC7rD,KAAKoH,MAAxCwkD,EADD,EACCA,YAAuBC,GADxB,EACcJ,SADd,EACwBI,SAE/B,OADApY,QAAQt7B,IAAI,gBAAiB0zC,GAE3B,yBAAK77C,UAAU,kBACb,yBAAKA,UAAU,YACb,kBAAC,GAAD,CACEo5C,KAAMwC,EACNP,aAAcrrD,KAAKorD,oBAGvB,yBAAKp7C,UAAU,mBACb,kBAAC,GAAD,CACE6lC,MAAOgW,EACPzC,KAAMwC,EACN5B,cAAehqD,KAAK+rD,sB,GA7IVvR,aA+JPC,eAAWC,aAPF,SAAAtzC,GAEtB,MAAO,CACLotC,gBAAiBptC,EAAMuzC,MAAMnG,mBAM/B,CACID,wBAHoBmG,CAKxBiR,KCvLIM,I,yLAEkB,IAER3zB,EAAOt4B,KAAKiH,MAAM+yC,MAAMC,OAAxB3hB,GACRqgB,EAAmBrgB,K,+BAIb,IAEF4zB,EACAlsD,KAAKiH,MAAM+yC,MAAMC,OADjBiS,MAIA1X,EACAx0C,KAAKiH,MADLutC,gBAGA2X,EAAO,KASX,MARa,QAATD,EACAC,EAAO,kBAAC,GAAD,MACO,UAATD,EACLC,EAAO,kBAAC,GAAD,MACO,aAATD,EACLC,EAAO,kBAAC,GAAD,MACO,WAATD,IACLC,EAAO,kBAAC,GAAD,OAEP,oCACI,kBAAC,GAAD,CACIn6C,MAAOwiC,GAAmBA,EAAgBxiC,MAAQwiC,EAAgBxiC,MAAQ,OAE9E,yBAAKhC,UAAU,gBACX,kBAAC,GAAD,OAEHm8C,GAAc,4E,GAnCT3R,cAkDPC,eAAWC,aATF,SAAAtzC,GAEpB,MAAO,CACHqwC,KAAMrwC,EAAMywC,SACZG,gBAAiB5wC,EAAMywC,SAASG,gBAChCxD,gBAAiBptC,EAAMuzC,MAAMnG,mBAMjC,CACImE,sBAHkB+B,CAKxBuR,K,8BCyFaG,GAxJD,WAAO,IAAD,EAEUC,mBAAS,IAFnB,oBAETC,EAFS,KAEFC,EAFE,OAGgBF,mBAAS,IAHzB,oBAGTG,EAHS,KAGCC,EAHD,OAIkBJ,mBAAS,IAJ3B,oBAITK,EAJS,KAIEC,EAJF,OAKsBN,oBAAS,GAL/B,oBAKTO,EALS,KAKIC,EALJ,OAMcR,oBAAS,GANvB,oBAMTS,EANS,KAMAC,EANA,KAOVC,EAAU,IAAIC,KAChB9Y,EAAU+Y,cAERC,EAAc,SAAC7lD,GACK,UAAlBA,EAAEQ,OAAOxG,KACTirD,EAASjlD,EAAEQ,OAAOzH,OACO,aAAlBiH,EAAEQ,OAAOxG,KAChBmrD,EAAYnlD,EAAEQ,OAAOzH,OAErBssD,EAAarlD,EAAEQ,OAAOzH,QAIxB+sD,EAAa,SAACjS,GAEZ4R,EADS,aAAT5R,IAOFkS,EAAe,SAAC/lD,EAAGxG,GACrBwG,EAAEmS,iBAEF,IAAIo6B,EAAU,CACVyY,QACAE,YAGS,aAAT1rD,EACI0rD,IAAaE,EACbG,GAAe,IAGfhZ,EAAQoC,aAAc,IAAIT,MAAO8X,oBCdzB,SAACzZ,GACrB,OAAO,IAAInzB,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAUC,SAAU,CACtBS,OAAQ,OACRC,QAAS,CACL,eAAgB,oBAEpBc,KAAM5X,KAAKC,UAAUyX,KAExB3V,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GAEH0yC,QAAQt7B,IAAI,oBAAqBpX,GACjC4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,SDVHw7B,CAASsB,GAAS3V,MAAK,SAAAjxB,GAEnB+/C,EAAQp/C,IAAI,QAASX,EAAIsgD,OACzBC,EAAkBvgD,MAErBumC,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,GAAKvL,MAAMktC,QAAQ7mC,KAAK,SCtD3B,SAACumC,GAClB,OAAO,IAAInzB,SAAQ,SAACC,EAASC,GACzBiyB,MAAMP,EAAUE,MAAO,CACnBQ,OAAQ,OACRC,QAAS,CACL,eAAgB,oBAEpBc,KAAM5X,KAAKC,UAAUyX,KAEpB3V,MAAK,SAACgV,GACH,GAAIA,EAASC,GACT,OAAOD,EAASE,OAEhB,KAAM,CACFC,IAAKH,EAASI,WACdC,OAAQL,EAASK,WAI5BrV,MAAK,SAACn9B,GACH0yC,QAAQt7B,IAAI,iBAAkBpX,GAC9B4f,EAAQ5f,MAEXyyC,OAAM,SAACz8B,GACJ08B,QAAQ18B,MAAM,SAAUA,GACxB6J,EAAO7J,SDmCXy7B,CAAMqB,GAAS3V,MAAK,SAAAjxB,GAEhBugD,EAAkBvgD,GAClBknC,EAAQ7mC,KAAK,kBAEhBkmC,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,GAAKvL,MAAMktC,QAAQ7mC,KAAK,SAMlCkgD,EAAoB,SAACvgD,GAEvB6lC,aAAa2a,QAAQ,QAASxgD,EAAIsgD,OAClCza,aAAa2a,QAAQ,UAAWxgD,EAAI6mC,SACpChB,aAAa2a,QAAQ,cAAexgD,EAAIgpC,cAG5C,OAAQ,6BACH6W,EACG,0BAAMY,SAAU,SAACrR,GAAD,OAAYgR,EAAahR,EAAQ,WAC7C,wCACA,6BACI,yCAGA,2BAAOv7C,KAAK,QACRQ,KAAK,QACLjB,MAAOisD,EACPlkD,SAAU+kD,EACVQ,UAAQ,KAGhB,6BACI,4CAGA,2BAAO7sD,KAAK,WACRQ,KAAK,WACLjB,MAAOmsD,EACPpkD,SAAU+kD,EACVQ,UAAQ,KAGhB,6BACI,2BAAO7sD,KAAK,SAAST,MAAM,YAE/B,0BAAM0L,QAAS,kBAAMqhD,EAAW,cAAhC,4BAEJ,0BAAMM,SAAU,SAACrR,GAAD,OAAYgR,EAAahR,EAAQ,cAC7C,2CACA,6BACI,yCAGA,2BAAOv7C,KAAK,QACRQ,KAAK,QACLjB,MAAOisD,EACPlkD,SAAU+kD,EACVQ,UAAQ,KAGhB,6BACI,4CAGA,2BAAO7sD,KAAK,WACRQ,KAAK,WACLjB,MAAOmsD,EACPpkD,SAAU+kD,EACVQ,UAAQ,KAGhB,6BACI,oDAGA,2BAAO7sD,KAAK,WACRQ,KAAK,YACLjB,MAAOqsD,EACPtkD,SAAU+kD,EACVQ,UAAQ,KAGhB,2BAAO7sD,KAAK,SAAST,MAAM,WAC1BusD,EAAc,2EAAwD,KACvE,0BAAM7gD,QAAS,kBAAMqhD,EAAW,WAAhC,4BE/IVQ,I,yDAEF,WAAY3mD,GAAQ,IAAD,8BACf,cAAMA,IAMVw2C,aAAe,SAACn2C,GAEZ,EAAKgB,SAAS,CACVsrC,UAAWtsC,EAAEQ,OAAOzH,SAVT,EAcnBs5C,gBAAkB,WAAO,IAEjB/F,EACA,EAAKxsC,MADLwsC,UAOAlwC,EAFA,EAAKuD,MADLotC,WAGmB5tC,OAEvB,EAAKQ,MAAM0sC,eAAeC,EAAWlwC,GACrC,EAAK4E,SAAS,CACVsrC,UAAW,MA3BA,EA+BnB2F,cAAgB,SAACC,GACb/F,QAAQt7B,IAAI,OAAQqhC,GACpB,EAAKvyC,MAAMstC,qBAAqBiF,GAChC,EAAKvyC,MAAMktC,QAAQ7mC,KAAK,cAAcksC,EAAGvF,IAAI,eAlC9B,EAqCnBU,gBAAkB,SAACrtC,EAAGkyC,GAClBlyC,EAAEC,kBACFmsC,EAAuB8F,EAAGvF,KAAK/V,MAAK,SAAAjxB,GAChC,EAAKhG,MAAMytC,kBAAkB8E,MAEhChG,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,SA3ChC,EAAKlG,MAAQ,CACTwsC,UAAW,IAHA,E,gEAkDE,IAAD,OAEhBhB,IAAgB1U,MAAK,SAAAjxB,GACjBwmC,QAAQt7B,IAAI,yBAA0BlL,GACtC,EAAKhG,MAAMmtC,gBAAgBnnC,EAAIylC,SAElCc,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,U,+BAK1B,IAAD,OAGDsmC,EACA5zC,KAAKoH,MADLwsC,UAIAS,EACAr0C,KAAKiH,MADLotC,WAGJ,OACI,oCACA,6BACI,6CACA,8BACI,2BAAOvzC,KAAK,OAAOT,MAAOuzC,EAAWxrC,SAAUpI,KAAKy9C,eACpD,4BAAQ1xC,QAAS/L,KAAK25C,iBAAtB,SAGR,wBAAI3pC,UAAU,SAENqkC,EAAW3zC,KAAI,SAAA84C,GAAE,OAAI,wBAAIxpC,UAAU,UAAUjE,QAAS,kBAAM,EAAKwtC,cAAcC,KAC3E,8BAAOA,EAAGl4C,MACV,4BAAQ0O,UAAU,SAASjE,QAAS,SAAC8hD,GAAD,OAAQ,EAAKlZ,gBAAgBkZ,EAAIrU,KAArE,oB,GAzFUgB,cA0GnBC,eAAWC,aARF,SAAAtzC,GAEpB,MAAO,CACH88C,gBAAiB98C,EAAMuzC,MAAMuJ,gBAC7B7P,WAAYjtC,EAAMuzC,MAAMtG,cAM5B,CACIV,iBACAS,kBACAG,uBACAG,qBANkBgG,CAQxBkT,KCnHIE,G,kDACF,WAAY7mD,GAAQ,IAAD,8BACf,cAAMA,IAiCV+7C,QAAU,WACN,EAAK/7C,MAAMktC,QAAQ7mC,KAAK,gBAnCT,E,gEAIE,IAAD,OAERipC,EAAiBv2C,KAAKiH,MAAM+yC,MAAMC,OAAlC1D,aACR9C,QAAQt7B,IAAI,eAAgBo+B,GAHZ,MASZv2C,KAAKiH,MADLutC,GARY,EAMZH,WANY,EAOZ6P,gBAPY,EAQZ1P,iBAKJf,QAAQt7B,IAAI,yCAA0Cq8B,GACxB,iBAAnBA,GAAsE,GAAvC9uC,OAAO80B,KAAKga,GAAiB/tC,QACnEywC,EAAWX,GAAcrY,MAAK,SAAAjxB,GAC1BwmC,QAAQt7B,IAAI,8BAA+BlL,GACvCA,GAAOA,EAAIylC,MAAQzlC,EAAIylC,KAAK,IAC5B,EAAKzrC,MAAMstC,qBAAqBtnC,EAAIylC,KAAK,OAGhDc,OAAM,SAAAlsC,GACHmsC,QAAQt7B,IAAI,MAAO7Q,GACH,KAAZA,EAAEisC,QAAwC,gBAAvBjsC,EAAE+rC,IAAI7gC,eACzB,EAAKvL,MAAMktC,QAAQ7mC,KAAK,U,+BAU9B,IAAD,EAKDtN,KAAKiH,MAHLotC,EAFC,EAEDA,WACA6P,EAHC,EAGDA,gBACA1P,EAJC,EAIDA,gBAGJ,OACI,6BAE+C,GAAvC9uC,OAAO80B,KAAKga,GAAiB/tC,OACzB,kBAAC,GAAD,CACI4tC,WAAYA,EACZ6P,gBAAiBA,EACjBlB,QAAShjD,KAAKgjD,UAElB,gD,GAvDAxI,aAwETC,eAAWC,aARF,SAAAtzC,GAEpB,MAAO,CACH88C,gBAAiB98C,EAAMuzC,MAAMnG,gBAC7BH,WAAYjtC,EAAMuzC,MAAMtG,cAM5B,CACIE,wBAHkBmG,CAKxBoT,K,OCVaC,OAvDf,WACE,OACE,kBAAC,IAAD,KAEI,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOC,OAAK,EAACC,KAAK,KAChB,kBAAC,GAAD,OAQF,kBAAC,IAAD,CAAOA,KAAK,sCACV,kBAAC,GAAD,OAEF,kBAAC,IAAD,CAAOA,KAAK,+CACV,kBAAC,GAAD,OAEF,kBAAC,IAAD,CAAOA,KAAK,eACV,kBAAC,GAAD,OAEF,kBAAC,IAAD,CAAOA,KAAK,4BACV,kBAAC,GAAD,UC/BQlS,QACW,cAA7BuI,OAAO4J,SAASC,UAEe,UAA7B7J,OAAO4J,SAASC,UAEhB7J,OAAO4J,SAASC,SAASnU,MACvB,2D,uBCFSnE,I,OAhBD,WAAyB,IAAxBzuC,EAAuB,uDAAf,GAAI8iD,EAAW,uCACpC,OAAQA,EAAOppD,MACb,IAAK,WACH,MAAM,GAAN,mBACKsG,GADL,CAEE,CACEkxB,GAAI4xB,EAAO5xB,GACXztB,KAAMq/C,EAAOr/C,KACbujD,WAAW,KAGjB,QACE,OAAOhnD,KCOEinD,GAnBA,WAAyB,IAAxBjnD,EAAuB,uDAAf,GAAI8iD,EAAW,uCACnC,OAAQA,EAAOppD,MACX,IAAK,gBAED,MAAM,GAAN,mBACOsG,GADP,YAEO8iD,EAAOmE,SAElB,IAAK,YAED,MAAM,GAAN,mBACOjnD,GACA,CAAC8iD,EAAOviD,QAEnB,QACI,OAAOP,ICHJkL,GAZA,WAA0C,IAAzClL,EAAwC,uDAAhC,CAAC/G,MAAO,YAAa6pD,EAAW,uCACpD,OAAQA,EAAOppD,MACX,IAAK,eACD,OAAO,2BACAsG,GADP,IAEI/G,MAAO6pD,EAAO53C,SAEtB,QACI,OAAOlL,ICRfe,GAAY,CACZmmD,IAAK,GACLC,QAAS,EACTxY,KAAM,IAAIP,MAyBCgZ,GAtBD,WAAgC,IAA/BpnD,EAA8B,uDAAtBe,GAAW+hD,EAAW,uCACzC,OAAQA,EAAOppD,MACX,IAAK,cACD,OAAO,2BACAsG,GADP,IAEIknD,IAAI,YAAKpE,EAAOuE,aAExB,IAAK,kBACD,OAAO,2BACArnD,GADP,IAEImnD,QAA0B,IAAjBrE,EAAO7pD,MAAc6pD,EAAO7pD,MAAQ+G,EAAMmnD,QAAUrE,EAAO7pD,QAE5E,IAAK,YACD,OAAO,2BACA+G,GADP,IAEI2uC,KAAMmU,EAAOnU,OAErB,QACI,OAAO3uC,ICxBNsnD,GAAe,CACxBn7C,MAAO,CACHyoC,OAAQ,OACRj7C,KAAM,CAAC,CACHwS,MAAO,QACR,CACCA,MAAO,YAGfggC,OAAQ,CACJyI,OAAQ,OACRj7C,KAAM,CAAC,CACHwS,MAAO,QACR,CACCA,MAAO,SACR,CACCA,MAAO,UAGfwiC,KAAM,CACF4Y,WAAY,IAAInZ,OAoET+G,GAhEC,WAAmC,IAAlCn1C,EAAiC,uDAAzBsnD,GAAcxE,EAAW,uCAC9C,OAAQA,EAAOppD,MACX,IAAK,WACD,OAAO,2BACAsG,GADP,IAEI2uC,KAAK,2BAAK3uC,EAAM2uC,MAAZ,IAAkB4Y,WAAYzE,EAAOyE,eAEjD,IAAK,aACD,OAAO,2BACAvnD,GADP,IAEImsC,OAAO,2BAAKnsC,EAAMmsC,QAAZ,IAAoByI,OAAQkO,EAAOzN,iBAEjD,IAAK,YACD,OAAO,2BACAr1C,GADP,IAEImM,MAAM,2BAAKnM,EAAMmM,OAAZ,IAAmByoC,OAAQkO,EAAO1N,gBAE/C,IAAK,YACD,OAAO,2BACAp1C,GADP,IAEImM,MAAM,2BAAKnM,EAAMmM,OAAZ,IAAmBxS,KAAK,GAAD,mBAAMqG,EAAMmM,MAAMxS,MAAlB,CAAwB,CAACwS,MAAO22C,EAAO32C,aAE3E,IAAK,eAED,IAAIq7C,EAMA,OAJJA,EAAgB1E,EAAOxmD,MAAQ,EAAI0D,EAAMmM,MAAMxS,KAAKmpD,EAAOxmD,MAAM,GAAK0D,EAAMmM,MAAMxS,KAAKmpD,EAAOxmD,MAAM,GAIzF,2BACA0D,GADP,IAEImM,MAAM,2BACCnM,EAAMmM,OADR,IAEDxS,KAAMqG,EAAMmM,MAAMxS,KAAKuR,QAAO,SAACC,EAAMhM,GAAP,OAAaA,IAAM2jD,EAAOxmD,SACxDs4C,OAAQ4S,GAAiBA,EAAcr7C,MAAQq7C,EAAcr7C,MAAQ,SAGrF,IAAK,aACD,OAAO,2BACAnM,GADP,IAEImsC,OAAO,2BAAKnsC,EAAMmsC,QAAZ,IAAoBxyC,KAAK,GAAD,mBAAMqG,EAAMmsC,OAAOxyC,MAAnB,CAAyB,CAACwS,MAAO22C,EAAO32C,aAE9E,IAAK,gBAQG,OAJa22C,EAAOxmD,MAAQ,EAAI0D,EAAMmsC,OAAOxyC,KAAKmpD,EAAOxmD,MAAM,GAAK0D,EAAMmsC,OAAOxyC,KAAKmpD,EAAOxmD,MAAM,GAI5F,2BACA0D,GADP,IAEImsC,OAAO,2BACAnsC,EAAMmsC,QADP,IAEFxyC,KAAMqG,EAAMmsC,OAAOxyC,KAAKuR,QAAO,SAACC,EAAMhM,GAAP,OAAaA,IAAM2jD,EAAOxmD,aAIzE,QACI,OAAO0D,IClFbsnD,GAAe,CACjBhc,KAAM,GACNsF,gBAAiB,KACjB6W,SAAU,MAkFChX,GA/EE,WAAmC,IAAlCzwC,EAAiC,uDAAzBsnD,GAAcxE,EAAW,uCAC/C,OAAQA,EAAOppD,MACX,IAAK,qBACD,OAAO,2BACAsG,GADP,IAEI4wC,gBAAiBkS,EAAO5xB,KAEhC,IAAK,cACD,IAAIw2B,EAAQ,eAAQ1nD,GAEpB,YAAkBqc,GAAdymC,EAAO1S,KAGP0S,EAAOrV,QAAQZ,IAAMiW,EAAOjW,IAC5B6a,EAASpc,KAAKwX,EAAOjW,KAAOvuC,OAAOU,OAAO,GAAI8jD,EAAOrV,SAC9Cia,IAKPA,EAASpc,KAAKwX,EAAOjW,KAAK4B,MAAMqU,EAAO1S,KAAO9xC,OAAOU,OAAO,GAAI8jD,EAAOrV,SAChEia,GAEf,IAAK,iBACD,IAAIC,EAAM,eAAQ3nD,GAWlB,OAVA2nD,EAAOrc,KAAKwX,EAAO5xB,IAAnB,2BACOy2B,EAAOrc,KAAKwX,EAAO5xB,KAD1B,mBAEK4xB,EAAO/pD,IAAM+pD,EAAOhS,MAErBgS,EAAO2E,WACPE,EAAOrc,KAAKwX,EAAO5xB,IAAnB,2BACOy2B,EAAOrc,KAAKwX,EAAO5xB,KAD1B,IAEIu2B,SAAU3E,EAAO2E,YAGrB9S,QAAQmO,EAAO5xB,IACRy2B,EAEA3nD,EACf,IAAK,sBACD,IAAI4nD,EAAO,eAAQ5nD,GAGfowC,EACA0S,EADA1S,IAcJ,OAXAwX,EAAQtc,KAAKwX,EAAO5xB,IAAIud,MAAM2B,GAA9B,2BACOwX,EAAQtc,KAAKwX,EAAO5xB,IAAIud,MAAM2B,IADrC,mBAEK0S,EAAO/pD,IAAM+pD,EAAOhS,MAErBgS,EAAO2E,WACPG,EAAQtc,KAAKwX,EAAO5xB,IAAIud,MAAM2B,GAA9B,2BACOwX,EAAQtc,KAAKwX,EAAO5xB,IAAIud,MAAM2B,IADrC,IAEIqX,SAAU3E,EAAO2E,YAIR,MAAb3E,EAAO5xB,GACA02B,EAEA5nD,EACf,IAAK,cACD,IAAI6nD,EAAM,eAAO7nD,GAGjB,cADO6nD,EAAOvc,KAAKwX,EAAO5xB,IACnB22B,EACX,IAAK,YACD,IAAIC,EAASxpD,OAAOU,OAAO,GAAIgB,GAE/B,OADA8nD,EAAOxc,KAAKwX,EAAO5xB,IAAIud,MAAQ,GACxBqZ,EACX,IAAK,eACD,IAAIC,EAAUrX,IAAOC,UAAU3wC,GAE/B,OADA+nD,EAAQzc,KAAOwX,EAAOxX,KACfyc,EACX,QACI,OAAO/nD,ICnFfsnD,GAAe,CACfp2B,GAAI,GACJmf,KAAM,CACF2X,OAAO,EACPp9C,MAAO,CACH+iC,MAAO,KACPE,aAAc,GACdD,UAAW,KACX30C,MAAO,GACP60C,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KACxB,CAAC,OAAQ,SAAU,cACvBhsC,YAAa,eAEjBisC,YAAa,CACTL,MAAO,KACPE,aAAc,GACdD,UAAW,KACX30C,MAAO,GACP60C,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KACxB,CAAC,OAAQ,SAAU,cACvBhsC,YAAa,qBAEjBksC,QAAS,CACLN,MAAO,KACPE,aAAc,GACdD,UAAW,KACX30C,MAAO,GACP60C,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KACxB,CAAC,OAAQ,SAAU,cACvBhsC,YAAa,iBAEjBmsC,OAAQ,CACJP,MAAO,KACPE,aAAc,GACdD,UAAW,KACX30C,MAAO,GACP60C,QAAS,CAAC,CAAC,CAAEC,OAAQ,CAAC,EAAG,GAAG,KACxB,CAAC,OAAQ,SAAU,cACvBhsC,YAAa,gBAEjBosC,UAAW,KACXE,QAAS,KACTliC,MAAO,GACPggC,OAAQ,GACRmC,SAAU,KACVC,UAAW,MAEfj1C,IAAK,GAGL2uD,MAAO,GAGPC,QAAS,IAuBEhX,GAlBO,WAAmC,IAAlClxC,EAAiC,uDAAzBsnD,GAAcxE,EAAW,uCACpD,OAAOA,EAAOppD,MACV,IAAK,WACD,OAAO,2BACAsG,GADP,IAEIqwC,KAAMyS,EAAOzS,OAErB,IAAK,eAED,OAAO,2BACArwC,GADP,IAEIqwC,KAAK,2BAAKrwC,EAAMqwC,MAAZ,mBAAmByS,EAAO/pD,IAAM+pD,EAAOhS,QAEnD,QACI,OAAO9wC,ICtENsnD,GAAe,CACxBla,gBAAiB,GACjBH,WAAY,IAiDDsG,GA9CD,WAAmC,IAAlCvzC,EAAiC,uDAAzBsnD,GAAcxE,EAAW,uCAExC7V,EACAjtC,EADAitC,WAEJ,OAAQ6V,EAAOppD,MACX,IxDZqB,gBwDgBjB,YAHoB2iB,GAAhBymC,EAAOxmD,QACPwmD,EAAOxmD,MAAQ2wC,EAAW5tC,QAEvB,2BACAW,GADP,IAEIitC,WAAW,GAAD,mBACHA,EAAWlT,MAAM,EAAG+oB,EAAOxmD,QADxB,CAENwmD,EAAOtW,WAFD,YAGHS,EAAWlT,MAAM+oB,EAAOxmD,WAGvC,IxDtBsB,iBwDuBlB,OAAO,2BACA0D,GADP,IAEIitC,WAAY6V,EAAO7V,aAE3B,IxDzB6B,wBwD0BzB,OAAO,2BACAjtC,GADP,IAEIotC,gBAAgB,eAAK0V,EAAO1V,mBAEpC,IxD5BwB,mBwD6BpB,IACI9wC,EADAo2C,EAAUzF,EAAW/hC,QAAO,SAAAknC,GAAE,OAAIA,EAAGvF,KAAOiW,EAAOxmD,SAMvD,OAJsB,GAAlBo2C,EAAQrzC,SACR/C,EAAQ2wC,EAAW9kC,QAAQuqC,EAAQ,IACnCrG,QAAQt7B,IAAI,gBAAiBzU,IAE1B,2BACA0D,GADP,IAEIitC,WAAW,GAAD,mBACHA,EAAWlT,MAAM,EAAGz9B,IADjB,YAEH2wC,EAAWlT,MAAMz9B,EAAQ,OAGxC,QACI,OAAO0D,IC/CbsnD,GAAe,CACjB18C,MAAO,GACPojC,YAAa,GACb4H,YAAa,OAeFuS,GAZM,WAAmC,IAAlCnoD,EAAiC,uDAAzBsnD,GAAcxE,EAAW,uCACnD,OAAQA,EAAOppD,MACX,ICV4B,uBDWxB,OAAO,2BACAsG,GACA8iD,EAAOzS,MAElB,QACI,OAAOrwC,IEHJooD,gBAAgB,CAC3B3Z,SACAwY,UACA/7C,UACAk8C,SAGAjS,WACA1E,YACAS,iBACAqC,SACA4U,kBCnBE1f,GAAa,CAAE4f,MAKrB,IAKeC,GALDC,aACZC,GACAC,KAAe,WAAf,EAAmBhgB,K,OCHrB9mC,iBAEI,kBAAC,IAAD,CAAU2mD,MAAOA,IACf,kBAAC,GAAD,OAIJlnD,SAAS88C,eAAe,SbmHpB,kBAAmBwK,WACrBA,UAAUC,cAAcC,MACrB9xB,MAAK,SAAA+xB,GACJA,EAAaC,gBAEd1c,OAAM,SAAAz8B,GACL08B,QAAQ18B,MAAMA,EAAM20C,a,iCchI5B,SAASyE,EAAe35C,GACtB,OAAuB,KCFT,OADiB0hC,EDGf1hC,ICFqB,kBAAR0hC,IAA2C,IAAvB13C,MAAMC,QAAQy3C,KDGpB,oBAAtCxyC,OAAOQ,UAAU5C,SAASoD,KAAK8P,GCJvB,IAAkB0hC,EDOlB,SAAS7F,EAAc77B,GACpC,IAAI45C,EAAKC,EAET,OAA0B,IAAtBF,EAAe35C,KAIC,oBADpB45C,EAAO55C,EAAEvQ,gBAKoB,IAAzBkqD,EADJE,EAAOD,EAAKlqD,aAIiC,IAAzCmqD,EAAKvqD,eAAe,mB,OA5B1B","file":"static/js/chunk-blinkmind.fbda846f.chunk.js","sourcesContent":["import _objectSpread from \"/Users/ramunarasinga/Documents/think-throo/tthroo/webapp/tthroo-webapp-v3/react-mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/ramunarasinga/Documents/think-throo/tthroo/webapp/tthroo-webapp-v3/react-mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/Users/ramunarasinga/Documents/think-throo/tthroo/webapp/tthroo-webapp-v3/react-mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/ramunarasinga/Documents/think-throo/tthroo/webapp/tthroo-webapp-v3/react-mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ramunarasinga/Documents/think-throo/tthroo/webapp/tthroo-webapp-v3/react-mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/ramunarasinga/Documents/think-throo/tthroo/webapp/tthroo-webapp-v3/react-mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/ramunarasinga/Documents/think-throo/tthroo/webapp/tthroo-webapp-v3/react-mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Record, List, Map as Map$1 } from 'immutable';\nimport debug from 'debug';\nimport isPlainObject from 'is-plain-object';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT',\n  SET_LAYOUT_DIR: 'SET_LAYOUT_DIR'\n};\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = /*#__PURE__*/function (_Record) {\n  _inherits(Block, _Record);\n\n  var _super = _createSuper(Block);\n\n  function Block() {\n    _classCallCheck(this, Block);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Block, [{\n    key: \"data\",\n    get: function get() {\n      return this.get('data');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this.get('type');\n    }\n  }], [{\n    key: \"create\",\n    value: function create(obj) {\n      return new Block(obj);\n    }\n  }, {\n    key: \"createList\",\n    value: function createList(obj) {\n      if (List.isList(obj) || Array.isArray(obj)) {\n        // @ts-ignore\n        return List(obj.map(Block.create));\n      }\n\n      throw new Error(\"Block.createList only accepts Array or List, but you passed it: \".concat(obj));\n    }\n  }]);\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = /*#__PURE__*/function (_Record2) {\n  _inherits(Config, _Record2);\n\n  var _super2 = _createSuper(Config);\n\n  function Config() {\n    _classCallCheck(this, Config);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Config, [{\n    key: \"layoutDir\",\n    get: function get() {\n      return this.get('layoutDir');\n    }\n  }, {\n    key: \"readOnly\",\n    get: function get() {\n      return this.get('readOnly');\n    }\n  }, {\n    key: \"allowUndo\",\n    get: function get() {\n      return this.get('allowUndo');\n    }\n  }, {\n    key: \"theme\",\n    get: function get() {\n      return this.get('theme');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      return new Config(obj);\n    }\n  }]);\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = /*#__PURE__*/function (_Record3) {\n  _inherits(Topic, _Record3);\n\n  var _super3 = _createSuper(Topic);\n\n  function Topic() {\n    _classCallCheck(this, Topic);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Topic, [{\n    key: \"getBlock\",\n    value: function getBlock(type) {\n      var index = this.blocks.findIndex(function (b) {\n        return b.type === type;\n      });\n      if (index === -1) return {\n        index: index,\n        block: null\n      };\n      return {\n        index: index,\n        block: this.blocks.get(index)\n      };\n    }\n  }, {\n    key: \"key\",\n    get: function get() {\n      return this.get('key');\n    }\n  }, {\n    key: \"parentKey\",\n    get: function get() {\n      return this.get('parentKey');\n    }\n  }, {\n    key: \"collapse\",\n    get: function get() {\n      return this.get('collapse');\n    }\n  }, {\n    key: \"subKeys\",\n    get: function get() {\n      return this.get('subKeys');\n    }\n  }, {\n    key: \"blocks\",\n    get: function get() {\n      return this.get('blocks');\n    }\n  }, {\n    key: \"relations\",\n    get: function get() {\n      return this.get('relations');\n    }\n  }, {\n    key: \"style\",\n    get: function get() {\n      return this.get('style');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      var key = obj.key,\n          _obj$parentKey = obj.parentKey,\n          parentKey = _obj$parentKey === void 0 ? null : _obj$parentKey,\n          blocks = obj.blocks,\n          _obj$subKeys = obj.subKeys,\n          subKeys = _obj$subKeys === void 0 ? [] : _obj$subKeys,\n          _obj$collapse = obj.collapse,\n          collapse = _obj$collapse === void 0 ? false : _obj$collapse;\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        collapse: collapse,\n        subKeys: List(subKeys),\n        blocks: Block.createList(blocks)\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(_ref) {\n      var key = _ref.key,\n          _ref$parentKey = _ref.parentKey,\n          parentKey = _ref$parentKey === void 0 ? null : _ref$parentKey,\n          _ref$content = _ref.content,\n          content = _ref$content === void 0 ? '' : _ref$content,\n          _ref$subKeys = _ref.subKeys,\n          subKeys = _ref$subKeys === void 0 ? [] : _ref$subKeys,\n          _ref$collapse = _ref.collapse,\n          collapse = _ref$collapse === void 0 ? false : _ref$collapse;\n      var block = Block.create({\n        type: BlockType.CONTENT,\n        data: content,\n        key: null\n      });\n      var blocks = List([block]);\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        blocks: blocks,\n        subKeys: List(subKeys),\n        collapse: collapse\n      });\n    }\n  }]);\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var _res;\n\n    var subKeys = item.subKeys.toArray();\n\n    (_res = res).push.apply(_res, _toConsumableArray(subKeys));\n\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, _toConsumableArray(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey) {\n  var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log = debug('modifier');\n\nfunction toggleCollapse(_ref2) {\n  var model = _ref2.model,\n      topicKey = _ref2.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_ref3) {\n  var model = _ref3.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  model = focusTopic({\n    model: model,\n    topicKey: model.editorRootTopicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction expandAll(_ref4) {\n  var model = _ref4.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo(_ref5) {\n  var model = _ref5.model,\n      topicKey = _ref5.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // 要让这个节点在视口中可见\n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_ref6) {\n  var model = _ref6.model,\n      topicKey = _ref6.topicKey,\n      focusMode = _ref6.focusMode;\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_ref7) {\n  var model = _ref7.model,\n      focusMode = _ref7.focusMode;\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_ref8) {\n  var model = _ref8.model,\n      topicKey = _ref8.topicKey;\n  log('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child.key, child);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_ref9) {\n  var model = _ref9.model,\n      topicKey = _ref9.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx = pItem.subKeys.indexOf(topicKey);\n    var sibling = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling.key, sibling);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx + 1, sibling.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_ref10) {\n  var model = _ref10.model,\n      topicKey = _ref10.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_ref11) {\n  var model = _ref11.model,\n      topicKey = _ref11.topicKey,\n      blockType = _ref11.blockType,\n      focusMode = _ref11.focusMode,\n      data = _ref11.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock = topic.getBlock(blockType),\n        index = _topic$getBlock.index,\n        block = _topic$getBlock.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_ref12) {\n  var model = _ref12.model,\n      topicKey = _ref12.topicKey,\n      blockType = _ref12.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock2 = topic.getBlock(blockType),\n        index = _topic$getBlock2.index;\n\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_ref13) {\n  var model = _ref13.model,\n      topicKey = _ref13.topicKey,\n      style = _ref13.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction clearAllCustomStyle(_ref14) {\n  var model = _ref14.model;\n  model = model.withMutations(function (model) {\n    model.topics.keySeq().forEach(function (key) {\n      model.setIn(['topics', key, 'style'], null);\n    });\n  });\n  return model;\n}\n\nfunction setTheme(_ref15) {\n  var model = _ref15.model,\n      theme = _ref15.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_ref16) {\n  var model = _ref16.model,\n      layoutDir = _ref16.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_ref17) {\n  var model = _ref17.model,\n      topicKey = _ref17.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_ref18) {\n  var model = _ref18.model,\n      zoomFactor = _ref18.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  clearAllCustomStyle: clearAllCustomStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: new Config(),\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = /*#__PURE__*/function (_Record4) {\n  _inherits(Model, _Record4);\n\n  var _super4 = _createSuper(Model);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Model, [{\n    key: \"toJS\",\n    value: function toJS() {\n      var obj = {\n        rootTopicKey: this.rootTopicKey,\n        topics: Object.values(this.topics.toJS()),\n        config: this.config,\n        extData: this.extData,\n        zoomFactor: this.zoomFactor\n      };\n      return obj;\n    }\n  }, {\n    key: \"getTopic\",\n    value: function getTopic(key) {\n      return this.topics.get(key);\n    }\n  }, {\n    key: \"getExtDataItem\",\n    value: function getExtDataItem(key, c) {\n      return this.extData.get(key) || new c();\n    }\n  }, {\n    key: \"getParentTopic\",\n    value: function getParentTopic(key) {\n      var topic = this.getTopic(key);\n      return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n    }\n  }, {\n    key: \"getTopicVisualLevel\",\n    value: function getTopicVisualLevel(key) {\n      var topic = this.getTopic(key);\n      var level = 0;\n\n      while (topic && topic.key !== this.editorRootTopicKey) {\n        level++;\n        topic = this.getParentTopic(topic.key);\n      }\n\n      return level;\n    }\n  }, {\n    key: \"extData\",\n    get: function get() {\n      return this.get('extData');\n    }\n  }, {\n    key: \"topics\",\n    get: function get() {\n      return this.get('topics');\n    }\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.get('config');\n    }\n  }, {\n    key: \"formatVersion\",\n    get: function get() {\n      return this.get('formatVersion');\n    }\n  }, {\n    key: \"rootTopicKey\",\n    get: function get() {\n      return this.get('rootTopicKey');\n    }\n  }, {\n    key: \"editorRootTopicKey\",\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    }\n  }, {\n    key: \"focusKey\",\n    get: function get() {\n      return this.get('focusKey');\n    }\n  }, {\n    key: \"focusMode\",\n    get: function get() {\n      return this.get('focusMode');\n    }\n  }, {\n    key: \"editingContentKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    }\n  }, {\n    key: \"editingDescKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    }\n  }, {\n    key: \"rootTopic\",\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    }\n  }, {\n    key: \"zoomFactor\",\n    get: function get() {\n      return this.get('zoomFactor');\n    }\n  }], [{\n    key: \"isModel\",\n    value: function isModel(obj) {\n      return obj instanceof Model;\n    }\n  }, {\n    key: \"create\",\n    value: function create() {\n      var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (attrs == null) return Model.createEmpty();\n      var res;\n\n      if (Model.isModel(attrs)) {\n        res = attrs;\n      }\n\n      if (isPlainObject(attrs)) {\n        res = Model.fromJSON(attrs);\n      }\n\n      if (res) {\n        if (res.focusKey == null) {\n          res = res.set('focusKey', res.rootTopicKey);\n        }\n\n        if (res.focusMode == null) {\n          res = res.set('focusMode', FocusMode.NORMAL);\n        }\n\n        return res;\n      }\n\n      throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \".concat(attrs));\n    }\n  }, {\n    key: \"createEmpty\",\n    value: function createEmpty() {\n      var model = new Model();\n      var rootTopic = Topic.create({\n        key: createKey(),\n        content: 'RootTopic'\n      });\n      return model.update('topics', function (topics) {\n        return topics.set(rootTopic.key, rootTopic);\n      }).set('rootTopicKey', rootTopic.key).set('editorRootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n    }\n  }, {\n    key: \"fromJSON\",\n    value: function fromJSON(object) {\n      var model = new Model();\n      var _object$topics = object.topics,\n          topics = _object$topics === void 0 ? [] : _object$topics,\n          _object$config = object.config,\n          config = _object$config === void 0 ? {} : _object$config,\n          rootTopicKey = object.rootTopicKey;\n      var editorRootTopicKey = object.editorRootTopicKey;\n      if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n      model = model.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey\n      });\n      model = model.withMutations(function (model) {\n        topics.forEach(function (topic) {\n          model.update('topics', function (topics) {\n            return topics.set(topic.key, Topic.fromJSON(topic));\n          });\n        });\n        model.set('config', Config.fromJSON(config));\n      });\n      return model;\n    }\n  }]);\n\n  return Model;\n}(Record(defaultModelRecord));\n\nfunction CorePlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === void 0 ? [] : _options$plugins;\n  return _toConsumableArray(plugins);\n}\n\nvar log$1 = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  var _iterator = _createForOfIteratorHelper(middleware),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var fn = _step.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Controller);\n\n    var _options$plugins2 = options.plugins,\n        plugins = _options$plugins2 === void 0 ? [] : _options$plugins2,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  _createClass(Controller, [{\n    key: \"run\",\n    value: function run(key) {\n      var middleware = this.middleware;\n      var fns = middleware[key] || [];\n      warning(fns.length !== 0, \"the middleware function \".concat(key, \" is not found!\"));\n      var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return composedFn.apply(void 0, args);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(propKey, arg) {\n      return this.run('getValue', _objectSpread(_objectSpread({}, arg), {}, {\n        propKey: propKey\n      }));\n    }\n  }, {\n    key: \"change\",\n    value: function change(model, callback) {\n      this.onChange(model, callback);\n      this.currentModel = model;\n    }\n  }]);\n\n  return Controller;\n}();\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import { BlockType, OpType, FocusMode } from '@blink-mind/core';\nimport { createElement, PureComponent } from 'react';\nimport plainSerializer from 'slate-plain-serializer';\nimport debug from 'debug';\nimport { Editor } from 'slate-react';\nimport styled from 'styled-components';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar log = debug('node:text-editor');\nvar Content = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  padding: 6px;\\n  background-color: \", \";\\n  cursor: \", \";\\n  min-width: 50px;\\n\"], [\"\\n  padding: 6px;\\n  background-color: \", \";\\n  cursor: \", \";\\n  min-width: 50px;\\n\"])), function (props) {\n  return props.readOnly ? null : 'white';\n}, function (props) {\n  return props.readOnly ? 'pointer' : 'text';\n});\n\nvar SimpleTextEditor =\n/** @class */\nfunction (_super) {\n  __extends(SimpleTextEditor, _super);\n\n  function SimpleTextEditor(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      content: null\n    };\n\n    _this.onMouseDown = function (e) {\n      e.stopPropagation();\n    };\n\n    _this.onMouseMove = function (e) {// log('onMouseMove');\n      // e.stopPropagation();\n    };\n\n    _this.onKeyDown = function (e) {};\n\n    _this._handleClick = function (event) {\n      var wasOutside = !_this.root.contains(event.target);\n      wasOutside && _this.onClickOutSide(event);\n    };\n\n    _this.rootRef = function (saveRef) {\n      return function (ref) {\n        saveRef(ref);\n        _this.root = ref;\n      };\n    };\n\n    _this.initState();\n\n    return _this;\n  }\n\n  SimpleTextEditor.prototype.onChange = function (_a) {\n    var value = _a.value;\n    log('onChange', value);\n    this.setState({\n      content: value\n    });\n  };\n\n  SimpleTextEditor.prototype.componentDidMount = function () {\n    var readOnly = this.props.readOnly;\n    if (readOnly) return;\n    document.addEventListener('click', this._handleClick);\n  };\n\n  SimpleTextEditor.prototype.componentWillUnmount = function () {\n    var readOnly = this.props.readOnly;\n    if (readOnly) return;\n    document.removeEventListener('click', this._handleClick);\n  };\n\n  SimpleTextEditor.prototype.onClickOutSide = function (e) {};\n\n  SimpleTextEditor.prototype.getCustomizeProps = function () {\n    return null;\n  };\n\n  SimpleTextEditor.prototype.getContent = function () {\n    var block = this.getCustomizeProps().block;\n    var content = block.data;\n    if (content == null) return null;\n\n    if (typeof content === 'string') {\n      content = plainSerializer.deserialize(content);\n    }\n\n    return content;\n  };\n\n  SimpleTextEditor.prototype.initState = function () {\n    var content = this.getContent();\n    this.state = {\n      content: content\n    };\n  };\n\n  SimpleTextEditor.prototype.render = function () {\n    var _a = this.props,\n        topicKey = _a.topicKey,\n        saveRef = _a.saveRef;\n\n    var _b = this.getCustomizeProps(),\n        readOnly = _b.readOnly,\n        getRefKeyFunc = _b.getRefKeyFunc,\n        placeholder = _b.placeholder,\n        style = _b.style;\n\n    log(readOnly);\n    var key = getRefKeyFunc(topicKey);\n    var content = readOnly ? this.getContent() : this.state.content;\n\n    var _c = this,\n        onMouseDown = _c.onMouseDown,\n        onMouseMove = _c.onMouseMove,\n        onKeyDown = _c.onKeyDown;\n\n    var editorProps = {\n      value: content,\n      readOnly: readOnly,\n      onChange: this.onChange.bind(this),\n      placeholder: placeholder,\n      style: style\n    };\n    var contentProps = {\n      key: key,\n      readOnly: readOnly,\n      ref: this.rootRef(saveRef(key)),\n      onMouseDown: onMouseDown,\n      onMouseMove: onMouseMove,\n      onKeyDown: onKeyDown\n    };\n    return createElement(Content, _assign({}, contentProps), createElement(Editor, _assign({}, editorProps, {\n      autoFocus: true\n    })));\n  };\n\n  return SimpleTextEditor;\n}(PureComponent);\n\nvar templateObject_1;\nvar log$1 = debug('node:topic-content-editor');\n\nfunction contentEditorRefKey(key) {\n  return \"content-editor-\" + key;\n}\n\nvar TopicContentEditor =\n/** @class */\nfunction (_super) {\n  __extends(TopicContentEditor, _super);\n\n  function TopicContentEditor(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.onKeyDown = function (e) {\n      if (e.nativeEvent.ctrlKey && e.nativeEvent.code === 'Enter') {\n        _this.save();\n      }\n    };\n\n    return _this;\n  }\n\n  TopicContentEditor.prototype.getCustomizeProps = function () {\n    var _a = this.props,\n        model = _a.model,\n        topicKey = _a.topicKey,\n        readOnly = _a.readOnly;\n    var block = model.getTopic(topicKey).getBlock(BlockType.CONTENT).block;\n    var getRefKeyFunc = contentEditorRefKey;\n    var style = {\n      whiteSpace: 'pre'\n    };\n    return {\n      block: block,\n      readOnly: readOnly,\n      getRefKeyFunc: getRefKeyFunc,\n      placeholder: 'new',\n      style: style\n    };\n  };\n\n  TopicContentEditor.prototype.onClickOutSide = function (e) {\n    log$1('onClickOutSide');\n    this.save();\n  };\n\n  TopicContentEditor.prototype.save = function () {\n    var _a = this.props,\n        model = _a.model,\n        topicKey = _a.topicKey;\n    var readOnly = model.editingContentKey !== topicKey;\n    if (readOnly) return;\n    var controller = this.props.controller;\n    controller.run('operation', _assign(_assign({}, this.props), {\n      opType: OpType.SET_TOPIC_BLOCK,\n      blockType: BlockType.CONTENT,\n      data: this.state.content,\n      focusMode: FocusMode.NORMAL\n    }));\n  };\n\n  return TopicContentEditor;\n}(SimpleTextEditor);\n\nvar log$2 = debug('node:topic-desc-editor');\n\nfunction descEditorRefKey(key) {\n  return \"desc-editor-\" + key;\n}\n\nvar TopicDescEditor =\n/** @class */\nfunction (_super) {\n  __extends(TopicDescEditor, _super);\n\n  function TopicDescEditor(props) {\n    var _this = _super.call(this, props) || this;\n\n    log$2('constructor');\n    return _this;\n  }\n\n  TopicDescEditor.prototype.initState = function () {\n    _super.prototype.initState.call(this);\n\n    var _a = this.props,\n        controller = _a.controller,\n        topicKey = _a.topicKey;\n    var key = \"topic-desc-data-\" + topicKey;\n    var value = this.state.content;\n    controller.run('setTempValue', {\n      key: key,\n      value: value\n    });\n  };\n\n  TopicDescEditor.prototype.getCustomizeProps = function () {\n    var _a = this.props,\n        model = _a.model,\n        topicKey = _a.topicKey;\n    var block = model.getTopic(topicKey).getBlock(BlockType.DESC).block;\n    var readOnly = model.editingDescKey !== topicKey;\n    var getRefKeyFunc = descEditorRefKey;\n    return {\n      block: block,\n      readOnly: readOnly,\n      getRefKeyFunc: getRefKeyFunc,\n      placeholder: 'write topic notes here'\n    };\n  };\n\n  TopicDescEditor.prototype.onChange = function (_a) {\n    var value = _a.value;\n    log$2('onChange');\n    var _b = this.props,\n        controller = _b.controller,\n        topicKey = _b.topicKey,\n        model = _b.model;\n    var readOnly = model.editingDescKey !== topicKey;\n    if (readOnly) return;\n    var key = \"topic-desc-data-\" + topicKey;\n    controller.run('setTempValue', {\n      key: key,\n      value: value\n    });\n    this.setState({\n      content: value\n    });\n  };\n\n  return TopicDescEditor;\n}(SimpleTextEditor);\n\nfunction SimpleTextEditorPlugin() {\n  return {\n    getTopicTitle: function getTopicTitle(props) {\n      var model = props.model,\n          controller = props.controller,\n          topicKey = props.topicKey,\n          maxLength = props.maxLength;\n      var topic = model.getTopic(topicKey);\n      var block = topic.getBlock(BlockType.CONTENT).block;\n      var text = controller.run('serializeBlockData', _assign(_assign({}, props), {\n        block: block\n      }));\n\n      if (maxLength != null) {\n        text = text.length > maxLength ? text.substr(0, maxLength) + '...' : text;\n      }\n\n      return text;\n    },\n    renderTopicContentEditor: function renderTopicContentEditor(props) {\n      return createElement(TopicContentEditor, _assign({}, props));\n    },\n    renderTopicDescEditor: function renderTopicDescEditor(props) {\n      return createElement(TopicDescEditor, _assign({}, props));\n    },\n    isBlockEmpty: function isBlockEmpty(props, next) {\n      var block = props.block,\n          controller = props.controller;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return block.data == null || controller.run('serializeBlockData', props) === '';\n      }\n\n      return next();\n    },\n    serializeBlockData: function serializeBlockData(props, next) {\n      var block = props.block;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return typeof block.data === 'string' ? block.data : plainSerializer.serialize(block.data);\n      }\n\n      return next();\n    }\n  };\n}\n\nexport default SimpleTextEditorPlugin;","export const FOCUS_MODE_SET_REFERENCE_TOPICS =\n  'FOCUS_MODE_SET_REFERENCE_TOPICS';\n// 添加引用的Topic\nexport const OP_TYPE_START_SET_REFERENCE_TOPICS =\n  'OP_TYPE_START_SET_REFERENCE_TOPICS';\nexport const OP_TYPE_SET_REFERENCE_TOPICS = 'OP_TYPE_SET_REFERENCE_TOPICS';\n\nexport const EXT_DATA_KEY_TOPIC_REFERENCE = 'TOPIC_REFERENCE';\n\nexport const EXT_KEY_TOPIC_REFERENCE = 'EXT_KEY_TOPIC_REFERENCE';\n","import { FocusMode, OpType } from '@blink-mind/core';\nimport { Flex, ZIndex } from '@blink-mind/renderer-react';\nimport { Button } from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { OP_TYPE_SET_REFERENCE_TOPICS } from './utils';\n\nconst Root = styled(ZIndex)`\n  position: absolute;\n  left: calc(50% - 150px);\n  top: 30px;\n  width: 300px;\n  background: white;\n  padding: 10px;\n  user-select: none;\n`;\n\nconst Title = styled.div`\n  margin-bottom: 10px;\n`;\n\nexport function AddReferenceTopicPanel(props) {\n  const { zIndex, controller, topicKey } = props;\n  const onClickCancel = e => {\n    controller.run('clearSelectedReferenceKeys', props);\n    controller.run('enableOperation', props);\n    controller.run('operation', {\n      ...props,\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FocusMode.NORMAL\n    });\n  };\n  const onClickConfirm = e => {\n    const referenceKeys = controller.run('getSelectedReferenceKeys', props);\n    controller.run('enableOperation', props);\n    controller.run('operation', {\n      ...props,\n      opArray: [\n        {\n          opType: OP_TYPE_SET_REFERENCE_TOPICS,\n          topicKey,\n          referenceKeys\n        },\n        {\n          opType: OpType.FOCUS_TOPIC,\n          topicKey,\n          focusMode: FocusMode.NORMAL\n        }\n      ]\n    });\n    controller.run('clearSelectedReferenceKeys', props);\n  };\n  return (\n    <Root zIndex={zIndex}>\n      <Title>\n        Please select the topics you want to reference. After selection, click\n        the confirm button.\n      </Title>\n      <Flex justifyContent={'space-around'}>\n        <Button onClick={onClickConfirm}>Confirm</Button>\n        <Button onClick={onClickCancel}>Cancel</Button>\n      </Flex>\n    </Root>\n  );\n}\n","import { KeyType } from '@blink-mind/core';\nimport { List, Map, Record } from 'immutable';\n\ntype ReferenceRecordType = {\n  keyList: List<KeyType>;\n  dataMap: Map<KeyType, any>;\n};\n\nconst defaultReferenceRecord: ReferenceRecordType = {\n  keyList: List(),\n  dataMap: Map()\n};\n\nexport class ReferenceRecord extends Record(defaultReferenceRecord) {\n  get keyList(): List<KeyType> {\n    return this.get('keyList');\n  }\n\n  get dataMap(): Map<KeyType, any> {\n    return this.get('dataMap');\n  }\n}\n\ntype ExtDataReferenceRecordType = {\n  reference: Map<KeyType, ReferenceRecord>;\n};\n\nconst defaultExtDataReferenceRecord: ExtDataReferenceRecordType = {\n  reference: Map()\n};\n\nexport class ExtDataReference extends Record(defaultExtDataReferenceRecord) {\n  get reference(): Map<KeyType, ReferenceRecord> {\n    return this.get('reference');\n  }\n\n  getReferenceKeys(topicKey: KeyType): KeyType[] {\n    if (this.reference.has(topicKey)) {\n      return this.reference.get(topicKey).keyList.toArray();\n    }\n    return [];\n  }\n\n  getReferencedKeys(topicKey: KeyType): KeyType[] {\n    const res = [];\n    this.reference.forEach((v, k) => {\n      if (v.keyList.includes(topicKey)) {\n        res.push(k);\n      }\n    });\n    return res;\n  }\n}\n","import { BaseModifierArg, KeyType } from '@blink-mind/core';\nimport { List } from 'immutable';\nimport { ExtDataReference, ReferenceRecord } from './ext-data-reference';\nimport { EXT_DATA_KEY_TOPIC_REFERENCE } from './utils';\n\n// TODO 能否优化这个函数的写法\nexport function setReferenceTopicKeys({\n  model,\n  topicKey,\n  referenceKeys\n}: BaseModifierArg & { referenceKeys: KeyType[] }) {\n  let extData: ExtDataReference = model.getExtDataItem(\n    EXT_DATA_KEY_TOPIC_REFERENCE,\n    ExtDataReference\n  );\n\n  let referenceRecord =\n    extData.reference.get(topicKey) || new ReferenceRecord();\n\n  referenceRecord = referenceRecord.set('keyList', List(referenceKeys));\n  extData = extData.setIn(['reference', topicKey], referenceRecord);\n  model = model.setIn(['extData', EXT_DATA_KEY_TOPIC_REFERENCE], extData);\n\n  return model;\n}\n","import { KeyType } from '@blink-mind/core';\nimport { BaseProps, PropKey } from '@blink-mind/renderer-react';\nimport { Alert, Button } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { useState } from 'react';\nimport styled from 'styled-components';\n\nconst Root = styled.div`\n  display: flex;\n  width: 380px;\n  margin: 10px;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Content = styled.div`\n  width: 300px;\n  text-decoration: underline;\n  cursor: pointer;\n`;\n\nconst ButtonPlace = styled.div`\n  width: 80px;\n`;\n\nexport type ReferenceTopicThumbnailProps = BaseProps & {\n  refKey: KeyType;\n  refType: 'reference' | 'referenced' | undefined | null;\n  removeHandler?: (event: React.MouseEvent<HTMLElement>) => void;\n};\nexport function ReferenceTopicThumbnail(props: ReferenceTopicThumbnailProps) {\n  const { controller, refKey, refType, removeHandler } = props;\n  const [deleteConfirm, setDeleteConfirm] = useState(false);\n  const onClick = e => {\n    e.stopPropagation();\n    controller.run('focusTopicAndMoveToCenter', { ...props, topicKey: refKey });\n  };\n\n  const onClickRemove = e => {\n    setDeleteConfirm(true);\n  };\n\n  const content = controller.getValue(PropKey.TOPIC_TITLE, {\n    ...props,\n    topicKey: refKey,\n    maxLength: 100\n  });\n  const deleteAlertProps = {\n    isOpen: deleteConfirm,\n    cancelButtonText: 'cancel',\n    onConfirm: e => {\n      removeHandler(e);\n    },\n    onCancel: e => {\n      setDeleteConfirm(false);\n    },\n    onClose: e => {\n      setDeleteConfirm(false);\n    }\n  };\n  return (\n    <Root>\n      <Content onClick={onClick}>{content}</Content>\n      <ButtonPlace>\n        {refType === 'reference' && (\n          <>\n            <Button onClick={onClickRemove}>Remove</Button>\n            <Alert {...deleteAlertProps}>\n              <p>Are you confirm to remove this reference?</p>\n            </Alert>\n          </>\n        )}\n      </ButtonPlace>\n    </Root>\n  );\n}\n","import { FocusMode } from '@blink-mind/core';\nimport { BaseProps, cancelEvent } from '@blink-mind/renderer-react';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { ExtDataReference } from './ext-data-reference';\nimport { ReferenceTopicThumbnail } from './reference-topic-thumbnail';\nimport {\n  EXT_DATA_KEY_TOPIC_REFERENCE,\n  OP_TYPE_SET_REFERENCE_TOPICS\n} from './utils';\nconst Root = styled.div``;\n\nconst Group = styled.div`\n  padding: 10px;\n`;\n\nconst GroupList = styled.div`\n  max-height: 200px;\n  overflow: auto;\n`;\n\nconst GroupTitle = styled.div`\n  font-size: 20px;\n  color: #106ba3;\n`;\n\nconst GotoBtn = styled.div`\n  text-decoration: underline;\n  color: #106ba3;\n  cursor: pointer;\n`;\n\nexport function ReferenceTopicList(props: BaseProps) {\n  const { topicKey, controller, model } = props;\n  const extData: ExtDataReference = model.extData.get(\n    EXT_DATA_KEY_TOPIC_REFERENCE\n  );\n\n  const removeReference = refKey => e => {\n    e.stopPropagation();\n    const keyList = extData.reference.get(topicKey).keyList;\n    controller.run('operation', {\n      ...props,\n      opArray: [\n        {\n          opType: OP_TYPE_SET_REFERENCE_TOPICS,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL,\n          referenceKeys: keyList.delete(keyList.indexOf(refKey)).toArray()\n        }\n      ]\n    });\n  };\n\n  const referenceKeys = extData.getReferenceKeys(topicKey);\n\n  const referenceGroup =\n    referenceKeys.length === 0 ? null : (\n      <Group>\n        <GroupTitle>Reference Topics:</GroupTitle>\n        <GroupList>\n          {referenceKeys.map(key => {\n            const thumbProps = {\n              ...props,\n              key,\n              refKey: key,\n              refType: 'reference',\n              removeHandler: removeReference(key)\n            };\n            //@ts-ignore\n            return <ReferenceTopicThumbnail {...thumbProps} />;\n          })}\n        </GroupList>\n      </Group>\n    );\n\n  const referencedKeys = extData.getReferencedKeys(topicKey);\n\n  const referencedGroup =\n    referencedKeys.length === 0 ? null : (\n      <Group>\n        <GroupTitle>Referenced Topics:</GroupTitle>\n        <GroupList>\n          {referencedKeys.map(key => {\n            const thumbProps = {\n              ...props,\n              key,\n              refKey: key,\n              refType: 'referenced'\n            };\n            //@ts-ignore\n            return <ReferenceTopicThumbnail {...thumbProps} />;\n          })}\n        </GroupList>\n      </Group>\n    );\n\n  const onClickGotoOriginTopic = e => {\n    e.stopPropagation();\n    controller.run('focusTopicAndMoveToCenter', props);\n  };\n\n  const currentTopic = model.focusKey !== topicKey && (\n    <Group>\n      <GotoBtn onClick={onClickGotoOriginTopic}>Goto Origin Topic</GotoBtn>\n    </Group>\n  );\n\n  return (\n    <Root onMouseDown={cancelEvent}>\n      {referenceGroup}\n      {referencedGroup}\n      {currentTopic}\n    </Root>\n  );\n}\n","import {\n  BaseProps,\n  iconClassName,\n  TopicBlockIcon\n} from '@blink-mind/renderer-react';\nimport { Popover, PopoverInteractionKind } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { ExtDataReference } from './ext-data-reference';\nimport { ReferenceTopicList } from './reference-topic-list';\nimport { EXT_DATA_KEY_TOPIC_REFERENCE } from './utils';\n\nexport function TopicExtReference(props: BaseProps) {\n  const { model, topicKey } = props;\n  const extData: ExtDataReference =\n    model.extData.get(EXT_DATA_KEY_TOPIC_REFERENCE) || new ExtDataReference();\n  const refRecord = extData.reference.get(topicKey);\n  const referencedKeys = [];\n  extData.reference.forEach((v, k) => {\n    if (v.keyList.includes(topicKey)) referencedKeys.push(k);\n  });\n  if (\n    (refRecord == null || refRecord.keyList.size === 0) &&\n    referencedKeys.length === 0\n  )\n    return null;\n\n  const iconProps = {\n    className: iconClassName('reference'),\n    tabIndex: -1\n  };\n  const icon = <TopicBlockIcon {...iconProps} />;\n  const tooltipContent = <ReferenceTopicList {...props} />;\n  const tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.CLICK,\n    hoverOpenDelay: 500\n  };\n  return <Popover {...tooltipProps}></Popover>;\n}\n","import { StyledCheckbox } from '@blink-mind/renderer-react';\nimport * as React from 'react';\n// useState 在vscode 运行报错 https://reactjs.org/docs/error-decoder.html/?invariant=321，\n// 问题原因，在yarn link package的时候，webpack 会打包进去多个 react-dom.js\nimport { useState } from 'react';\nexport function TopicReferenceCheckbox(props) {\n  const { topicKey, selectedTopicKeys } = props;\n  const a = selectedTopicKeys.has(topicKey);\n  const [checked, setChecked] = useState(a);\n  const checkboxProps = {\n    checked,\n    onChange: () => {\n      if (selectedTopicKeys.has(topicKey)) {\n        selectedTopicKeys.delete(topicKey);\n      } else {\n        selectedTopicKeys.add(topicKey);\n      }\n      setChecked(!checked);\n    }\n  };\n  return <StyledCheckbox {...checkboxProps} />;\n}\n","import { FocusMode, OpType } from '@blink-mind/core';\nimport { BaseProps } from '@blink-mind/renderer-react';\nimport {\n  IInputGroupProps,\n  Popover,\n  PopoverInteractionKind\n} from '@blueprintjs/core';\nimport { ItemListPredicate, ItemRenderer, Omnibar } from '@blueprintjs/select';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport './search-panel.css';\n\nconst NavOmniBar = Omnibar.ofType<INavigationSection>();\n\nconst StyledNavOmniBar = styled(NavOmniBar)`\n  top: 20%;\n  left: 25% !important;\n  width: 50% !important;\n`;\n\nconst TopicTitle = styled.div`\n  margin: 0 5px;\n  padding: 10px 5px;\n  width: 100%;\n  font-size: 16px;\n  cursor: pointer;\n  &:hover {\n    background: #e3e8ec;\n  }\n`;\n\nconst StyledPopover = styled(Popover)`\n  display: block;\n`;\n\nconst Tip = styled.div`\n  padding: 10px;\n  font-size: 16px;\n  //max-width: 800px;\n  //max-height: 600px;\n  overflow: auto;\n`;\n\nconst TipContent = styled.div`\n  white-space: break-spaces;\n`;\n\nexport interface INavigationSection {\n  // path: string[];\n  key: KeyType;\n  title: string;\n}\n\nconst INPUT_PROPS: IInputGroupProps = {\n  placeholder: 'Search'\n};\nexport type SearchPanelProps = BaseProps & {\n  setSearchWord: (s: string) => void;\n};\nexport function SearchPanel(props: SearchPanelProps) {\n  const { model, setSearchWord, controller } = props;\n  const onClose = () => {\n    controller.run('operation', {\n      ...props,\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FocusMode.NORMAL\n    });\n  };\n\n  const getAllSections = () => {\n    const res = [];\n    model.topics.forEach((topic, topicKey) => {\n      res.push({\n        key: topicKey,\n        title: controller.run('getTopicTitle', {\n          ...props,\n          topicKey\n        })\n      });\n    });\n    return res;\n  };\n\n  const navigateToTopic = topicKey => e => {\n    controller.run('focusTopicAndMoveToCenter', { ...props, topicKey });\n  };\n\n  const renderItem: ItemRenderer<INavigationSection> = (section, props) => {\n    // const pathElements = section.path.reduce<React.ReactChild[]>(\n    //   (elems, el) => {\n    //     elems.push(el, <Icon key={el} icon=\"caret-right\" />);\n    //     return elems;\n    //   },\n    //   []\n    // );\n    const { key, title: sectionTitle } = section;\n    const maxLength = 100;\n    const needTip = sectionTitle.length > maxLength;\n    const title = needTip\n      ? sectionTitle.substr(0, maxLength) + '...'\n      : sectionTitle;\n    const titleProps = {\n      key,\n      onClick: navigateToTopic(key)\n    };\n    const titleEl = <TopicTitle {...titleProps}>{title}</TopicTitle>;\n    const tip = (\n      <Tip>\n        <TipContent>{sectionTitle}</TipContent>\n      </Tip>\n    );\n    const popoverProps = {\n      key,\n      target: titleEl,\n      content: tip,\n      fill: true,\n      interactionKind: PopoverInteractionKind.HOVER_TARGET_ONLY,\n      hoverOpenDelay: 1000\n    };\n    return needTip ? <StyledPopover {...popoverProps} /> : titleEl;\n  };\n\n  const filterMatches: ItemListPredicate<INavigationSection> = (\n    query,\n    items\n  ) => {\n    return items.filter(item =>\n      item.title.toLowerCase().includes(query.toLowerCase())\n    );\n  };\n\n  const sections = getAllSections();\n\n  return (\n    <StyledNavOmniBar\n      inputProps={INPUT_PROPS}\n      itemListPredicate={filterMatches}\n      isOpen={true}\n      items={sections}\n      itemRenderer={renderItem}\n      // onItemSelect={handleItemSelect}\n      onClose={onClose}\n      resetOnSelect={true}\n    />\n  );\n}\n","export const HOT_KEY_NAME_SEARCH = 'DEFAULT_SEARCH';\nexport const FOCUS_MODE_SEARCH = 'FOCUS_MODE_SEARCH';\n","import { OpType } from '@blink-mind/core';\nimport { HotKeysConfig } from '@blink-mind/renderer-react';\nimport * as React from 'react';\nimport { SearchPanel } from './search-panel';\nimport { FOCUS_MODE_SEARCH, HOT_KEY_NAME_SEARCH } from './utils';\n\nexport function SearchPlugin() {\n  let searchWord: string;\n  const setSearchWorld = s => {\n    searchWord = s;\n  };\n  return {\n    customizeHotKeys(props, next): HotKeysConfig {\n      const { controller, model } = props;\n      const hotKeys: HotKeysConfig = next();\n\n      hotKeys.globalHotKeys.set(HOT_KEY_NAME_SEARCH, {\n        label: 'search',\n        combo: 'ctrl + f',\n        onKeyDown: () => {\n          controller.run('operation', {\n            ...props,\n            opType: OpType.FOCUS_TOPIC,\n            topicKey: model.focusKey,\n            focusMode: FOCUS_MODE_SEARCH\n          });\n        }\n      });\n      return hotKeys;\n    },\n\n    renderDiagramCustomize(props, next) {\n      const res = next();\n      const { model } = props;\n      if (model.focusMode === FOCUS_MODE_SEARCH) {\n        const searchPanelProps = {\n          key: 'search-panel',\n          ...props,\n          setSearchWorld\n        };\n        res.push(<SearchPanel {...searchPanelProps} />);\n      }\n      return res;\n    }\n  };\n}\n","import {\n  BaseModifierArg,\n  getAllSubTopicKeys,\n  Model,\n  ModelModifier,\n  OpType\n} from '@blink-mind/core';\nimport { Icon, PropKey } from '@blink-mind/renderer-react';\nimport { MenuDivider, MenuItem } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { AddReferenceTopicPanel } from './add-reference-topic-panel';\nimport {\n  EXT_DATA_KEY_TOPIC_REFERENCE,\n  EXT_KEY_TOPIC_REFERENCE,\n  FOCUS_MODE_SET_REFERENCE_TOPICS,\n  OP_TYPE_SET_REFERENCE_TOPICS,\n  OP_TYPE_START_SET_REFERENCE_TOPICS\n} from './utils';\n\nimport { IControllerRunContext } from '@blink-mind/core/src/interfaces';\nimport { List, Map } from 'immutable';\nimport { ExtDataReference, ReferenceRecord } from './ext-data-reference';\nimport { setReferenceTopicKeys } from './op-function';\nimport { TopicExtReference } from './topic-ext-reference';\nimport { TopicReferenceCheckbox } from './topic-reference-checkbox';\n\nexport function TopicReferencePlugin() {\n  let selectedTopicKeys = new Set();\n  function startSetReferenceTopics({ model, topicKey }: BaseModifierArg) {\n    const extData: ExtDataReference = model.getExtDataItem(\n      EXT_DATA_KEY_TOPIC_REFERENCE,\n      ExtDataReference\n    );\n\n    selectedTopicKeys = new Set(extData.getReferenceKeys(topicKey));\n\n    model = ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FOCUS_MODE_SET_REFERENCE_TOPICS\n    });\n    return model;\n  }\n\n  return {\n    customizeTopicContextMenu(props, next) {\n      const { controller } = props;\n      function onClickSetReferenceTopics(e) {\n        controller.run('operation', {\n          ...props,\n          opType: OP_TYPE_START_SET_REFERENCE_TOPICS\n        });\n        controller.run('disableOperation', {\n          ...props,\n          whiteList: [OpType.TOGGLE_COLLAPSE]\n        });\n      }\n      return (\n        <>\n          {next()}\n          <MenuDivider />\n          <MenuItem\n            key={EXT_KEY_TOPIC_REFERENCE}\n            icon={Icon('reference')}\n            text=\"Set Reference Topics\"\n            onClick={onClickSetReferenceTopics}\n          />\n        </>\n      );\n    },\n\n    getOpMap(props, next) {\n      const opMap = next();\n      opMap.set(OP_TYPE_START_SET_REFERENCE_TOPICS, startSetReferenceTopics);\n      opMap.set(OP_TYPE_SET_REFERENCE_TOPICS, setReferenceTopicKeys);\n      return opMap;\n    },\n\n    beforeOpFunction(props, next) {\n      let model: Model = next();\n      const { opType, topicKey } = props;\n      // 注意是在beforeOpFunction里面操作\n      if (\n        opType === OpType.DELETE_TOPIC &&\n        topicKey !== model.editorRootTopicKey\n      ) {\n        const allDeleteKeys = getAllSubTopicKeys(model, topicKey);\n        allDeleteKeys.push(topicKey);\n\n        let extData: ExtDataReference = model.getExtDataItem(\n          EXT_DATA_KEY_TOPIC_REFERENCE,\n          ExtDataReference\n        );\n        let reference = extData.reference;\n        // 注意这里要处理所有被删除的Key\n        allDeleteKeys.forEach((deleteKey: KeyType) => {\n          const referencedKeys = extData.getReferencedKeys(deleteKey);\n\n          // 处理被引用的部分\n          reference = reference.withMutations(reference => {\n            referencedKeys.forEach(v => {\n              reference.updateIn([v, 'keyList'], (keyList: List<KeyType>) =>\n                keyList.delete(keyList.indexOf(deleteKey))\n              );\n            });\n          });\n          // 处理引用的部分\n          if (reference.has(deleteKey)) {\n            reference = reference.delete(deleteKey);\n          }\n        });\n\n        extData = extData.set('reference', reference);\n        model = model.setIn(['extData', EXT_DATA_KEY_TOPIC_REFERENCE], extData);\n      }\n      return model;\n    },\n\n    renderDiagramCustomize(props: IControllerRunContext, next) {\n      const { model, controller } = props;\n      const zIndex =\n        controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX) + 2;\n      const res = next();\n      if (model.focusMode === FOCUS_MODE_SET_REFERENCE_TOPICS) {\n        const panelProps = {\n          ...props,\n          zIndex,\n          topicKey: model.focusKey,\n          key: 'AddReferenceTopicPanel'\n        };\n        res.push(<AddReferenceTopicPanel {...panelProps} />);\n      }\n      return res;\n    },\n\n    renderTopicContentOthers(props, next) {\n      const { model, topicKey, controller } = props;\n      const res = next();\n      res.push(\n        controller.run('renderTopicExtReference', {\n          ...props,\n          key: EXT_KEY_TOPIC_REFERENCE + '-icon'\n        })\n      );\n      if (\n        model.focusMode === FOCUS_MODE_SET_REFERENCE_TOPICS &&\n        model.focusKey !== topicKey\n      ) {\n        const checkBoxProps = { ...props, key: 'checkbox', selectedTopicKeys };\n        const checkbox = <TopicReferenceCheckbox {...checkBoxProps} />;\n        res.push(checkbox);\n      }\n      return res;\n    },\n\n    renderTopicExtReference(props, next) {\n      return <TopicExtReference {...props} />;\n    },\n\n    clearSelectedReferenceKeys() {\n      selectedTopicKeys.clear();\n    },\n\n    getSelectedReferenceKeys() {\n      return Array.from(selectedTopicKeys);\n    },\n\n    //TODO\n    deserializeExtDataItem(props, next) {\n      const { extDataKey, extDataItem } = props;\n      if (extDataKey === EXT_DATA_KEY_TOPIC_REFERENCE) {\n        let extDataReference = new ExtDataReference();\n        for (const key in extDataItem.reference) {\n          const item = extDataItem.reference[key];\n          const referenceRecord = new ReferenceRecord({\n            keyList: List(item.keyList),\n            dataMap: Map(item.dataMap)\n          });\n          extDataReference = extDataReference.update('reference', reference =>\n            reference.set(key, referenceRecord)\n          );\n        }\n        return extDataReference;\n      }\n      return next();\n    }\n  };\n}\n","import './iconfont/base/iconfont.css';","import { PureComponent, createElement, Component, Fragment, useState } from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled, { css, ThemeProvider } from 'styled-components';\nimport debug from 'debug';\nimport { Checkbox, Menu, MenuItem, Breadcrumbs, PopoverPosition, Breadcrumb, Tooltip, Hotkey, Hotkeys, HotkeysTarget, Dialog, Classes, ContextMenuTarget, PopoverInteractionKind, Popover, Position, Drawer, Tabs, Divider, Button, NumericInput, InputGroup, Tab, Alert } from '@blueprintjs/core';\nimport { FocusMode, OpType, DiagramLayoutType, ModelModifier, getRelationship, TopicRelationship, getAllSubTopicKeys, BlockType, TopicDirection, isThemeType, TopicVisualLevel, Controller } from '@blink-mind/core';\nimport '@blink-mind/icons';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport memoizeOne from 'memoize-one';\nimport SimpleTextEditorPlugin from '@blink-mind/plugin-simple-text-editor';\nimport { Stack, List } from 'immutable';\nimport cx from 'classnames';\nimport { Select } from '@blueprintjs/select';\nimport { SketchPicker } from 'react-color';\nimport { merge, clone, isEqual } from 'lodash';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n}\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar BaseWidget =\n/** @class */\nfunction (_super) {\n  __extends(BaseWidget, _super);\n\n  function BaseWidget(props) {\n    return _super.call(this, props) || this;\n  }\n\n  BaseWidget.prototype.operation = function (opType, arg) {\n    this.props.controller.run('operation', _assign({\n      opType: opType\n    }, arg));\n  };\n\n  BaseWidget.prototype.run = function (name, arg) {\n    this.props.controller.run(name, arg);\n  };\n\n  Object.defineProperty(BaseWidget.prototype, \"topic\", {\n    get: function get() {\n      return this.props.model.getTopic(this.props.topicKey);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return BaseWidget;\n}(PureComponent);\n\nvar log = debug('node:drag-scroll-widget');\nvar DragScrollView = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n  overflow: scroll;\\n\"], [\"\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n  overflow: scroll;\\n\"])));\nvar DragScrollContent = styled.div(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n  position: relative;\\n  width: max-content;\\n\"], [\"\\n  position: relative;\\n  width: max-content;\\n\"])));\n\nvar DragScrollWidget =\n/** @class */\nfunction (_super) {\n  __extends(DragScrollWidget, _super);\n\n  function DragScrollWidget(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.contentResizeCallback = function (entries, observer) {\n      if (_this.oldContentRect) {\n        var widgetStyle = {\n          width: _this.content.clientWidth + _this.viewBox.clientWidth * 2,\n          height: _this.content.clientHeight + _this.viewBox.clientHeight * 2\n        };\n        _this.bigView.style.width = widgetStyle.width + 'px';\n        _this.bigView.style.height = widgetStyle.height + 'px';\n      }\n\n      _this.oldContentRect = entries[0].contentRect;\n    };\n\n    _this.contentResizeObserver = new ResizeObserver(_this.contentResizeCallback);\n\n    _this.contentRef = function (ref) {\n      if (ref) {\n        _this.content = ref;\n\n        _this.contentResizeObserver.observe(_this.content);\n      }\n    };\n\n    _this.viewBoxRef = function (ref) {\n      if (ref) {\n        _this.viewBox = ref;\n\n        if (!_this.props.enableMouseWheel) {\n          log('addEventListener onwheel');\n\n          _this.viewBox.addEventListener('wheel', function (e) {\n            log('onwheel');\n            (e.ctrlKey || e.altKey) && e.preventDefault();\n          }, {\n            passive: false\n          });\n        }\n\n        _this.setViewBoxScroll(_this.viewBox.clientWidth, _this.viewBox.clientHeight);\n      }\n    };\n\n    _this.bigViewRef = function (ref) {\n      if (ref) {\n        _this.bigView = ref;\n      }\n    };\n\n    _this.setWidgetStyle = function () {\n      if (_this.content && _this.viewBox && _this.bigView) {\n        _this.bigView.style.width = (_this.content.clientWidth + _this.viewBox.clientWidth) * 2 + 'px';\n        _this.bigView.style.height = (_this.content.clientHeight + _this.viewBox.clientHeight) * 2 + 'px';\n        _this.content.style.left = _this.viewBox.clientWidth + 'px';\n        _this.content.style.top = _this.viewBox.clientHeight + 'px';\n      }\n    };\n\n    _this.setViewBoxScroll = function (left, top) {\n      log(\"setViewBoxScroll \" + left + \" \" + top);\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft = left;\n        _this.viewBox.scrollTop = top;\n      }\n    };\n\n    _this.setViewBoxScrollDelta = function (deltaLeft, deltaTop) {\n      log(\"setViewBoxScrollDelta \" + deltaLeft + \" \" + deltaTop);\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft += deltaLeft;\n        _this.viewBox.scrollTop += deltaTop;\n      }\n    };\n\n    _this.onMouseDown = function (e) {\n      // log('Drag Scroll onMouseDown');\n      // log(e.nativeEvent.target);\n      // mouseKey 表示鼠标按下那个键才可以进行拖动，左键或者右键\n      // needKeyPressed 为了支持是否需要按下ctrl键，才可以进行拖动\n      // canDragFunc是一个函数，它是为了支持使用者以传入函数的方式，这个函数的返回值表示当前的内容是否可以被拖拽而移动\n      var _a = _this.props,\n          mouseKey = _a.mouseKey,\n          needKeyPressed = _a.needKeyPressed,\n          canDragFunc = _a.canDragFunc;\n      if (canDragFunc && !canDragFunc()) return;\n\n      if (e.button === 0 && mouseKey === 'left' || e.button === 2 && mouseKey === 'right') {\n        if (needKeyPressed) {\n          if (!e.ctrlKey) return;\n        }\n\n        _this._lastCoordX = _this.viewBox.scrollLeft + e.nativeEvent.clientX;\n        _this._lastCoordY = _this.viewBox.scrollTop + e.nativeEvent.clientY;\n        var ele = _this.viewBox;\n        ele.addEventListener('mousemove', _this.onMouseMove);\n        ele.addEventListener('mouseup', _this.onMouseUp);\n      }\n    };\n\n    _this.onMouseUp = function (e) {\n      var ele = _this.viewBox;\n      ele.removeEventListener('mousemove', _this.onMouseMove);\n      ele.removeEventListener('mouseup', _this.onMouseUp);\n    };\n\n    _this.onMouseMove = function (e) {\n      _this.viewBox.scrollLeft = _this._lastCoordX - e.clientX;\n      _this.viewBox.scrollTop = _this._lastCoordY - e.clientY; // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n    };\n\n    _this.handleContextMenu = function (e) {\n      e.preventDefault();\n    };\n\n    _this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n    return _this;\n  }\n\n  DragScrollWidget.prototype.componentDidMount = function () {\n    this.setWidgetStyle();\n    document.addEventListener('contextmenu', this.handleContextMenu);\n  };\n\n  DragScrollWidget.prototype.componentWillUnmount = function () {\n    document.removeEventListener('contextmenu', this.handleContextMenu);\n  };\n\n  DragScrollWidget.prototype.setZoomFactor = function (zoomFactor) {\n    this.bigView.style.transform = \"scale(\" + zoomFactor + \")\";\n    this.bigView.style.transformOrigin = '50% 50%';\n  };\n\n  DragScrollWidget.prototype.render = function () {\n    var style = _assign({}, this.state.widgetStyle // zoom:this.props.zoomFactor,\n    // transform: `scale(${this.props.zoomFactor})`,\n    // transformOrigin: '50% 50%'\n    );\n\n    return createElement(DragScrollView, {\n      ref: this.viewBoxRef,\n      onMouseDown: this.onMouseDown\n    }, createElement(\"div\", {\n      style: style,\n      ref: this.bigViewRef\n    }, createElement(DragScrollContent, {\n      ref: this.contentRef,\n      style: this.state.contentStyle\n    }, this.props.children(this.setViewBoxScroll, this.setViewBoxScrollDelta))));\n  };\n\n  DragScrollWidget.defaultProps = {\n    mouseKey: 'left',\n    needKeyPressed: false\n  };\n  return DragScrollWidget;\n}(Component);\n\nvar templateObject_1, templateObject_2;\nvar log$1 = debug('node:save-ref'); //TODO 可能会引起内存泄露,在删除一个topic时\n\nvar SaveRef =\n/** @class */\nfunction (_super) {\n  __extends(SaveRef, _super);\n\n  function SaveRef() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.getRef = function (name) {\n      log$1(_this);\n      return _this[name];\n    };\n\n    _this.saveRef = function (name) {\n      return function (node) {\n        if (node) {\n          _this[name] = node;\n\n          _this.fireListener(name, node);\n        }\n      };\n    };\n\n    _this.deleteRef = function (name) {\n      log$1('deleteRef:', name);\n      delete _this[name];\n    };\n\n    _this.observers = new Map();\n\n    _this.fireListener = function (name, ref) {\n      var e_1, _a;\n\n      if (_this.observers.has(name)) {\n        var listeners = _this.observers.get(name);\n\n        try {\n          for (var listeners_1 = __values(listeners), listeners_1_1 = listeners_1.next(); !listeners_1_1.done; listeners_1_1 = listeners_1.next()) {\n            var listener = listeners_1_1.value;\n            listener(name, ref);\n          }\n        } catch (e_1_1) {\n          e_1 = {\n            error: e_1_1\n          };\n        } finally {\n          try {\n            if (listeners_1_1 && !listeners_1_1.done && (_a = listeners_1.return)) _a.call(listeners_1);\n          } finally {\n            if (e_1) throw e_1.error;\n          }\n        }\n      }\n    };\n\n    _this.registerRefListener = function (name, listener) {\n      if (!_this.observers.has(name)) {\n        _this.observers.set(name, [listener]);\n      } else {\n        _this.observers.get(name).push(listener);\n      }\n    };\n\n    return _this;\n  }\n\n  SaveRef.prototype.render = function () {\n    return this.props.children(this.saveRef, this.getRef, this.deleteRef, this.registerRefListener.bind(this));\n  };\n\n  return SaveRef;\n}(Component);\n\nvar Flex = styled.div(templateObject_1$1 || (templateObject_1$1 = __makeTemplateObject([\"\\n  display: flex;\\n  flex-direction: \", \";\\n  align-items: \", \";\\n  justify-content: \", \";\\n\"], [\"\\n  display: flex;\\n  flex-direction: \", \";\\n  align-items: \", \";\\n  justify-content: \", \";\\n\"])), function (props) {\n  return props.flexDirection ? props.flexDirection : 'row';\n}, function (props) {\n  return props.alignItems;\n}, function (props) {\n  return props.justifyContent;\n});\nvar Margin = styled.div(templateObject_2$1 || (templateObject_2$1 = __makeTemplateObject([\"\\n  margin: \", \";\\n\"], [\"\\n  margin: \", \";\\n\"])), function (props) {\n  return props.margin;\n});\nvar ShowMenuIcon = styled.a(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n  font-size: 20px !important;\\n\"], [\"\\n  font-size: 20px !important;\\n\"])));\nvar IconBg = styled.div(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n  padding: 5px;\\n  cursor: pointer;\\n\"], [\"\\n  padding: 5px;\\n  cursor: pointer;\\n\"])));\nvar Btn = styled.div(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n  cursor: pointer;\\n  &:hover {\\n    color: #1ea7fd;\\n  }\\n\"], [\"\\n  cursor: pointer;\\n  &:hover {\\n    color: #1ea7fd;\\n  }\\n\"])));\nvar StyledCheckbox = styled(Checkbox)(templateObject_6 || (templateObject_6 = __makeTemplateObject([\"\\n  margin-bottom: 0px !important;\\n\"], [\"\\n  margin-bottom: 0px !important;\\n\"])));\nvar CloseIcon = styled(Btn)(templateObject_7 || (templateObject_7 = __makeTemplateObject([\"\\n  position: absolute;\\n  right: 5px;\\n  top: 5px;\\n  //padding: 5px;\\n\"], [\"\\n  position: absolute;\\n  right: 5px;\\n  top: 5px;\\n  //padding: 5px;\\n\"])));\nvar Title = styled.div(templateObject_8 || (templateObject_8 = __makeTemplateObject([\"\\n  height: 16px;\\n\"], [\"\\n  height: 16px;\\n\"])));\nvar TopicBlockIcon = styled.span(templateObject_9 || (templateObject_9 = __makeTemplateObject([\"\\n  margin: 0px 10px;\\n  &:hover {\\n    color: palevioletred;\\n  }\\n\"], [\"\\n  margin: 0px 10px;\\n  &:hover {\\n    color: palevioletred;\\n  }\\n\"])));\nvar ZIndex = styled.div(templateObject_10 || (templateObject_10 = __makeTemplateObject([\"\\n  z-index: \", \";\\n\"], [\"\\n  z-index: \", \";\\n\"])), function (props) {\n  return props.zIndex;\n});\nvar PanelTabRoot = styled.div(templateObject_11 || (templateObject_11 = __makeTemplateObject([\"\\n  min-width: 360px;\\n  max-height: 470px;\\n  overflow: auto;\\n\"], [\"\\n  min-width: 360px;\\n  max-height: 470px;\\n  overflow: auto;\\n\"])));\nvar templateObject_1$1, templateObject_2$1, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9, templateObject_10, templateObject_11;\nvar log$2 = debug('plugin:event');\n\nfunction EventPlugin() {\n  var eventListeners = {};\n  return {\n    handleTopicClick: function handleTopicClick(props) {\n      log$2('handleTopicClick');\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey;\n      log$2(model.zoomFactor); //TODO\n\n      if (model.editingDescKey !== null) return;\n      if (model.editingContentKey === topicKey) return;\n      if (model.focusKey === topicKey && model.focusMode === FocusMode.EDITING_CONTENT) return;\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      }));\n    },\n    handleTopicDoubleClick: function handleTopicDoubleClick(props) {\n      var controller = props.controller,\n          model = props.model;\n      if (model.editingDescKey !== null) return;\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      }));\n    },\n    handleTopicContextMenu: function handleTopicContextMenu(props) {\n      var controller = props.controller;\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      }));\n    },\n    handleActiveModalClose: function handleActiveModalClose(props) {\n      var controller = props.controller;\n      var activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n\n      if (activeModalProps.name === 'edit-desc') {\n        return function () {\n          controller.run('operation', _assign(_assign({}, props), {\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          }));\n        };\n      }\n    },\n    addEventListener: function addEventListener(props) {\n      var key = props.key,\n          listener = props.listener,\n          once = props.once,\n          controller = props.controller;\n      if (!eventListeners[key]) eventListeners[key] = [];\n\n      if (once) {\n        only.origin = listener;\n        eventListeners[key].push(only);\n      } else {\n        eventListeners[key].push(listener);\n      }\n\n      function only() {\n        listener();\n        controller.run('removeEventListener', {\n          key: key,\n          listener: listener\n        });\n      }\n    },\n    removeEventListener: function removeEventListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListeners[key]) {\n        eventListeners[key] = eventListeners[key].filter(function (fn) {\n          return fn !== listener && fn.origin !== listener;\n        });\n      }\n    },\n    fireEvent: function fireEvent(props) {\n      var key = props.key;\n\n      if (eventListeners[key]) {\n        eventListeners[key].forEach(function (fn) {\n          return fn();\n        });\n      }\n    }\n  };\n}\n\nvar IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes',\n  PLUS: 'plus',\n  MINUS: 'minus',\n  COLLAPSE_ALL: 'collapse',\n  EXPAND_ALL: 'expand',\n  CENTER: 'center',\n  TRASH: 'trash',\n  SEARCH: 'search',\n  THEME: 'theme',\n  EXPORT: 'export',\n  OPEN_FILE: 'openfile'\n};\n\nfunction iconClassName(name) {\n  return \"icon iconfont bm-\" + name;\n}\n\nfunction Icon(iconName) {\n  return createElement(\"span\", {\n    className: iconClassName(iconName)\n  });\n}\n\nfunction contentRefKey(key) {\n  return \"content-\" + key;\n}\n\nfunction contentEditorRefKey(key) {\n  return \"content-editor-\" + key;\n}\n\nfunction descEditorRefKey(key) {\n  return \"desc-editor-\" + key;\n}\n\nfunction topicWidgetRefKey(key) {\n  return \"topic-widget-\" + key;\n}\n\nfunction topicRefKey(key) {\n  return \"topic-\" + key;\n}\n\nfunction linksRefKey(key) {\n  return \"links-\" + key;\n}\n\nfunction linksSvgRefKey(key) {\n  return \"links-svg-\" + key;\n}\n\nfunction collapseRefKey(key) {\n  return \"collapse-\" + key;\n}\n\nfunction dropAreaRefKey(key, dir) {\n  return \"dropArea-\" + dir + \"-\" + key;\n}\n\nvar RefKey = {\n  DIAGRAM_ROOT_KEY: 'DIAGRAM-ROOT',\n  DRAG_SCROLL_WIDGET_KEY: 'DragScrollWidget',\n  SVG_HIGHLIGHT_KEY: 'svg-highlight',\n  FOCUS_HIGHLIGHT_KEY: 'focus-highlight',\n  DROP_EFFECT_KEY: 'drop-effect'\n};\nvar EventKey = {\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC'\n};\nvar PropKey = {\n  DIAGRAM_CUSTOMIZE_BASE_Z_INDEX: 'DIAGRAM_CUSTOMIZE_BASE_Z_INDEX',\n  TOPIC_CONTEXT_MENU_ENABLED: 'TOPIC_CONTEXT_MENU_ENABLED',\n  TOPIC_TITLE: 'TOPIC_TITLE'\n};\n\nvar cancelEvent = function cancelEvent(e) {\n  e.stopPropagation();\n};\n\nfunction browserDownloadFile(url, filename) {\n  var link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  link.click();\n}\n\nfunction browserDownloadText(text, filename) {\n  var url = \"data:text/plain,\" + encodeURIComponent(text);\n  browserDownloadFile(url, filename);\n}\n\nfunction browserOpenFile(accept) {\n  var input = document.createElement('input');\n  input.type = 'file';\n  input.accept = accept;\n  return new Promise(function (resolve, reject) {\n    input.addEventListener('change', function (evt) {\n      //@ts-ignore\n      var file = evt.target.files[0];\n      var fr = new FileReader();\n\n      fr.onload = function (evt) {\n        var txt = evt.target.result; //@ts-ignore\n\n        resolve(txt);\n      };\n\n      fr.onerror = function (evt) {\n        reject(evt.target.error);\n      };\n\n      fr.readAsText(file);\n    });\n    input.click();\n  });\n}\n\nfunction paddingCss(arg) {\n  var _a = arg.top,\n      top = _a === void 0 ? 0 : _a,\n      _b = arg.right,\n      right = _b === void 0 ? 0 : _b,\n      _c = arg.bottom,\n      bottom = _c === void 0 ? 0 : _c,\n      _d = arg.left,\n      left = _d === void 0 ? 0 : _d;\n  return top + \"px \" + right + \"px \" + bottom + \"px \" + left + \"px\";\n}\n\nfunction getLinkKey(fromKey, toKey) {\n  return \"link-\" + fromKey + \"-\" + toKey;\n}\n\nfunction centerY(rect) {\n  return (rect.top + rect.bottom) / 2;\n}\n\nfunction centerX(rect) {\n  return (rect.left + rect.right) / 2;\n}\n\nfunction centerPointX(p1, p2) {\n  return (p1.x + p2.x) / 2;\n}\n\nfunction centerPointY(p1, p2) {\n  return (p1.y + p2.y) / 2;\n}\n\nfunction center(rect) {\n  return [(rect.left + rect.right) / 2, (rect.top + rect.bottom) / 2];\n}\n\nfunction _getRelativeRect(el, rel, scale) {\n  if (scale === void 0) {\n    scale = 1;\n  }\n\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  elCenter[0] = (elCenter[0] - relCenter[0]) / scale;\n  elCenter[1] = (elCenter[1] - relCenter[1]) / scale;\n  var width = rect.width / scale;\n  var height = rect.height / scale;\n  return {\n    left: elCenter[0] - width / 2,\n    right: elCenter[0] + width / 2,\n    top: elCenter[1] - height / 2,\n    bottom: elCenter[1] + height / 2,\n    width: width,\n    height: height\n  };\n}\n\nfunction getRelativeVector(el, rel) {\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  return [elCenter[0] - relCenter[0], elCenter[1] - relCenter[1]];\n}\n\nfunction GetValuePlugin() {\n  return {\n    getValue: function getValue(props, next) {\n      var propKey = props.propKey,\n          controller = props.controller;\n\n      switch (propKey) {\n        case PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:\n          return 3;\n\n        case PropKey.TOPIC_CONTEXT_MENU_ENABLED:\n          return controller.run('isOperationEnabled', props);\n\n        case PropKey.TOPIC_TITLE:\n          return controller.run('getTopicTitle', props);\n      }\n\n      return next();\n    }\n  };\n}\n\nvar HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_CONTENT: 'EDIT_CONTENT',\n  EDIT_NOTES: 'EDIT_NOTES',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\n\nfunction op(opType, props) {\n  var topicKey = props.topicKey,\n      model = props.model,\n      controller = props.controller;\n\n  if (topicKey === undefined) {\n    props = _assign(_assign({}, props), {\n      topicKey: model.focusKey\n    });\n  }\n\n  controller.run('operation', _assign(_assign({}, props), {\n    opType: opType\n  }));\n}\n\nfunction HotKeyPlugin() {\n  return {\n    customizeHotKeys: function customizeHotKeys(props) {\n      var handleKeyDown = function handleKeyDown(opType) {\n        return function (e) {\n          // log('HotKeyPlugin', opType);\n          op(opType, props);\n        };\n      };\n\n      var topicHotKeys = new Map([[HotKeyName.ADD_CHILD, {\n        label: 'add child',\n        combo: 'tab',\n        onKeyDown: handleKeyDown(OpType.ADD_CHILD)\n      }], [HotKeyName.ADD_SIBLING, {\n        label: 'add sibling',\n        combo: 'enter',\n        onKeyDown: handleKeyDown(OpType.ADD_SIBLING)\n      }], [HotKeyName.DELETE_TOPIC, {\n        label: 'delete topic',\n        combo: 'del',\n        onKeyDown: handleKeyDown(OpType.DELETE_TOPIC)\n      }], [HotKeyName.EDIT_CONTENT, {\n        label: 'edit content',\n        combo: 'space',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_CONTENT)\n      }], [HotKeyName.EDIT_NOTES, {\n        label: 'edit notes',\n        combo: 'alt + d',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_DESC)\n      }], [HotKeyName.SET_EDITOR_ROOT, {\n        label: 'set editor root',\n        combo: 'alt + shift + f',\n        onKeyDown: handleKeyDown(OpType.SET_EDITOR_ROOT)\n      }]]);\n      var globalHotKeys = new Map();\n      return {\n        topicHotKeys: topicHotKeys,\n        globalHotKeys: globalHotKeys\n      };\n    }\n  };\n}\n\nfunction LayoutPlugin() {\n  var _zoomFactor = 1;\n  return {\n    getPartTopics: function getPartTopics(_a) {\n      var layout = _a.layout,\n          model = _a.model,\n          topicKey = _a.topicKey;\n      var topic = model.getTopic(topicKey);\n      var subTopicCount = topic.subKeys.size;\n      var topics = topic.subKeys.toArray();\n\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return {\n            R: topics\n          };\n\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return {\n            L: topics\n          };\n\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n    createSubTopics: function createSubTopics(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          topics = props.topics,\n          saveRef = props.saveRef;\n      var topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      var subTopics = [];\n      topics.forEach(function (tKey) {\n        var topicProps = _assign(_assign({}, props), {\n          topicKey: tKey,\n          key: tKey,\n          ref: saveRef(topicWidgetRefKey(tKey))\n        });\n\n        subTopics.push(controller.run('renderTopicWidget', topicProps));\n      });\n      return {\n        subTopics: subTopics\n      };\n    },\n    layout: function layout(props) {\n      var getRef = props.getRef,\n          model = props.model;\n      var links = getRef(linksRefKey(model.editorRootTopicKey));\n      var highlight = getRef(RefKey.FOCUS_HIGHLIGHT_KEY);\n      var dropEffect = getRef(RefKey.DROP_EFFECT_KEY);\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n      var editorRootTopic = model.getTopic(model.editorRootTopicKey);\n      layoutTopic(editorRootTopic);\n\n      function layoutTopic(topic) {\n        var e_1, _a;\n\n        if (topic.key !== model.editorRootTopicKey) {\n          var topicWidget = getRef(topicWidgetRefKey(topic.key));\n          topicWidget && topicWidget.layoutLinks();\n        }\n\n        if (!topic.collapse) {\n          try {\n            for (var _b = __values(topic.subKeys), _c = _b.next(); !_c.done; _c = _b.next()) {\n              var subKey = _c.value;\n              layoutTopic(model.getTopic(subKey));\n            }\n          } catch (e_1_1) {\n            e_1 = {\n              error: e_1_1\n            };\n          } finally {\n            try {\n              if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n          }\n        }\n      }\n    },\n    setLayoutDir: function setLayoutDir(props) {\n      var layoutDir = props.layoutDir,\n          model = props.model,\n          controller = props.controller;\n      controller.change(ModelModifier.setLayoutDir({\n        model: model,\n        layoutDir: layoutDir\n      }));\n    },\n    getRelativeRect: function getRelativeRect(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      return _getRelativeRect(element, bigView, zoomFactor);\n    },\n    getRelativeRectFromViewPort: function getRelativeRectFromViewPort(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return _getRelativeRect(element, viewBox, zoomFactor);\n    },\n    getRelativeVectorFromViewPort: function getRelativeVectorFromViewPort(props) {\n      var element = props.element,\n          getRef = props.getRef;\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeVector(element, viewBox);\n    },\n    addZoomFactorChangeEventListener: function addZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('addTempValueChangeListener', _assign({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    removeZoomFactorChangeEventListener: function removeZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('removeTempValueChangeListener', _assign({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    setZoomFactor: function setZoomFactor(props) {\n      var controller = props.controller,\n          zoomFactor = props.zoomFactor;\n      return controller.run('setTempValue', {\n        key: 'ZoomFactor',\n        value: zoomFactor\n      });\n    },\n    getZoomFactor: function getZoomFactor(props) {\n      var controller = props.controller;\n      return controller.run('getTempValue', {\n        key: 'ZoomFactor'\n      }) || _zoomFactor;\n    },\n    moveTopicToCenter: function moveTopicToCenter(props) {\n      var getRef = props.getRef,\n          topicKey = props.topicKey,\n          model = props.model;\n\n      if (model.editorRootTopicKey !== topicKey && getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n        throw new Error(\"moveTopicToCenter error: topicKey \" + topicKey + \" is not the DESCENDANT of editor root topic\");\n      }\n\n      var topic = getRef(topicRefKey(topicKey));\n      var dragScroll = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n      var viewBox = dragScroll.viewBox;\n\n      if (!topic || !viewBox) {\n        throw new Error(\"moveTopicToCenter error: topic or viewBox is null\");\n      }\n\n      var vector = getRelativeVector(topic, viewBox); //TODO\n\n      dragScroll.setViewBoxScrollDelta(vector[0], vector[1]);\n    },\n    focusTopicAndMoveToCenter: function focusTopicAndMoveToCenter(props) {\n      var controller = props.controller,\n          topicKey = props.topicKey;\n      controller.run('operation', _assign(_assign({}, props), {\n        opArray: [{\n          opType: OpType.FOCUS_TOPIC,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL\n        }, {\n          opType: OpType.EXPAND_TO,\n          topicKey: topicKey\n        }],\n        callback: function callback() {\n          controller.run('moveTopicToCenter', _assign(_assign({}, props), {\n            topicKey: topicKey\n          }));\n        }\n      }));\n    }\n  };\n}\n\nvar log$3 = debug('plugin:operation');\n\nfunction OperationPlugin() {\n  var startEditingContent = function startEditingContent(_a) {\n    var model = _a.model,\n        topicKey = _a.topicKey;\n    return ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n\n  var startEditingDesc = function startEditingDesc(_a) {\n    var model = _a.model,\n        topicKey = _a.topicKey;\n    var topic = model.getTopic(topicKey);\n    var desc = topic.getBlock(BlockType.DESC);\n\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setBlockData({\n        model: model,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: ''\n      });\n    }\n\n    model = ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n    return model;\n  };\n\n  function dragAndDrop(props) {\n    var srcKey = props.srcKey,\n        dstKey = props.dstKey,\n        dropDir = props.dropDir;\n    var model = props.model;\n    var srcTopic = model.getTopic(srcKey);\n    var dstTopic = model.getTopic(dstKey);\n    var srcParentKey = srcTopic.parentKey;\n    var srcParentTopic = model.getTopic(srcParentKey);\n    var srcParentSubKeys = srcParentTopic.subKeys;\n    var srcIndex = srcParentSubKeys.indexOf(srcKey);\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      var dstSubKeys_1 = dstTopic.subKeys;\n      dstSubKeys_1 = dstSubKeys_1.push(srcKey);\n      model = model.withMutations(function (m) {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstKey).setIn(['topics', dstKey, 'subKeys'], dstSubKeys_1).setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      var dstParentKey_1 = dstTopic.parentKey;\n      var dstParentItem = model.getTopic(dstParentKey_1);\n      var dstParentSubKeys_1 = dstParentItem.subKeys;\n      var dstIndex = dstParentSubKeys_1.indexOf(dstKey); //src 和 dst 的父亲相同，这种情况要做特殊处理\n\n      if (srcParentKey === dstParentKey_1) {\n        var newDstParentSubKeys_1 = List();\n        dstParentSubKeys_1.forEach(function (key) {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys_1 = newDstParentSubKeys_1.push(srcKey).push(key);\n              } else {\n                newDstParentSubKeys_1 = newDstParentSubKeys_1.push(key).push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys_1 = newDstParentSubKeys_1.push(key);\n            }\n          }\n        });\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', dstParentKey_1, 'subKeys'], newDstParentSubKeys_1);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys_1 = dstParentSubKeys_1.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys_1 = dstParentSubKeys_1.insert(dstIndex + 1, srcKey);\n        }\n\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstParentKey_1).setIn(['topics', dstParentKey_1, 'subKeys'], dstParentSubKeys_1).setIn(['topics', dstParentKey_1, 'collapse'], false);\n        });\n      }\n    }\n\n    return model;\n  }\n\n  var OpMap = new Map([[OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse], [OpType.COLLAPSE_ALL, ModelModifier.collapseAll], [OpType.EXPAND_ALL, ModelModifier.expandAll], [OpType.EXPAND_TO, ModelModifier.expandTo], [OpType.ADD_CHILD, ModelModifier.addChild], [OpType.ADD_SIBLING, ModelModifier.addSibling], [OpType.DELETE_TOPIC, ModelModifier.deleteTopic], [OpType.FOCUS_TOPIC, ModelModifier.focusTopic], [OpType.SET_FOCUS_MODE, ModelModifier.setFocusMode], [OpType.SET_STYLE, ModelModifier.setStyle], [OpType.SET_THEME, ModelModifier.setTheme], [OpType.SET_TOPIC_BLOCK, ModelModifier.setBlockData], [OpType.DELETE_TOPIC_BLOCK, ModelModifier.deleteBlock], [OpType.START_EDITING_CONTENT, startEditingContent], [OpType.START_EDITING_DESC, startEditingDesc], [OpType.DRAG_AND_DROP, dragAndDrop], [OpType.SET_EDITOR_ROOT, ModelModifier.setEditorRootTopicKey]]);\n  var undoStack = Stack();\n  var redoStack = Stack();\n  var enabled = true;\n  var whiteListOperation = new Set();\n  return {\n    isOperationEnabled: function isOperationEnabled(props) {\n      return enabled;\n    },\n    enableOperation: function enableOperation() {\n      enabled = true;\n    },\n    disableOperation: function disableOperation(_a) {\n      var whiteList = _a.whiteList;\n      enabled = false;\n      if (whiteList) whiteListOperation = new Set(whiteList);else whiteListOperation.clear();\n    },\n\n    /** plugin can extend Operation Map\r\n     * for example: A plugin can write a function\r\n     * getOpMap(props,next) {\r\n     *   let opMap = next();\r\n     *   opMap.set(\"OpTypeName\",opFunc);\r\n     *   return opMap;\r\n     * }\r\n     * @param props\r\n     */\n    getOpMap: function getOpMap(props) {\n      return OpMap;\n    },\n    getAllowUndo: function getAllowUndo(props) {\n      var model = props.model,\n          opType = props.opType;\n\n      if (opType) {\n        switch (opType) {\n          case OpType.FOCUS_TOPIC:\n          case OpType.START_EDITING_CONTENT:\n          case OpType.START_EDITING_DESC:\n            return false;\n        }\n      }\n\n      switch (model.focusMode) {\n        case 'EDITING_DESC':\n        case 'EDITING_CONTENT':\n          return false;\n      }\n\n      return model.config.allowUndo;\n    },\n    getUndoRedoStack: function getUndoRedoStack() {\n      return {\n        undoStack: undoStack,\n        redoStack: redoStack\n      };\n    },\n    setUndoStack: function setUndoStack(props) {\n      log$3('setUndoStack', props.undoStack);\n      undoStack = props.undoStack;\n    },\n    setRedoStack: function setRedoStack(props) {\n      log$3('setRedoStack', props.redoStack);\n      redoStack = props.redoStack;\n    },\n    canUndo: function canUndo(props) {\n      var controller = props.controller;\n      var undoStack = controller.run('getUndoRedoStack', props).undoStack;\n      var allowUndo = controller.run('getAllowUndo', props);\n      return undoStack.size > 0 && allowUndo;\n    },\n    canRedo: function canRedo(props) {\n      var controller = props.controller;\n      var redoStack = controller.run('getUndoRedoStack', props).redoStack;\n      var allowUndo = controller.run('getAllowUndo', props);\n      return redoStack.size > 0 && allowUndo;\n    },\n    undo: function undo(props) {\n      var controller = props.controller,\n          model = props.model;\n\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n\n      var _a = controller.run('getUndoRedoStack', props),\n          undoStack = _a.undoStack,\n          redoStack = _a.redoStack;\n\n      var newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _assign(_assign({}, props), {\n        undoStack: undoStack.shift()\n      }));\n      controller.run('setRedoStack', _assign(_assign({}, props), {\n        redoStack: redoStack.push(model)\n      }));\n      log$3(newModel);\n      controller.change(newModel);\n    },\n    redo: function redo(props) {\n      var controller = props.controller,\n          model = props.model;\n\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n\n      var _a = controller.run('getUndoRedoStack', props),\n          undoStack = _a.undoStack,\n          redoStack = _a.redoStack;\n\n      var newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _assign(_assign({}, props), {\n        undoStack: undoStack.push(model)\n      }));\n      controller.run('setRedoStack', _assign(_assign({}, props), {\n        redoStack: redoStack.shift()\n      }));\n      controller.change(newModel);\n    },\n    //TODO 有空重构这个函数\n    operation: function operation(props) {\n      var controller = props.controller,\n          opType = props.opType,\n          model = props.model,\n          opArray = props.opArray,\n          callback = props.callback;\n\n      if (opArray != null && !Array.isArray(opArray)) {\n        throw new Error('operation: the type of opArray must be array!');\n      }\n\n      if (opType != null && opArray != null) {\n        throw new Error('operation: opType and opArray conflict!');\n      }\n\n      var isOperationEnabled = controller.run('isOperationEnabled', props);\n\n      if (!isOperationEnabled) {\n        // warning(\n        //   true,\n        //   `You have disabled operation,but you run operation ${props} now!`\n        // );\n        if (whiteListOperation.size === 0) return;\n\n        if (opArray != null) {\n          var opNotInWhiteList = opArray.filter(function (op) {\n            return !whiteListOperation.has(op.opType);\n          });\n\n          if (opNotInWhiteList && opNotInWhiteList.length > 0) {\n            return;\n          }\n        } else if (!whiteListOperation.has(opType)) {\n          return;\n        }\n      }\n\n      log$3('operation:', opType);\n      log$3('operation:', model);\n      log$3('operation:', props);\n      var opMap = controller.run('getOpMap', props);\n      controller.run('beforeOperation', props);\n\n      if (controller.run('getAllowUndo', props)) {\n        var undoStack_1 = controller.run('getUndoRedoStack', props).undoStack;\n        controller.run('setUndoStack', _assign(_assign({}, props), {\n          undoStack: undoStack_1.push(model)\n        }));\n      }\n\n      var newModel;\n\n      if (opArray != null) {\n        newModel = opArray.reduce(function (acc, cur) {\n          var opType = cur.opType;\n          if (!opMap.has(opType)) throw new Error(\"opType:\" + opType + \" not exist!\");\n          var opFunc = opMap.get(opType);\n\n          var opFuncProps = _assign(_assign({\n            controller: controller\n          }, cur), {\n            model: acc\n          });\n\n          var res = controller.run('beforeOpFunction', opFuncProps);\n          res = opFunc(_assign(_assign({}, opFuncProps), {\n            model: res\n          }));\n          res = controller.run('afterOpFunction', _assign(_assign({}, opFuncProps), {\n            model: res\n          }));\n          return res;\n        }, model);\n      } else {\n        if (!opMap.has(opType)) throw new Error(\"opType:\" + opType + \" not exist!\");\n        var opFunc = opMap.get(opType);\n        newModel = controller.run('beforeOpFunction', props);\n        newModel = opFunc(_assign(_assign({}, props), {\n          model: newModel\n        }));\n        newModel = controller.run('afterOpFunction', _assign(_assign({}, props), {\n          model: newModel\n        }));\n      }\n\n      log$3('newModel:', newModel);\n      controller.change(newModel, callback);\n      controller.run('afterOperation', props);\n    },\n    deleteRefKey: function deleteRefKey(props) {\n      var e_1, _a;\n\n      var model = props.model,\n          topicKey = props.topicKey,\n          deleteRef = props.deleteRef;\n      var allSubKeys = getAllSubTopicKeys(model, topicKey);\n      allSubKeys.push(topicKey);\n\n      try {\n        for (var allSubKeys_1 = __values(allSubKeys), allSubKeys_1_1 = allSubKeys_1.next(); !allSubKeys_1_1.done; allSubKeys_1_1 = allSubKeys_1.next()) {\n          var key = allSubKeys_1_1.value;\n          deleteRef(linksRefKey(key));\n          deleteRef(linksSvgRefKey(key));\n          deleteRef(contentRefKey(key));\n          deleteRef(contentEditorRefKey(key));\n          deleteRef(descEditorRefKey(key));\n          deleteRef(topicWidgetRefKey(key));\n          deleteRef(topicRefKey(key));\n          deleteRef(collapseRefKey(key));\n          deleteRef(dropAreaRefKey(key, 'next'));\n          deleteRef(dropAreaRefKey(key, 'prev'));\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (allSubKeys_1_1 && !allSubKeys_1_1.done && (_a = allSubKeys_1.return)) _a.call(allSubKeys_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    },\n    // 在整个Operation执行之前被调用\n    beforeOperation: function beforeOperation(props) {},\n    afterOperation: function afterOperation(props) {},\n    // 在单个OpFunction执行之前被调用\n    beforeOpFunction: function beforeOpFunction(props) {\n      var controller = props.controller,\n          opType = props.opType,\n          model = props.model,\n          topicKey = props.topicKey;\n\n      if (opType === OpType.DELETE_TOPIC && topicKey !== model.editorRootTopicKey) {\n        controller.run('deleteRefKey', props);\n      }\n\n      return model;\n    },\n    afterOpFunction: function afterOpFunction(props) {\n      return props.model;\n    }\n  };\n}\n\nvar TopicContextMenu =\n/** @class */\nfunction (_super) {\n  __extends(TopicContextMenu, _super);\n\n  function TopicContextMenu() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TopicContextMenu.prototype.render = function () {\n    var controller = this.props.controller;\n    return createElement(Menu, null, controller.run('customizeTopicContextMenu', this.props));\n  };\n\n  return TopicContextMenu;\n}(BaseWidget);\n\nvar items = [{\n  icon: 'edit',\n  label: 'edit',\n  shortcut: 'Space',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_CONTENT\n}, {\n  icon: 'add-sibling',\n  label: 'add sibling',\n  shortcut: 'Enter',\n  opType: OpType.ADD_SIBLING\n}, {\n  icon: 'add-child',\n  label: 'add child',\n  shortcut: 'Tab',\n  rootCanUse: true,\n  opType: OpType.ADD_CHILD\n}, {\n  icon: 'notes',\n  label: 'edit notes',\n  shortcut: 'Alt + D',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_DESC\n}, {\n  icon: 'delete-node',\n  label: 'delete node',\n  shortcut: 'Del',\n  opType: OpType.DELETE_TOPIC\n}, {\n  icon: 'root',\n  label: 'set as editor root',\n  shortcut: 'Alt + Shift + F',\n  opType: OpType.SET_EDITOR_ROOT\n}];\n\nfunction ContextMenuPlugin() {\n  return {\n    renderTopicContextMenu: function renderTopicContextMenu(props) {\n      return createElement(TopicContextMenu, _assign({}, props));\n    },\n    customizeTopicContextMenu: function customizeTopicContextMenu(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      var isRoot = topicKey === model.editorRootTopicKey;\n\n      function onClickItem(item) {\n        return function (e) {\n          item.opType && controller.run('operation', _assign(_assign({}, props), {\n            opType: item.opType\n          }));\n        };\n      }\n\n      return items.map(function (item) {\n        return isRoot && !item.rootCanUse ? null : createElement(MenuItem, {\n          key: item.label,\n          icon: Icon(item.icon),\n          text: item.label,\n          labelElement: createElement(\"kbd\", null, item.shortcut),\n          onClick: onClickItem(item)\n        });\n      });\n    }\n  };\n}\n\nvar log$4 = debug('node:topic-drop-effect');\nvar DropEffectSvg = styled.svg(templateObject_1$2 || (templateObject_1$2 = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicDropEffect =\n/** @class */\nfunction (_super) {\n  __extends(TopicDropEffect, _super);\n\n  function TopicDropEffect() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      content: null\n    };\n    return _this;\n  }\n\n  TopicDropEffect.prototype.layout = function () {\n    var props = this.props;\n    var _a = this.props,\n        getRef = _a.getRef,\n        model = _a.model,\n        zoomFactor = _a.zoomFactor,\n        controller = _a.controller;\n    var targetProps = controller.run('getDragTargetProps', props);\n    var key = targetProps.key,\n        dropDir = targetProps.dropDir;\n    log$4('layout', dropDir);\n\n    if (key === null) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n\n    var refKey;\n\n    if (dropDir === 'in') {\n      refKey = contentRefKey(key);\n    } else {\n      refKey = dropAreaRefKey(key, dropDir);\n    }\n\n    var content = getRef(refKey);\n    var svg = getRef('svg-drop-effect');\n    var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n    var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n    var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n    var padding = 3;\n    var x = contentRect.left - svgRect.left - padding;\n    var y = contentRect.top - svgRect.top - padding;\n    var width = contentRect.width + 2 * padding;\n    var height = contentRect.height + 2 * padding;\n    this.setState({\n      content: createElement(\"g\", null, createElement(\"rect\", {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        fill: \"none\",\n        stroke: model.config.theme.highlightColor,\n        strokeDasharray: \"5,5\",\n        strokeWidth: 2\n      }))\n    });\n  };\n\n  TopicDropEffect.prototype.render = function () {\n    var saveRef = this.props.saveRef;\n    return createElement(DropEffectSvg, {\n      ref: saveRef('svg-drop-effect')\n    }, this.state.content);\n  };\n\n  return TopicDropEffect;\n}(BaseWidget);\n\nvar templateObject_1$2;\nvar log$5 = debug('plugin:drag-and-drop');\nvar DropArea = styled.div(templateObject_1$3 || (templateObject_1$3 = __makeTemplateObject([\"\\n  height: \", \";\\n  width: 100%;\\n  margin: 5px 0px;\\n\"], [\"\\n  height: \", \";\\n  width: 100%;\\n  margin: 5px 0px;\\n\"])), function (props) {\n  return props.height + \"px\";\n});\n\nfunction DragAndDropPlugin() {\n  var dragTargetKey = null;\n  var dragTargetDir = null;\n  return {\n    renderTopicDropArea: function renderTopicDropArea(props) {\n      var topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          saveRef = props.saveRef,\n          controller = props.controller,\n          model = props.model;\n\n      var onDragEnter = function onDragEnter(ev) {\n        log$5('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', _assign(_assign({}, props), {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragLeave = function onDragLeave(ev) {\n        log$5('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', _assign(_assign({}, props), {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragOver = function onDragOver(ev) {\n        ev.preventDefault();\n      };\n\n      var onDrop = function onDrop(ev) {\n        log$5('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', _assign(_assign({}, props), {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var eventHandlers = {\n        onDragEnter: onDragEnter,\n        onDragLeave: onDragLeave,\n        onDragOver: onDragOver,\n        onDrop: onDrop\n      };\n      return createElement(DropArea, _assign({\n        height: model.config.theme.marginV / 2,\n        ref: saveRef(dropAreaRefKey(topicKey, dropDir))\n      }, eventHandlers));\n    },\n    renderDragAndDropEffect: function renderDragAndDropEffect(props) {\n      log$5('renderDragAndDropEffect');\n      var saveRef = props.saveRef;\n      return createElement(TopicDropEffect, _assign({\n        ref: saveRef(RefKey.DROP_EFFECT_KEY)\n      }, props));\n    },\n    getDragTargetProps: function getDragTargetProps(props) {\n      return {\n        key: dragTargetKey,\n        dropDir: dragTargetDir\n      };\n    },\n    handleTopicDragStart: function handleTopicDragStart(props) {\n      var controller = props.controller,\n          ev = props.ev;\n      ev.stopPropagation();\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      }));\n    },\n    canDrop: function canDrop(props) {\n      var srcKey = props.srcKey,\n          dstKey = props.dstKey,\n          model = props.model,\n          dropDir = props.dropDir;\n      if (srcKey === model.editorRootTopicKey || srcKey === dstKey || getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR) return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n      var srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n    handleTopicDragEnter: function handleTopicDragEnter(props) {\n      var dropDir = props.dropDir,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          model = props.model;\n      log$5('handleTopicDragEnter:', topicKey, dropDir);\n      var canDrop = controller.run('canDrop', _assign(_assign({}, props), {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      }));\n\n      if (canDrop) {\n        dragTargetKey = topicKey;\n        dragTargetDir = dropDir;\n        controller.change(model);\n      }\n    },\n    handleTopicDragLeave: function handleTopicDragLeave(props) {\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          getRef = props.getRef,\n          ev = props.ev;\n      var relatedTarget = ev.nativeEvent.relatedTarget;\n      log$5('handleTopicDragLeave:', topicKey, dropDir);\n      var content = getRef(contentRefKey(topicKey));\n\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n\n      dragTargetKey = null;\n      dragTargetDir = null;\n      controller.change(model);\n    },\n    handleTopicDrop: function handleTopicDrop(props) {\n      log$5('handleTopicDrop');\n      var controller = props.controller,\n          topicKey = props.topicKey,\n          model = props.model;\n      props = _assign(_assign({}, props), {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      dragTargetKey = null;\n      dragTargetDir = null;\n\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.DRAG_AND_DROP\n        }));\n      }\n    }\n  };\n}\n\nvar templateObject_1$3;\nvar EditorRootBreadcrumbsRoot = styled(ZIndex)(templateObject_1$4 || (templateObject_1$4 = __makeTemplateObject([\"\\n  position: absolute;\\n  width: 20%;\\n  padding: 0 5px;\\n  background: white;\\n  left: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n\"], [\"\\n  position: absolute;\\n  width: 20%;\\n  padding: 0 5px;\\n  background: white;\\n  left: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n\"])));\nvar TooltipContent = styled.div(templateObject_2$2 || (templateObject_2$2 = __makeTemplateObject([\"\\n  max-width: 600px;\\n\"], [\"\\n  max-width: 600px;\\n\"])));\nvar BreadcrumbTitle = styled.span(templateObject_3$1 || (templateObject_3$1 = __makeTemplateObject([\"\"], [\"\"])));\n\nvar EditorRootBreadcrumbs =\n/** @class */\nfunction (_super) {\n  __extends(EditorRootBreadcrumbs, _super);\n\n  function EditorRootBreadcrumbs(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.setEditorRootTopicKey = function (topicKey) {\n      return function () {\n        var _a = _this.props,\n            model = _a.model,\n            controller = _a.controller;\n\n        if (model.editorRootTopicKey !== topicKey) {\n          controller.change(ModelModifier.setEditorRootTopicKey({\n            model: model,\n            topicKey: topicKey\n          }));\n        }\n      };\n    };\n\n    _this.breadcrumbRenderer = function (props) {\n      var text = props.text,\n          breadProps = __rest(props, [\"text\"]);\n\n      var needTooltip = text.length > 8;\n      var title = needTooltip ? text.substr(0, 8) + '...' : text; //TODO\n\n      var content = createElement(TooltipContent, null, text);\n      var tooltipProps = {\n        content: content,\n        position: PopoverPosition.BOTTOM_RIGHT\n      };\n      var breadcrumb = createElement(Breadcrumb, _assign({}, breadProps), createElement(BreadcrumbTitle, null, title));\n      return needTooltip ? createElement(Tooltip, _assign({}, tooltipProps), breadcrumb) : breadcrumb; // return (\n      //   <Breadcrumb {...breadProps}>\n      //     <BreadcrumbTitle>{title}</BreadcrumbTitle>\n      //   </Breadcrumb>\n      // );\n    };\n\n    _this.state = {\n      show: false\n    };\n    return _this;\n  }\n\n  EditorRootBreadcrumbs.prototype.render = function () {\n    var props = this.props;\n    var model = props.model,\n        controller = props.controller,\n        zIndex = props.zIndex;\n    var editingRootKey = model.editorRootTopicKey;\n    if (editingRootKey === model.rootTopicKey) return null;\n    var items = [];\n    var topic = model.getTopic(editingRootKey);\n\n    while (topic != null) {\n      var title = controller.getValue(PropKey.TOPIC_TITLE, _assign(_assign({}, props), {\n        topicKey: topic.key\n      }));\n      items.unshift({\n        text: title,\n        onClick: this.setEditorRootTopicKey(topic.key)\n      });\n      topic = model.getTopic(topic.parentKey);\n    }\n\n    var breadcrumbProps = {\n      items: items,\n      breadcrumbRenderer: this.breadcrumbRenderer\n    };\n    return createElement(EditorRootBreadcrumbsRoot, {\n      zIndex: zIndex\n    }, createElement(Breadcrumbs, _assign({}, breadcrumbProps)));\n  };\n\n  return EditorRootBreadcrumbs;\n}(BaseWidget);\n\nvar templateObject_1$4, templateObject_2$2, templateObject_3$1;\nvar NodeLayer = styled.div(templateObject_1$5 || (templateObject_1$5 = __makeTemplateObject([\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  padding: 5px;\\n\"], [\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  padding: 5px;\\n\"])));\nvar DIV = styled.div(templateObject_2$3 || (templateObject_2$3 = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  background: \", \";\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  background: \", \";\\n\"])), function (props) {\n  return props.theme.background;\n});\n\nvar MindDragScrollWidget =\n/** @class */\nfunction (_super) {\n  __extends(MindDragScrollWidget, _super);\n\n  function MindDragScrollWidget(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.setZoomFactor = function (zoomFactor) {\n      _this.dragScrollWidget.setZoomFactor(zoomFactor);\n    };\n\n    _this.onWheel = function (e) {\n      if (e.altKey || e.ctrlKey) {\n        var controller = _this.props.controller;\n        var zoomFactor = controller.run('getZoomFactor', _this.props);\n        zoomFactor = zoomFactor - (e.nativeEvent.deltaY > 0 ? 0.1 : -0.1);\n        if (zoomFactor < 0.5) zoomFactor = 0.5;\n        if (zoomFactor > 4) zoomFactor = 4; // console.log('zoomFactor=>', zoomFactor);\n\n        controller.run('setZoomFactor', _assign(_assign({}, _this.props), {\n          zoomFactor: zoomFactor\n        }));\n      }\n    };\n\n    return _this;\n  }\n\n  MindDragScrollWidget.prototype.renderHotkeys = function () {\n    var props = this.props;\n    var controller = props.controller,\n        model = props.model;\n    var hotKeys = controller.run('customizeHotKeys', props);\n    if (hotKeys === null) return null;\n\n    if (!(hotKeys.topicHotKeys instanceof Map && hotKeys.globalHotKeys instanceof Map)) {\n      throw new TypeError('topicHotKeys and globalHotKeys must be a Map');\n    }\n\n    var children = [];\n\n    if (model.focusMode === FocusMode.NORMAL || model.focusMode === FocusMode.SHOW_POPUP) {\n      hotKeys.topicHotKeys.forEach(function (v, k) {\n        children.push(createElement(Hotkey, _assign({\n          key: k\n        }, v, {\n          global: true\n        })));\n      });\n    }\n\n    hotKeys.globalHotKeys.forEach(function (v, k) {\n      children.push(createElement(Hotkey, _assign({\n        key: k\n      }, v, {\n        global: true\n      })));\n    });\n    return createElement(Hotkeys, null, children);\n  };\n\n  MindDragScrollWidget.prototype.componentDidMount = function () {\n    var _a = this.props,\n        getRef = _a.getRef,\n        model = _a.model,\n        controller = _a.controller;\n    controller.run('addZoomFactorChangeEventListener', _assign(_assign({}, this.props), {\n      listener: this.setZoomFactor\n    }));\n    var rootTopic = getRef(topicRefKey(model.editorRootTopicKey)); //TODO\n\n    var nodeLayer = getRef('node-layer');\n    var rootTopicRect = rootTopic.getBoundingClientRect();\n    var nodeLayerRect = nodeLayer.getBoundingClientRect();\n    this.dragScrollWidget.setViewBoxScrollDelta(0, rootTopicRect.top - nodeLayerRect.top - this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 + rootTopicRect.height);\n    this.layout();\n  };\n\n  MindDragScrollWidget.prototype.componentWillUnmount = function () {\n    var controller = this.props.controller;\n    controller.run('removeZoomFactorChangeEventListener', _assign(_assign({}, this.props), {\n      listener: this.setZoomFactor\n    }));\n  };\n\n  Object.defineProperty(MindDragScrollWidget.prototype, \"dragScrollWidget\", {\n    get: function get() {\n      return this.props.getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  MindDragScrollWidget.prototype.componentDidUpdate = function () {\n    var controller = this.props.controller;\n    controller.run('fireEvent', _assign(_assign({}, this.props), {\n      key: EventKey.CENTER_ROOT_TOPIC\n    }));\n    this.layout();\n  };\n\n  MindDragScrollWidget.prototype.layout = function () {\n    var controller = this.props.controller;\n    controller.run('layout', this.props);\n  };\n\n  MindDragScrollWidget.prototype.render = function () {\n    var _this = this;\n\n    var _a = this.props,\n        saveRef = _a.saveRef,\n        model = _a.model,\n        controller = _a.controller;\n    var nodeKey = model.editorRootTopicKey;\n    return createElement(DIV, {\n      onWheel: this.onWheel\n    }, createElement(DragScrollWidget, _assign({}, this.state, {\n      enableMouseWheel: false,\n      zoomFactor: model.zoomFactor,\n      ref: saveRef(RefKey.DRAG_SCROLL_WIDGET_KEY)\n    }), function (setViewBoxScroll, setViewBoxScrollDelta) {\n      var rootWidgetProps = _assign(_assign({}, _this.props), {\n        topicKey: nodeKey,\n        setViewBoxScroll: setViewBoxScroll,\n        setViewBoxScrollDelta: setViewBoxScrollDelta\n      });\n\n      return createElement(NodeLayer, {\n        ref: saveRef('node-layer')\n      }, controller.run('renderRootWidget', rootWidgetProps));\n    }));\n  };\n\n  MindDragScrollWidget = __decorate([HotkeysTarget], MindDragScrollWidget);\n  return MindDragScrollWidget;\n}(Component);\n\nvar templateObject_1$5, templateObject_2$3;\n\nvar Modals =\n/** @class */\nfunction (_super) {\n  __extends(Modals, _super);\n\n  function Modals() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.handleClose = function () {\n      var controller = _this.props.controller;\n      var handleActiveModalClose = controller.run('handleActiveModalClose', _this.props);\n      handleActiveModalClose && handleActiveModalClose();\n    };\n\n    return _this;\n  }\n\n  Modals.prototype.render = function () {\n    var controller = this.props.controller;\n    var activeModal = controller.run('renderModal', this.props);\n    var activeModalProps = controller.run('getActiveModalProps', this.props);\n    return createElement(Dialog, {\n      onClose: this.handleClose,\n      isOpen: activeModal !== null,\n      autoFocus: true,\n      enforceFocus: true,\n      usePortal: true,\n      title: activeModalProps && activeModalProps.title,\n      style: activeModalProps && activeModalProps.style\n    }, createElement(\"div\", {\n      className: Classes.DIALOG_BODY,\n      style: {\n        minHeight: 0\n      }\n    }, activeModal));\n  };\n\n  return Modals;\n}(BaseWidget);\n\nvar RootLinksSvg = styled.svg(templateObject_1$6 || (templateObject_1$6 = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$6 = debug('node:root-sub-links');\n\nvar RootSubLinks =\n/** @class */\nfunction (_super) {\n  __extends(RootSubLinks, _super);\n\n  function RootSubLinks() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      curves: []\n    };\n    return _this;\n  }\n\n  RootSubLinks.prototype.layout = function () {\n    var props = this.props;\n    var model = props.model,\n        getRef = props.getRef,\n        topicKey = props.topicKey,\n        zoomFactor = props.zoomFactor,\n        controller = props.controller;\n    var topic = model.getTopic(topicKey);\n    var content = getRef(contentRefKey(topicKey));\n    var svg = getRef(linksSvgRefKey(topicKey));\n    var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n    var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n    var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n    var p1, p2;\n    p1 = {\n      x: centerX(contentRect) - svgRect.left,\n      y: centerY(contentRect) - svgRect.top\n    };\n    var curves = [];\n    topic.subKeys.forEach(function (key) {\n      var linkStyle = controller.run('getLinkStyle', _assign(_assign({}, props), {\n        topicKey: key\n      }));\n      var lineType = linkStyle.lineType;\n      var subTopicContent = getRef(contentRefKey(key));\n\n      var rect = _getRelativeRect(subTopicContent, bigView, zoomFactor);\n\n      if (rect.left > contentRect.right) {\n        p2 = {\n          x: rect.left,\n          y: centerY(rect)\n        };\n      } else {\n        p2 = {\n          x: rect.right,\n          y: centerY(rect)\n        };\n      }\n\n      p2 = {\n        x: p2.x - svgRect.left,\n        y: p2.y - svgRect.top\n      };\n      var curve;\n\n      if (lineType === 'curve') {\n        curve = \"M \" + p1.x + \" \" + p1.y + \" C \" + p1.x + \" \" + centerPointY(p1, p2) + \" \" + centerPointX(p1, p2) + \" \" + p2.y + \" \" + p2.x + \" \" + p2.y;\n      } else if (lineType === 'line') {\n        curve = \"M \" + p1.x + \" \" + p1.y + \" L \" + p2.x + \" \" + p2.y;\n      } else if (lineType === 'round') {\n        var vDir = p2.y > p1.y ? 1 : -1;\n        var hDir = p2.x > p1.x ? 1 : -1;\n        var radius = linkStyle.lineRadius;\n\n        if (radius == null) {\n          throw new Error('link line type is round, but lineRadius is not provided!');\n        }\n\n        if (p2.y === p1.y) {\n          curve = \"M \" + p1.x + \" \" + p1.y + \" H \" + p2.x;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = \"M \" + p1.x + \" \" + p1.y + \"  V \" + (p2.y - vDir * radius) + \" A \" + radius + \" \" + radius + \" 0 0 \" + (vDir * hDir === 1 ? 0 : 1) + \" \" + (p1.x + radius * hDir) + \" \" + p2.y + \" H \" + p2.x;\n        }\n      }\n\n      curves.push(createElement(\"path\", {\n        key: \"link-\" + key,\n        d: curve,\n        strokeWidth: linkStyle.lineWidth,\n        stroke: linkStyle.lineColor,\n        fill: \"none\"\n      }));\n    });\n    this.setState({\n      curves: curves\n    });\n  };\n\n  RootSubLinks.prototype.render = function () {\n    log$6('render');\n    var _a = this.props,\n        topicKey = _a.topicKey,\n        saveRef = _a.saveRef;\n    return createElement(RootLinksSvg, {\n      ref: saveRef(linksSvgRefKey(topicKey))\n    }, createElement(\"g\", null, this.state.curves));\n  };\n\n  return RootSubLinks;\n}(BaseWidget);\n\nvar templateObject_1$6;\nvar log$7 = debug('RootNode');\nvar LayerPart = styled.div(templateObject_1$7 || (templateObject_1$7 = __makeTemplateObject([\"\\n  display: flex;\\n  position: relative;\\n\\n  align-items: \", \";\\n  flex-direction: column;\\n\\n  padding: \", \";\\n\"], [\"\\n  display: flex;\\n  position: relative;\\n\\n  align-items: \", \";\\n  flex-direction: column;\\n\\n  padding: \", \";\\n\"])), function (props) {\n  //@ts-ignore\n  return props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start';\n}, function (props) {\n  //@ts-ignore\n  return props.topicDirection === TopicDirection.LEFT ? '15px 60px 15px 0px' : '15px 0px 15px 60px';\n});\nvar Topic = styled.div(templateObject_2$4 || (templateObject_2$4 = __makeTemplateObject([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n  z-index: 3;\\n\"], [\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n  z-index: 3;\\n\"])));\n\nvar RootWidget =\n/** @class */\nfunction (_super) {\n  __extends(RootWidget, _super);\n\n  function RootWidget() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  RootWidget.prototype.renderPartTopics = function (topics, dir) {\n    var _a = this.props,\n        controller = _a.controller,\n        saveRef = _a.saveRef;\n    var res = controller.run('createSubTopics', _assign(_assign({}, this.props), {\n      dir: dir,\n      isRoot: true,\n      topics: topics\n    }));\n    if (!res) return null;\n    var subTopics = res.subTopics;\n    var cxName = \"bm-layer-\" + (dir === TopicDirection.LEFT ? 'left' : 'right');\n    return (//@ts-ignore\n      createElement(LayerPart, {\n        topicDirection: dir,\n        ref: saveRef(cxName)\n      }, subTopics)\n    );\n  };\n\n  RootWidget.prototype.render = function () {\n    log$7('render');\n    var props = this.props;\n    var model = props.model,\n        topicKey = props.topicKey,\n        saveRef = props.saveRef,\n        controller = props.controller;\n    var topicStyle = controller.run('getTopicContentStyle', props);\n    var config = model.config;\n    var topicContent = controller.run('renderTopicContent', _assign(_assign({}, props), {\n      topicStyle: topicStyle,\n      dir: TopicDirection.MAIN\n    }));\n    var partTopics = controller.run('getPartTopics', {\n      layout: config.layoutDir,\n      model: model,\n      topicKey: topicKey\n    });\n    var rootTopic = createElement(Topic, {\n      ref: saveRef(topicRefKey(topicKey))\n    }, topicContent);\n    var children = controller.run('renderRootWidgetOtherChildren', props);\n\n    switch (config.layoutDir) {\n      case DiagramLayoutType.LEFT_AND_RIGHT:\n        return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n      case DiagramLayoutType.LEFT_TO_RIGHT:\n        return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n      case DiagramLayoutType.RIGHT_TO_LEFT:\n        return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, children);\n\n      case DiagramLayoutType.TOP_TO_BOTTOM:\n        return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.B, 'B'), children);\n    }\n\n    return null;\n  };\n\n  return RootWidget;\n}(Component);\n\nvar templateObject_1$7, templateObject_2$4;\nvar Icon$1 = styled.div(templateObject_3$2 || (templateObject_3$2 = __makeTemplateObject([\"\\n  position: absolute;\\n  top: calc(50% - 10px);\\n  \", \";\\n  border-radius: 50%;\\n  width: 20px;\\n  height: 20px;\\n  text-align: center;\\n  //@ts-ignore\\n  background: \", \";\\n  cursor: pointer;\\n  padding: 0;\\n  font-size: 14px;\\n  line-height: 20px;\\n  border: 0;\\n  z-index: 2;\\n\"], [\"\\n  position: absolute;\\n  top: calc(50% - 10px);\\n  \", \";\\n  border-radius: 50%;\\n  width: 20px;\\n  height: 20px;\\n  text-align: center;\\n  //@ts-ignore\\n  background: \", \";\\n  cursor: pointer;\\n  padding: 0;\\n  font-size: 14px;\\n  line-height: 20px;\\n  border: 0;\\n  z-index: 2;\\n\"])), function (_a) {\n  var dir = _a.dir;\n  if (dir === TopicDirection.RIGHT) return css(templateObject_1$8 || (templateObject_1$8 = __makeTemplateObject([\"\\n        right: -25px;\\n      \"], [\"\\n        right: -25px;\\n      \"])));\n  if (dir === TopicDirection.LEFT) return css(templateObject_2$5 || (templateObject_2$5 = __makeTemplateObject([\"\\n        left: -25px;\\n      \"], [\"\\n        left: -25px;\\n      \"])));\n}, function (props) {\n  return props.background;\n});\n\nfunction TopicCollapseIcon(props) {\n  var _a;\n\n  var model = props.model,\n      topicKey = props.topicKey,\n      topicStyle = props.topicStyle,\n      dir = props.dir,\n      saveRef = props.saveRef,\n      onClickCollapse = props.onClickCollapse;\n  var topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? createElement(Icon$1, {\n    ref: saveRef(collapseRefKey(topicKey)),\n    onClick: onClickCollapse,\n    background: topicStyle.background,\n    dir: dir,\n    className: cx((_a = {\n      icon: true,\n      iconfont: true\n    }, _a[\"bm-\" + (topic.collapse ? 'plus' : 'minus')] = true, _a))\n  }) : null;\n}\n\nvar templateObject_1$8, templateObject_2$5, templateObject_3$2;\nvar log$8 = debug('node:topic-content2');\nvar EditingRoot = styled.div(templateObject_1$9 || (templateObject_1$9 = __makeTemplateObject([\"\\n  position: relative;\\n\"], [\"\\n  position: relative;\\n\"])));\nvar EditingWrapper = styled.div(templateObject_2$6 || (templateObject_2$6 = __makeTemplateObject([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: auto;\\n  z-index: 10;\\n  color: black;\\n\"], [\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: auto;\\n  z-index: 10;\\n  color: black;\\n\"])));\n\nvar cancelEvent$1 = function cancelEvent$1(e) {\n  log$8('cancelEvent');\n  e.preventDefault();\n  e.stopPropagation();\n};\n\nfunction TopicContent(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var readOnly = model.editingContentKey !== topicKey;\n  var editor = controller.run('renderTopicContentEditor', _assign(_assign({}, props), {\n    readOnly: readOnly\n  }));\n  var child;\n\n  if (readOnly) {\n    child = editor;\n  } else {\n    var wrapper_1;\n\n    var wrapperRef = function wrapperRef(ref) {\n      if (ref) {\n        wrapper_1 = ref;\n        contentResizeObserver_1.observe(wrapper_1);\n      }\n    };\n\n    var rect_1 = {\n      width: 50,\n      height: 40\n    };\n    var editorDiv = getRef(\"content-editor-\" + topicKey);\n    if (editorDiv) rect_1 = editorDiv.getBoundingClientRect();\n\n    var contentResizeCallback = function contentResizeCallback(entries, observer) {\n      var r = entries[0].contentRect;\n      wrapper_1.style.left = (rect_1.width - r.width) / 2 + 'px';\n      wrapper_1.style.top = (rect_1.height - r.height) / 2 + 'px';\n    };\n\n    var contentResizeObserver_1 = new ResizeObserver(contentResizeCallback);\n    log$8(rect_1);\n    child = createElement(Fragment, null, createElement(\"div\", {\n      style: {\n        width: rect_1.width,\n        height: rect_1.height\n      }\n    }), createElement(EditingWrapper, {\n      ref: wrapperRef\n    }, editor));\n  }\n\n  return createElement(EditingRoot, {\n    onDragEnter: cancelEvent$1,\n    onDragOver: cancelEvent$1\n  }, child);\n}\n\nvar templateObject_1$9, templateObject_2$6;\nvar log$9 = debug('node:topic-content-widget');\nvar TopicContent$1 = styled.div(templateObject_1$a || (templateObject_1$a = __makeTemplateObject([\"\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  //overflow: hidden;\\n  position: relative;\\n\"], [\"\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  //overflow: hidden;\\n  position: relative;\\n\"])));\nvar TopicContentWithDropArea = styled.div(templateObject_2$7 || (templateObject_2$7 = __makeTemplateObject([\"\\n  position: relative;\\n\"], [\"\\n  position: relative;\\n\"])));\n\nvar TopicContentWidget =\n/** @class */\nfunction (_super) {\n  __extends(TopicContentWidget, _super);\n\n  function TopicContentWidget(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.onDragStart = function (ev) {\n      _this.run('handleTopicDragStart', _assign(_assign({}, _this.props), {\n        ev: ev\n      }));\n    };\n\n    _this.onDragOver = function (ev) {\n      // log('onDragOver');\n      ev.preventDefault();\n    };\n\n    _this.onDragEnter = function (ev) {\n      log$9('onDragEnter', _this.props.topicKey);\n\n      _this.run('handleTopicDragEnter', _assign(_assign({}, _this.props), {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this.onDragLeave = function (ev) {\n      _this.run('handleTopicDragLeave', _assign(_assign({}, _this.props), {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this.onDrop = function (ev) {\n      log$9('onDrop');\n\n      _this.run('handleTopicDrop', _assign(_assign({}, _this.props), {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this.onClick = function (ev) {\n      var props = _this.props;\n      var controller = props.controller; //TODO bug [Violation] 'setTimeout' handler took 69ms\n\n      _this.handleTopicClickTimeout = setTimeout(function () {\n        // log('handleTopicClick');\n        //注意这里要传递this.props, 而不是props, 因为会先调用onClick, 再调用其他的topic-content-editor的onClickOutside\n        //其他组件的onClickOutside是个同步的函数,会设置新的model, 如果这里用props传参,会导致model 还是老的model\n        controller.run('handleTopicClick', _assign(_assign({}, _this.props), {\n          ev: ev\n        }));\n      }, 200);\n    };\n\n    _this.onDoubleClick = function (ev) {\n      clearTimeout(_this.handleTopicClickTimeout);\n      var controller = _this.props.controller;\n      controller.run('handleTopicDoubleClick', _assign(_assign({}, _this.props), {\n        ev: ev\n      }));\n    };\n\n    _this.needRelocation = false;\n\n    _this.onClickCollapse = function (e) {\n      e.stopPropagation();\n      var _a = _this.props,\n          topicKey = _a.topicKey,\n          getRef = _a.getRef;\n      _this.needRelocation = true;\n      var collapseIcon = getRef(collapseRefKey(topicKey));\n      var rect = collapseIcon.getBoundingClientRect();\n      log$9('oldRect', rect);\n      _this.oldCollapseIconVector = [rect.left + rect.width / 2, rect.top + rect.height / 2];\n      log$9('oldCollapseIconVector', _this.oldCollapseIconVector); // this.oldCollapseIconVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: collapseIcon\n      // });\n\n      _this.operation(OpType.TOGGLE_COLLAPSE, _this.props);\n    };\n\n    _this.state = {\n      dragEnter: false\n    };\n    return _this;\n  }\n\n  TopicContentWidget.prototype.renderContextMenu = function () {\n    var controller = this.props.controller;\n\n    if (!controller.getValue(PropKey.TOPIC_CONTEXT_MENU_ENABLED, _assign({}, this.props))) {\n      return;\n    }\n\n    this.operation(OpType.FOCUS_TOPIC, _assign(_assign({}, this.props), {\n      focusMode: FocusMode.SHOW_POPUP\n    }));\n    return controller.run('renderTopicContextMenu', this.props);\n  };\n\n  TopicContentWidget.prototype.onContextMenuClose = function () {// Optional method called once the context menu is closed.\n  };\n\n  TopicContentWidget.prototype.componentDidUpdate = function () {\n    if (this.needRelocation) {\n      var _a = this.props,\n          getRef = _a.getRef,\n          topicKey = _a.topicKey,\n          setViewBoxScrollDelta = _a.setViewBoxScrollDelta;\n      var newIcon = getRef(collapseRefKey(topicKey));\n      var newRect = newIcon.getBoundingClientRect(); // const newVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: getRef(collapseRefKey(topicKey))\n      // });\n\n      var newVector = [newRect.left + newRect.width / 2, newRect.top + newRect.height / 2];\n      log$9('newVector:', newVector);\n      log$9('oldVector:', this.oldCollapseIconVector); //TODO bug\n\n      var vector = [newVector[0] - this.oldCollapseIconVector[0], newVector[1] - this.oldCollapseIconVector[1]];\n      log$9('vector', vector);\n      setViewBoxScrollDelta(vector[0], vector[1]);\n      this.needRelocation = false;\n    }\n  };\n\n  TopicContentWidget.prototype.render = function () {\n    var props = this.props;\n    var saveRef = props.saveRef,\n        topicKey = props.topicKey,\n        model = props.model,\n        controller = props.controller,\n        topicStyle = props.topicStyle,\n        dir = props.dir;\n    log$9('render', topicKey, model.focusMode);\n    var draggable = controller.run('isOperationEnabled', props) && model.editingContentKey !== topicKey;\n    var collapseIcon = controller.run('renderTopicCollapseIcon', _assign(_assign({}, props), {\n      onClickCollapse: this.onClickCollapse.bind(this)\n    }));\n    var prevDropArea = controller.run('renderTopicDropArea', _assign(_assign({}, props), {\n      dropDir: 'prev'\n    }));\n    var nextDropArea = controller.run('renderTopicDropArea', _assign(_assign({}, props), {\n      dropDir: 'next'\n    }));\n    var dropEventHandlers = {\n      onDragEnter: this.onDragEnter,\n      onDragLeave: this.onDragLeave,\n      onDragOver: this.onDragOver,\n      onDrop: this.onDrop\n    }; // log(topicKey, 'style', topicStyle);\n\n    return createElement(TopicContentWithDropArea, null, prevDropArea, createElement(TopicContent$1, _assign({\n      style: topicStyle,\n      draggable: draggable,\n      ref: saveRef(contentRefKey(topicKey)),\n      onDragStart: this.onDragStart,\n      onClick: this.onClick,\n      onDoubleClick: this.onDoubleClick\n    }, dropEventHandlers), controller.run('renderTopicBlocks', props), controller.run('renderTopicContentOthers', props)), nextDropArea, dir !== TopicDirection.MAIN && collapseIcon);\n  };\n\n  TopicContentWidget = __decorate([ContextMenuTarget], TopicContentWidget);\n  return TopicContentWidget;\n}(BaseWidget);\n\nvar templateObject_1$a, templateObject_2$7;\nvar log$a = debug('node:topic-desc');\nvar TooltipContentWrapper = styled.div(templateObject_1$b || (templateObject_1$b = __makeTemplateObject([\"\\n  overflow: auto;\\n\"], [\"\\n  overflow: auto;\\n\"])));\n\nfunction TopicDesc(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var isEditing = model.editingDescKey === topicKey;\n  log$a('isEditing', isEditing);\n\n  var onClick = function onClick(e) {\n    e.stopPropagation();\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.START_EDITING_DESC\n    }));\n  };\n\n  var desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  if (!isEditing && controller.run('isBlockEmpty', _assign(_assign({}, props), {\n    block: desc.block\n  }))) return null;\n  var descEditor = controller.run('renderTopicDescEditor', props);\n  var diagramRoot = getRef(RefKey.DIAGRAM_ROOT_KEY);\n  var style = {\n    maxWidth: '800px',\n    maxHeight: '600px'\n  };\n\n  if (diagramRoot) {\n    var dRect = diagramRoot.getBoundingClientRect();\n    style.maxWidth = dRect.width * 0.6 + \"px\";\n    style.maxHeight = dRect.height * 0.8 + \"px\";\n  }\n\n  var tooltipContent = createElement(TooltipContentWrapper, {\n    onClick: cancelEvent,\n    classname: Classes.POPOVER_DISMISS,\n    style: style\n  }, descEditor);\n  var icon = createElement(TopicBlockIcon, {\n    onClick: onClick,\n    className: iconClassName(IconName.NOTES),\n    tabIndex: -1\n  });\n  var tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.HOVER,\n    hoverOpenDelay: 500\n  };\n  var descIcon = desc.block && createElement(Popover, _assign({}, tooltipProps));\n  return descIcon;\n}\n\nvar templateObject_1$b;\nvar FocusHighlightSvg = styled.svg(templateObject_1$c || (templateObject_1$c = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicHighlight =\n/** @class */\nfunction (_super) {\n  __extends(TopicHighlight, _super);\n\n  function TopicHighlight() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      content: null\n    };\n    return _this;\n  }\n\n  TopicHighlight.prototype.layout = function () {\n    var _a = this.props,\n        getRef = _a.getRef,\n        model = _a.model,\n        zoomFactor = _a.zoomFactor;\n    var focusKey = model.focusKey;\n    var focusMode = model.focusMode;\n\n    if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n\n    var content = getRef(contentRefKey(focusKey));\n    var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    var svg = getRef(RefKey.SVG_HIGHLIGHT_KEY);\n\n    var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n    var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n    var padding = 3;\n    var x = contentRect.left - svgRect.left - padding;\n    var y = contentRect.top - svgRect.top - padding;\n    var width = contentRect.width + 2 * padding;\n    var height = contentRect.height + 2 * padding;\n    this.setState({\n      content: createElement(\"rect\", {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        fill: \"none\",\n        stroke: model.config.theme.highlightColor,\n        strokeWidth: 2\n      })\n    });\n  };\n\n  TopicHighlight.prototype.render = function () {\n    var saveRef = this.props.saveRef;\n    return createElement(FocusHighlightSvg, {\n      ref: saveRef(RefKey.SVG_HIGHLIGHT_KEY)\n    }, this.state.content);\n  };\n\n  return TopicHighlight;\n}(BaseWidget);\n\nvar templateObject_1$c;\nvar TopicLinksSvg = styled.svg(templateObject_1$d || (templateObject_1$d = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$b = debug('node:topic-sub-links');\n\nvar TopicSubLinks =\n/** @class */\nfunction (_super) {\n  __extends(TopicSubLinks, _super);\n\n  function TopicSubLinks() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      curves: []\n    };\n    return _this;\n  }\n\n  TopicSubLinks.prototype.layout = function () {\n    var props = this.props;\n    var model = props.model,\n        getRef = props.getRef,\n        topicKey = props.topicKey,\n        dir = props.dir,\n        controller = props.controller;\n    var z = controller.run('getZoomFactor', props);\n    var topic = model.getTopic(topicKey);\n    var content = getRef(contentRefKey(topicKey));\n    var svg = getRef(linksSvgRefKey(topicKey));\n    var collapseIcon = getRef(collapseRefKey(topicKey));\n    var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n    var svgRect = _getRelativeRect(svg, bigView, z);\n\n    var collapseRect = _getRelativeRect(collapseIcon, bigView, z);\n\n    var contentRect = _getRelativeRect(content, bigView, z);\n\n    log$b(topicKey);\n    log$b('svgRect', svgRect);\n    log$b('collapseRect', collapseRect);\n    log$b('contentRect', contentRect);\n    var p1, p2, p3;\n\n    if (dir === TopicDirection.RIGHT) {\n      p1 = {\n        x: 0,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.right - svgRect.left + 10,\n        y: p1.y\n      };\n    } else if (dir === TopicDirection.LEFT) {\n      p1 = {\n        x: svgRect.right - svgRect.left,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.left - svgRect.left - 10,\n        y: p1.y\n      };\n    }\n\n    var curves = [];\n    topic.subKeys.forEach(function (key) {\n      var curve;\n      var linkStyle = controller.run('getLinkStyle', _assign(_assign({}, props), {\n        topicKey: key\n      })); // log(key);\n\n      var subContent = getRef(contentRefKey(key));\n      if (!subContent) return;\n\n      var rect = _getRelativeRect(subContent, bigView, z);\n\n      if (dir === TopicDirection.RIGHT) {\n        p3 = {\n          x: rect.left - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n\n      if (dir === TopicDirection.LEFT) {\n        p3 = {\n          x: rect.right - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n\n      var lineType = linkStyle.lineType;\n\n      if (lineType === 'curve') {\n        curve = \"M \" + p1.x + \" \" + p1.y + \" L \" + p2.x + \" \" + p2.y + \" C \" + p2.x + \" \" + centerPointY(p2, p3) + \" \" + centerPointX(p2, p3) + \" \" + p3.y + \" \" + p3.x + \" \" + p3.y;\n      } else if (lineType === 'round') {\n        var vDir = p3.y > p1.y ? 1 : -1;\n        var hDir = p3.x > p1.x ? 1 : -1;\n        var radius = linkStyle.lineRadius; // if (p3.y === p1.y) { //这样判断不可靠\n\n        if (topic.subKeys.size === 1 || Math.abs(p3.y - p1.y) <= 1) {\n          curve = \"M \" + p1.x + \" \" + p1.y + \" L \" + p3.x + \" \" + p3.y;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = \"M \" + p1.x + \" \" + p1.y + \" H \" + p2.x + \" V \" + (p3.y - vDir * radius) + \" A \" + radius + \" \" + radius + \" 0 0 \" + (vDir * hDir === 1 ? 0 : 1) + \" \" + (p2.x + radius * hDir) + \" \" + p3.y + \" H \" + p3.x;\n        }\n      } else if (lineType === 'line') {\n        curve = \"M \" + p1.x + \" \" + p1.y + \" H \" + p2.x + \" L \" + p3.x + \" \" + p3.y;\n      }\n\n      curves.push(createElement(\"path\", {\n        key: \"link-\" + key,\n        d: curve,\n        strokeWidth: linkStyle.lineWidth,\n        stroke: linkStyle.lineColor,\n        fill: \"none\"\n      }));\n    });\n    this.setState({\n      curves: curves\n    });\n  };\n\n  TopicSubLinks.prototype.render = function () {\n    var _a = this.props,\n        topicKey = _a.topicKey,\n        saveRef = _a.saveRef;\n    return createElement(TopicLinksSvg, {\n      ref: saveRef(linksSvgRefKey(topicKey))\n    }, createElement(\"g\", null, this.state.curves));\n  };\n\n  return TopicSubLinks;\n}(BaseWidget);\n\nvar templateObject_1$d;\nvar log$c = debug('node:topic-widget');\nvar Node = styled.div(templateObject_1$e || (templateObject_1$e = __makeTemplateObject([\"\\n  display: flex;\\n  align-items: center;\\n  flex-direction: \", \";\\n\"], [\"\\n  display: flex;\\n  align-items: center;\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n}); // TODO\n\nvar NodeChildren = styled.div(templateObject_2$8 || (templateObject_2$8 = __makeTemplateObject([\"\\n  position: relative;\\n  padding: \", \";\\n\"], [\"\\n  position: relative;\\n  padding: \", \";\\n\"])), function (props) {\n  return props.dir === TopicDirection.RIGHT ? \"0 0 0 \" + props.marginH + \"px\" : \"0 \" + props.marginH + \"px 0 0\";\n});\nvar NodeTopic = styled.div(templateObject_3$3 || (templateObject_3$3 = __makeTemplateObject([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n\\n  flex-direction: \", \";\\n\"], [\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n});\n\nvar TopicWidget =\n/** @class */\nfunction (_super) {\n  __extends(TopicWidget, _super);\n\n  function TopicWidget() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TopicWidget.prototype.renderSubTopics = function () {\n    var props = this.props;\n    var controller = props.controller,\n        model = props.model,\n        topicKey = props.topicKey,\n        dir = props.dir;\n    var topics = model.getTopic(topicKey).subKeys.toArray();\n    var res = controller.run('createSubTopics', _assign(_assign({}, props), {\n      topics: topics\n    }));\n    if (!res) return null;\n    var subTopics = res.subTopics;\n    var subLinks = controller.run('renderSubLinks', props);\n    return createElement(NodeChildren, {\n      dir: dir,\n      marginH: model.config.theme.marginH\n    }, subTopics, \" \", subLinks);\n  }; // componentDidUpdate(): void {\n  //   this.layoutLinks();\n  // }\n  //\n  // componentDidMount(): void {\n  //   this.layoutLinks();\n  // }\n\n\n  TopicWidget.prototype.layoutLinks = function () {\n    var _a = this.props,\n        getRef = _a.getRef,\n        topicKey = _a.topicKey,\n        model = _a.model;\n    var topic = model.getTopic(topicKey);\n    if (topic.subKeys.size === 0 || topic.collapse) return;\n    log$c('layoutLinks', topicKey);\n    var links = getRef(linksRefKey(topicKey));\n    links && links.layout();\n  };\n\n  TopicWidget.prototype.render = function () {\n    var props = this.props;\n    var controller = props.controller,\n        topicKey = props.topicKey,\n        dir = props.dir,\n        saveRef = props.saveRef;\n    log$c('render', topicKey);\n    var topicStyle = controller.run('getTopicContentStyle', props);\n\n    var propsMore = _assign(_assign({}, props), {\n      topicStyle: topicStyle\n    });\n\n    var topicContent = controller.run('renderTopicContent', propsMore);\n    return createElement(Node, {\n      topicDirection: dir\n    }, createElement(NodeTopic, {\n      topicDirection: dir,\n      ref: saveRef(topicRefKey(topicKey))\n    }, topicContent), this.renderSubTopics());\n  };\n\n  return TopicWidget;\n}(Component);\n\nvar templateObject_1$e, templateObject_2$8, templateObject_3$3;\nvar log$d = debug('node:view-port-viewer');\nvar ViewerRoot = styled(ZIndex)(templateObject_1$f || (templateObject_1$f = __makeTemplateObject([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"], [\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"])));\nvar Item_ = styled(Btn)(templateObject_2$9 || (templateObject_2$9 = __makeTemplateObject([\"\\n  margin: 10px;\\n\"], [\"\\n  margin: 10px;\\n\"])));\nvar ZoomFactorSpan = styled.span(templateObject_3$4 || (templateObject_3$4 = __makeTemplateObject([\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"], [\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"])));\n\nvar Item = function Item(props) {\n  return createElement(Tooltip, {\n    content: props.tooltip,\n    position: Position.TOP,\n    className: Classes.ICON\n  }, createElement(Item_, {\n    onClick: props.onClick,\n    tabIndex: -1\n  }, props.children));\n};\n\nvar ViewPortViewer =\n/** @class */\nfunction (_super) {\n  __extends(ViewPortViewer, _super);\n\n  function ViewPortViewer(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.zoomFactorChange = function (zoomFactor) {\n      log$d('zoomFactorChange', zoomFactor);\n\n      _this.setState({\n        zoomFactor: zoomFactor\n      });\n    };\n\n    _this.onClickResetZoom = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      controller.run('setZoomFactor', _assign(_assign({}, props), {\n        zoomFactor: 1\n      }));\n    };\n\n    _this.onClickAddZoom = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _assign(_assign({}, props), {\n        zoomFactor: zoomFactor + 0.1\n      }));\n    };\n\n    _this.onClickMinusZoom = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _assign(_assign({}, props), {\n        zoomFactor: zoomFactor - 0.1\n      }));\n    };\n\n    _this.onClickCollapseAll = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _assign(_assign({}, props), {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.COLLAPSE_ALL\n      }));\n    };\n\n    _this.onClickExpandAll = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _assign(_assign({}, props), {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.EXPAND_ALL\n      }));\n    };\n\n    _this.centerRootTopic = function () {\n      var _a = _this.props,\n          model = _a.model,\n          controller = _a.controller;\n      controller.run('moveTopicToCenter', _assign(_assign({}, _this.props), {\n        topicKey: model.editorRootTopicKey\n      }));\n    };\n\n    return _this;\n  }\n\n  ViewPortViewer.prototype.componentDidMount = function () {\n    var props = this.props;\n    var controller = props.controller;\n    controller.run('addZoomFactorChangeEventListener', _assign(_assign({}, props), {\n      listener: this.zoomFactorChange\n    }));\n  };\n\n  ViewPortViewer.prototype.componentWillUnmount = function () {\n    var props = this.props;\n    var controller = props.controller;\n    controller.run('removeZoomFactorChangeEventListener', _assign(_assign({}, props), {\n      listener: this.zoomFactorChange\n    }));\n  };\n\n  ViewPortViewer.prototype.render = function () {\n    log$d('render');\n    var props = this.props;\n    var controller = props.controller,\n        zIndex = props.zIndex;\n    var zoomFactor = controller.run('getZoomFactor', props);\n    return createElement(ViewerRoot, {\n      zIndex: zIndex\n    }, createElement(Item, {\n      onClick: this.onClickCollapseAll,\n      tooltip: \"collapse all\"\n    }, Icon(IconName.COLLAPSE_ALL)), createElement(Item, {\n      onClick: this.onClickExpandAll,\n      tooltip: \"expand all\"\n    }, Icon(IconName.EXPAND_ALL)), createElement(Item, {\n      onClick: this.centerRootTopic,\n      tooltip: \"center root topic\"\n    }, Icon(IconName.CENTER)), createElement(Item, {\n      onClick: this.onClickMinusZoom,\n      tooltip: \"zoom in\"\n    }, Icon(IconName.MINUS)), createElement(Item, {\n      onClick: this.onClickResetZoom,\n      tooltip: \"reset zoom\"\n    }, createElement(ZoomFactorSpan, null, \"zoom:\" + Math.floor(zoomFactor * 100) + \"%\")), createElement(Item, {\n      onClick: this.onClickAddZoom,\n      tooltip: \"zoom out\"\n    }, Icon(IconName.PLUS)));\n  };\n\n  return ViewPortViewer;\n}(BaseWidget);\n\nvar templateObject_1$f, templateObject_2$9, templateObject_3$4;\nvar DescEditorWrapper = styled.div(templateObject_1$g || (templateObject_1$g = __makeTemplateObject([\"\\n  overflow: auto;\\n  padding: 0px 0px 0px 20px;\\n  background: #88888850;\\n\"], [\"\\n  overflow: auto;\\n  padding: 0px 0px 0px 20px;\\n  background: #88888850;\\n\"])));\n\nfunction renderDrawer(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n\n  if (model.focusMode === FocusMode.EDITING_DESC) {\n    var onDescEditorClose = function onDescEditorClose(e) {\n      e.stopPropagation();\n      var key = \"topic-desc-data-\" + topicKey;\n      var descData = controller.run('deleteTempValue', {\n        key: key\n      });\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.SET_TOPIC_BLOCK,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: descData,\n        focusMode: FocusMode.NORMAL\n      }));\n    };\n\n    var descEditor = controller.run('renderTopicDescEditor', props);\n    return createElement(Drawer, {\n      key: \"drawer\",\n      title: \"Edit Notes\",\n      icon: Icon('note'),\n      isOpen: true,\n      hasBackdrop: true,\n      backdropProps: {\n        onMouseDown: cancelEvent\n      },\n      isCloseButtonShown: false,\n      onClose: onDescEditorClose,\n      size: \"70%\"\n    }, createElement(DescEditorWrapper, null, descEditor));\n  }\n}\n\nvar templateObject_1$g; //TODO 是否需要themeProvider\n\nfunction Theme(_a) {\n  var theme = _a.theme,\n      children = _a.children;\n  return (//@ts-ignore\n    createElement(ThemeProvider, {\n      theme: theme\n    }, createElement(Fragment, null, children))\n  );\n}\n\nvar log$e = debug('plugin:rendering');\n\nfunction RenderingPlugin() {\n  var DiagramRoot = styled.div(templateObject_1$h || (templateObject_1$h = __makeTemplateObject([\"\\n    width: 100%;\\n    height: 100%;\\n    background: \", \";\\n    position: relative;\\n  \"], [\"\\n    width: 100%;\\n    height: 100%;\\n    background: \", \";\\n    position: relative;\\n  \"])), function (props) {\n    return props.theme.background;\n  });\n  var diagramProps;\n  return {\n    getDiagramProps: function getDiagramProps() {\n      return diagramProps;\n    },\n    renderDiagram: function renderDiagram(props) {\n      var model = props.model,\n          controller = props.controller;\n      return createElement(SaveRef, null, function (saveRef, getRef, deleteRef) {\n        diagramProps = _assign(_assign({}, props), {\n          saveRef: saveRef,\n          getRef: getRef,\n          deleteRef: deleteRef\n        });\n        log$e('renderDiagram', model);\n        return createElement(Theme, {\n          theme: model.config.theme\n        }, createElement(DiagramRoot, {\n          ref: saveRef(RefKey.DIAGRAM_ROOT_KEY)\n        }, createElement(MindDragScrollWidget, _assign({}, diagramProps)), controller.run('renderDiagramCustomize', diagramProps)));\n      });\n    },\n    renderDrawer: renderDrawer,\n    renderDiagramCustomize: function renderDiagramCustomize(props) {\n      var controller = props.controller,\n          model = props.model;\n      var zIndex = controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX);\n\n      var nProps = _assign(_assign({}, props), {\n        zIndex: zIndex,\n        topicKey: model.focusKey\n      });\n\n      var breadcrumbs = controller.run('renderEditorRootBreadcrumbs', nProps); // const styleEditor = controller.run('renderStyleEditor', nProps);\n\n      var rightTopPanel = controller.run('renderRightTopPanel', nProps);\n      var modals = controller.run('renderModals', _assign(_assign({}, nProps), {\n        zIndex: zIndex + 1\n      }));\n      var drawer = controller.run('renderDrawer', _assign(_assign({}, nProps), {\n        zIndex: zIndex + 1\n      }));\n      var viewportViewer = controller.run('renderViewPortViewer', nProps);\n      return [breadcrumbs, rightTopPanel, modals, drawer, viewportViewer];\n    },\n    renderEditorRootBreadcrumbs: function renderEditorRootBreadcrumbs(props) {\n      return createElement(EditorRootBreadcrumbs, _assign({\n        key: \"EditorRootBreadcrumbs\"\n      }, props));\n    },\n    renderModals: function renderModals(props) {\n      return createElement(Modals, _assign({\n        key: \"modals\"\n      }, props));\n    },\n    renderModal: function renderModal(props) {\n      return null;\n    },\n    getActiveModalProps: function getActiveModalProps(props) {\n      return null;\n    },\n    renderDoc: function renderDoc(_a) {\n      var children = _a.children;\n      return children;\n    },\n    renderRootWidget: function renderRootWidget(props) {\n      return createElement(RootWidget, _assign({}, props));\n    },\n    renderTopicWidget: function renderTopicWidget(props) {\n      return createElement(TopicWidget, _assign({}, props));\n    },\n    renderTopicContent: function renderTopicContent(props) {\n      return createElement(TopicContentWidget, _assign({}, props));\n    },\n    renderTopicCollapseIcon: function renderTopicCollapseIcon(props) {\n      return createElement(TopicCollapseIcon, _assign({}, props));\n    },\n    renderTopicContentOthers: function renderTopicContentOthers(props) {\n      return [];\n    },\n    renderTopicBlocks: function renderTopicBlocks(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller;\n      var topic = model.getTopic(topicKey);\n      var blocks = topic.blocks;\n      var res = [];\n      var i = 0;\n      blocks.forEach(function (block) {\n        var b = controller.run('renderTopicBlock', _assign(_assign({}, props), {\n          block: block,\n          blockKey: \"block-\" + i\n        }));\n\n        if (b) {\n          res.push(createElement(Fragment, {\n            key: \"block-\" + i\n          }, b));\n          i++;\n        }\n      });\n      return res;\n    },\n    renderTopicBlock: function renderTopicBlock(props) {\n      var controller = props.controller,\n          block = props.block;\n\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicBlockContent', props);\n\n        case BlockType.DESC:\n          return controller.run('renderTopicBlockDesc', props);\n      }\n\n      return null;\n    },\n    renderTopicBlockContent: function renderTopicBlockContent(props) {\n      return createElement(TopicContent, _assign({}, props));\n    },\n    renderTopicBlockDesc: function renderTopicBlockDesc(props) {\n      return createElement(TopicDesc, _assign({}, props));\n    },\n    renderSubLinks: function renderSubLinks(props) {\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return createElement(TopicSubLinks, _assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderRootSubLinks: function renderRootSubLinks(props) {\n      // log('renderRootSubLinks');\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey; // 这里逻辑有问题,会导致layout 错误\n      // const topic = model.getTopic(topicKey);\n      // if (topic.subKeys.size === 0) return null;\n\n      return createElement(RootSubLinks, _assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderFocusItemHighlight: function renderFocusItemHighlight(props) {\n      var saveRef = props.saveRef;\n      return createElement(TopicHighlight, _assign({\n        ref: saveRef(RefKey.FOCUS_HIGHLIGHT_KEY)\n      }, props));\n    },\n    renderRootWidgetOtherChildren: function renderRootWidgetOtherChildren(props) {\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      props = _assign(_assign({}, props), {\n        zoomFactor: zoomFactor\n      });\n      return createElement(Fragment, null, controller.run('renderRootSubLinks', props), controller.run('renderFocusItemHighlight', props), controller.run('renderDragAndDropEffect', props));\n    },\n    renderViewPortViewer: function renderViewPortViewer(props) {\n      return createElement(ViewPortViewer, _assign({\n        key: \"view-port-viewer\"\n      }, props));\n    }\n  };\n}\n\nvar templateObject_1$h;\nvar PanelRoot = styled(ZIndex)(templateObject_1$i || (templateObject_1$i = __makeTemplateObject([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n  user-select: none;\\n\"], [\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n  user-select: none;\\n\"])));\nvar StyledTabs = styled(Tabs)(templateObject_2$a || (templateObject_2$a = __makeTemplateObject([\"\\n  padding: 0px 10px;\\n\"], [\"\\n  padding: 0px 10px;\\n\"])));\n\nfunction RightTopPanel(props) {\n  var controller = props.controller,\n      zIndex = props.zIndex,\n      selectedTabId = props.selectedTabId,\n      handleTabIdChange = props.handleTabIdChange;\n\n  var _a = __read(useState(false), 2),\n      expand = _a[0],\n      setExpand = _a[1];\n\n  if (!expand) {\n    return createElement(PanelRoot, {\n      zIndex: zIndex\n    }, createElement(IconBg, {\n      onClick: function onClick() {\n        return setExpand(true);\n      }\n    }, createElement(ShowMenuIcon, {\n      className: iconClassName(IconName.SHOW_MENU)\n    })));\n  }\n\n  return createElement(PanelRoot, {\n    zIndex: zIndex\n  }, createElement(Title, null, createElement(CloseIcon, {\n    className: iconClassName(IconName.CLOSE),\n    onClick: function onClick() {\n      return setExpand(false);\n    }\n  })), createElement(StyledTabs, {\n    id: selectedTabId,\n    onChange: handleTabIdChange\n  }, controller.run('renderRightTopPanelTabs', props)));\n}\n\nvar templateObject_1$i, templateObject_2$a;\nvar SettingTitle = styled.div(templateObject_1$j || (templateObject_1$j = __makeTemplateObject([\"\\n  margin-top: 10px;\\n  margin-bottom: 5px;\\n  font-weight: bold;\\n\"], [\"\\n  margin-top: 10px;\\n  margin-bottom: 5px;\\n  font-weight: bold;\\n\"])));\nvar SettingItem = styled.span(templateObject_2$b || (templateObject_2$b = __makeTemplateObject([\"\\n  margin: 0px 10px 0px 0px;\\n\"], [\"\\n  margin: 0px 10px 0px 0px;\\n\"])));\nvar SettingBoxContainer = styled.div(templateObject_3$5 || (templateObject_3$5 = __makeTemplateObject([\"\\n  padding: 10px;\\n  margin: 0 0 10px 0;\\n  border: rgba(16, 22, 26, 0.15) solid 1px;\\n  border-radius: 5px;\\n\"], [\"\\n  padding: 10px;\\n  margin: 0 0 10px 0;\\n  border: rgba(16, 22, 26, 0.15) solid 1px;\\n  border-radius: 5px;\\n\"])));\nvar SettingLabel = styled(SettingItem)(templateObject_4$1 || (templateObject_4$1 = __makeTemplateObject([\"\"], [\"\"])));\nvar SettingRow = styled.div(templateObject_5$1 || (templateObject_5$1 = __makeTemplateObject([\"\\n  display: flex;\\n  align-items: center;\\n  //justify-content: center;\\n  margin: 5px 0;\\n\"], [\"\\n  display: flex;\\n  align-items: center;\\n  //justify-content: center;\\n  margin: 5px 0;\\n\"])));\nvar ColorBar = styled.div(templateObject_6$1 || (templateObject_6$1 = __makeTemplateObject([\"\\n  height: 3px;\\n  width: 80%;\\n  margin-left: 10%;\\n  margin-right: 10%;\\n  margin-bottom: 2px;\\n  background: \", \";\\n\"], [\"\\n  height: 3px;\\n  width: 80%;\\n  margin-left: 10%;\\n  margin-right: 10%;\\n  margin-bottom: 2px;\\n  background: \", \";\\n\"])), function (props) {\n  return props.color;\n});\nvar WithBorder = styled.div(templateObject_7$1 || (templateObject_7$1 = __makeTemplateObject([\"\\n  border: 1px solid grey;\\n  cursor: pointer;\\n  font-weight: bold;\\n\"], [\"\\n  border: 1px solid grey;\\n  cursor: pointer;\\n  font-weight: bold;\\n\"])));\nvar templateObject_1$j, templateObject_2$b, templateObject_3$5, templateObject_4$1, templateObject_5$1, templateObject_6$1, templateObject_7$1;\n\nfunction SettingGroup(props) {\n  return createElement(\"div\", null, props.children, createElement(Divider, {\n    style: {\n      margin: '10px 0'\n    }\n  }));\n}\n\nfunction SettingItemColorPicker(props) {\n  var color = props.color,\n      handleColorChange = props.handleColorChange;\n  return createElement(SettingItem, null, createElement(Popover, null, createElement(WithBorder, null, createElement(\"div\", {\n    className: iconClassName(IconName.COLOR_PICKER)\n  }), createElement(ColorBar, {\n    color: color\n  })), createElement(\"div\", null, createElement(SketchPicker, {\n    color: color,\n    onChangeComplete: function onChangeComplete(color) {\n      return handleColorChange(color.hex);\n    }\n  }))));\n}\n\nfunction SettingItemButton(props) {\n  var title = props.title,\n      handleClick = props.handleClick;\n  return createElement(SettingItem, null, createElement(Button, {\n    onClick: handleClick\n  }, title));\n}\n\nfunction SettingItemNumericInput(props) {\n  var _a = props.layout,\n      layout = _a === void 0 ? 'h' : _a,\n      title = props.title,\n      restProps = __rest(props, [\"layout\", \"title\"]);\n\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, _assign({}, flexProps), createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title), createElement(NumericInput, _assign({}, restProps))));\n}\n\nfunction SettingItemSelect(props) {\n  var text = props.text,\n      items = props.items,\n      itemRenderer = props.itemRenderer,\n      onItemSelect = props.onItemSelect;\n  var PxSelect = Select.ofType();\n  var pxProps = {\n    items: items,\n    itemRenderer: itemRenderer,\n    onItemSelect: onItemSelect,\n    filterable: false\n  };\n  return createElement(SettingItem, null, createElement(PxSelect, _assign({}, pxProps), createElement(Button, {\n    text: text\n  })));\n}\n\nvar renderItem = function renderItem(unit) {\n  return function (width, _a) {\n    var handleClick = _a.handleClick;\n    return createElement(MenuItem, {\n      text: \"\" + width + unit,\n      key: width,\n      onClick: handleClick\n    });\n  };\n};\n\nvar PxSelect = Select.ofType();\n\nvar borderWidthItems = __spread(Array(7).keys());\n\nvar borderWidthItems$1 = __spread(Array(7).keys());\n\nvar borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\nvar borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n\nfunction BorderStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleBorderWidthChange = function handleBorderWidthChange(value) {\n    // log('handleBorderWithChange:', value);\n    setContentStyle({\n      borderWidth: value + \"px\"\n    });\n  };\n\n  var handleBorderStyleChange = function handleBorderStyleChange(value) {\n    setContentStyle({\n      borderStyle: value\n    });\n  };\n\n  var handleBorderRadiusChange = function handleBorderRadiusChange(value) {\n    // log('handleBorderRadiusChange:', value);\n    setContentStyle({\n      borderRadius: value + \"px\"\n    });\n  };\n\n  var handleBorderColorChange = function handleBorderColorChange(color) {\n    setContentStyle({\n      borderColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, \"Border\"), createElement(\"div\", null, createElement(SettingItemSelect, {\n    text: \"width: \" + (contentStyle.borderWidth ? contentStyle.borderWidth : '0px'),\n    items: borderWidthItems$1,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"style: \" + (contentStyle.borderStyle ? contentStyle.borderStyle : 'none'),\n    items: borderStyleItems,\n    itemRenderer: renderItem(''),\n    onItemSelect: handleBorderStyleChange\n  }), createElement(SettingItemSelect, {\n    text: \"radius: \" + contentStyle.borderRadius,\n    items: borderRadiusItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderRadiusChange\n  }), createElement(SettingItemColorPicker, {\n    color: contentStyle.borderColor,\n    handleColorChange: handleBorderColorChange\n  })));\n}\n\nfunction ClearAllCustomStyle(props) {\n  var controller = props.controller;\n\n  var handleClearAllCustomStyle = function handleClearAllCustomStyle(e) {\n    controller.run('clearAllCustomStyle', props);\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingItem, null, createElement(Button, {\n    onClick: handleClearAllCustomStyle\n  }, \"Clear All Custom Styles\")));\n}\n\nvar lineTypes = ['curve', 'round', 'line'];\n\nvar renderLineTypeItem = function renderLineTypeItem(lineType, _a) {\n  var handleClick = _a.handleClick,\n      modifiers = _a.modifiers,\n      query = _a.query;\n  return createElement(MenuItem, {\n    text: \"\" + lineType,\n    key: lineType,\n    onClick: handleClick\n  });\n};\n\nfunction LinkStyleEditor(props) {\n  var _a = props.showLinkStyle,\n      showLinkStyle = _a === void 0 ? true : _a,\n      _b = props.showSubLinkStyle,\n      showSubLinkStyle = _b === void 0 ? true : _b,\n      _c = props.linkStyle,\n      linkStyle = _c === void 0 ? {} : _c,\n      _d = props.subLinkStyle,\n      subLinkStyle = _d === void 0 ? {} : _d,\n      setLinkStyle = props.setLinkStyle,\n      setSubLinkStyle = props.setSubLinkStyle;\n\n  var handleLinkWidthChange = function handleLinkWidthChange(value) {\n    setLinkStyle({\n      lineWidth: value + \"px\"\n    });\n  };\n\n  var handleLinkTypeChange = function handleLinkTypeChange(value) {\n    setLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleLinkColorChange = function handleLinkColorChange(color) {\n    setLinkStyle({\n      lineColor: color\n    });\n  };\n\n  var handleSubLinkWidthChange = function handleSubLinkWidthChange(value) {\n    setSubLinkStyle({\n      lineWidth: value + \"px\"\n    });\n  };\n\n  var handleSubLinkTypeChange = function handleSubLinkTypeChange(value) {\n    setSubLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleSubLinkColorChange = function handleSubLinkColorChange(color) {\n    setSubLinkStyle({\n      lineColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, \"Link\"), showLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, \"LinkToParent: \"), createElement(SettingItemSelect, {\n    text: \"width: \" + (linkStyle ? linkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"lineType: \" + linkStyle.lineType,\n    items: lineTypes,\n    itemRenderer: renderLineTypeItem,\n    onItemSelect: handleLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: linkStyle.lineColor,\n    handleColorChange: handleLinkColorChange\n  })), showSubLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, \"SubLinks: \"), createElement(SettingItemSelect, {\n    text: \"width: \" + (subLinkStyle ? subLinkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleSubLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"lineType: \" + subLinkStyle.lineType,\n    items: lineTypes,\n    itemRenderer: renderLineTypeItem,\n    onItemSelect: handleSubLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: subLinkStyle.lineColor,\n    handleColorChange: handleSubLinkColorChange\n  })));\n}\n\nfunction TextStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleFontSizeChange = function handleFontSizeChange(value) {\n    // log('handleFontSizeChange:', value);\n    setContentStyle({\n      fontSize: value\n    });\n  };\n\n  var handleLineHeightChange = function handleLineHeightChange(e) {\n    // log('handleLineHeightChange:', e.target.value);\n    setContentStyle({\n      lineHeight: e.target.value\n    });\n  };\n\n  var handleColorChange = function handleColorChange(color) {\n    setContentStyle({\n      color: color\n    });\n  };\n\n  var fontSizeNumInputProps = {\n    title: 'FontSize:',\n    min: 12,\n    max: 100,\n    value: parseInt(contentStyle.fontSize),\n    style: {\n      width: 50\n    },\n    onValueChange: handleFontSizeChange\n  };\n  var lineHeightInputProps = {\n    style: {\n      width: 50\n    },\n    value: contentStyle.lineHeight || '',\n    onChange: handleLineHeightChange\n  };\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, \"Text Editor\"), createElement(Flex, null, createElement(SettingItemNumericInput, _assign({}, fontSizeNumInputProps)), createElement(SettingItem, null, createElement(Flex, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, \"LineHeight: \"), createElement(InputGroup, _assign({}, lineHeightInputProps)))), createElement(SettingItemColorPicker, {\n    color: contentStyle.color,\n    handleColorChange: handleColorChange\n  })));\n}\n\nvar log$f = debug('node:style-editor');\nvar copiedStyle;\n\nfunction StyleEditor(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  var setContentStyle = function setContentStyle(style) {\n    controller.run('setTopicContentStyle', _assign(_assign({}, props), {\n      style: style\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(color) {\n    setContentStyle({\n      background: color\n    });\n  };\n\n  var handleClearStyle = function handleClearStyle() {\n    if (topic.style) {\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.SET_STYLE,\n        style: null\n      }));\n    }\n  };\n\n  var handleCopyStyle = function handleCopyStyle() {\n    copiedStyle = controller.run('getTopicStyle', props);\n    log$f(copiedStyle);\n  };\n\n  var handlePasteStyle = function handlePasteStyle() {\n    if (copiedStyle) {\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.SET_STYLE,\n        style: JSON.stringify(copiedStyle)\n      }));\n    }\n  };\n\n  if (!model.focusKey) return null;\n  var contentStyle = controller.run('getTopicContentStyle', props);\n  var linkStyle = controller.run('getLinkStyle', props);\n  var subLinkStyle = controller.run('getSubLinkStyle', props);\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    controller.run('setLinkStyle', _assign(_assign({}, props), {\n      linkStyle: linkStyle\n    }));\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    controller.run('setSubLinkStyle', _assign(_assign({}, props), {\n      subLinkStyle: subLinkStyle\n    }));\n  };\n\n  var linkStyleEditorProps = {\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  };\n  var contentStyleEditorPros = {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  };\n  return createElement(PanelTabRoot, null, createElement(BorderStyleEditor, _assign({}, contentStyleEditorPros)), createElement(TextStyleEditor, _assign({}, contentStyleEditorPros)), createElement(SettingGroup, null, createElement(SettingTitle, null, \"Background\"), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: handleBackgroundColorChange\n  })), createElement(LinkStyleEditor, _assign({}, linkStyleEditorProps)), createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: \"Clear Topic Style\",\n    handleClick: handleClearStyle\n  }), createElement(SettingItemButton, {\n    title: \"Copy Style\",\n    handleClick: handleCopyStyle\n  }), createElement(SettingItemButton, {\n    title: \"Paste Style\",\n    handleClick: handlePasteStyle\n  })), ClearAllCustomStyle(props));\n}\n/** Event handler that exposes the target element's value as a boolean. */\n\n\nfunction handleBooleanChange(handler) {\n  return function (event) {\n    return handler(event.target.checked);\n  };\n}\n\nvar expand = require('css-shorthand-expand');\n\nfunction PaddingStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n  var padding = expand('padding', contentStyle.padding || '0');\n  var commonProps = {\n    layout: 'v',\n    min: 0,\n    max: 99,\n    style: {\n      width: 38\n    }\n  };\n  var top = parseInt(padding['padding-top']);\n  var right = parseInt(padding['padding-right']);\n  var bottom = parseInt(padding['padding-bottom']);\n  var left = parseInt(padding['padding-left']);\n  var p = {\n    top: top,\n    right: right,\n    bottom: bottom,\n    left: left\n  };\n\n  var setPadding = function setPadding(dir) {\n    return function (v) {\n      var _a;\n\n      setContentStyle({\n        padding: paddingCss(_assign(_assign({}, p), (_a = {}, _a[dir] = v, _a)))\n      });\n    };\n  };\n\n  var topProps = _assign(_assign({}, commonProps), {\n    title: 'top',\n    value: top,\n    onValueChange: setPadding('top')\n  });\n\n  var rightProps = _assign(_assign({}, commonProps), {\n    title: 'right',\n    value: right,\n    onValueChange: setPadding('right')\n  });\n\n  var bottomProps = _assign(_assign({}, commonProps), {\n    title: 'bottom',\n    value: bottom,\n    onValueChange: setPadding('bottom')\n  });\n\n  var leftProps = _assign(_assign({}, commonProps), {\n    title: 'left',\n    value: left,\n    onValueChange: setPadding('left')\n  });\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, \"Padding\"), createElement(SettingRow, null, createElement(SettingItemNumericInput, _assign({}, topProps)), createElement(SettingItemNumericInput, _assign({}, rightProps)), createElement(SettingItemNumericInput, _assign({}, bottomProps)), createElement(SettingItemNumericInput, _assign({}, leftProps))));\n}\n\nvar TopicThemeEditorRoot = styled.div(templateObject_1$k || (templateObject_1$k = __makeTemplateObject([\"\\n  height: 250px;\\n  overflow: auto;\\n\"], [\"\\n  height: 250px;\\n  overflow: auto;\\n\"])));\n\nfunction TopicThemeEditor(props) {\n  var topicStyle = props.topicStyle,\n      setTopicStyle = props.setTopicStyle;\n  var _a = topicStyle.contentStyle,\n      contentStyle = _a === void 0 ? {} : _a,\n      _b = topicStyle.linkStyle,\n      linkStyle = _b === void 0 ? {} : _b,\n      _c = topicStyle.subLinkStyle,\n      subLinkStyle = _c === void 0 ? {} : _c;\n\n  var setContentStyle = function setContentStyle(contentStyle) {\n    setTopicStyle({\n      contentStyle: contentStyle\n    });\n  };\n\n  var nProps = {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  };\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    setTopicStyle({\n      linkStyle: linkStyle\n    });\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    setTopicStyle({\n      subLinkStyle: subLinkStyle\n    });\n  };\n\n  var linkStyleEditorProps = {\n    showLinkStyle: false,\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  };\n  return createElement(TopicThemeEditorRoot, null, createElement(BorderStyleEditor, _assign({}, nProps)), createElement(PaddingStyleEditor, _assign({}, nProps)), createElement(TextStyleEditor, _assign({}, nProps)), createElement(SettingGroup, null, createElement(SettingTitle, null, \"Background\"), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: function handleColorChange(color) {\n      setContentStyle({\n        background: color\n      });\n    }\n  })), createElement(LinkStyleEditor, _assign({}, linkStyleEditorProps)));\n}\n\nvar templateObject_1$k;\nvar tabId = 'normal';\n\nfunction ThemeEditor(props) {\n  var _a = __read(useState(false), 2),\n      showExportDialog = _a[0],\n      setShowExportDialog = _a[1];\n\n  var _b = __read(useState(false), 2),\n      alertThemeError = _b[0],\n      setAlertThemeError = _b[1];\n\n  var model = props.model,\n      controller = props.controller;\n  var theme = model.config.theme;\n  var rootTopic = theme.rootTopic,\n      primaryTopic = theme.primaryTopic,\n      normalTopic = theme.normalTopic;\n\n  var setTheme = function setTheme(theme) {\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.SET_THEME,\n      theme: clone(theme)\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(background) {\n    setTheme(merge(theme, {\n      background: background\n    }));\n  };\n\n  var handleHighlightColorChange = function handleHighlightColorChange(highlightColor) {\n    setTheme(merge(theme, {\n      highlightColor: highlightColor\n    }));\n  };\n\n  var handleRandomColorChange = handleBooleanChange(function (randomColor) {\n    setTheme(merge(theme, {\n      randomColor: randomColor\n    }));\n  });\n\n  var setRootTopicStyle = function setRootTopicStyle(style) {\n    setTheme(merge(theme, {\n      rootTopic: style\n    }));\n  };\n\n  var setPrimaryTopicStyle = function setPrimaryTopicStyle(style) {\n    setTheme(merge(theme, {\n      primaryTopic: style\n    }));\n  };\n\n  var setNormalTopicStyle = function setNormalTopicStyle(style) {\n    setTheme(merge(theme, {\n      normalTopic: style\n    }));\n  };\n\n  var rootTopicEditorProps = {\n    topicStyle: rootTopic,\n    setTopicStyle: setRootTopicStyle\n  };\n  var rootTopicEditor = createElement(TopicThemeEditor, _assign({}, rootTopicEditorProps));\n  var primaryTopicEditorProps = {\n    topicStyle: primaryTopic,\n    setTopicStyle: setPrimaryTopicStyle\n  };\n  var primaryTopicEditor = createElement(TopicThemeEditor, _assign({}, primaryTopicEditorProps));\n  var normalTopicEditorProps = {\n    topicStyle: normalTopic,\n    setTopicStyle: setNormalTopicStyle\n  };\n  var normalTopicEditor = createElement(TopicThemeEditor, _assign({}, normalTopicEditorProps));\n  var tabsProps = {\n    id: tabId,\n    handleTabIdChange: function handleTabIdChange(id) {\n      tabId = id;\n    }\n  };\n  var topicThemes = createElement(SettingBoxContainer, null, createElement(Tabs, _assign({}, tabsProps), createElement(Tab, {\n    id: \"normal\",\n    title: \"NormalTopic\",\n    panel: normalTopicEditor\n  }), createElement(Tab, {\n    id: \"primary\",\n    title: \"PrimaryTopic\",\n    panel: primaryTopicEditor\n  }), createElement(Tab, {\n    id: \"root\",\n    title: \"RootTopic\",\n    panel: rootTopicEditor\n  })));\n\n  var handleExportTheme = function handleExportTheme(e) {\n    // setShowExportDialog(true);\n    var text = JSON.stringify(theme);\n    browserDownloadText(text, 'blink-mind-theme.json');\n  };\n\n  var handleImportTheme = function handleImportTheme(e) {\n    browserOpenFile('.json,.txt').then(function (txt) {\n      var t = JSON.parse(txt);\n\n      if (!isThemeType(t)) {\n        setAlertThemeError(true);\n        return;\n      }\n\n      setTheme(t);\n    });\n  };\n\n  var alertProps = {\n    isOpen: alertThemeError,\n    onClose: function onClose(e) {\n      setAlertThemeError(false);\n    }\n  };\n  var alert = createElement(Alert, _assign({}, alertProps), createElement(\"p\", null, \"File format error\"));\n  return createElement(PanelTabRoot, null, createElement(SettingGroup, null, createElement(SettingTitle, null, \"Global\"), createElement(SettingRow, null, createElement(SettingLabel, null, \"Background:\"), createElement(SettingItemColorPicker, {\n    color: theme.background,\n    handleColorChange: handleBackgroundColorChange\n  }), createElement(SettingLabel, null, \"Highlight:\"), createElement(SettingItemColorPicker, {\n    color: theme.highlightColor,\n    handleColorChange: handleHighlightColorChange\n  }), createElement(SettingLabel, null, \"Random Color:\"), createElement(StyledCheckbox, {\n    checked: theme.randomColor,\n    onChange: handleRandomColorChange\n  }))), topicThemes, createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: \"Export Theme\",\n    handleClick: handleExportTheme\n  }), createElement(SettingItemButton, {\n    title: \"Import Theme\",\n    handleClick: handleImportTheme\n  })), alert);\n}\n\nfunction RightTopPanelPlugin() {\n  var selectedTabId = 'topic-style';\n\n  var handleTabIdChange = function handleTabIdChange(tabId) {\n    selectedTabId = tabId;\n  };\n\n  return {\n    renderRightTopPanel: function renderRightTopPanel(props) {\n      var nProps = _assign(_assign({}, props), {\n        key: 'right-top-panel',\n        selectedTabId: selectedTabId,\n        handleTabIdChange: handleTabIdChange\n      });\n\n      return createElement(RightTopPanel, _assign({}, nProps));\n    },\n    renderRightTopPanelTabs: function renderRightTopPanelTabs(props) {\n      var controller = props.controller;\n      var styleEditorTab = controller.run('renderTopicStyleEditor', props);\n      var themeEditorTab = controller.run('renderThemeEditor', props);\n      return [styleEditorTab, themeEditorTab];\n    },\n    renderTopicStyleEditor: function renderTopicStyleEditor(props) {\n      var tProps = {\n        id: 'topic-style',\n        key: 'topic-style',\n        title: 'TopicStyle',\n        panel: createElement(StyleEditor, _assign({}, props))\n      };\n      return createElement(Tab, _assign({}, tProps));\n    },\n    renderThemeEditor: function renderThemeEditor(props) {\n      var tProps = {\n        id: 'theme-editor',\n        key: 'theme-editor',\n        title: 'Theme',\n        panel: createElement(ThemeEditor, _assign({}, props))\n      };\n      return createElement(Tab, _assign({}, tProps));\n    }\n  };\n}\n\nvar log$g = debug('plugin:utils');\n\nfunction UtilsPlugin() {\n  var tempValueMap = new Map();\n  var eventListenerMap = new Map();\n  return {\n    addTempValueChangeListener: function addTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (!eventListenerMap.has(key)) {\n        eventListenerMap.set(key, []);\n      }\n\n      eventListenerMap.get(key).push(listener);\n    },\n    removeTempValueChangeListener: function removeTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListenerMap.has(key)) {\n        eventListenerMap[key] = eventListenerMap.get(key).filter(function (l) {\n          return l !== listener;\n        });\n      }\n    },\n    getTempValue: function getTempValue(props) {\n      var key = props.key;\n      log$g('getTempValue', key);\n      return tempValueMap.get(key);\n    },\n    setTempValue: function setTempValue(props) {\n      var e_1, _a;\n\n      var key = props.key,\n          value = props.value;\n      log$g('setTempValue', key);\n      tempValueMap.set(key, value);\n\n      if (eventListenerMap.has(key)) {\n        var listeners = eventListenerMap.get(key);\n\n        try {\n          for (var listeners_1 = __values(listeners), listeners_1_1 = listeners_1.next(); !listeners_1_1.done; listeners_1_1 = listeners_1.next()) {\n            var listener = listeners_1_1.value;\n            listener(value);\n          }\n        } catch (e_1_1) {\n          e_1 = {\n            error: e_1_1\n          };\n        } finally {\n          try {\n            if (listeners_1_1 && !listeners_1_1.done && (_a = listeners_1.return)) _a.call(listeners_1);\n          } finally {\n            if (e_1) throw e_1.error;\n          }\n        }\n      }\n    },\n    deleteTempValue: function deleteTempValue(props) {\n      var key = props.key;\n      log$g('deleteTempValue', key);\n      var value = tempValueMap.get(key);\n      tempValueMap.delete(key);\n      return value;\n    }\n  };\n}\n\nfunction ReactPlugin(options) {\n  return [RenderingPlugin(), UtilsPlugin(), ContextMenuPlugin(), RightTopPanelPlugin(), DragAndDropPlugin()];\n}\n\nvar log$h = debug('plugin:StylePlugin');\n\nfunction StylePlugin() {\n  var colorMap = new Map();\n  var colorIndex = 0;\n  return {\n    getTopicStyle: function getTopicStyle(props) {\n      var controller = props.controller;\n      return {\n        contentStyle: controller.run('getTopicContentStyle', props),\n        linkStyle: controller.run('getLinkStyle', props),\n        subLinkStyle: controller.run('getSubLinkStyle', props)\n      };\n    },\n    getTopicContentStyle: function getTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$h('getTopicContentStyle:', topicKey, model);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;else if (visualLevel === TopicVisualLevel.PRIMARY) themeStyle = theme.primaryTopic;else themeStyle = theme.normalTopic;\n      themeStyle = _assign(_assign({}, theme.contentStyle), themeStyle.contentStyle);\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        themeStyle = _assign(_assign({}, themeStyle), {\n          background: randomColor,\n          borderColor: randomColor,\n          subLinkStyle: _assign(_assign({}, themeStyle.subLinkStyle), {\n            lineColor: randomColor\n          })\n        });\n      }\n\n      var topic = model.getTopic(topicKey);\n\n      if (!topic.style) {\n        return themeStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _assign(_assign({}, themeStyle), customStyle.contentStyle);\n    },\n    getLinkStyle: function getLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$h('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var linkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.linkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.linkStyle;else presetStyle = theme.normalTopic.linkStyle;\n      linkStyle = _assign(_assign({}, linkStyle), presetStyle);\n      var topic = model.getTopic(topicKey);\n\n      if (topic.parentKey != null) {\n        var parentSubLinkStyle = controller.run('getSubLinkStyle', _assign(_assign({}, props), {\n          topicKey: topic.parentKey\n        }));\n        linkStyle = _assign(_assign({}, linkStyle), parentSubLinkStyle);\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _assign(_assign({}, linkStyle), customStyle.linkStyle);\n    },\n    getSubLinkStyle: function getSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$h('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var subLinkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.subLinkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.subLinkStyle;else presetStyle = theme.normalTopic.subLinkStyle;\n      subLinkStyle = _assign(_assign({}, subLinkStyle), presetStyle);\n      var topic = model.getTopic(topicKey); // 获取父节点的color\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        log$h(randomColor);\n        subLinkStyle = _assign(_assign({}, subLinkStyle), {\n          lineColor: randomColor\n        });\n      }\n\n      if (!topic.style) {\n        return subLinkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n\n      var res = _assign(_assign({}, subLinkStyle), customStyle.subLinkStyle); // if (res.lineRadius == null) res.lineRadius = 5;\n\n\n      return res;\n    },\n    setTopicContentStyle: function setTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          style = props.style,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var topicStyle = topic.style;\n      var styleObj = topicStyle ? JSON.parse(topicStyle) : {};\n\n      var newStyleObj = _assign(_assign({}, styleObj), {\n        contentStyle: _assign(_assign({}, styleObj.contentStyle), style)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setLinkStyle: function setLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          linkStyle = props.linkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _assign(_assign({}, styleObj), {\n        linkStyle: _assign(_assign({}, styleObj.linkStyle), linkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setSubLinkStyle: function setSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          subLinkStyle = props.subLinkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _assign(_assign({}, styleObj), {\n        subLinkStyle: _assign(_assign({}, styleObj.subLinkStyle), subLinkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    getTopicThemeStyle: function getTopicThemeStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model;\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n    getRandomColor: function getRandomColor(props) {\n      var topicKey = props.topicKey;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      var colors = ['#00CC99', '#FFEE88', '#A167A5', '#E5F993', '#F5C396', '#DB995A', '#83BCFF', '#ED7B84', '#739E82', '#D3BCC0', '#FFA0FD', '#EFD3D7', '#C6878F'];\n      var color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      log$h('getRandomColor', topicKey, color);\n      return color;\n    },\n    clearAllCustomStyle: function clearAllCustomStyle(props) {\n      var model = props.model,\n          controller = props.controller;\n      var newModel = model.withMutations(function (model) {\n        model.topics.keySeq().forEach(function (key) {\n          model.setIn(['topics', key, 'style'], null);\n        });\n      });\n      controller.change(newModel);\n    }\n  };\n}\n\nfunction DefaultPlugin() {\n  return [ReactPlugin(), LayoutPlugin(), OperationPlugin(), StylePlugin(), EventPlugin(), HotKeyPlugin(), GetValuePlugin(), SimpleTextEditorPlugin()];\n}\n\nvar log$i = debug('node:Diagram');\n\nvar Diagram =\n/** @class */\nfunction (_super) {\n  __extends(Diagram, _super);\n\n  function Diagram() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.resolveController = memoizeOne(function (plugins, TheDefaultPlugin) {\n      if (plugins === void 0) {\n        plugins = [];\n      }\n\n      var defaultPlugin = TheDefaultPlugin();\n      _this.controller = new Controller({\n        plugins: [plugins, defaultPlugin],\n        construct: false,\n        onChange: _this.props.onChange\n      }); // this.controller.run('onConstruct');\n    });\n    return _this;\n  }\n\n  Diagram.prototype.getDiagramProps = function () {\n    return this.controller.run('getDiagramProps');\n  };\n\n  Diagram.prototype.openNewModel = function (newModel) {\n    var _this = this;\n\n    var props = this.getDiagramProps();\n    var model = props.model,\n        controller = props.controller;\n    controller.run('deleteRefKey', _assign(_assign({}, props), {\n      topicKey: model.rootTopicKey\n    }));\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.EXPAND_TO,\n      topicKey: newModel.focusKey,\n      model: newModel,\n      callback: function callback() {\n        var props = _this.getDiagramProps();\n\n        var model = props.model;\n        controller.run('moveTopicToCenter', _assign(_assign({}, props), {\n          topicKey: model.focusKey\n        }));\n      }\n    }));\n  };\n\n  Diagram.prototype.render = function () {\n    var plugins = this.props.plugins;\n    this.resolveController(plugins, DefaultPlugin);\n    this.diagramProps = _assign(_assign({}, this.props), {\n      controller: this.controller\n    });\n    return this.controller.run('renderDiagram', this.diagramProps);\n  };\n\n  return Diagram;\n}(Component);\n\nexport { BaseWidget, Btn, CloseIcon, DefaultPlugin, Diagram, DragScrollWidget, EventKey, Flex, HotKeyName, HotKeyPlugin, Icon, IconBg, IconName, Margin, PanelTabRoot, PropKey, RefKey, SaveRef, ShowMenuIcon, StyledCheckbox, Title, TopicBlockIcon, ZIndex, browserDownloadFile, browserDownloadText, browserOpenFile, cancelEvent, center, centerPointX, centerPointY, centerX, centerY, collapseRefKey, contentEditorRefKey, contentRefKey, descEditorRefKey, dropAreaRefKey, getLinkKey, _getRelativeRect as getRelativeRect, getRelativeVector, iconClassName, linksRefKey, linksSvgRefKey, paddingCss, topicRefKey, topicWidgetRefKey };","import * as React from 'react';\n\nimport { BaseProps } from './base-props';\n\nexport class BaseWidget<\n  P extends BaseProps = BaseProps,\n  S = any\n> extends React.PureComponent<P, S> {\n  constructor(props: P) {\n    super(props);\n  }\n\n  operation(opType: string, arg: any) {\n    this.props.controller.run('operation', {\n      opType,\n      ...arg\n    });\n  }\n\n  run(name: string, arg: any) {\n    this.props.controller.run(name, arg);\n  }\n\n  get topic() {\n    return this.props.model.getTopic(this.props.topicKey);\n  }\n}\n","import * as React from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled from 'styled-components';\n\nimport debug from 'debug';\nconst log = debug('node:drag-scroll-widget');\n\nconst DragScrollView = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n`;\n\nconst DragScrollContent = styled.div`\n  position: relative;\n  width: max-content;\n`;\n\nconst useWindowListener = false;\n\ninterface DragScrollWidgetProps {\n  mouseKey?: 'left' | 'right';\n  needKeyPressed?: boolean;\n  canDragFunc?: () => Boolean;\n  enableMouseWheel: boolean;\n  zoomFactor: number;\n  children: (\n    setViewBoxScroll: (left: number, top: number) => void,\n    setViewBoxScrollDelta: (left: number, top: number) => void\n  ) => React.ReactNode;\n}\n\nexport class DragScrollWidget extends React.Component<\n  DragScrollWidgetProps,\n  any\n> {\n  constructor(props: DragScrollWidgetProps) {\n    super(props);\n    this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n  }\n\n  static defaultProps = {\n    mouseKey: 'left',\n    needKeyPressed: false\n  };\n\n  contentResizeCallback = (\n    entries: ResizeObserverEntry[],\n    observer: ResizeObserver\n  ) => {\n    if (this.oldContentRect) {\n      const widgetStyle = {\n        width: this.content.clientWidth + this.viewBox.clientWidth * 2,\n        height: this.content.clientHeight + this.viewBox.clientHeight * 2\n      };\n      this.bigView.style.width = widgetStyle.width + 'px';\n      this.bigView.style.height = widgetStyle.height + 'px';\n    }\n    this.oldContentRect = entries[0].contentRect;\n  };\n\n  contentResizeObserver = new ResizeObserver(this.contentResizeCallback);\n  // oldScroll: { left: number; top: number };\n  oldContentRect: any;\n  content: HTMLElement;\n  contentRef = ref => {\n    if (ref) {\n      this.content = ref;\n      this.contentResizeObserver.observe(this.content);\n    }\n  };\n\n  viewBox: HTMLElement;\n  viewBoxRef = ref => {\n    if (ref) {\n      this.viewBox = ref;\n      if (!this.props.enableMouseWheel) {\n        log('addEventListener onwheel');\n        this.viewBox.addEventListener(\n          'wheel',\n          function(e) {\n            log('onwheel');\n            (e.ctrlKey || e.altKey) && e.preventDefault();\n          },\n          {\n            passive: false\n          }\n        );\n      }\n      this.setViewBoxScroll(\n        this.viewBox.clientWidth,\n        this.viewBox.clientHeight\n      );\n    }\n  };\n\n  bigView: HTMLElement;\n  bigViewRef = ref => {\n    if (ref) {\n      this.bigView = ref;\n    }\n  };\n\n  setWidgetStyle = () => {\n    if (this.content && this.viewBox && this.bigView) {\n      this.bigView.style.width =\n        (this.content.clientWidth + this.viewBox.clientWidth) * 2 + 'px';\n      this.bigView.style.height =\n        (this.content.clientHeight + this.viewBox.clientHeight) * 2 + 'px';\n\n      this.content.style.left = this.viewBox.clientWidth + 'px';\n      this.content.style.top = this.viewBox.clientHeight + 'px';\n    }\n  };\n\n  setViewBoxScroll = (left: number, top: number) => {\n    log(`setViewBoxScroll ${left} ${top}`);\n    if (this.viewBox) {\n      this.viewBox.scrollLeft = left;\n      this.viewBox.scrollTop = top;\n    }\n  };\n\n  setViewBoxScrollDelta = (deltaLeft: number, deltaTop: number) => {\n    log(`setViewBoxScrollDelta ${deltaLeft} ${deltaTop}`);\n    if (this.viewBox) {\n      this.viewBox.scrollLeft += deltaLeft;\n      this.viewBox.scrollTop += deltaTop;\n    }\n  };\n\n  onMouseDown = e => {\n    // log('Drag Scroll onMouseDown');\n    // log(e.nativeEvent.target);\n\n    // mouseKey 表示鼠标按下那个键才可以进行拖动，左键或者右键\n    // needKeyPressed 为了支持是否需要按下ctrl键，才可以进行拖动\n    // canDragFunc是一个函数，它是为了支持使用者以传入函数的方式，这个函数的返回值表示当前的内容是否可以被拖拽而移动\n    const { mouseKey, needKeyPressed, canDragFunc } = this.props;\n    if (canDragFunc && !canDragFunc()) return;\n    if (\n      (e.button === 0 && mouseKey === 'left') ||\n      (e.button === 2 && mouseKey === 'right')\n    ) {\n      if (needKeyPressed) {\n        if (!e.ctrlKey) return;\n      }\n      this._lastCoordX = this.viewBox.scrollLeft + e.nativeEvent.clientX;\n      this._lastCoordY = this.viewBox.scrollTop + e.nativeEvent.clientY;\n\n      const ele = useWindowListener ? window : this.viewBox;\n      ele.addEventListener('mousemove', this.onMouseMove);\n      ele.addEventListener('mouseup', this.onMouseUp);\n    }\n  };\n\n  onMouseUp = e => {\n    const ele = useWindowListener ? window : this.viewBox;\n    ele.removeEventListener('mousemove', this.onMouseMove);\n    ele.removeEventListener('mouseup', this.onMouseUp);\n  };\n\n  // _lastCoordX和_lastCorrdY 是为了在拖动过程中 计算 viewBox的scrollLeft和scrollTop值用到\n  // _lastCoordX和_lastCorrdY 记录下拖动开始时刻viewBox的scroll值和鼠标位置值\n  _lastCoordX: number;\n  _lastCoordY: number;\n\n  onMouseMove = (e: MouseEvent) => {\n    this.viewBox.scrollLeft = this._lastCoordX - e.clientX;\n    this.viewBox.scrollTop = this._lastCoordY - e.clientY;\n    // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n  };\n\n  handleContextMenu = e => {\n    e.preventDefault();\n  };\n\n  componentDidMount(): void {\n    this.setWidgetStyle();\n    document.addEventListener('contextmenu', this.handleContextMenu);\n  }\n\n  componentWillUnmount(): void {\n    document.removeEventListener('contextmenu', this.handleContextMenu);\n  }\n\n  setZoomFactor(zoomFactor) {\n    this.bigView.style.transform = `scale(${zoomFactor})`;\n    this.bigView.style.transformOrigin = '50% 50%';\n  }\n\n  render() {\n    const style = {\n      ...this.state.widgetStyle\n      // zoom:this.props.zoomFactor,\n      // transform: `scale(${this.props.zoomFactor})`,\n      // transformOrigin: '50% 50%'\n    };\n    return (\n      <DragScrollView ref={this.viewBoxRef} onMouseDown={this.onMouseDown}>\n        <div style={style} ref={this.bigViewRef}>\n          <DragScrollContent\n            ref={this.contentRef}\n            style={this.state.contentStyle}\n          >\n            {this.props.children(\n              this.setViewBoxScroll,\n              this.setViewBoxScrollDelta\n            )}\n          </DragScrollContent>\n        </div>\n      </DragScrollView>\n    );\n  }\n}\n","import debug from 'debug';\nimport * as React from 'react';\n\nconst log = debug('node:save-ref');\n\ninterface SaveRefProps {\n  children: (\n    saveRef: Function,\n    getRef: Function,\n    deleteRef: Function,\n    registerRefListener: Function\n  ) => React.ReactNode;\n}\n\ntype RefListener = (name: string, ref: HTMLElement) => void;\n\n//TODO 可能会引起内存泄露,在删除一个topic时\nexport class SaveRef extends React.Component<SaveRefProps> {\n  getRef = name => {\n    log(this);\n    return this[name];\n  };\n\n  saveRef = name => {\n    return node => {\n      if (node) {\n        this[name] = node;\n        this.fireListener(name, node);\n      }\n    };\n  };\n\n  deleteRef = name => {\n    log('deleteRef:', name);\n    delete this[name];\n  };\n\n  observers: Map<string, [RefListener]> = new Map();\n\n  fireListener = (name: string, ref: HTMLElement) => {\n    if (this.observers.has(name)) {\n      const listeners = this.observers.get(name);\n      for (const listener of listeners) {\n        listener(name, ref);\n      }\n    }\n  };\n\n  registerRefListener = (name, listener: RefListener) => {\n    if (!this.observers.has(name)) {\n      this.observers.set(name, [listener]);\n    } else {\n      this.observers.get(name).push(listener);\n    }\n  };\n\n  render() {\n    return this.props.children(\n      this.saveRef,\n      this.getRef,\n      this.deleteRef,\n      this.registerRefListener.bind(this)\n    );\n  }\n}\n","import { Checkbox } from '@blueprintjs/core';\nimport styled from 'styled-components';\n\nexport const Flex = styled.div`\n  display: flex;\n  flex-direction: ${props =>\n    props.flexDirection ? props.flexDirection : 'row'};\n  align-items: ${props => props.alignItems};\n  justify-content: ${props => props.justifyContent};\n`;\n\nexport const Margin = styled.div`\n  margin: ${props => props.margin};\n`;\n\nexport const ShowMenuIcon = styled.a`\n  font-size: 20px !important;\n`;\n\nexport const IconBg = styled.div`\n  padding: 5px;\n  cursor: pointer;\n`;\n\nexport const Btn = styled.div`\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n`;\n\nexport const StyledCheckbox = styled(Checkbox)`\n  margin-bottom: 0px !important;\n`;\n\nexport const CloseIcon = styled(Btn)`\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n`;\n\nexport const Title = styled.div`\n  height: 16px;\n`;\n\nexport const TopicBlockIcon = styled.span`\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n`;\n\nexport const ZIndex = styled.div`\n  z-index: ${props => props.zIndex};\n`;\n\nexport const PanelTabRoot = styled.div`\n  min-width: 360px;\n  max-height: 470px;\n  overflow: auto;\n`;\n","import { FocusMode, OpType } from '@blink-mind/core';\n\nimport debug from 'debug';\n\nconst log = debug('plugin:event');\n\nexport function EventPlugin() {\n  const eventListeners = {};\n  return {\n    handleTopicClick(props) {\n      log('handleTopicClick');\n      const { controller, model, topicKey } = props;\n      log(model.zoomFactor);\n      //TODO\n      if (model.editingDescKey !== null) return;\n      if (model.editingContentKey === topicKey) return;\n      if (\n        model.focusKey === topicKey &&\n        model.focusMode === FocusMode.EDITING_CONTENT\n      )\n        return;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      });\n    },\n\n    handleTopicDoubleClick(props) {\n      const { controller, model } = props;\n      if (model.editingDescKey !== null) return;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      });\n    },\n\n    handleTopicContextMenu(props) {\n      const { controller } = props;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      });\n    },\n\n    handleActiveModalClose(props) {\n      const { controller } = props;\n      const activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n      if (activeModalProps.name === 'edit-desc') {\n        return function() {\n          controller.run('operation', {\n            ...props,\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          });\n        };\n      }\n    },\n\n    addEventListener(props) {\n      const { key, listener, once, controller } = props;\n      if (!eventListeners[key]) eventListeners[key] = [];\n      if (once) {\n        only.origin = listener;\n        eventListeners[key].push(only);\n      } else {\n        eventListeners[key].push(listener);\n      }\n\n      function only() {\n        listener();\n        controller.run('removeEventListener', {\n          key,\n          listener\n        });\n      }\n    },\n\n    removeEventListener(props) {\n      const { key, listener } = props;\n      if (eventListeners[key]) {\n        eventListeners[key] = eventListeners[key].filter(fn => {\n          return fn !== listener && fn.origin !== listener;\n        });\n      }\n    },\n\n    fireEvent(props) {\n      const { key } = props;\n      if (eventListeners[key]) {\n        eventListeners[key].forEach(fn => fn());\n      }\n    }\n  };\n}\n","import * as React from 'react';\nexport const IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes',\n  PLUS: 'plus',\n  MINUS: 'minus',\n  COLLAPSE_ALL: 'collapse',\n  EXPAND_ALL: 'expand',\n  CENTER: 'center',\n  TRASH: 'trash',\n  SEARCH: 'search',\n  THEME: 'theme',\n  EXPORT: 'export',\n  OPEN_FILE: 'openfile'\n};\n\nexport function iconClassName(name) {\n  return `icon iconfont bm-${name}`;\n}\n\nexport function Icon(iconName) {\n  return <span className={iconClassName(iconName)} />;\n}\n","export function contentRefKey(key) {\n  return `content-${key}`;\n}\n\nexport function contentEditorRefKey(key) {\n  return `content-editor-${key}`;\n}\n\nexport function descEditorRefKey(key) {\n  return `desc-editor-${key}`;\n}\n\nexport function topicWidgetRefKey(key) {\n  return `topic-widget-${key}`;\n}\n\nexport function topicRefKey(key) {\n  return `topic-${key}`;\n}\n\nexport function linksRefKey(key) {\n  return `links-${key}`;\n}\n\nexport function linksSvgRefKey(key) {\n  return `links-svg-${key}`;\n}\n\nexport function collapseRefKey(key) {\n  return `collapse-${key}`;\n}\n\nexport function dropAreaRefKey(key, dir) {\n  return `dropArea-${dir}-${key}`;\n}\n\nexport const RefKey = {\n  DIAGRAM_ROOT_KEY: 'DIAGRAM-ROOT',\n  DRAG_SCROLL_WIDGET_KEY: 'DragScrollWidget',\n  SVG_HIGHLIGHT_KEY: 'svg-highlight',\n  FOCUS_HIGHLIGHT_KEY: 'focus-highlight',\n  DROP_EFFECT_KEY: 'drop-effect'\n};\nexport const EventKey = {\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC'\n};\n\nexport const PropKey = {\n  DIAGRAM_CUSTOMIZE_BASE_Z_INDEX: 'DIAGRAM_CUSTOMIZE_BASE_Z_INDEX',\n  TOPIC_CONTEXT_MENU_ENABLED: 'TOPIC_CONTEXT_MENU_ENABLED',\n  TOPIC_TITLE: 'TOPIC_TITLE'\n};\n","export const cancelEvent = e => {\n  e.stopPropagation();\n};\n","export function browserDownloadFile(url: string, filename: string) {\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  link.click();\n}\n\nexport function browserDownloadText(text: string, filename: string) {\n  const url = `data:text/plain,${encodeURIComponent(text)}`;\n  browserDownloadFile(url, filename);\n}\n\nexport function browserOpenFile(accept: string): Promise<any> {\n  const input = document.createElement('input');\n  input.type = 'file';\n  input.accept = accept;\n\n  return new Promise<string>((resolve, reject) => {\n    input.addEventListener('change', evt => {\n      //@ts-ignore\n      const file = evt.target.files[0];\n      const fr = new FileReader();\n\n      fr.onload = (evt: ProgressEvent<FileReader>) => {\n        const txt = evt.target.result;\n        //@ts-ignore\n        resolve(txt);\n      };\n      fr.onerror = (evt: ProgressEvent<FileReader>) => {\n        reject(evt.target.error);\n      };\n      fr.readAsText(file);\n    });\n    input.click();\n  });\n}\n","export function paddingCss(arg: {\n  top: number;\n  right: number;\n  bottom: number;\n  left: number;\n}) {\n  const { top = 0, right = 0, bottom = 0, left = 0 } = arg;\n  return `${top}px ${right}px ${bottom}px ${left}px`;\n}\n","export function createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    const r = (Math.random() * 16) | 0,\n      v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n","import { OpType } from '@blink-mind/core';\n\nexport interface HotKeyItem {\n  label: string;\n  combo: string;\n  onKeyDown: (e: KeyboardEvent) => any;\n}\n\nexport type HotKeyMap = Map<string, HotKeyItem>;\n\nexport interface HotKeysConfig {\n  topicHotKeys: HotKeyMap;\n  globalHotKeys: HotKeyMap;\n}\n\nexport const HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_CONTENT: 'EDIT_CONTENT',\n  EDIT_NOTES: 'EDIT_NOTES',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\n\nfunction op(opType: string, props) {\n  const { topicKey, model, controller } = props;\n  if (topicKey === undefined) {\n    props = { ...props, topicKey: model.focusKey };\n  }\n  controller.run('operation', { ...props, opType });\n}\n\nexport function HotKeyPlugin() {\n  return {\n    customizeHotKeys(props): HotKeysConfig {\n      const handleKeyDown = opType => e => {\n        // log('HotKeyPlugin', opType);\n        op(opType, props);\n      };\n      const topicHotKeys = new Map<string, HotKeyItem>([\n        [\n          HotKeyName.ADD_CHILD,\n          {\n            label: 'add child',\n            combo: 'tab',\n            onKeyDown: handleKeyDown(OpType.ADD_CHILD)\n          }\n        ],\n        [\n          HotKeyName.ADD_SIBLING,\n          {\n            label: 'add sibling',\n            combo: 'enter',\n            onKeyDown: handleKeyDown(OpType.ADD_SIBLING)\n          }\n        ],\n        [\n          HotKeyName.DELETE_TOPIC,\n          {\n            label: 'delete topic',\n            combo: 'del',\n            onKeyDown: handleKeyDown(OpType.DELETE_TOPIC)\n          }\n        ],\n        [\n          HotKeyName.EDIT_CONTENT,\n          {\n            label: 'edit content',\n            combo: 'space',\n            onKeyDown: handleKeyDown(OpType.START_EDITING_CONTENT)\n          }\n        ],\n        [\n          HotKeyName.EDIT_NOTES,\n          {\n            label: 'edit notes',\n            combo: 'alt + d',\n            onKeyDown: handleKeyDown(OpType.START_EDITING_DESC)\n          }\n        ],\n        [\n          HotKeyName.SET_EDITOR_ROOT,\n          {\n            label: 'set editor root',\n            combo: 'alt + shift + f',\n            onKeyDown: handleKeyDown(OpType.SET_EDITOR_ROOT)\n          }\n        ]\n      ]);\n      const globalHotKeys = new Map();\n      return {\n        topicHotKeys,\n        globalHotKeys\n      };\n    }\n  };\n}\n","import {\n  BaseModifierArg,\n  BlockType,\n  FocusMode,\n  getAllSubTopicKeys,\n  Model,\n  ModelModifier,\n  OpType\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport { List, Stack } from 'immutable';\nimport {\n  collapseRefKey,\n  contentEditorRefKey,\n  contentRefKey,\n  descEditorRefKey,\n  dropAreaRefKey,\n  linksRefKey,\n  linksSvgRefKey,\n  topicRefKey,\n  topicWidgetRefKey\n} from '../utils';\nconst log = debug('plugin:operation');\n\nexport function OperationPlugin() {\n  const startEditingContent = ({ model, topicKey }: BaseModifierArg) => {\n    return ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n  const startEditingDesc = ({ model, topicKey }: BaseModifierArg) => {\n    const topic = model.getTopic(topicKey);\n    const desc = topic.getBlock(BlockType.DESC);\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setBlockData({\n        model,\n        topicKey,\n        blockType: BlockType.DESC,\n        data: ''\n      });\n    }\n    model = ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n    return model;\n  };\n\n  function dragAndDrop(props) {\n    const { srcKey, dstKey, dropDir } = props;\n    let { model } = props;\n    const srcTopic = model.getTopic(srcKey);\n    const dstTopic = model.getTopic(dstKey);\n\n    const srcParentKey = srcTopic.parentKey;\n    const srcParentTopic = model.getTopic(srcParentKey);\n    let srcParentSubKeys = srcParentTopic.subKeys;\n    const srcIndex = srcParentSubKeys.indexOf(srcKey);\n\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      let dstSubKeys = dstTopic.subKeys;\n      dstSubKeys = dstSubKeys.push(srcKey);\n      model = model.withMutations(m => {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys)\n          .setIn(['topics', srcKey, 'parentKey'], dstKey)\n          .setIn(['topics', dstKey, 'subKeys'], dstSubKeys)\n          .setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      const dstParentKey = dstTopic.parentKey;\n      const dstParentItem = model.getTopic(dstParentKey);\n      let dstParentSubKeys = dstParentItem.subKeys;\n      const dstIndex = dstParentSubKeys.indexOf(dstKey);\n      //src 和 dst 的父亲相同，这种情况要做特殊处理\n      if (srcParentKey === dstParentKey) {\n        let newDstParentSubKeys = List();\n        dstParentSubKeys.forEach(key => {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys = newDstParentSubKeys\n                  .push(srcKey)\n                  .push(key);\n              } else {\n                newDstParentSubKeys = newDstParentSubKeys\n                  .push(key)\n                  .push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys = newDstParentSubKeys.push(key);\n            }\n          }\n        });\n        model = model.withMutations(m => {\n          m.setIn(['topics', dstParentKey, 'subKeys'], newDstParentSubKeys);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex + 1, srcKey);\n        }\n        model = model.withMutations(m => {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys)\n            .setIn(['topics', srcKey, 'parentKey'], dstParentKey)\n            .setIn(['topics', dstParentKey, 'subKeys'], dstParentSubKeys)\n            .setIn(['topics', dstParentKey, 'collapse'], false);\n        });\n      }\n    }\n    return model;\n  }\n  const OpMap = new Map([\n    [OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse],\n    [OpType.COLLAPSE_ALL, ModelModifier.collapseAll],\n    [OpType.EXPAND_ALL, ModelModifier.expandAll],\n    [OpType.EXPAND_TO, ModelModifier.expandTo],\n    [OpType.ADD_CHILD, ModelModifier.addChild],\n    [OpType.ADD_SIBLING, ModelModifier.addSibling],\n    [OpType.DELETE_TOPIC, ModelModifier.deleteTopic],\n    [OpType.FOCUS_TOPIC, ModelModifier.focusTopic],\n    [OpType.SET_FOCUS_MODE, ModelModifier.setFocusMode],\n    [OpType.SET_STYLE, ModelModifier.setStyle],\n    [OpType.SET_THEME, ModelModifier.setTheme],\n    [OpType.SET_TOPIC_BLOCK, ModelModifier.setBlockData],\n    [OpType.DELETE_TOPIC_BLOCK, ModelModifier.deleteBlock],\n    [OpType.START_EDITING_CONTENT, startEditingContent],\n    [OpType.START_EDITING_DESC, startEditingDesc],\n    [OpType.DRAG_AND_DROP, dragAndDrop],\n    [OpType.SET_EDITOR_ROOT, ModelModifier.setEditorRootTopicKey]\n  ]);\n\n  let undoStack = Stack<Model>();\n  let redoStack = Stack<Model>();\n\n  let enabled = true;\n  let whiteListOperation = new Set<string>();\n\n  return {\n    isOperationEnabled(props) {\n      return enabled;\n    },\n\n    enableOperation() {\n      enabled = true;\n    },\n\n    disableOperation({ whiteList }) {\n      enabled = false;\n      if (whiteList) whiteListOperation = new Set(whiteList);\n      else whiteListOperation.clear();\n    },\n\n    /** plugin can extend Operation Map\n     * for example: A plugin can write a function\n     * getOpMap(props,next) {\n     *   let opMap = next();\n     *   opMap.set(\"OpTypeName\",opFunc);\n     *   return opMap;\n     * }\n     * @param props\n     */\n    getOpMap(props) {\n      return OpMap;\n    },\n    getAllowUndo(props) {\n      const { model, opType } = props;\n      if (opType) {\n        switch (opType) {\n          case OpType.FOCUS_TOPIC:\n          case OpType.START_EDITING_CONTENT:\n          case OpType.START_EDITING_DESC:\n            return false;\n          default:\n            break;\n        }\n      }\n      switch (model.focusMode) {\n        case 'EDITING_DESC':\n        case 'EDITING_CONTENT':\n          return false;\n      }\n      return model.config.allowUndo;\n    },\n\n    getUndoRedoStack() {\n      return {\n        undoStack,\n        redoStack\n      };\n    },\n\n    setUndoStack(props) {\n      log('setUndoStack', props.undoStack);\n      undoStack = props.undoStack;\n    },\n\n    setRedoStack(props) {\n      log('setRedoStack', props.redoStack);\n      redoStack = props.redoStack;\n    },\n\n    canUndo(props) {\n      const { controller } = props;\n      const { undoStack } = controller.run('getUndoRedoStack', props);\n      const allowUndo = controller.run('getAllowUndo', props);\n      return undoStack.size > 0 && allowUndo;\n    },\n\n    canRedo(props) {\n      const { controller } = props;\n      const { redoStack } = controller.run('getUndoRedoStack', props);\n      const allowUndo = controller.run('getAllowUndo', props);\n      return redoStack.size > 0 && allowUndo;\n    },\n\n    undo(props) {\n      const { controller, model } = props;\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n      const { undoStack, redoStack } = controller.run(\n        'getUndoRedoStack',\n        props\n      );\n      const newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', {\n        ...props,\n        undoStack: undoStack.shift()\n      });\n      controller.run('setRedoStack', {\n        ...props,\n        redoStack: redoStack.push(model)\n      });\n      log(newModel);\n      controller.change(newModel);\n    },\n\n    redo(props) {\n      const { controller, model } = props;\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n      const { undoStack, redoStack } = controller.run(\n        'getUndoRedoStack',\n        props\n      );\n      const newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', {\n        ...props,\n        undoStack: undoStack.push(model)\n      });\n      controller.run('setRedoStack', {\n        ...props,\n        redoStack: redoStack.shift()\n      });\n      controller.change(newModel);\n    },\n\n    //TODO 有空重构这个函数\n    operation(props) {\n      const { controller, opType, model, opArray, callback } = props;\n      if (opArray != null && !Array.isArray(opArray)) {\n        throw new Error('operation: the type of opArray must be array!');\n      }\n      if (opType != null && opArray != null) {\n        throw new Error('operation: opType and opArray conflict!');\n      }\n      const isOperationEnabled = controller.run('isOperationEnabled', props);\n      if (!isOperationEnabled) {\n        // warning(\n        //   true,\n        //   `You have disabled operation,but you run operation ${props} now!`\n        // );\n        if (whiteListOperation.size === 0) return;\n\n        if (opArray != null) {\n          const opNotInWhiteList = opArray.filter(\n            op => !whiteListOperation.has(op.opType)\n          );\n          if (opNotInWhiteList && opNotInWhiteList.length > 0) {\n            return;\n          }\n        } else if (!whiteListOperation.has(opType)) {\n          return;\n        }\n      }\n\n      log('operation:', opType);\n      log('operation:', model);\n      log('operation:', props);\n\n      const opMap = controller.run('getOpMap', props);\n      controller.run('beforeOperation', props);\n      if (controller.run('getAllowUndo', props)) {\n        const { undoStack } = controller.run('getUndoRedoStack', props);\n        controller.run('setUndoStack', {\n          ...props,\n          undoStack: undoStack.push(model)\n        });\n      }\n      let newModel;\n\n      if (opArray != null) {\n        newModel = opArray.reduce((acc, cur) => {\n          const { opType } = cur;\n          if (!opMap.has(opType))\n            throw new Error(`opType:${opType} not exist!`);\n          const opFunc = opMap.get(opType);\n          const opFuncProps = { controller, ...cur, model: acc };\n          let res = controller.run('beforeOpFunction', opFuncProps);\n          res = opFunc({ ...opFuncProps, model: res });\n          res = controller.run('afterOpFunction', {\n            ...opFuncProps,\n            model: res\n          });\n          return res;\n        }, model);\n      } else {\n        if (!opMap.has(opType)) throw new Error(`opType:${opType} not exist!`);\n        const opFunc = opMap.get(opType);\n        newModel = controller.run('beforeOpFunction', props);\n        newModel = opFunc({ ...props, model: newModel });\n        newModel = controller.run('afterOpFunction', {\n          ...props,\n          model: newModel\n        });\n      }\n      log('newModel:', newModel);\n      controller.change(newModel, callback);\n      controller.run('afterOperation', props);\n    },\n\n    deleteRefKey(props) {\n      const { model, topicKey, deleteRef } = props;\n      const allSubKeys = getAllSubTopicKeys(model, topicKey);\n      allSubKeys.push(topicKey);\n      for (const key of allSubKeys) {\n        deleteRef(linksRefKey(key));\n        deleteRef(linksSvgRefKey(key));\n        deleteRef(contentRefKey(key));\n        deleteRef(contentEditorRefKey(key));\n        deleteRef(descEditorRefKey(key));\n        deleteRef(topicWidgetRefKey(key));\n        deleteRef(topicRefKey(key));\n        deleteRef(collapseRefKey(key));\n        deleteRef(dropAreaRefKey(key, 'next'));\n        deleteRef(dropAreaRefKey(key, 'prev'));\n      }\n    },\n\n    // 在整个Operation执行之前被调用\n    beforeOperation(props) {},\n    afterOperation(props) {},\n\n    // 在单个OpFunction执行之前被调用\n    beforeOpFunction(props) {\n      const { controller, opType, model, topicKey } = props;\n      if (\n        opType === OpType.DELETE_TOPIC &&\n        topicKey !== model.editorRootTopicKey\n      ) {\n        controller.run('deleteRefKey', props);\n      }\n      return model;\n    },\n\n    afterOpFunction(props) {\n      return props.model;\n    }\n  };\n}\n","import { Menu } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { BaseWidget } from '../../../components/common';\n\nexport class TopicContextMenu extends BaseWidget {\n  render() {\n    const { controller } = this.props;\n    return (\n      <Menu>{controller.run('customizeTopicContextMenu', this.props)}</Menu>\n    );\n  }\n}\n","import { OpType } from '@blink-mind/core';\nimport { MenuItem } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { Icon } from '../../utils';\nimport { TopicContextMenu } from './components/topic-context-menu';\n\nexport type TopicContextMenuItemConfig = {\n  icon?: string;\n  label?: string;\n  shortcut?: string;\n  opType?: string;\n  rootCanUse?: boolean;\n  hotKey?: string;\n};\n\nconst items: TopicContextMenuItemConfig[] = [\n  {\n    icon: 'edit',\n    label: 'edit',\n    shortcut: 'Space',\n    rootCanUse: true,\n    opType: OpType.START_EDITING_CONTENT\n  },\n  {\n    icon: 'add-sibling',\n    label: 'add sibling',\n    shortcut: 'Enter',\n    opType: OpType.ADD_SIBLING\n  },\n  {\n    icon: 'add-child',\n    label: 'add child',\n    shortcut: 'Tab',\n    rootCanUse: true,\n    opType: OpType.ADD_CHILD\n  },\n  {\n    icon: 'notes',\n    label: 'edit notes',\n    shortcut: 'Alt + D',\n    rootCanUse: true,\n    opType: OpType.START_EDITING_DESC\n  },\n  {\n    icon: 'delete-node',\n    label: 'delete node',\n    shortcut: 'Del',\n    opType: OpType.DELETE_TOPIC\n  },\n  {\n    icon: 'root',\n    label: 'set as editor root',\n    shortcut: 'Alt + Shift + F',\n    opType: OpType.SET_EDITOR_ROOT\n  }\n];\n\nexport function ContextMenuPlugin() {\n  return {\n    renderTopicContextMenu(props) {\n      return <TopicContextMenu {...props} />;\n    },\n    customizeTopicContextMenu(props) {\n      const { topicKey, model, controller } = props;\n      const isRoot = topicKey === model.editorRootTopicKey;\n      function onClickItem(item) {\n        return function(e) {\n          item.opType &&\n            controller.run('operation', { ...props, opType: item.opType });\n        };\n      }\n      return items.map(item =>\n        isRoot && !item.rootCanUse ? null : (\n          <MenuItem\n            key={item.label}\n            icon={Icon(item.icon)}\n            text={item.label}\n            labelElement={<kbd>{item.shortcut}</kbd>}\n            onClick={onClickItem(item)}\n          />\n        )\n      );\n    }\n  };\n}\n","import debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  contentRefKey,\n  dropAreaRefKey,\n  getRelativeRect,\n  RefKey\n} from '../../../utils';\nconst log = debug('node:topic-drop-effect');\n\nconst DropEffectSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n`;\n\ninterface State {\n  content: any;\n}\n\nexport class TopicDropEffect extends BaseWidget<BaseProps, State> {\n  state = {\n    content: null\n  };\n\n  layout() {\n    const props = this.props;\n    const { getRef, model, zoomFactor, controller } = this.props;\n    const targetProps = controller.run('getDragTargetProps', props);\n    const { key, dropDir } = targetProps;\n    log('layout', dropDir);\n\n    if (key === null) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n    let refKey;\n    if (dropDir === 'in') {\n      refKey = contentRefKey(key);\n    } else {\n      refKey = dropAreaRefKey(key, dropDir);\n    }\n    const content = getRef(refKey);\n    const svg = getRef('svg-drop-effect');\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const contentRect = getRelativeRect(content, bigView, zoomFactor);\n    const svgRect = getRelativeRect(svg, bigView, zoomFactor);\n    const padding = 3;\n    const x = contentRect.left - svgRect.left - padding;\n    const y = contentRect.top - svgRect.top - padding;\n    const width = contentRect.width + 2 * padding;\n    const height = contentRect.height + 2 * padding;\n\n    this.setState({\n      content: (\n        <g>\n          <rect\n            x={x}\n            y={y}\n            width={width}\n            height={height}\n            fill=\"none\"\n            stroke={model.config.theme.highlightColor}\n            strokeDasharray=\"5,5\"\n            strokeWidth={2}\n          />\n        </g>\n      )\n    });\n  }\n\n  render() {\n    const { saveRef } = this.props;\n    return (\n      <DropEffectSvg ref={saveRef('svg-drop-effect')}>\n        {this.state.content}\n      </DropEffectSvg>\n    );\n  }\n}\n","import {\n  FocusMode,\n  getRelationship,\n  OpType,\n  TopicRelationship\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { contentRefKey, dropAreaRefKey, RefKey } from '../../utils';\nimport { TopicDropEffect } from './components/topic-drop-effect';\nconst log = debug('plugin:drag-and-drop');\nconst DropArea = styled.div`\n  height: ${props => `${props.height}px`};\n  width: 100%;\n  margin: 5px 0px;\n`;\n\nexport function DragAndDropPlugin() {\n  let dragTargetKey: KeyType = null;\n  let dragTargetDir: string = null;\n\n  return {\n    renderTopicDropArea(props) {\n      const { topicKey, dropDir, saveRef, controller, model } = props;\n      const onDragEnter = ev => {\n        log('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', { ...props, ev, dropDir });\n      };\n      const onDragLeave = ev => {\n        log('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', { ...props, ev, dropDir });\n      };\n      const onDragOver = ev => {\n        ev.preventDefault();\n      };\n      const onDrop = ev => {\n        log('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', { ...props, ev, dropDir });\n      };\n      const eventHandlers = {\n        onDragEnter,\n        onDragLeave,\n        onDragOver,\n        onDrop\n      };\n      return (\n        <DropArea\n          height={model.config.theme.marginV / 2}\n          ref={saveRef(dropAreaRefKey(topicKey, dropDir))}\n          {...eventHandlers}\n        />\n      );\n    },\n\n    renderDragAndDropEffect(props) {\n      log('renderDragAndDropEffect');\n      const { saveRef } = props;\n      return (\n        <TopicDropEffect\n          ref={saveRef(RefKey.DROP_EFFECT_KEY)}\n          {...props}\n        ></TopicDropEffect>\n      );\n    },\n\n    getDragTargetProps(props) {\n      return {\n        key: dragTargetKey,\n        dropDir: dragTargetDir\n      };\n    },\n\n    handleTopicDragStart(props) {\n      const { controller, ev } = props;\n      ev.stopPropagation();\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      });\n    },\n\n    canDrop(props) {\n      const { srcKey, dstKey, model, dropDir } = props;\n      if (\n        srcKey === model.editorRootTopicKey ||\n        srcKey === dstKey ||\n        getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR\n      )\n        return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n\n      const srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n\n    handleTopicDragEnter(props) {\n      const { dropDir, topicKey, controller, model } = props;\n      log('handleTopicDragEnter:', topicKey, dropDir);\n      const canDrop = controller.run('canDrop', {\n        ...props,\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      if (canDrop) {\n        dragTargetKey = topicKey;\n        dragTargetDir = dropDir;\n        controller.change(model);\n      }\n    },\n\n    handleTopicDragLeave(props) {\n      const { controller, model, topicKey, dropDir, getRef, ev } = props;\n      const relatedTarget = ev.nativeEvent.relatedTarget;\n      log('handleTopicDragLeave:', topicKey, dropDir);\n      const content = getRef(contentRefKey(topicKey));\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n      dragTargetKey = null;\n      dragTargetDir = null;\n      controller.change(model);\n    },\n\n    handleTopicDrop(props) {\n      log('handleTopicDrop');\n      const { controller, topicKey, model } = props;\n      props = { ...props, srcKey: model.focusKey, dstKey: topicKey };\n\n      dragTargetKey = null;\n      dragTargetDir = null;\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', {\n          ...props,\n          opType: OpType.DRAG_AND_DROP\n        });\n      }\n    }\n  };\n}\n","import { ModelModifier } from '@blink-mind/core';\nimport {\n  Breadcrumb,\n  Breadcrumbs,\n  PopoverPosition,\n  Tooltip\n} from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget, ZIndex } from '../../../components/common';\nimport { PropKey } from '../../../utils';\n\nconst EditorRootBreadcrumbsRoot = styled(ZIndex)`\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n`;\n\nconst TooltipContent = styled.div`\n  max-width: 600px;\n`;\n\nconst BreadcrumbTitle = styled.span``;\n\nexport class EditorRootBreadcrumbs extends BaseWidget {\n  constructor(props) {\n    super(props);\n    this.state = {\n      show: false\n    };\n  }\n\n  setEditorRootTopicKey = topicKey => () => {\n    const { model, controller } = this.props;\n    if (model.editorRootTopicKey !== topicKey) {\n      controller.change(\n        ModelModifier.setEditorRootTopicKey({\n          model,\n          topicKey\n        })\n      );\n    }\n  };\n\n  breadcrumbRenderer = props => {\n    const { text, ...breadProps } = props;\n    const needTooltip = text.length > 8;\n    const title = needTooltip ? text.substr(0, 8) + '...' : text;\n    //TODO\n\n    const content = <TooltipContent>{text}</TooltipContent>;\n    const tooltipProps = {\n      content,\n      position: PopoverPosition.BOTTOM_RIGHT\n    };\n    const breadcrumb = (\n      <Breadcrumb {...breadProps}>\n        <BreadcrumbTitle>{title}</BreadcrumbTitle>\n      </Breadcrumb>\n    );\n    return needTooltip ? (\n      <Tooltip {...tooltipProps}>{breadcrumb}</Tooltip>\n    ) : (\n      breadcrumb\n    );\n\n    // return (\n    //   <Breadcrumb {...breadProps}>\n    //     <BreadcrumbTitle>{title}</BreadcrumbTitle>\n    //   </Breadcrumb>\n    // );\n  };\n\n  render() {\n    const props = this.props;\n    const { model, controller, zIndex } = props;\n    const editingRootKey = model.editorRootTopicKey;\n    if (editingRootKey === model.rootTopicKey) return null;\n\n    const items = [];\n    let topic = model.getTopic(editingRootKey);\n    while (topic != null) {\n      const title = controller.getValue(PropKey.TOPIC_TITLE, {\n        ...props,\n        topicKey: topic.key\n      });\n      items.unshift({\n        text: title,\n        onClick: this.setEditorRootTopicKey(topic.key)\n      });\n      topic = model.getTopic(topic.parentKey);\n    }\n    const breadcrumbProps = {\n      items,\n      breadcrumbRenderer: this.breadcrumbRenderer\n    };\n    return (\n      <EditorRootBreadcrumbsRoot zIndex={zIndex}>\n        <Breadcrumbs {...breadcrumbProps} />\n      </EditorRootBreadcrumbsRoot>\n    );\n  }\n}\n","import { Controller, FocusMode, Model } from '@blink-mind/core';\nimport { HotKeysConfig } from '@blink-mind/renderer-react';\nimport { Hotkey, Hotkeys, HotkeysTarget } from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { DragScrollWidget } from '../../../components/common';\nimport { EventKey, RefKey, topicRefKey } from '../../../utils';\nconst NodeLayer = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n`;\n\nconst DIV = styled.div`\n  width: 100%;\n  height: 100%;\n  background: ${props => props.theme.background};\n`;\n\nexport interface MindDragScrollWidgetProps {\n  controller: Controller;\n  model: Model;\n  saveRef?: Function;\n  getRef?: Function;\n}\n\n@HotkeysTarget\nexport class MindDragScrollWidget<\n  P extends MindDragScrollWidgetProps\n> extends React.Component<MindDragScrollWidgetProps> {\n  constructor(props: MindDragScrollWidgetProps) {\n    super(props);\n  }\n\n  renderHotkeys() {\n    const props = this.props;\n    const { controller, model } = props;\n    const hotKeys: HotKeysConfig = controller.run('customizeHotKeys', props);\n    if (hotKeys === null) return null;\n    if (\n      !(\n        hotKeys.topicHotKeys instanceof Map &&\n        hotKeys.globalHotKeys instanceof Map\n      )\n    ) {\n      throw new TypeError('topicHotKeys and globalHotKeys must be a Map');\n    }\n    const children = [];\n    if (\n      model.focusMode === FocusMode.NORMAL ||\n      model.focusMode === FocusMode.SHOW_POPUP\n    ) {\n      hotKeys.topicHotKeys.forEach((v, k) => {\n        children.push(<Hotkey key={k} {...v} global />);\n      });\n    }\n    hotKeys.globalHotKeys.forEach((v, k) => {\n      children.push(<Hotkey key={k} {...v} global />);\n    });\n    return <Hotkeys>{children}</Hotkeys>;\n  }\n\n  componentDidMount(): void {\n    const { getRef, model, controller } = this.props;\n    controller.run('addZoomFactorChangeEventListener', {\n      ...this.props,\n      listener: this.setZoomFactor\n    });\n    const rootTopic: HTMLElement = getRef(\n      topicRefKey(model.editorRootTopicKey)\n    );\n    //TODO\n    const nodeLayer: HTMLElement = getRef('node-layer');\n    const rootTopicRect = rootTopic.getBoundingClientRect();\n    const nodeLayerRect = nodeLayer.getBoundingClientRect();\n    this.dragScrollWidget.setViewBoxScrollDelta(\n      0,\n      rootTopicRect.top -\n        nodeLayerRect.top -\n        this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 +\n        rootTopicRect.height\n    );\n    this.layout();\n  }\n\n  componentWillUnmount(): void {\n    const { controller } = this.props;\n    controller.run('removeZoomFactorChangeEventListener', {\n      ...this.props,\n      listener: this.setZoomFactor\n    });\n  }\n\n  get dragScrollWidget(): DragScrollWidget {\n    return this.props.getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n  }\n\n  componentDidUpdate(): void {\n    const { controller } = this.props;\n    controller.run('fireEvent', {\n      ...this.props,\n      key: EventKey.CENTER_ROOT_TOPIC\n    });\n    this.layout();\n  }\n\n  layout() {\n    const { controller } = this.props;\n    controller.run('layout', this.props);\n  }\n\n  setZoomFactor = zoomFactor => {\n    this.dragScrollWidget.setZoomFactor(zoomFactor);\n  };\n\n  onWheel = e => {\n    if (e.altKey || e.ctrlKey) {\n      const { controller } = this.props;\n      let zoomFactor = controller.run('getZoomFactor', this.props);\n      zoomFactor = zoomFactor - (e.nativeEvent.deltaY > 0 ? 0.1 : -0.1);\n      if (zoomFactor < 0.5) zoomFactor = 0.5;\n      if (zoomFactor > 4) zoomFactor = 4;\n      // console.log('zoomFactor=>', zoomFactor);\n      controller.run('setZoomFactor', { ...this.props, zoomFactor });\n    }\n  };\n\n  render() {\n    const { saveRef, model, controller } = this.props;\n    const nodeKey = model.editorRootTopicKey;\n    return (\n      <DIV onWheel={this.onWheel}>\n        <DragScrollWidget\n          {...this.state}\n          enableMouseWheel={false}\n          zoomFactor={model.zoomFactor}\n          ref={saveRef(RefKey.DRAG_SCROLL_WIDGET_KEY)}\n        >\n          {(\n            setViewBoxScroll: (left: number, top: number) => void,\n            setViewBoxScrollDelta: (left: number, top: number) => void\n          ) => {\n            const rootWidgetProps = {\n              ...this.props,\n              topicKey: nodeKey,\n              setViewBoxScroll,\n              setViewBoxScrollDelta\n            };\n            return (\n              <NodeLayer ref={saveRef('node-layer')}>\n                {controller.run('renderRootWidget', rootWidgetProps)}\n              </NodeLayer>\n            );\n          }}\n        </DragScrollWidget>\n      </DIV>\n    );\n  }\n}\n","import { Classes, Dialog } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\n\ninterface Props extends BaseProps {\n  saveRef?: Function;\n}\n\nexport class Modals extends BaseWidget<Props> {\n  handleClose = () => {\n    const { controller } = this.props;\n    const handleActiveModalClose = controller.run(\n      'handleActiveModalClose',\n      this.props\n    );\n\n    handleActiveModalClose && handleActiveModalClose();\n  };\n\n  render() {\n    const { controller } = this.props;\n    const activeModal = controller.run('renderModal', this.props);\n    const activeModalProps = controller.run('getActiveModalProps', this.props);\n    return (\n      <Dialog\n        onClose={this.handleClose}\n        isOpen={activeModal !== null}\n        autoFocus\n        enforceFocus\n        usePortal\n        title={activeModalProps && activeModalProps.title}\n        style={activeModalProps && activeModalProps.style}\n      >\n        <div className={Classes.DIALOG_BODY} style={{ minHeight: 0 }}>\n          {activeModal}\n        </div>\n      </Dialog>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  centerPointX,\n  centerPointY,\n  centerX,\n  centerY,\n  getRelativeRect,\n  Point,\n  RefKey\n} from '../../../utils';\n\nimport debug from 'debug';\nimport { contentRefKey, linksSvgRefKey } from '../../../utils';\nconst RootLinksSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n`;\n\nconst log = debug('node:root-sub-links');\n\ninterface Props extends BaseProps {}\n\ninterface State {\n  curves: any[];\n}\n\nexport class RootSubLinks extends BaseWidget<Props, State> {\n  state = {\n    curves: []\n  };\n\n  layout() {\n    const props = this.props;\n    const { model, getRef, topicKey, zoomFactor, controller } = props;\n    const topic = model.getTopic(topicKey);\n    const content = getRef(contentRefKey(topicKey));\n    const svg = getRef(linksSvgRefKey(topicKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const contentRect = getRelativeRect(content, bigView, zoomFactor);\n    const svgRect = getRelativeRect(svg, bigView, zoomFactor);\n    let p1: Point, p2: Point;\n\n    p1 = {\n      x: centerX(contentRect) - svgRect.left,\n      y: centerY(contentRect) - svgRect.top\n    };\n    const curves = [];\n    topic.subKeys.forEach(key => {\n      const linkStyle = controller.run('getLinkStyle', {\n        ...props,\n        topicKey: key\n      });\n      const lineType = linkStyle.lineType;\n      const subTopicContent = getRef(contentRefKey(key));\n      const rect = getRelativeRect(subTopicContent, bigView, zoomFactor);\n      if (rect.left > contentRect.right) {\n        p2 = {\n          x: rect.left,\n          y: centerY(rect)\n        };\n      } else {\n        p2 = {\n          x: rect.right,\n          y: centerY(rect)\n        };\n      }\n      p2 = { x: p2.x - svgRect.left, y: p2.y - svgRect.top };\n      let curve;\n      if (lineType === 'curve') {\n        curve = `M ${p1.x} ${p1.y} C ${p1.x} ${centerPointY(\n          p1,\n          p2\n        )} ${centerPointX(p1, p2)} ${p2.y} ${p2.x} ${p2.y}`;\n      } else if (lineType === 'line') {\n        curve = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`;\n      } else if (lineType === 'round') {\n        const vDir = p2.y > p1.y ? 1 : -1;\n        const hDir = p2.x > p1.x ? 1 : -1;\n        const radius = linkStyle.lineRadius;\n        if (radius == null) {\n          throw new Error(\n            'link line type is round, but lineRadius is not provided!'\n          );\n        }\n        if (p2.y === p1.y) {\n          curve = `M ${p1.x} ${p1.y} H ${p2.x}`;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = `M ${p1.x} ${p1.y}  V ${p2.y -\n            vDir * radius} A ${radius} ${radius} 0 0 ${\n            vDir * hDir === 1 ? 0 : 1\n          } ${p1.x + radius * hDir} ${p2.y} H ${p2.x}`;\n        }\n      }\n      curves.push(\n        <path\n          key={`link-${key}`}\n          d={curve}\n          strokeWidth={linkStyle.lineWidth}\n          stroke={linkStyle.lineColor}\n          fill=\"none\"\n        />\n      );\n    });\n    this.setState({\n      curves\n    });\n  }\n\n  render() {\n    log('render');\n    const { topicKey, saveRef } = this.props;\n    return (\n      <RootLinksSvg ref={saveRef(linksSvgRefKey(topicKey))}>\n        <g>{this.state.curves}</g>\n      </RootLinksSvg>\n    );\n  }\n}\n","import { DiagramLayoutType, KeyType, TopicDirection } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { topicRefKey } from '../../../utils';\n\nconst log = debug('RootNode');\n\nconst LayerPart = styled.div`\n  display: flex;\n  position: relative;\n\n  align-items: ${props =>\n    //@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start'};\n  flex-direction: column;\n\n  padding: ${props =>\n    //@ts-ignore\n    props.topicDirection === TopicDirection.LEFT\n      ? '15px 60px 15px 0px'\n      : '15px 0px 15px 60px'};\n`;\n\nconst Topic = styled.div`\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n`;\n\ninterface Props extends BaseProps {\n  setViewBoxScroll?: (left: number, top: number) => void;\n  setViewBoxScrollDelta?: (left: number, top: number) => void;\n}\n\nexport class RootWidget extends React.Component<Props> {\n  renderPartTopics(topics: KeyType[], dir: string) {\n    const { controller, saveRef } = this.props;\n    const res = controller.run('createSubTopics', {\n      ...this.props,\n      dir,\n      isRoot: true,\n      topics\n    });\n    if (!res) return null;\n    const { subTopics } = res;\n    const cxName = `bm-layer-${dir === TopicDirection.LEFT ? 'left' : 'right'}`;\n    return (\n      //@ts-ignore\n      <LayerPart topicDirection={dir} ref={saveRef(cxName)}>\n        {subTopics}\n      </LayerPart>\n    );\n  }\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { model, topicKey, saveRef, controller } = props;\n    const topicStyle = controller.run('getTopicContentStyle', props);\n    const config = model.config;\n    const topicContent = controller.run('renderTopicContent', {\n      ...props,\n      topicStyle,\n      dir: TopicDirection.MAIN\n    });\n    const partTopics = controller.run('getPartTopics', {\n      layout: config.layoutDir,\n      model,\n      topicKey\n    });\n    const rootTopic = (\n      <Topic ref={saveRef(topicRefKey(topicKey))}>{topicContent}</Topic>\n    );\n    const children = controller.run('renderRootWidgetOtherChildren', props);\n    switch (config.layoutDir) {\n      case DiagramLayoutType.LEFT_AND_RIGHT:\n        return (\n          <>\n            {this.renderPartTopics(partTopics.L, 'L')}\n            {rootTopic}\n            {this.renderPartTopics(partTopics.R, 'R')}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.LEFT_TO_RIGHT:\n        return (\n          <>\n            {rootTopic}\n            {this.renderPartTopics(partTopics.R, 'R')}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.RIGHT_TO_LEFT:\n        return (\n          <>\n            {this.renderPartTopics(partTopics.L, 'L')}\n            {rootTopic}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.TOP_TO_BOTTOM:\n        return (\n          <>\n            {rootTopic}\n            {this.renderPartTopics(partTopics.B, 'B')}\n            {children}\n          </>\n        );\n    }\n    return null;\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport cx from 'classnames';\nimport * as React from 'react';\nimport styled, { css } from 'styled-components';\nimport { collapseRefKey } from '../../../utils';\n\nconst Icon = styled.div`\n  position: absolute;\n  top: calc(50% - 10px);\n  ${({ dir }) => {\n    if (dir === TopicDirection.RIGHT)\n      return css`\n        right: -25px;\n      `;\n    if (dir === TopicDirection.LEFT)\n      return css`\n        left: -25px;\n      `;\n  }};\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ${props => props.background};\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n`;\n\nexport function TopicCollapseIcon(props) {\n  const { model, topicKey, topicStyle, dir, saveRef, onClickCollapse } = props;\n  const topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? (\n    <Icon\n      ref={saveRef(collapseRefKey(topicKey))}\n      onClick={onClickCollapse}\n      background={topicStyle.background}\n      dir={dir}\n      className={cx({\n        icon: true,\n        iconfont: true,\n        [`bm-${topic.collapse ? 'plus' : 'minus'}`]: true\n      })}\n    />\n  ) : null;\n}\n","import debug from 'debug';\nimport * as React from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled from 'styled-components';\nconst log = debug('node:topic-content2');\n\nconst EditingRoot = styled.div`\n  position: relative;\n`;\n\nconst EditingWrapper = styled.div`\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n`;\nconst cancelEvent = e => {\n  log('cancelEvent');\n  e.preventDefault();\n  e.stopPropagation();\n};\nexport function TopicContent(props) {\n  const { controller, model, topicKey, getRef } = props;\n  const readOnly = model.editingContentKey !== topicKey;\n  const editor = controller.run('renderTopicContentEditor', {\n    ...props,\n    readOnly\n  });\n  let child;\n  if (readOnly) {\n    child = editor;\n  } else {\n    let wrapper;\n    const wrapperRef = ref => {\n      if (ref) {\n        wrapper = ref;\n        contentResizeObserver.observe(wrapper);\n      }\n    };\n    let rect = { width: 50, height: 40 };\n    const editorDiv = getRef(`content-editor-${topicKey}`);\n    if (editorDiv) rect = editorDiv.getBoundingClientRect();\n    const contentResizeCallback = (\n      entries: ResizeObserverEntry[],\n      observer: ResizeObserver\n    ) => {\n      const r = entries[0].contentRect;\n      wrapper.style.left = (rect.width - r.width) / 2 + 'px';\n      wrapper.style.top = (rect.height - r.height) / 2 + 'px';\n    };\n    const contentResizeObserver = new ResizeObserver(contentResizeCallback);\n    log(rect);\n    child = (\n      <>\n        <div style={{ width: rect.width, height: rect.height }}></div>\n        {/*<Dialog isOpen>{editor}</Dialog>*/}\n        <EditingWrapper ref={wrapperRef}>{editor}</EditingWrapper>\n      </>\n    );\n  }\n  return (\n    <EditingRoot onDragEnter={cancelEvent} onDragOver={cancelEvent}>\n      {child}\n    </EditingRoot>\n  );\n}\n","import { FocusMode, OpType, TopicDirection } from '@blink-mind/core';\nimport { ContextMenuTarget } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { collapseRefKey, contentRefKey, PropKey } from '../../../utils';\n\nconst log = debug('node:topic-content-widget');\n\ninterface TopicContentProps {\n  dragEnter?: boolean;\n}\n\nconst TopicContent = styled.div<TopicContentProps>`\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n`;\n\nconst TopicContentWithDropArea = styled.div`\n  position: relative;\n`;\n\ninterface Props extends BaseProps {\n  draggable: boolean;\n}\n\ninterface State {\n  dragEnter: boolean;\n}\n\n@ContextMenuTarget\nexport class TopicContentWidget extends BaseWidget<Props, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dragEnter: false\n    };\n  }\n\n  onDragStart = ev => {\n    this.run('handleTopicDragStart', { ...this.props, ev });\n  };\n\n  onDragOver = ev => {\n    // log('onDragOver');\n    ev.preventDefault();\n  };\n\n  onDragEnter = ev => {\n    log('onDragEnter', this.props.topicKey);\n    this.run('handleTopicDragEnter', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  onDragLeave = ev => {\n    this.run('handleTopicDragLeave', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  onDrop = ev => {\n    log('onDrop');\n    this.run('handleTopicDrop', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  public renderContextMenu() {\n    const { controller } = this.props;\n    if (\n      !controller.getValue(PropKey.TOPIC_CONTEXT_MENU_ENABLED, {\n        ...this.props\n      })\n    ) {\n      return;\n    }\n    this.operation(OpType.FOCUS_TOPIC, {\n      ...this.props,\n      focusMode: FocusMode.SHOW_POPUP\n    });\n    return controller.run('renderTopicContextMenu', this.props);\n  }\n\n  public onContextMenuClose() {\n    // Optional method called once the context menu is closed.\n  }\n\n  handleTopicClickTimeout;\n\n  onClick = ev => {\n    const props = this.props;\n    const { controller } = props;\n    //TODO bug [Violation] 'setTimeout' handler took 69ms\n    this.handleTopicClickTimeout = setTimeout(() => {\n      // log('handleTopicClick');\n      //注意这里要传递this.props, 而不是props, 因为会先调用onClick, 再调用其他的topic-content-editor的onClickOutside\n      //其他组件的onClickOutside是个同步的函数,会设置新的model, 如果这里用props传参,会导致model 还是老的model\n      controller.run('handleTopicClick', { ...this.props, ev });\n    }, 200);\n  };\n\n  onDoubleClick = ev => {\n    clearTimeout(this.handleTopicClickTimeout);\n    const { controller } = this.props;\n    controller.run('handleTopicDoubleClick', { ...this.props, ev });\n  };\n\n  needRelocation: boolean = false;\n  oldCollapseIconVector;\n\n  componentDidUpdate() {\n    if (this.needRelocation) {\n      const { getRef, topicKey, setViewBoxScrollDelta } = this.props;\n      const newIcon = getRef(collapseRefKey(topicKey));\n      const newRect = newIcon.getBoundingClientRect();\n      // const newVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: getRef(collapseRefKey(topicKey))\n      // });\n      const newVector = [\n        newRect.left + newRect.width / 2,\n        newRect.top + newRect.height / 2\n      ];\n      log('newVector:', newVector);\n      log('oldVector:', this.oldCollapseIconVector);\n      //TODO bug\n      const vector = [\n        newVector[0] - this.oldCollapseIconVector[0],\n        newVector[1] - this.oldCollapseIconVector[1]\n      ];\n      log('vector', vector);\n      setViewBoxScrollDelta(vector[0], vector[1]);\n      this.needRelocation = false;\n    }\n  }\n\n  onClickCollapse = e => {\n    e.stopPropagation();\n    const { topicKey, getRef } = this.props;\n    this.needRelocation = true;\n    const collapseIcon = getRef(collapseRefKey(topicKey));\n    const rect = collapseIcon.getBoundingClientRect();\n    log('oldRect', rect);\n    this.oldCollapseIconVector = [\n      rect.left + rect.width / 2,\n      rect.top + rect.height / 2\n    ];\n    log('oldCollapseIconVector', this.oldCollapseIconVector);\n    // this.oldCollapseIconVector = controller.run('getRelativeVectorFromViewPort', {\n    //   ...this.props,\n    //   element: collapseIcon\n    // });\n    this.operation(OpType.TOGGLE_COLLAPSE, this.props);\n  };\n\n  render() {\n    const props = this.props;\n    const { saveRef, topicKey, model, controller, topicStyle, dir } = props;\n    log('render', topicKey, model.focusMode);\n    const draggable =\n      controller.run('isOperationEnabled', props) &&\n      model.editingContentKey !== topicKey;\n    const collapseIcon = controller.run('renderTopicCollapseIcon', {\n      ...props,\n      onClickCollapse: this.onClickCollapse.bind(this)\n    });\n    const prevDropArea = controller.run('renderTopicDropArea', {\n      ...props,\n      dropDir: 'prev'\n    });\n    const nextDropArea = controller.run('renderTopicDropArea', {\n      ...props,\n      dropDir: 'next'\n    });\n    const dropEventHandlers = {\n      onDragEnter: this.onDragEnter,\n      onDragLeave: this.onDragLeave,\n      onDragOver: this.onDragOver,\n      onDrop: this.onDrop\n    };\n    // log(topicKey, 'style', topicStyle);\n    return (\n      <TopicContentWithDropArea>\n        {prevDropArea}\n        <TopicContent\n          style={topicStyle}\n          draggable={draggable}\n          ref={saveRef(contentRefKey(topicKey))}\n          onDragStart={this.onDragStart}\n          onClick={this.onClick}\n          onDoubleClick={this.onDoubleClick}\n          {...dropEventHandlers}\n        >\n          {controller.run('renderTopicBlocks', props)}\n          {controller.run('renderTopicContentOthers', props)}\n        </TopicContent>\n        {nextDropArea}\n        {dir !== TopicDirection.MAIN && collapseIcon}\n      </TopicContentWithDropArea>\n    );\n  }\n}\n","import { BlockType, OpType } from '@blink-mind/core';\nimport { Classes, Popover, PopoverInteractionKind } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { TopicBlockIcon } from '../../../components/common/styled';\nimport { cancelEvent, iconClassName, IconName, RefKey } from '../../../utils';\n\nconst log = debug('node:topic-desc');\n\nconst TooltipContentWrapper = styled.div`\n  overflow: auto;\n`;\n\nexport function TopicDesc(props) {\n  const { controller, model, topicKey, getRef } = props;\n  const isEditing = model.editingDescKey === topicKey;\n  log('isEditing', isEditing);\n  const onClick = e => {\n    e.stopPropagation();\n    controller.run('operation', {\n      ...props,\n      opType: OpType.START_EDITING_DESC\n    });\n  };\n\n  const desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  if (\n    !isEditing &&\n    controller.run('isBlockEmpty', { ...props, block: desc.block })\n  )\n    return null;\n  const descEditor = controller.run('renderTopicDescEditor', props);\n  const diagramRoot = getRef(RefKey.DIAGRAM_ROOT_KEY);\n  const style = {\n    maxWidth: '800px',\n    maxHeight: '600px'\n  };\n  if (diagramRoot) {\n    const dRect = diagramRoot.getBoundingClientRect();\n    style.maxWidth = `${dRect.width * 0.6}px`;\n    style.maxHeight = `${dRect.height * 0.8}px`;\n  }\n  const tooltipContent = (\n    <TooltipContentWrapper\n      onClick={cancelEvent}\n      classname={Classes.POPOVER_DISMISS}\n      style={style}\n    >\n      {descEditor}\n    </TooltipContentWrapper>\n  );\n  const icon = (\n    <TopicBlockIcon\n      onClick={onClick}\n      className={iconClassName(IconName.NOTES)}\n      tabIndex={-1}\n    />\n  );\n  const tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.HOVER,\n    hoverOpenDelay: 500\n  };\n\n  const descIcon = desc.block && <Popover {...tooltipProps}></Popover>;\n  return descIcon;\n}\n","import { FocusMode } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { contentRefKey, getRelativeRect, RefKey } from '../../../utils';\n\nconst FocusHighlightSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n`;\n\ninterface State {\n  content: any;\n}\n\nexport class TopicHighlight extends BaseWidget<BaseProps, State> {\n  state = {\n    content: null\n  };\n\n  layout() {\n    const { getRef, model, zoomFactor } = this.props;\n    const focusKey = model.focusKey;\n    const focusMode = model.focusMode;\n    if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n    const content = getRef(contentRefKey(focusKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const svg = getRef(RefKey.SVG_HIGHLIGHT_KEY);\n    const contentRect = getRelativeRect(content, bigView, zoomFactor);\n    const svgRect = getRelativeRect(svg, bigView, zoomFactor);\n    const padding = 3;\n    const x = contentRect.left - svgRect.left - padding;\n    const y = contentRect.top - svgRect.top - padding;\n    const width = contentRect.width + 2 * padding;\n    const height = contentRect.height + 2 * padding;\n    this.setState({\n      content: (\n        <rect\n          x={x}\n          y={y}\n          width={width}\n          height={height}\n          fill=\"none\"\n          stroke={model.config.theme.highlightColor}\n          strokeWidth={2}\n        />\n      )\n    });\n  }\n\n  render() {\n    const { saveRef } = this.props;\n    return (\n      <FocusHighlightSvg ref={saveRef(RefKey.SVG_HIGHLIGHT_KEY)}>\n        {this.state.content}\n      </FocusHighlightSvg>\n    );\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/common/base-props';\nimport {\n  centerPointX,\n  centerPointY,\n  centerY,\n  collapseRefKey,\n  contentRefKey,\n  getRelativeRect,\n  linksSvgRefKey,\n  Point,\n  RefKey\n} from '../../../utils';\n\nconst TopicLinksSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n`;\nimport debug from 'debug';\nconst log = debug('node:topic-sub-links');\n\ninterface Props extends BaseProps {}\n\ninterface State {\n  curves: any[];\n}\n\nexport class TopicSubLinks extends BaseWidget<Props, State> {\n  state = {\n    curves: []\n  };\n  layout() {\n    const props = this.props;\n    const { model, getRef, topicKey, dir, controller } = props;\n    const z = controller.run('getZoomFactor', props);\n    const topic = model.getTopic(topicKey);\n    const content = getRef(contentRefKey(topicKey));\n    const svg = getRef(linksSvgRefKey(topicKey));\n    const collapseIcon = getRef(collapseRefKey(topicKey));\n    const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    const svgRect = getRelativeRect(svg, bigView, z);\n    const collapseRect = getRelativeRect(collapseIcon, bigView, z);\n    const contentRect = getRelativeRect(content, bigView, z);\n    log(topicKey);\n    log('svgRect', svgRect);\n    log('collapseRect', collapseRect);\n    log('contentRect', contentRect);\n    let p1: Point, p2: Point, p3: Point;\n\n    if (dir === TopicDirection.RIGHT) {\n      p1 = {\n        x: 0,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.right - svgRect.left + 10,\n        y: p1.y\n      };\n    } else if (dir === TopicDirection.LEFT) {\n      p1 = {\n        x: svgRect.right - svgRect.left,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.left - svgRect.left - 10,\n        y: p1.y\n      };\n    }\n    const curves = [];\n\n    topic.subKeys.forEach(key => {\n      let curve;\n      const linkStyle = controller.run('getLinkStyle', {\n        ...props,\n        topicKey: key\n      });\n      // log(key);\n      const subContent = getRef(contentRefKey(key));\n      if (!subContent) return;\n      const rect = getRelativeRect(subContent, bigView, z);\n\n      if (dir === TopicDirection.RIGHT) {\n        p3 = {\n          x: rect.left - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n      if (dir === TopicDirection.LEFT) {\n        p3 = {\n          x: rect.right - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n      const { lineType } = linkStyle;\n\n      if (lineType === 'curve') {\n        curve = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y} C ${p2.x} ${centerPointY(\n          p2,\n          p3\n        )} ${centerPointX(p2, p3)} ${p3.y} ${p3.x} ${p3.y}`;\n      } else if (lineType === 'round') {\n        const vDir = p3.y > p1.y ? 1 : -1;\n        const hDir = p3.x > p1.x ? 1 : -1;\n        const radius = linkStyle.lineRadius;\n        // if (p3.y === p1.y) { //这样判断不可靠\n        if (topic.subKeys.size === 1 || Math.abs(p3.y - p1.y) <= 1) {\n          curve = `M ${p1.x} ${p1.y} L ${p3.x} ${p3.y}`;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = `M ${p1.x} ${p1.y} H ${p2.x} V ${p3.y -\n            vDir * radius} A ${radius} ${radius} 0 0 ${\n            vDir * hDir === 1 ? 0 : 1\n          } ${p2.x + radius * hDir} ${p3.y} H ${p3.x}`;\n        }\n      } else if (lineType === 'line') {\n        curve = `M ${p1.x} ${p1.y} H ${p2.x} L ${p3.x} ${p3.y}`;\n      }\n\n      curves.push(\n        <path\n          key={`link-${key}`}\n          d={curve}\n          strokeWidth={linkStyle.lineWidth}\n          stroke={linkStyle.lineColor}\n          fill=\"none\"\n        />\n      );\n    });\n    this.setState({\n      curves\n    });\n  }\n\n  render() {\n    const { topicKey, saveRef } = this.props;\n    return (\n      <TopicLinksSvg ref={saveRef(linksSvgRefKey(topicKey))}>\n        <g>{this.state.curves}</g>\n      </TopicLinksSvg>\n    );\n  }\n}\n","import { TopicDirection } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseProps } from '../../../components/common/base-props';\nimport { linksRefKey, topicRefKey } from '../../../utils';\nimport { TopicSubLinks } from './topic-sub-links';\n\nconst log = debug('node:topic-widget');\n\ntype NodeProps = {\n  topicDirection: string;\n};\n\nconst Node = styled.div<NodeProps>`\n  display: flex;\n  align-items: center;\n  flex-direction: ${props =>\n    props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse'};\n`;\n\ninterface NodeChildrenProps {\n  dir: string;\n  marginH: number;\n}\n\n// TODO\nconst NodeChildren = styled.div<NodeChildrenProps>`\n  position: relative;\n  padding: ${props =>\n    props.dir === TopicDirection.RIGHT\n      ? `0 0 0 ${props.marginH}px`\n      : `0 ${props.marginH}px 0 0`};\n`;\n\ninterface NodeTopicProps {\n  topicDirection: string;\n}\n\nconst NodeTopic = styled.div<NodeTopicProps>`\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ${props =>\n    props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse'};\n`;\n\ninterface Props extends BaseProps {\n  setViewBoxScroll?: (left: number, top: number) => void;\n  setViewBoxScrollDelta?: (left: number, top: number) => void;\n}\n\nexport class TopicWidget extends React.Component<Props> {\n  renderSubTopics() {\n    const props = this.props;\n    const { controller, model, topicKey, dir } = props;\n    const topics = model.getTopic(topicKey).subKeys.toArray();\n    const res = controller.run('createSubTopics', { ...props, topics });\n    if (!res) return null;\n    const { subTopics } = res;\n    const subLinks = controller.run('renderSubLinks', props);\n    return (\n      <NodeChildren dir={dir} marginH={model.config.theme.marginH}>\n        {subTopics} {subLinks}\n      </NodeChildren>\n    );\n  }\n\n  // componentDidUpdate(): void {\n  //   this.layoutLinks();\n  // }\n  //\n  // componentDidMount(): void {\n  //   this.layoutLinks();\n  // }\n\n  layoutLinks() {\n    const { getRef, topicKey, model } = this.props;\n    const topic = model.getTopic(topicKey);\n    if (topic.subKeys.size === 0 || topic.collapse) return;\n    log('layoutLinks', topicKey);\n    const links: TopicSubLinks = getRef(linksRefKey(topicKey));\n    links && links.layout();\n  }\n\n  render() {\n    const props = this.props;\n    const { controller, topicKey, dir, saveRef } = props;\n    log('render', topicKey);\n    const topicStyle = controller.run('getTopicContentStyle', props);\n    const propsMore = {\n      ...props,\n      topicStyle\n    };\n    const topicContent = controller.run('renderTopicContent', propsMore);\n\n    return (\n      <Node topicDirection={dir}>\n        <NodeTopic topicDirection={dir} ref={saveRef(topicRefKey(topicKey))}>\n          {topicContent}\n        </NodeTopic>\n        {this.renderSubTopics()}\n      </Node>\n    );\n  }\n}\n","import { OpType } from '@blink-mind/core';\nimport { Classes, Position, Tooltip } from '@blueprintjs/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget, Btn, ZIndex } from '../../../../components/common';\nimport { EventKey, Icon, IconName } from '../../../../utils';\n\nconst log = debug('node:view-port-viewer');\n\nconst ViewerRoot = styled(ZIndex)`\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n`;\n\nconst Item_ = styled(Btn)`\n  margin: 10px;\n`;\n\nconst ZoomFactorSpan = styled.span`\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n`;\n\nconst Item = props => {\n  return (\n    <Tooltip\n      content={props.tooltip}\n      position={Position.TOP}\n      className={Classes.ICON}\n    >\n      <Item_ onClick={props.onClick} tabIndex={-1}>\n        {props.children}\n      </Item_>\n    </Tooltip>\n  );\n};\n\nexport class ViewPortViewer extends BaseWidget {\n  constructor(props) {\n    super(props);\n  }\n\n  componentDidMount(): void {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addZoomFactorChangeEventListener', {\n      ...props,\n      listener: this.zoomFactorChange\n    });\n  }\n\n  componentWillUnmount(): void {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('removeZoomFactorChangeEventListener', {\n      ...props,\n      listener: this.zoomFactorChange\n    });\n  }\n\n  zoomFactorChange = zoomFactor => {\n    log('zoomFactorChange', zoomFactor);\n    this.setState({ zoomFactor });\n  };\n\n  onClickResetZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: 1\n    });\n  };\n\n  onClickAddZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: zoomFactor + 0.1\n    });\n  };\n\n  onClickMinusZoom = e => {\n    const props = this.props;\n    const { controller } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    controller.run('setZoomFactor', {\n      ...props,\n      zoomFactor: zoomFactor - 0.1\n    });\n  };\n\n  onClickCollapseAll = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addEventListener', {\n      ...props,\n      key: EventKey.CENTER_ROOT_TOPIC,\n      listener: this.centerRootTopic,\n      once: true\n    });\n    controller.run('operation', {\n      ...props,\n      opType: OpType.COLLAPSE_ALL\n    });\n  };\n\n  onClickExpandAll = e => {\n    const props = this.props;\n    const { controller } = props;\n    controller.run('addEventListener', {\n      ...props,\n      key: EventKey.CENTER_ROOT_TOPIC,\n      listener: this.centerRootTopic,\n      once: true\n    });\n    controller.run('operation', {\n      ...props,\n      opType: OpType.EXPAND_ALL\n    });\n  };\n\n  centerRootTopic = () => {\n    const { model, controller } = this.props;\n    controller.run('moveTopicToCenter', {\n      ...this.props,\n      topicKey: model.editorRootTopicKey\n    });\n  };\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { controller, zIndex } = props;\n    const zoomFactor = controller.run('getZoomFactor', props);\n    return (\n      <ViewerRoot zIndex={zIndex}>\n        <Item onClick={this.onClickCollapseAll} tooltip=\"collapse all\">\n          {Icon(IconName.COLLAPSE_ALL)}\n        </Item>\n        <Item onClick={this.onClickExpandAll} tooltip=\"expand all\">\n          {Icon(IconName.EXPAND_ALL)}\n        </Item>\n        <Item onClick={this.centerRootTopic} tooltip=\"center root topic\">\n          {Icon(IconName.CENTER)}\n        </Item>\n        <Item onClick={this.onClickMinusZoom} tooltip=\"zoom in\">\n          {Icon(IconName.MINUS)}\n        </Item>\n        <Item onClick={this.onClickResetZoom} tooltip=\"reset zoom\">\n          <ZoomFactorSpan>{`zoom:${Math.floor(\n            zoomFactor * 100\n          )}%`}</ZoomFactorSpan>\n        </Item>\n        <Item onClick={this.onClickAddZoom} tooltip=\"zoom out\">\n          {Icon(IconName.PLUS)}\n        </Item>\n      </ViewerRoot>\n    );\n  }\n}\n","import { BlockType, FocusMode, OpType } from '@blink-mind/core';\nimport { Drawer } from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { cancelEvent, Icon } from '../../utils';\nconst DescEditorWrapper = styled.div`\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n`;\n\nexport function renderDrawer(props) {\n  const { controller, model, topicKey } = props;\n  if (model.focusMode === FocusMode.EDITING_DESC) {\n    const onDescEditorClose = e => {\n      e.stopPropagation();\n      const key = `topic-desc-data-${topicKey}`;\n      const descData = controller.run('deleteTempValue', { key });\n      controller.run('operation', {\n        ...props,\n        opType: OpType.SET_TOPIC_BLOCK,\n        topicKey,\n        blockType: BlockType.DESC,\n        data: descData,\n        focusMode: FocusMode.NORMAL\n      });\n    };\n    const descEditor = controller.run('renderTopicDescEditor', props);\n    return (\n      <Drawer\n        key=\"drawer\"\n        title=\"Edit Notes\"\n        icon={Icon('note')}\n        isOpen\n        hasBackdrop\n        backdropProps={{ onMouseDown: cancelEvent }}\n        isCloseButtonShown={false}\n        onClose={onDescEditorClose}\n        size=\"70%\"\n      >\n        <DescEditorWrapper>{descEditor}</DescEditorWrapper>\n      </Drawer>\n    );\n  }\n}\n","import * as React from 'react';\nimport { ThemeProvider } from 'styled-components';\n\n//TODO 是否需要themeProvider\nexport default function Theme({ theme, children }) {\n  return (\n    //@ts-ignore\n    <ThemeProvider theme={theme}>\n      <React.Fragment>{children}</React.Fragment>\n    </ThemeProvider>\n  );\n}\n","import { BlockType } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { SaveRef } from '../../components/common';\nimport { linksRefKey, PropKey, RefKey } from '../../utils';\nimport { EditorRootBreadcrumbs } from './components/editor-root-breadcrumbs';\nimport { MindDragScrollWidget } from './components/mind-drag-scroll-widget';\nimport { Modals } from './components/modals';\nimport { RootSubLinks } from './components/root-sublinks';\nimport { RootWidget } from './components/root-widget';\nimport { TopicCollapseIcon } from './components/topic-collapse-icon';\nimport { TopicContent } from './components/topic-content';\nimport { TopicContentWidget } from './components/topic-content-widget';\nimport { TopicDesc } from './components/topic-desc';\nimport { TopicHighlight } from './components/topic-highlight';\nimport { TopicSubLinks } from './components/topic-sub-links';\nimport { TopicWidget } from './components/topic-widget';\nimport { ViewPortViewer } from './components/view-port-util';\nimport { renderDrawer } from './drawer';\nimport Theme from './theme';\nconst log = debug('plugin:rendering');\n\nexport function RenderingPlugin() {\n  const DiagramRoot = styled.div`\n    width: 100%;\n    height: 100%;\n    background: ${props => props.theme.background};\n    position: relative;\n  `;\n  let diagramProps;\n  return {\n    getDiagramProps() {\n      return diagramProps;\n    },\n    renderDiagram(props) {\n      const { model, controller } = props;\n      return (\n        <SaveRef>\n          {(saveRef, getRef, deleteRef) => {\n            diagramProps = {\n              ...props,\n              saveRef,\n              getRef,\n              deleteRef\n            };\n\n            log('renderDiagram', model);\n            return (\n              <Theme theme={model.config.theme}>\n                <DiagramRoot ref={saveRef(RefKey.DIAGRAM_ROOT_KEY)}>\n                  <MindDragScrollWidget {...diagramProps} />\n                  {controller.run('renderDiagramCustomize', diagramProps)}\n                </DiagramRoot>\n              </Theme>\n            );\n          }}\n        </SaveRef>\n      );\n    },\n    renderDrawer,\n\n    renderDiagramCustomize(props) {\n      const { controller, model } = props;\n      const zIndex = controller.getValue(\n        PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX\n      );\n      const nProps = {\n        ...props,\n        zIndex,\n        topicKey: model.focusKey\n      };\n      const breadcrumbs = controller.run('renderEditorRootBreadcrumbs', nProps);\n      // const styleEditor = controller.run('renderStyleEditor', nProps);\n      const rightTopPanel = controller.run('renderRightTopPanel', nProps);\n      const modals = controller.run('renderModals', {\n        ...nProps,\n        zIndex: zIndex + 1\n      });\n      const drawer = controller.run('renderDrawer', {\n        ...nProps,\n        zIndex: zIndex + 1\n      });\n      const viewportViewer = controller.run('renderViewPortViewer', nProps);\n      return [breadcrumbs, rightTopPanel, modals, drawer, viewportViewer];\n    },\n\n    renderEditorRootBreadcrumbs(props) {\n      return <EditorRootBreadcrumbs key=\"EditorRootBreadcrumbs\" {...props} />;\n    },\n\n    renderModals(props) {\n      return <Modals key=\"modals\" {...props} />;\n    },\n\n    renderModal(props) {\n      return null;\n    },\n\n    getActiveModalProps(props) {\n      return null;\n    },\n\n    renderDoc({ children }) {\n      return children;\n    },\n\n    renderRootWidget(props) {\n      return <RootWidget {...props} />;\n    },\n\n    renderTopicWidget(props) {\n      return <TopicWidget {...props} />;\n    },\n\n    renderTopicContent(props) {\n      return <TopicContentWidget {...props} />;\n    },\n\n    renderTopicCollapseIcon(props) {\n      return <TopicCollapseIcon {...props} />;\n    },\n\n    renderTopicContentOthers(props) {\n      return [];\n    },\n\n    renderTopicBlocks(props) {\n      const { model, topicKey, controller } = props;\n      const topic = model.getTopic(topicKey);\n      const blocks = topic.blocks;\n      const res = [];\n      let i = 0;\n      blocks.forEach(block => {\n        const b = controller.run('renderTopicBlock', {\n          ...props,\n          block,\n          blockKey: `block-${i}`\n        });\n        if (b) {\n          res.push(<React.Fragment key={`block-${i}`}>{b}</React.Fragment>);\n          i++;\n        }\n      });\n      return res;\n    },\n\n    renderTopicBlock(props) {\n      const { controller, block } = props;\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicBlockContent', props);\n        case BlockType.DESC:\n          return controller.run('renderTopicBlockDesc', props);\n        default:\n          break;\n      }\n      return null;\n    },\n\n    renderTopicBlockContent(props) {\n      return <TopicContent {...props} />;\n    },\n\n    renderTopicBlockDesc(props) {\n      return <TopicDesc {...props} />;\n    },\n\n    renderSubLinks(props) {\n      const { saveRef, topicKey, model } = props;\n      const topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return <TopicSubLinks ref={saveRef(linksRefKey(topicKey))} {...props} />;\n    },\n\n    renderRootSubLinks(props) {\n      // log('renderRootSubLinks');\n      const { saveRef, topicKey } = props;\n      // 这里逻辑有问题,会导致layout 错误\n      // const topic = model.getTopic(topicKey);\n      // if (topic.subKeys.size === 0) return null;\n      return <RootSubLinks ref={saveRef(linksRefKey(topicKey))} {...props} />;\n    },\n\n    renderFocusItemHighlight(props) {\n      const { saveRef } = props;\n      return (\n        <TopicHighlight ref={saveRef(RefKey.FOCUS_HIGHLIGHT_KEY)} {...props} />\n      );\n    },\n\n    renderRootWidgetOtherChildren(props) {\n      const { controller } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      props = { ...props, zoomFactor };\n      return (\n        <>\n          {controller.run('renderRootSubLinks', props)}\n          {controller.run('renderFocusItemHighlight', props)}\n          {controller.run('renderDragAndDropEffect', props)}\n        </>\n      );\n    },\n\n    renderViewPortViewer(props) {\n      return <ViewPortViewer key=\"view-port-viewer\" {...props} />;\n    }\n  };\n}\n","import { TabId, Tabs } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { useState } from 'react';\nimport styled from 'styled-components';\nimport {\n  BaseProps,\n  CloseIcon,\n  IconBg,\n  ShowMenuIcon,\n  Title,\n  ZIndex\n} from '../../../../components/common';\nimport { iconClassName, IconName } from '../../../../utils';\n\nconst PanelRoot = styled(ZIndex)`\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n`;\n\nconst StyledTabs = styled(Tabs)`\n  padding: 0px 10px;\n`;\n\nexport type RightTopPanelProps = BaseProps & {\n  selectedTabId: TabId;\n  handleTabIdChange: (tabId: TabId) => void;\n  zIndex: number;\n};\n\nexport function RightTopPanel(props: RightTopPanelProps) {\n  const { controller, zIndex, selectedTabId, handleTabIdChange } = props;\n  const [expand, setExpand] = useState(false);\n\n  if (!expand) {\n    return (\n      <PanelRoot zIndex={zIndex}>\n        <IconBg onClick={() => setExpand(true)}>\n          <ShowMenuIcon className={iconClassName(IconName.SHOW_MENU)} />\n        </IconBg>\n      </PanelRoot>\n    );\n  }\n\n  return (\n    <PanelRoot zIndex={zIndex}>\n      <Title>\n        <CloseIcon\n          className={iconClassName(IconName.CLOSE)}\n          onClick={() => setExpand(false)}\n        />\n      </Title>\n      <StyledTabs id={selectedTabId} onChange={handleTabIdChange}>\n        {controller.run('renderRightTopPanelTabs', props)}\n      </StyledTabs>\n    </PanelRoot>\n  );\n}\n","import styled from 'styled-components';\n\nexport const SettingTitle = styled.div`\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n`;\n\nexport const SettingItem = styled.span`\n  margin: 0px 10px 0px 0px;\n`;\n\nexport const SettingBoxContainer = styled.div`\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n`;\n\nexport const SettingLabel = styled(SettingItem)``;\n\nexport const SettingRow = styled.div`\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n`;\n\nexport const ColorBar = styled.div`\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ${props => props.color};\n`;\n\nexport const WithBorder = styled.div`\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n`;\n","import {\n  Button,\n  Divider,\n  MenuItem,\n  NumericInput,\n  Popover\n} from '@blueprintjs/core';\nimport { Select } from '@blueprintjs/select';\nimport { ItemRenderer } from '@blueprintjs/select/src/common/itemRenderer';\nimport * as React from 'react';\nimport { SketchPicker } from 'react-color';\nimport { Flex, Margin } from '../../../../components/common';\nimport { iconClassName, IconName } from '../../../../utils';\nimport { ColorBar, SettingItem, WithBorder } from './styled';\nexport function SettingGroup(props) {\n  return (\n    <div>\n      {props.children}\n      <Divider style={{ margin: '10px 0' }} />\n    </div>\n  );\n}\n\nexport function SettingItemColorPicker(props: {\n  color: string;\n  handleColorChange: (color: string) => void;\n}) {\n  const { color, handleColorChange } = props;\n  return (\n    <SettingItem>\n      <Popover>\n        <WithBorder>\n          <div className={iconClassName(IconName.COLOR_PICKER)} />\n          <ColorBar color={color} />\n        </WithBorder>\n        <div>\n          <SketchPicker\n            color={color}\n            onChangeComplete={color => handleColorChange(color.hex)}\n          />\n        </div>\n      </Popover>\n    </SettingItem>\n  );\n}\n\nexport function SettingItemButton(props: {\n  title: string;\n  handleClick: (e) => void;\n}) {\n  const { title, handleClick } = props;\n  return (\n    <SettingItem>\n      <Button onClick={handleClick}>{title}</Button>\n    </SettingItem>\n  );\n}\n\nexport interface SettingItemNumericInputProps {\n  layout?: string;\n  title: string;\n  value: number;\n  min: number;\n  max: number;\n  onValueChange: (valueAsNumber: number, valueAsString: string) => void;\n}\n\nexport function SettingItemNumericInput(props: SettingItemNumericInputProps) {\n  const { layout = 'h', title, ...restProps } = props;\n  const flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return (\n    <SettingItem>\n      <Flex {...flexProps}>\n        <Margin margin=\"0 5px 0 0\">{title}</Margin>\n        <NumericInput {...restProps} />\n      </Flex>\n    </SettingItem>\n  );\n}\n\nexport function SettingItemSelect<T>(props: {\n  text: string;\n  items: T[];\n  itemRenderer: ItemRenderer<T>;\n  onItemSelect: (item: T, event?: React.SyntheticEvent<HTMLElement>) => void;\n}) {\n  const { text, items, itemRenderer, onItemSelect } = props;\n  const PxSelect = Select.ofType<T>();\n  const pxProps = {\n    items,\n    itemRenderer,\n    onItemSelect,\n    filterable: false\n  };\n  return (\n    <SettingItem>\n      <PxSelect {...pxProps}>\n        <Button text={text} />\n      </PxSelect>\n    </SettingItem>\n  );\n}\n\nexport const renderItem = unit => (width, { handleClick }) => {\n  return (\n    <MenuItem text={`${width}${unit}`} key={width} onClick={handleClick} />\n  );\n};\n\nexport const PxSelect = Select.ofType();\n\nexport const borderWidthItems = [...Array(7).keys()];\n","import * as React from 'react';\nimport {\n  renderItem,\n  SettingGroup,\n  SettingItemColorPicker,\n  SettingItemSelect,\n  SettingTitle\n} from '../right-top-panel';\nimport { ContentStyleEditorProps } from './types';\n\nconst borderWidthItems = [...Array(7).keys()];\nconst borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\nconst borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n\nexport function BorderStyleEditor(props: ContentStyleEditorProps) {\n  const { contentStyle, setContentStyle } = props;\n  const handleBorderWidthChange = value => {\n    // log('handleBorderWithChange:', value);\n    setContentStyle({ borderWidth: `${value}px` });\n  };\n\n  const handleBorderStyleChange = value => {\n    setContentStyle({ borderStyle: value });\n  };\n\n  const handleBorderRadiusChange = value => {\n    // log('handleBorderRadiusChange:', value);\n    setContentStyle({ borderRadius: `${value}px` });\n  };\n\n  const handleBorderColorChange = color => {\n    setContentStyle({ borderColor: color });\n  };\n\n  return (\n    <SettingGroup>\n      <SettingTitle>Border</SettingTitle>\n      <div>\n        <SettingItemSelect\n          text={`width: ${\n            contentStyle.borderWidth ? contentStyle.borderWidth : '0px'\n          }`}\n          items={borderWidthItems}\n          itemRenderer={renderItem('px')}\n          onItemSelect={handleBorderWidthChange}\n        />\n        <SettingItemSelect\n          text={`style: ${\n            contentStyle.borderStyle ? contentStyle.borderStyle : 'none'\n          }`}\n          items={borderStyleItems}\n          itemRenderer={renderItem('')}\n          onItemSelect={handleBorderStyleChange}\n        />\n        <SettingItemSelect\n          text={`radius: ${contentStyle.borderRadius}`}\n          items={borderRadiusItems}\n          itemRenderer={renderItem('px')}\n          onItemSelect={handleBorderRadiusChange}\n        />\n        <SettingItemColorPicker\n          color={contentStyle.borderColor}\n          handleColorChange={handleBorderColorChange}\n        />\n      </div>\n    </SettingGroup>\n  );\n}\n","import { LinkStyle } from '@blink-mind/core';\nimport { MenuItem } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { Margin } from '../../../../components/common';\nimport {\n  borderWidthItems,\n  renderItem,\n  SettingGroup,\n  SettingItemColorPicker,\n  SettingItemSelect,\n  SettingRow,\n  SettingTitle\n} from '../right-top-panel';\n\nconst lineTypes = ['curve', 'round', 'line'];\n\nconst renderLineTypeItem = (lineType, { handleClick, modifiers, query }) => {\n  return <MenuItem text={`${lineType}`} key={lineType} onClick={handleClick} />;\n};\n\nexport interface LinkStyleEditorProps {\n  showLinkStyle?: boolean;\n  showSubLinkStyle?: boolean;\n  linkStyle: LinkStyle;\n  subLinkStyle: LinkStyle;\n  setLinkStyle: (LinkStyle) => void;\n  setSubLinkStyle: (LinkStyle) => void;\n}\n\nexport function LinkStyleEditor(props: LinkStyleEditorProps) {\n  const {\n    showLinkStyle = true,\n    showSubLinkStyle = true,\n    linkStyle = {},\n    subLinkStyle = {},\n    setLinkStyle,\n    setSubLinkStyle\n  } = props;\n\n  const handleLinkWidthChange = value => {\n    setLinkStyle({ lineWidth: `${value}px` });\n  };\n\n  const handleLinkTypeChange = value => {\n    setLinkStyle({ lineType: value });\n  };\n\n  const handleLinkColorChange = color => {\n    setLinkStyle({ lineColor: color });\n  };\n\n  const handleSubLinkWidthChange = value => {\n    setSubLinkStyle({ lineWidth: `${value}px` });\n  };\n\n  const handleSubLinkTypeChange = value => {\n    setSubLinkStyle({ lineType: value });\n  };\n\n  const handleSubLinkColorChange = color => {\n    setSubLinkStyle({ lineColor: color });\n  };\n  return (\n    <SettingGroup>\n      <SettingTitle>Link</SettingTitle>\n      {showLinkStyle && (\n        <SettingRow alignItems=\"center\">\n          <Margin margin=\"0 5px 0 0\">LinkToParent: </Margin>\n          <SettingItemSelect\n            text={`width: ${linkStyle ? linkStyle.lineWidth : '0px'}`}\n            items={borderWidthItems}\n            itemRenderer={renderItem('px')}\n            onItemSelect={handleLinkWidthChange}\n          />\n          <SettingItemSelect\n            text={`lineType: ${linkStyle.lineType}`}\n            items={lineTypes}\n            itemRenderer={renderLineTypeItem}\n            onItemSelect={handleLinkTypeChange}\n          />\n          <SettingItemColorPicker\n            color={linkStyle.lineColor}\n            handleColorChange={handleLinkColorChange}\n          />\n        </SettingRow>\n      )}\n      {showSubLinkStyle && (\n        <SettingRow alignItems=\"center\">\n          <Margin margin=\"0 5px 0 0\">SubLinks: </Margin>\n          <SettingItemSelect\n            text={`width: ${subLinkStyle ? subLinkStyle.lineWidth : '0px'}`}\n            items={borderWidthItems}\n            itemRenderer={renderItem('px')}\n            onItemSelect={handleSubLinkWidthChange}\n          />\n          <SettingItemSelect\n            text={`lineType: ${subLinkStyle.lineType}`}\n            items={lineTypes}\n            itemRenderer={renderLineTypeItem}\n            onItemSelect={handleSubLinkTypeChange}\n          />\n          <SettingItemColorPicker\n            color={subLinkStyle.lineColor}\n            handleColorChange={handleSubLinkColorChange}\n          />\n        </SettingRow>\n      )}\n    </SettingGroup>\n  );\n}\n","import { InputGroup } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { Flex, Margin } from '../../../../components/common';\nimport {\n  SettingGroup,\n  SettingItem,\n  SettingItemColorPicker,\n  SettingItemNumericInput,\n  SettingTitle\n} from '../right-top-panel';\nimport { ContentStyleEditorProps } from './types';\n\nexport function TextStyleEditor(props: ContentStyleEditorProps) {\n  const { contentStyle, setContentStyle } = props;\n  const handleFontSizeChange = value => {\n    // log('handleFontSizeChange:', value);\n    setContentStyle({ fontSize: value });\n  };\n\n  const handleLineHeightChange = e => {\n    // log('handleLineHeightChange:', e.target.value);\n    setContentStyle({ lineHeight: e.target.value });\n  };\n\n  const handleColorChange = color => {\n    setContentStyle({ color });\n  };\n\n  const fontSizeNumInputProps = {\n    title: 'FontSize:',\n    min: 12,\n    max: 100,\n    value: parseInt(contentStyle.fontSize),\n    style: {\n      width: 50\n    },\n    onValueChange: handleFontSizeChange\n  };\n  const lineHeightInputProps = {\n    style: {\n      width: 50\n    },\n    value: contentStyle.lineHeight || '',\n    onChange: handleLineHeightChange\n  };\n  return (\n    <SettingGroup>\n      <SettingTitle>Text Editor</SettingTitle>\n      <Flex>\n        <SettingItemNumericInput {...fontSizeNumInputProps} />\n        <SettingItem>\n          <Flex alignItems=\"center\">\n            <Margin margin=\"0 5px 0 0\">LineHeight: </Margin>\n            <InputGroup {...lineHeightInputProps} />\n          </Flex>\n        </SettingItem>\n        <SettingItemColorPicker\n          color={contentStyle.color}\n          handleColorChange={handleColorChange}\n        />\n      </Flex>\n    </SettingGroup>\n  );\n}\n","import { LinkStyle, OpType, TopicContentStyle } from '@blink-mind/core';\nimport debug from 'debug';\nimport * as React from 'react';\nimport { BaseProps, PanelTabRoot } from '../../../../components/common';\nimport {\n  SettingGroup,\n  SettingItemButton,\n  SettingItemColorPicker,\n  SettingTitle\n} from '../right-top-panel/';\nimport { BorderStyleEditor } from './border-style-editor';\nimport { ClearAllCustomStyle } from './clear-all-custom-style';\nimport { LinkStyleEditor, LinkStyleEditorProps } from './link-style-editor';\nimport { TextStyleEditor } from './text-style-editor';\nimport { ContentStyleEditorProps } from './types';\n\nconst log = debug('node:style-editor');\n\nlet copiedStyle;\n\nexport function StyleEditor(props: BaseProps) {\n  const { controller, model, topicKey } = props;\n  const topic = model.getTopic(topicKey);\n  const setContentStyle = style => {\n    controller.run('setTopicContentStyle', { ...props, style });\n  };\n\n  const handleBackgroundColorChange = color => {\n    setContentStyle({ background: color });\n  };\n\n  const handleClearStyle = () => {\n    if (topic.style) {\n      controller.run('operation', {\n        ...props,\n        opType: OpType.SET_STYLE,\n        style: null\n      });\n    }\n  };\n\n  const handleCopyStyle = () => {\n    copiedStyle = controller.run('getTopicStyle', props);\n    log(copiedStyle);\n  };\n\n  const handlePasteStyle = () => {\n    if (copiedStyle) {\n      controller.run('operation', {\n        ...props,\n        opType: OpType.SET_STYLE,\n        style: JSON.stringify(copiedStyle)\n      });\n    }\n  };\n\n  if (!model.focusKey) return null;\n  const contentStyle: TopicContentStyle = controller.run(\n    'getTopicContentStyle',\n    props\n  );\n\n  const linkStyle: LinkStyle = controller.run('getLinkStyle', props);\n  const subLinkStyle: LinkStyle = controller.run('getSubLinkStyle', props);\n  const setLinkStyle = linkStyle => {\n    controller.run('setLinkStyle', {\n      ...props,\n      linkStyle\n    });\n  };\n\n  const setSubLinkStyle = subLinkStyle => {\n    controller.run('setSubLinkStyle', {\n      ...props,\n      subLinkStyle\n    });\n  };\n\n  const linkStyleEditorProps: LinkStyleEditorProps = {\n    linkStyle,\n    subLinkStyle,\n    setLinkStyle,\n    setSubLinkStyle\n  };\n\n  const contentStyleEditorPros: ContentStyleEditorProps = {\n    contentStyle,\n    setContentStyle\n  };\n\n  return (\n    <PanelTabRoot>\n      <BorderStyleEditor {...contentStyleEditorPros} />\n      <TextStyleEditor {...contentStyleEditorPros} />\n      <SettingGroup>\n        <SettingTitle>Background</SettingTitle>\n        <SettingItemColorPicker\n          color={contentStyle.background}\n          handleColorChange={handleBackgroundColorChange}\n        />\n      </SettingGroup>\n      <LinkStyleEditor {...linkStyleEditorProps} />\n      <SettingGroup>\n        <SettingItemButton\n          title=\"Clear Topic Style\"\n          handleClick={handleClearStyle}\n        />\n        <SettingItemButton title=\"Copy Style\" handleClick={handleCopyStyle} />\n        <SettingItemButton title=\"Paste Style\" handleClick={handlePasteStyle} />\n      </SettingGroup>\n      {ClearAllCustomStyle(props)}\n    </PanelTabRoot>\n  );\n}\n","import { Button } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { SettingGroup, SettingItem } from '../right-top-panel';\n\nexport function ClearAllCustomStyle(props) {\n  const { controller } = props;\n  const handleClearAllCustomStyle = e => {\n    controller.run('clearAllCustomStyle', props);\n  };\n\n  return (\n    <SettingGroup>\n      <SettingItem>\n        <Button onClick={handleClearAllCustomStyle}>\n          Clear All Custom Styles\n        </Button>\n      </SettingItem>\n    </SettingGroup>\n  );\n}\n","import * as React from 'react';\nimport { paddingCss } from '../../../../utils';\nimport {\n  SettingGroup,\n  SettingItemNumericInput,\n  SettingRow,\n  SettingTitle\n} from '../right-top-panel';\nimport { ContentStyleEditorProps } from './types';\n\nconst expand = require('css-shorthand-expand');\n\nexport function PaddingStyleEditor(props: ContentStyleEditorProps) {\n  const { contentStyle, setContentStyle } = props;\n  const padding = expand('padding', contentStyle.padding || '0');\n  const commonProps = {\n    layout: 'v',\n    min: 0,\n    max: 99,\n    style: {\n      width: 38\n    }\n  };\n  const top = parseInt(padding['padding-top']);\n  const right = parseInt(padding['padding-right']);\n  const bottom = parseInt(padding['padding-bottom']);\n  const left = parseInt(padding['padding-left']);\n  const p = {\n    top,\n    right,\n    bottom,\n    left\n  };\n\n  const setPadding = dir => v => {\n    setContentStyle({ padding: paddingCss({ ...p, [dir]: v }) });\n  };\n  const topProps = {\n    ...commonProps,\n    title: 'top',\n    value: top,\n    onValueChange: setPadding('top')\n  };\n  const rightProps = {\n    ...commonProps,\n    title: 'right',\n    value: right,\n    onValueChange: setPadding('right')\n  };\n  const bottomProps = {\n    ...commonProps,\n    title: 'bottom',\n    value: bottom,\n    onValueChange: setPadding('bottom')\n  };\n  const leftProps = {\n    ...commonProps,\n    title: 'left',\n    value: left,\n    onValueChange: setPadding('left')\n  };\n  return (\n    <SettingGroup>\n      <SettingTitle>Padding</SettingTitle>\n      <SettingRow>\n        <SettingItemNumericInput {...topProps} />\n        <SettingItemNumericInput {...rightProps} />\n        <SettingItemNumericInput {...bottomProps} />\n        <SettingItemNumericInput {...leftProps} />\n      </SettingRow>\n    </SettingGroup>\n  );\n}\n","import { LinkStyle, TopicContentStyle, TopicStyle } from '@blink-mind/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport {\n  SettingGroup,\n  SettingItemColorPicker,\n  SettingTitle\n} from '../right-top-panel';\nimport { BorderStyleEditor } from '../style-editor/border-style-editor';\nimport { LinkStyleEditor } from '../style-editor/link-style-editor';\nimport { PaddingStyleEditor } from '../style-editor/padding-style-editor';\nimport { TextStyleEditor } from '../style-editor/text-style-editor';\nimport { ContentStyleEditorProps } from '../style-editor/types';\n\nconst TopicThemeEditorRoot = styled.div`\n  height: 250px;\n  overflow: auto;\n`;\n\nexport interface TopicThemeEditorProps {\n  topicStyle: TopicStyle;\n  setTopicStyle: (style: TopicStyle) => void;\n}\n\nexport function TopicThemeEditor(props: TopicThemeEditorProps) {\n  const { topicStyle, setTopicStyle } = props;\n  const { contentStyle = {}, linkStyle = {}, subLinkStyle = {} } = topicStyle;\n\n  const setContentStyle = (contentStyle: TopicContentStyle) => {\n    setTopicStyle({ contentStyle });\n  };\n\n  const nProps: ContentStyleEditorProps = {\n    contentStyle,\n    setContentStyle\n  };\n\n  const setLinkStyle = (linkStyle: LinkStyle) => {\n    setTopicStyle({ linkStyle });\n  };\n\n  const setSubLinkStyle = (subLinkStyle: LinkStyle) => {\n    setTopicStyle({ subLinkStyle });\n  };\n\n  const linkStyleEditorProps = {\n    showLinkStyle: false,\n    linkStyle,\n    subLinkStyle,\n    setLinkStyle,\n    setSubLinkStyle\n  };\n  return (\n    <TopicThemeEditorRoot>\n      <BorderStyleEditor {...nProps} />\n      <PaddingStyleEditor {...nProps} />\n      <TextStyleEditor {...nProps} />\n      <SettingGroup>\n        <SettingTitle>Background</SettingTitle>\n        <SettingItemColorPicker\n          color={contentStyle.background}\n          handleColorChange={color => {\n            setContentStyle({ background: color });\n          }}\n        />\n      </SettingGroup>\n      <LinkStyleEditor {...linkStyleEditorProps} />\n    </TopicThemeEditorRoot>\n  );\n}\n","import { isThemeType, OpType, ThemeType, TopicStyle } from '@blink-mind/core';\nimport { Alert, Tab, Tabs } from '@blueprintjs/core';\nimport { clone, merge } from 'lodash';\nimport * as React from 'react';\nimport { useState } from 'react';\nimport {\n  BaseProps,\n  PanelTabRoot,\n  StyledCheckbox\n} from '../../../../components/common';\nimport { browserDownloadText, browserOpenFile } from '../../../../utils';\nimport { handleBooleanChange } from '../../../../utils/blueprint';\nimport {\n  SettingBoxContainer,\n  SettingGroup,\n  SettingItemButton,\n  SettingItemColorPicker,\n  SettingLabel,\n  SettingRow,\n  SettingTitle\n} from '../right-top-panel';\nimport { TopicThemeEditor, TopicThemeEditorProps } from './topic-theme-editor';\n\nlet tabId = 'normal';\n\nexport function ThemeEditor(props: BaseProps) {\n  const [showExportDialog, setShowExportDialog] = useState(false);\n  const [alertThemeError, setAlertThemeError] = useState(false);\n  const { model, controller } = props;\n  const theme: ThemeType = model.config.theme;\n\n  const { rootTopic, primaryTopic, normalTopic } = theme;\n\n  const setTheme = theme => {\n    controller.run('operation', {\n      ...props,\n      opType: OpType.SET_THEME,\n      theme: clone(theme)\n    });\n  };\n\n  const handleBackgroundColorChange = background => {\n    setTheme(merge(theme, { background }));\n  };\n\n  const handleHighlightColorChange = highlightColor => {\n    setTheme(merge(theme, { highlightColor }));\n  };\n\n  const handleRandomColorChange = handleBooleanChange(randomColor => {\n    setTheme(merge(theme, { randomColor }));\n  });\n\n  const setRootTopicStyle = (style: TopicStyle) => {\n    setTheme(merge(theme, { rootTopic: style }));\n  };\n\n  const setPrimaryTopicStyle = (style: TopicStyle) => {\n    setTheme(merge(theme, { primaryTopic: style }));\n  };\n\n  const setNormalTopicStyle = (style: TopicStyle) => {\n    setTheme(merge(theme, { normalTopic: style }));\n  };\n\n  const rootTopicEditorProps: TopicThemeEditorProps = {\n    topicStyle: rootTopic,\n    setTopicStyle: setRootTopicStyle\n  };\n\n  const rootTopicEditor = <TopicThemeEditor {...rootTopicEditorProps} />;\n\n  const primaryTopicEditorProps: TopicThemeEditorProps = {\n    topicStyle: primaryTopic,\n    setTopicStyle: setPrimaryTopicStyle\n  };\n\n  const primaryTopicEditor = <TopicThemeEditor {...primaryTopicEditorProps} />;\n\n  const normalTopicEditorProps: TopicThemeEditorProps = {\n    topicStyle: normalTopic,\n    setTopicStyle: setNormalTopicStyle\n  };\n\n  const normalTopicEditor = <TopicThemeEditor {...normalTopicEditorProps} />;\n\n  const tabsProps = {\n    id: tabId,\n    handleTabIdChange: id => {\n      tabId = id;\n    }\n  };\n\n  const topicThemes = (\n    <SettingBoxContainer>\n      <Tabs {...tabsProps}>\n        <Tab id=\"normal\" title=\"NormalTopic\" panel={normalTopicEditor} />\n        <Tab id=\"primary\" title=\"PrimaryTopic\" panel={primaryTopicEditor} />\n        <Tab id=\"root\" title=\"RootTopic\" panel={rootTopicEditor} />\n      </Tabs>\n    </SettingBoxContainer>\n  );\n\n  const handleExportTheme = e => {\n    // setShowExportDialog(true);\n    const text = JSON.stringify(theme);\n    browserDownloadText(text, 'blink-mind-theme.json');\n  };\n  const handleImportTheme = e => {\n    browserOpenFile('.json,.txt').then(txt => {\n      const t: ThemeType = JSON.parse(txt);\n      if (!isThemeType(t)) {\n        setAlertThemeError(true);\n        return;\n      }\n      setTheme(t);\n    });\n  };\n  const alertProps = {\n    isOpen: alertThemeError,\n    onClose: e => {\n      setAlertThemeError(false);\n    }\n  };\n  const alert = (\n    <Alert {...alertProps}>\n      <p>File format error</p>\n    </Alert>\n  );\n\n  return (\n    <PanelTabRoot>\n      <SettingGroup>\n        <SettingTitle>Global</SettingTitle>\n        <SettingRow>\n          <SettingLabel>Background:</SettingLabel>\n          <SettingItemColorPicker\n            color={theme.background}\n            handleColorChange={handleBackgroundColorChange}\n          />\n          <SettingLabel>Highlight:</SettingLabel>\n          <SettingItemColorPicker\n            color={theme.highlightColor}\n            handleColorChange={handleHighlightColorChange}\n          />\n          <SettingLabel>Random Color:</SettingLabel>\n          <StyledCheckbox\n            checked={theme.randomColor}\n            onChange={handleRandomColorChange}\n          />\n        </SettingRow>\n      </SettingGroup>\n      {topicThemes}\n\n      <SettingGroup>\n        <SettingItemButton\n          title=\"Export Theme\"\n          handleClick={handleExportTheme}\n        />\n        <SettingItemButton\n          title=\"Import Theme\"\n          handleClick={handleImportTheme}\n        />\n      </SettingGroup>\n\n      {/*<Dialog*/}\n      {/*  onClose={()=>setShowExportDialog(false)}*/}\n      {/*  isOpen={showExportDialog}*/}\n      {/*  autoFocus*/}\n      {/*  enforceFocus*/}\n      {/*  usePortal*/}\n      {/*  title=\"Please input the export file name\"*/}\n      {/*>*/}\n      {/*  */}\n      {/*</Dialog>*/}\n      {alert}\n    </PanelTabRoot>\n  );\n}\n","import * as React from 'react';\n/** Event handler that exposes the target element's value as a boolean. */\nexport function handleBooleanChange(handler: (checked: boolean) => void) {\n  return (event: React.FormEvent<HTMLElement>) =>\n    handler((event.target as HTMLInputElement).checked);\n}\n\n/** Event handler that exposes the target element's value as a string. */\nexport function handleStringChange(handler: (value: string) => void) {\n  return (event: React.FormEvent<HTMLElement>) =>\n    handler((event.target as HTMLInputElement).value);\n}\n\n/** Event handler that exposes the target element's value as a number. */\nexport function handleNumberChange(handler: (value: number) => void) {\n  return handleStringChange(value => handler(+value));\n}\n","import { Tab } from '@blueprintjs/core';\nimport * as React from 'react';\nimport {\n  RightTopPanel,\n  RightTopPanelProps\n} from './components/right-top-panel/right-top-panel';\nimport { StyleEditor } from './components/style-editor';\nimport { ThemeEditor } from './components/theme-editor';\n\nexport function RightTopPanelPlugin() {\n  let selectedTabId = 'topic-style';\n  const handleTabIdChange = tabId => {\n    selectedTabId = tabId;\n  };\n  return {\n    renderRightTopPanel(props) {\n      const nProps: RightTopPanelProps = {\n        ...props,\n        key: 'right-top-panel',\n        selectedTabId,\n        handleTabIdChange\n      };\n      return <RightTopPanel {...nProps} />;\n    },\n\n    renderRightTopPanelTabs(props) {\n      const { controller } = props;\n      const styleEditorTab = controller.run('renderTopicStyleEditor', props);\n      const themeEditorTab = controller.run('renderThemeEditor', props);\n\n      return [styleEditorTab, themeEditorTab];\n    },\n\n    renderTopicStyleEditor(props) {\n      const tProps = {\n        id: 'topic-style',\n        key: 'topic-style',\n        title: 'TopicStyle',\n        panel: <StyleEditor {...props} />\n      };\n      return <Tab {...tProps} />;\n    },\n\n    renderThemeEditor(props) {\n      const tProps = {\n        id: 'theme-editor',\n        key: 'theme-editor',\n        title: 'Theme',\n        panel: <ThemeEditor {...props} />\n      };\n      return <Tab {...tProps} />;\n    }\n  };\n}\n","import debug from 'debug';\nconst log = debug('plugin:utils');\nexport function UtilsPlugin() {\n  const tempValueMap = new Map();\n  const eventListenerMap = new Map();\n  return {\n    addTempValueChangeListener(props) {\n      const { key, listener } = props;\n      if (!eventListenerMap.has(key)) {\n        eventListenerMap.set(key, []);\n      }\n      eventListenerMap.get(key).push(listener);\n    },\n\n    removeTempValueChangeListener(props) {\n      const { key, listener } = props;\n      if (eventListenerMap.has(key)) {\n        eventListenerMap[key] = eventListenerMap\n          .get(key)\n          .filter(l => l !== listener);\n      }\n    },\n\n    getTempValue(props) {\n      const { key } = props;\n      log('getTempValue', key);\n      return tempValueMap.get(key);\n    },\n\n    setTempValue(props) {\n      const { key, value } = props;\n      log('setTempValue', key);\n      tempValueMap.set(key, value);\n      if (eventListenerMap.has(key)) {\n        const listeners = eventListenerMap.get(key);\n        for (const listener of listeners) {\n          listener(value);\n        }\n      }\n    },\n\n    deleteTempValue(props) {\n      const { key } = props;\n      log('deleteTempValue', key);\n      const value = tempValueMap.get(key);\n      tempValueMap.delete(key);\n      return value;\n    }\n  };\n}\n","import {\n  LinkStyle,\n  OpType,\n  ThemeType,\n  TopicStyle,\n  TopicVisualLevel\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport { isEqual } from 'lodash';\n\nconst log = debug('plugin:StylePlugin');\n\nexport function StylePlugin() {\n  const colorMap = new Map();\n  let colorIndex = 0;\n  return {\n    getTopicStyle(props): TopicStyle {\n      const { controller } = props;\n      return {\n        contentStyle: controller.run('getTopicContentStyle', props),\n        linkStyle: controller.run('getLinkStyle', props),\n        subLinkStyle: controller.run('getSubLinkStyle', props)\n      };\n    },\n\n    getTopicContentStyle(props): TopicStyle {\n      const { topicKey, model, controller } = props;\n      log('getTopicContentStyle:', topicKey, model);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        themeStyle = theme.primaryTopic;\n      else themeStyle = theme.normalTopic;\n\n      themeStyle = { ...theme.contentStyle, ...themeStyle.contentStyle };\n\n      if (theme.randomColor) {\n        const randomColor = controller.run('getRandomColor', props);\n        themeStyle = {\n          ...themeStyle,\n          background: randomColor,\n          borderColor: randomColor,\n          subLinkStyle: {\n            ...themeStyle.subLinkStyle,\n            lineColor: randomColor\n          }\n        };\n      }\n      const topic = model.getTopic(topicKey);\n      if (!topic.style) {\n        return themeStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      return {\n        ...themeStyle,\n        ...customStyle.contentStyle\n      };\n    },\n\n    getLinkStyle(props): LinkStyle {\n      const { topicKey, model, controller } = props;\n      log('getLinkStyle', topicKey);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme: ThemeType = model.config.theme;\n      let linkStyle: LinkStyle = theme.linkStyle;\n      let presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT)\n        presetStyle = theme.rootTopic.linkStyle;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        presetStyle = theme.primaryTopic.linkStyle;\n      else presetStyle = theme.normalTopic.linkStyle;\n\n      linkStyle = { ...linkStyle, ...presetStyle };\n\n      const topic = model.getTopic(topicKey);\n\n      if (topic.parentKey != null) {\n        const parentSubLinkStyle = controller.run('getSubLinkStyle', {\n          ...props,\n          topicKey: topic.parentKey\n        });\n\n        linkStyle = {\n          ...linkStyle,\n          ...parentSubLinkStyle\n        };\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      return {\n        ...linkStyle,\n        ...customStyle.linkStyle\n      };\n    },\n\n    getSubLinkStyle(props): LinkStyle {\n      const { topicKey, model, controller } = props;\n      log('getLinkStyle', topicKey);\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let subLinkStyle = theme.linkStyle;\n      let presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT)\n        presetStyle = theme.rootTopic.subLinkStyle;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        presetStyle = theme.primaryTopic.subLinkStyle;\n      else presetStyle = theme.normalTopic.subLinkStyle;\n\n      subLinkStyle = { ...subLinkStyle, ...presetStyle };\n\n      const topic = model.getTopic(topicKey);\n      // 获取父节点的color\n      if (theme.randomColor) {\n        const randomColor = controller.run('getRandomColor', props);\n        log(randomColor);\n        subLinkStyle = {\n          ...subLinkStyle,\n          lineColor: randomColor\n        };\n      }\n\n      if (!topic.style) {\n        return subLinkStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      const res = {\n        ...subLinkStyle,\n        ...customStyle.subLinkStyle\n      };\n      // if (res.lineRadius == null) res.lineRadius = 5;\n      return res;\n    },\n\n    setTopicContentStyle(props) {\n      const { topicKey, controller, style, model } = props;\n      const topic = model.getTopic(topicKey);\n      const topicStyle = topic.style;\n      const styleObj = topicStyle ? JSON.parse(topicStyle) : {};\n      const newStyleObj = {\n        ...styleObj,\n        contentStyle: {\n          ...styleObj.contentStyle,\n          ...style\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    setLinkStyle(props) {\n      const { topicKey, controller, linkStyle, model } = props;\n      const topic = model.getTopic(topicKey);\n      const style = topic.style;\n      const styleObj = style ? JSON.parse(style) : {};\n      const newStyleObj = {\n        ...styleObj,\n        linkStyle: {\n          ...styleObj.linkStyle,\n          ...linkStyle\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    setSubLinkStyle(props) {\n      const { topicKey, controller, subLinkStyle, model } = props;\n      const topic = model.getTopic(topicKey);\n      const style = topic.style;\n      const styleObj = style ? JSON.parse(style) : {};\n      const newStyleObj = {\n        ...styleObj,\n        subLinkStyle: {\n          ...styleObj.subLinkStyle,\n          ...subLinkStyle\n        }\n      };\n      if (!isEqual(styleObj, newStyleObj)) {\n        const newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', {\n          ...props,\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        });\n      }\n    },\n\n    getTopicThemeStyle(props): TopicStyle {\n      const { topicKey, model } = props;\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n\n    getRandomColor(props) {\n      const { topicKey } = props;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      const colors = [\n        '#00CC99',\n        '#FFEE88',\n        '#A167A5',\n        '#E5F993',\n        '#F5C396',\n        '#DB995A',\n        '#83BCFF',\n        '#ED7B84',\n        '#739E82',\n        '#D3BCC0',\n        '#FFA0FD',\n        '#EFD3D7',\n        '#C6878F'\n      ];\n      const color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      log('getRandomColor', topicKey, color);\n      return color;\n    },\n\n    clearAllCustomStyle(props) {\n      const { model, controller } = props;\n      const newModel = model.withMutations(model => {\n        model.topics.keySeq().forEach(key => {\n          model.setIn(['topics', key, 'style'], null);\n        });\n      });\n      controller.change(newModel);\n    }\n  };\n}\n","import SimpleTextEditorPlugin from '@blink-mind/plugin-simple-text-editor';\nimport { EventPlugin } from './event';\nimport { GetValuePlugin } from './get-value';\nimport { HotKeyPlugin } from './hotkey';\nimport { LayoutPlugin } from './layout';\nimport { OperationPlugin } from './operation';\nimport { ReactPlugin } from './react';\nimport { StylePlugin } from './style';\n\nexport * from './hotkey';\n\nexport function DefaultPlugin() {\n  return [\n    ReactPlugin(),\n    LayoutPlugin(),\n    OperationPlugin(),\n    StylePlugin(),\n    EventPlugin(),\n    HotKeyPlugin(),\n    GetValuePlugin(),\n    SimpleTextEditorPlugin()\n  ];\n}\n","import { ContextMenuPlugin } from './context-menu';\nimport { DragAndDropPlugin } from './drag-and-drop';\nimport { RenderingPlugin } from './rendering';\nimport { RightTopPanelPlugin } from './right-top-panel-plugin';\nimport { UtilsPlugin } from './utils';\n\nexport function ReactPlugin(options = {}) {\n  return [\n    RenderingPlugin(),\n    UtilsPlugin(),\n    ContextMenuPlugin(),\n    RightTopPanelPlugin(),\n    DragAndDropPlugin()\n  ];\n}\n","import {\n  DiagramLayoutType,\n  FocusMode,\n  getRelationship,\n  KeyType,\n  Model,\n  ModelModifier,\n  OpType,\n  Topic,\n  TopicRelationship\n} from '@blink-mind/core';\nimport {\n  getRelativeRect,\n  getRelativeVector,\n  linksRefKey,\n  RefKey,\n  topicRefKey,\n  topicWidgetRefKey\n} from '../utils';\nimport { RootSubLinks } from './react/components/root-sublinks';\nimport { TopicDropEffect } from './react/components/topic-drop-effect';\nimport { TopicHighlight } from './react/components/topic-highlight';\nimport { TopicWidget } from './react/components/topic-widget';\n\nexport type GetPartTopicsArg = {\n  layout: DiagramLayoutType;\n  model: Model;\n  topicKey: KeyType;\n};\nexport interface GetPartTopicsRes {\n  [part: number]: KeyType[];\n}\n\nexport function LayoutPlugin() {\n  const _zoomFactor = 1;\n  return {\n    getPartTopics({\n      layout,\n      model,\n      topicKey\n    }: GetPartTopicsArg): GetPartTopicsRes {\n      const topic = model.getTopic(topicKey);\n      const subTopicCount = topic.subKeys.size;\n      const topics = topic.subKeys.toArray();\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return { R: topics };\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return { L: topics };\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n\n    createSubTopics(props) {\n      const { model, topicKey, controller, topics, saveRef } = props;\n      const topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      const subTopics = [];\n      topics.forEach(tKey => {\n        const topicProps = {\n          ...props,\n          topicKey: tKey,\n          key: tKey,\n          ref: saveRef(topicWidgetRefKey(tKey))\n        };\n        subTopics.push(controller.run('renderTopicWidget', topicProps));\n      });\n      return { subTopics };\n    },\n\n    layout(props) {\n      const { getRef, model } = props;\n      const links = getRef(\n        linksRefKey(model.editorRootTopicKey)\n      ) as RootSubLinks;\n      const highlight = getRef(RefKey.FOCUS_HIGHLIGHT_KEY) as TopicHighlight;\n      const dropEffect = getRef(RefKey.DROP_EFFECT_KEY) as TopicDropEffect;\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n\n      const editorRootTopic = model.getTopic(model.editorRootTopicKey);\n      layoutTopic(editorRootTopic);\n\n      function layoutTopic(topic: Topic) {\n        if (topic.key !== model.editorRootTopicKey) {\n          const topicWidget = getRef(\n            topicWidgetRefKey(topic.key)\n          ) as TopicWidget;\n          topicWidget && topicWidget.layoutLinks();\n        }\n        if (!topic.collapse) {\n          for (const subKey of topic.subKeys) {\n            layoutTopic(model.getTopic(subKey));\n          }\n        }\n      }\n    },\n\n    setLayoutDir(props) {\n      const { layoutDir, model, controller } = props;\n      controller.change(ModelModifier.setLayoutDir({ model, layoutDir }));\n    },\n\n    getRelativeRect(props) {\n      const { element, controller, getRef } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      const bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      return getRelativeRect(element, bigView, zoomFactor);\n    },\n\n    getRelativeRectFromViewPort(props) {\n      const { element, controller, getRef } = props;\n      const zoomFactor = controller.run('getZoomFactor', props);\n      const viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeRect(element, viewBox, zoomFactor);\n    },\n    getRelativeVectorFromViewPort(props) {\n      const { element, getRef } = props;\n      const viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeVector(element, viewBox);\n    },\n\n    addZoomFactorChangeEventListener(props) {\n      const { controller } = props;\n      controller.run('addTempValueChangeListener', {\n        key: 'ZoomFactor',\n        ...props\n      });\n    },\n\n    removeZoomFactorChangeEventListener(props) {\n      const { controller } = props;\n      controller.run('removeTempValueChangeListener', {\n        key: 'ZoomFactor',\n        ...props\n      });\n    },\n\n    setZoomFactor(props) {\n      const { controller, zoomFactor } = props;\n      return controller.run('setTempValue', {\n        key: 'ZoomFactor',\n        value: zoomFactor\n      });\n    },\n\n    getZoomFactor(props) {\n      const { controller } = props;\n      return (\n        controller.run('getTempValue', { key: 'ZoomFactor' }) || _zoomFactor\n      );\n    },\n\n    moveTopicToCenter(props) {\n      const { getRef, topicKey, model } = props;\n      if (\n        model.editorRootTopicKey !== topicKey &&\n        getRelationship(model, topicKey, model.editorRootTopicKey) !==\n          TopicRelationship.DESCENDANT\n      ) {\n        throw new Error(\n          `moveTopicToCenter error: topicKey ${topicKey} is not the DESCENDANT of editor root topic`\n        );\n      }\n      const topic = getRef(topicRefKey(topicKey));\n      const dragScroll = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n      const viewBox = dragScroll.viewBox;\n      if (!topic || !viewBox) {\n        throw new Error(`moveTopicToCenter error: topic or viewBox is null`);\n      }\n      const vector = getRelativeVector(topic, viewBox);\n      //TODO\n      dragScroll.setViewBoxScrollDelta(vector[0], vector[1]);\n    },\n\n    focusTopicAndMoveToCenter(props) {\n      const { controller, topicKey } = props;\n      controller.run('operation', {\n        ...props,\n        opArray: [\n          {\n            opType: OpType.FOCUS_TOPIC,\n            topicKey,\n            focusMode: FocusMode.NORMAL\n          },\n          {\n            opType: OpType.EXPAND_TO,\n            topicKey\n          }\n        ],\n        callback: () => {\n          controller.run('moveTopicToCenter', { ...props, topicKey });\n        }\n      });\n    }\n  };\n}\n","import { PropKey } from '../utils';\n\nexport function GetValuePlugin() {\n  return {\n    getValue(props, next) {\n      const { propKey, controller } = props;\n      switch (propKey) {\n        case PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:\n          return 3;\n        case PropKey.TOPIC_CONTEXT_MENU_ENABLED:\n          return controller.run('isOperationEnabled', props);\n        case PropKey.TOPIC_TITLE:\n          return controller.run('getTopicTitle', props);\n      }\n      return next();\n    }\n  };\n}\n","import {\n  Controller,\n  IDiagram,\n  IDiagramProps,\n  Model,\n  OnChangeFunction,\n  OpType\n} from '@blink-mind/core';\n// TODO\nimport '@blink-mind/icons';\n\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport debug from 'debug';\nimport memoizeOne from 'memoize-one';\nimport * as React from 'react';\nimport { DefaultPlugin, HotKeysConfig } from '../plugins';\nimport './diagram.css';\nconst log = debug('node:Diagram');\n\ninterface Props {\n  model: Model;\n  onChange: OnChangeFunction;\n  commands?: any;\n  plugins?: any;\n}\n\nexport class Diagram extends React.Component<Props> implements IDiagram {\n  controller: Controller;\n\n  public getDiagramProps(): IDiagramProps {\n    return this.controller.run('getDiagramProps');\n  }\n\n  public openNewModel(newModel: Model) {\n    const props = this.getDiagramProps();\n    const { model, controller } = props;\n    controller.run('deleteRefKey', {\n      ...props,\n      topicKey: model.rootTopicKey\n    });\n    controller.run('operation', {\n      ...props,\n      opType: OpType.EXPAND_TO,\n      topicKey: newModel.focusKey,\n      model: newModel,\n      callback: () => {\n        const props = this.getDiagramProps();\n        const { model } = props;\n        controller.run('moveTopicToCenter', {\n          ...props,\n          topicKey: model.focusKey\n        });\n      }\n    });\n  }\n\n  private diagramProps: IDiagramProps;\n\n  private resolveController = memoizeOne((plugins = [], TheDefaultPlugin) => {\n    const defaultPlugin = TheDefaultPlugin();\n    this.controller = new Controller({\n      plugins: [plugins, defaultPlugin],\n      construct: false,\n      onChange: this.props.onChange\n    });\n    // this.controller.run('onConstruct');\n  });\n\n  render() {\n    const { plugins } = this.props;\n    this.resolveController(plugins, DefaultPlugin);\n    this.diagramProps = {\n      ...this.props,\n      controller: this.controller\n    };\n    return this.controller.run('renderDiagram', this.diagramProps);\n  }\n}\n","import { Controller, KeyType, Model } from '@blink-mind/core';\nimport { BaseWidget } from '@blink-mind/renderer-react';\nimport RichMarkDownEditor from 'awehook-rich-markdown-editor';\nimport debug from 'debug';\nimport * as React from 'react';\nimport styled from 'styled-components';\nconst log = debug('node:topic-content-editor');\n\nconst NodeContent = styled.div`\n  ${props =>\n    !props.readOnly &&\n    `\n    // padding: 75px\n    // min-width: 150px\n    // min-height: 150px\n  `};\n`;\ninterface Props {\n  controller: Controller;\n  model: Model;\n  readOnly: boolean;\n  topicKey: KeyType;\n  saveRef?: Function;\n}\n\ninterface State {\n  content: any;\n}\n\nexport class RichTextEditor extends BaseWidget<Props, State> {\n  constructor(props) {\n    super(props);\n    this.initState();\n  }\n\n  initState() {\n    this.state = {\n      content: this.getContent()\n    };\n  }\n\n  getContent() {\n    const { block } = this.getCustomizeProps();\n    return block.data;\n  }\n\n  onMouseDown = e => {\n    e.stopPropagation();\n  };\n\n  onMouseMove = e => {\n    e.stopPropagation();\n  };\n  onChange(value) {\n    this.setState({\n      content: value\n    });\n  }\n\n  getCustomizeProps() {\n    return null;\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this._handleClick);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this._handleClick);\n  }\n\n  root;\n\n  rootRef = saveRef => ref => {\n    saveRef(ref);\n    this.root = ref;\n  };\n\n  _handleClick = event => {\n    const wasOutside = !this.root.contains(event.target);\n    wasOutside && this.onClickOutSide(event);\n  };\n\n  onClickOutSide(e) {}\n\n  render() {\n    const { topicKey, saveRef } = this.props;\n    const { readOnly, getRefKeyFunc, placeholder } = this.getCustomizeProps();\n    log('readOnly:', readOnly);\n    const content = readOnly ? this.getContent() : this.state.content;\n    if (content == null) return null;\n    const key = getRefKeyFunc(topicKey);\n    const { onMouseDown, onMouseMove } = this;\n    const richEditorProps = {\n      editorValue: content,\n      readOnly,\n      onChange: this.onChange.bind(this),\n      placeholder\n    };\n\n    const nodeContentProps = {\n      key,\n      ref: this.rootRef(saveRef(key)),\n      readOnly,\n      onMouseDown,\n      onMouseMove\n    };\n    return (\n      <NodeContent {...nodeContentProps}>\n        <RichMarkDownEditor {...richEditorProps} />\n      </NodeContent>\n    );\n  }\n}\n","import { BlockType } from '@blink-mind/core';\nimport { descEditorRefKey } from '@blink-mind/renderer-react';\nimport { RichTextEditor } from './rich-text-editor';\n\nexport class TopicDescEditor extends RichTextEditor {\n  initState() {\n    super.initState();\n    const { controller, topicKey } = this.props;\n    const key = `topic-desc-data-${topicKey}`;\n    const value = this.state.content;\n    controller.run('setTempValue', { key, value });\n  }\n\n  getCustomizeProps() {\n    const { model, topicKey } = this.props;\n    const block = model.getTopic(topicKey).getBlock(BlockType.DESC).block;\n    const readOnly = model.editingDescKey !== topicKey;\n    //TODO\n    const getRefKeyFunc = descEditorRefKey;\n    return {\n      block,\n      readOnly,\n      getRefKeyFunc,\n      placeholder: 'write topic notes here'\n    };\n  }\n\n  onChange(value) {\n    const { controller, topicKey } = this.props;\n    const key = `topic-desc-data-${topicKey}`;\n    controller.run('setTempValue', { key, value });\n    this.setState({\n      content: value\n    });\n  }\n}\n","import MarkdownSerializer from 'slate-md-serializer';\nexport default new MarkdownSerializer();\n","import { BlockType } from '@blink-mind/core';\nimport * as React from 'react';\nimport { TopicDescEditor } from './components/topic-desc-editor';\nimport markdownSerializer from './markdown-serializer';\nexport default function RichTextEditorPlugin() {\n  return {\n    renderTopicDescEditor(props) {\n      return <TopicDescEditor {...props} />;\n    },\n\n    isBlockEmpty(props, next) {\n      const { block, controller } = props;\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return (\n          block.data == null ||\n          controller.run('serializeBlockData', props) === ''\n        );\n      }\n      return next();\n    },\n\n    serializeBlockData(props, next) {\n      const { block } = props;\n      if (block.type === BlockType.DESC) {\n        return typeof block.data === 'string'\n          ? block.data\n          : markdownSerializer.serialize(block.data);\n      }\n      return next();\n    }\n  };\n}\n","import {\n  Block,\n  Config,\n  ExtData,\n  FocusMode,\n  Model,\n  Topic\n} from '@blink-mind/core';\nimport { IControllerRunContext } from '@blink-mind/core/src/interfaces';\nimport debug from 'debug';\nimport { isImmutable, List, Map } from 'immutable';\n\nconst log = debug('plugin:json-serializer');\n\nexport function JsonSerializerPlugin() {\n  return {\n    serializeModel(props: IControllerRunContext, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { model, controller } = props;\n      const obj = {\n        rootTopicKey: model.rootTopicKey,\n        editorRootTopicKey: model.editorRootTopicKey,\n        focusKey: model.focusKey,\n        extData: controller.run('serializeExtData', {\n          ...props,\n          extData: model.extData\n        }),\n        topics: model.topics\n          .valueSeq()\n          .toArray()\n          .map(topic => controller.run('serializeTopic', { ...props, topic })),\n        config: controller.run('serializeConfig', {\n          ...props,\n          config: model.config\n        }),\n        formatVersion: model.formatVersion\n      };\n      return obj;\n    },\n\n    deserializeModel(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { obj, controller } = props;\n      if (obj.formatVersion == null) {\n        obj.formatVersion = '0.0';\n      }\n      const {\n        rootTopicKey,\n        editorRootTopicKey,\n        focusKey,\n        topics,\n        config,\n        extData,\n        formatVersion\n      } = obj;\n      let res = new Model();\n      res = res.merge({\n        rootTopicKey,\n        editorRootTopicKey:\n          editorRootTopicKey == null ? rootTopicKey : editorRootTopicKey,\n        focusKey,\n        extData: controller.run('deserializeExtData', {\n          ...props,\n          extData,\n          formatVersion\n        }),\n        config: controller.run('deserializeConfig', {\n          ...props,\n          config,\n          formatVersion\n        }),\n        topics: controller.run('deserializeTopics', {\n          ...props,\n          topics,\n          formatVersion\n        }),\n        formatVersion: obj.formatVersion\n      });\n      if (res.focusKey == null) {\n        res = res.set('focusKey', res.rootTopicKey);\n      }\n      if (res.focusMode == null) {\n        res = res.set('focusMode', FocusMode.NORMAL);\n      }\n      log('deserializeModel', res);\n      return res;\n    },\n\n    serializeExtData(\n      props: IControllerRunContext & { extData: ExtData },\n      next\n    ) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { extData, controller } = props;\n      const res = {};\n      extData.forEach((v, k) => {\n        res[k] = controller.run('serializeExtDataItem', {\n          props,\n          extDataKey: k,\n          extDataItem: v\n        });\n      });\n      return res;\n    },\n\n    deserializeExtData(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { extData, controller } = props;\n      let res = Map();\n      for (const extDataKey in extData) {\n        res = res.set(\n          extDataKey,\n          controller.run('deserializeExtDataItem', {\n            ...props,\n            extDataKey,\n            extDataItem: extData[extDataKey]\n          })\n        );\n      }\n      return res;\n    },\n\n    serializeExtDataItem(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { extDataItem } = props;\n      if (isImmutable(extDataItem)) {\n        return extDataItem.toJS();\n      }\n      return extDataItem;\n    },\n\n    deserializeExtDataItem(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { extDataItem } = props;\n      return extDataItem;\n    },\n\n    serializeConfig(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { config } = props;\n      return config.toJS();\n    },\n\n    deserializeConfig(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { config } = props;\n      return new Config(config);\n    },\n\n    serializeTopic(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { topic, controller } = props;\n      return {\n        key: topic.key,\n        parentKey: topic.parentKey,\n        subKeys: topic.subKeys.toArray(),\n        collapse: topic.collapse,\n        style: topic.style,\n        blocks: topic.blocks.map(block =>\n          controller.run('serializeBlock', { ...props, block })\n        )\n      };\n    },\n\n    deserializeTopic(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { topic, controller } = props;\n      const { key, parentKey, subKeys, blocks, style, collapse } = topic;\n      let res = new Topic();\n      res = res.merge({\n        key,\n        parentKey,\n        subKeys: List(subKeys),\n        style,\n        collapse,\n        blocks: controller.run('deserializeBlocks', { ...props, blocks })\n      });\n      return res;\n    },\n\n    deserializeTopics(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { topics, controller } = props;\n      let res = Map();\n      res = res.withMutations(r => {\n        topics.forEach(topic =>\n          r.set(\n            topic.key,\n            controller.run('deserializeTopic', { ...props, topic })\n          )\n        );\n      });\n      return res;\n    },\n\n    serializeBlock(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { block, controller } = props;\n      const res = {\n        type: block.type,\n        data: controller.run('serializeBlockData', { ...props })\n      };\n      return res;\n    },\n\n    serializeBlockData(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { block } = props;\n      return block.data;\n    },\n\n    deserializeBlock(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { block, controller } = props;\n      const { type } = block;\n\n      return new Block({\n        type,\n        data: controller.run('deserializeBlockData', { ...props, block })\n      });\n    },\n\n    deserializeBlockData(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { block } = props;\n      return block.data;\n    },\n\n    deserializeBlocks(props, next) {\n      const nextRes = next();\n      if (nextRes != null) return nextRes;\n      const { blocks, controller } = props;\n      let res = List();\n      res = res.withMutations(res => {\n        blocks.forEach(block =>\n          res.push(controller.run('deserializeBlock', { ...props, block }))\n        );\n      });\n      return res;\n    }\n  };\n}\n","import { ThemeType } from '@blink-mind/core';\n\nexport const themeRandomColorSquare: ThemeType = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n\n  contentStyle: {\n    lineHeight: '1.5',\n    fontSize: '16px'\n  },\n\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n\n  rootTopic: {\n    contentStyle: {\n      fontSize: '36px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      fontSize: '24px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px'\n    }\n  },\n\n  normalTopic: {\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px'\n    }\n  }\n};\n","import { ThemeType } from '@blink-mind/core';\n\nexport const theme1: ThemeType = {\n  name: 'theme1',\n  randomColor: false,\n  background: 'rgb(250,245,205)',\n  highlightColor: '#50C9CE',\n  marginH: 50,\n  marginV: 30,\n\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n\n  linkStyle: {\n    lineRadius: 5\n  },\n  rootTopic: {\n    contentStyle: {\n      background: 'rgb(221, 170, 68)',\n      color: '#fff',\n      fontSize: '34px',\n      borderRadius: '5px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: 'rgb(221, 170, 68)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      background: '#e8eaec',\n      borderWidth: '2px',\n      borderStyle: 'solid',\n      borderColor: 'rgb(221, 170, 68)',\n      borderRadius: '5px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: 'rgb(221, 170, 68)'\n    }\n  },\n\n  normalTopic: {\n    contentStyle: {\n      background: '#fff',\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      color: 'rgb(187, 136, 34)',\n      fontSize: '13px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'round',\n      lineRadius: 5,\n      lineWidth: '1px',\n      lineColor: 'rgb(187, 136, 34)'\n    }\n  }\n};\n","import { ThemeType } from '@blink-mind/core';\n\nexport const theme2: ThemeType = {\n  name: 'theme2',\n  randomColor: false,\n  background: '#f8f8f8',\n  highlightColor: '#50C9CE',\n  marginH: 45,\n  marginV: 10,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5\n  },\n  rootTopic: {\n    contentStyle: {\n      background: '#50C18A',\n      color: '#fff',\n      fontSize: '34px',\n      borderRadius: '5px',\n      padding: '16px 18px 16px 18px'\n    },\n\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      background: '#ffffff',\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderColor: 'rgb(221, 170, 68)',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '14px',\n      padding: '6px 10px 5px 10px'\n    },\n\n    subLinkStyle: {\n      lineType: 'round',\n      lineRadius: 5,\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n\n  normalTopic: {\n    contentStyle: {\n      background: '#fff',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '13px',\n      padding: '3px 9px 4px',\n      boxShadow: '1px 1px 1px #ccc'\n    },\n\n    subLinkStyle: {\n      lineType: 'round',\n      lineRadius: 5,\n      lineWidth: '1px',\n      lineColor: '#43a9ff'\n    }\n  }\n};\n","import { ThemeType } from '@blink-mind/core';\n\nexport const theme3: ThemeType = {\n  name: 'theme3',\n  randomColor: false,\n  background: '#A9DEF9',\n  highlightColor: '#50C9CE',\n  marginH: 50,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n\n  linkStyle: {\n    lineRadius: 5\n  },\n\n  rootTopic: {\n    contentStyle: {\n      background: '#FF99C8',\n      color: '#fff',\n      fontSize: '34px',\n      borderRadius: '5px',\n      padding: '16px 18px 16px 18px'\n    },\n\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      background: '#FCF6BD',\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderColor: '#E4C1F9',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '14px',\n      padding: '6px 10px 5px 10px'\n    },\n\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n\n  normalTopic: {\n    contentStyle: {\n      background: '#E4FDE1',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '13px',\n      padding: '3px 9px 4px',\n      boxShadow: '1px 1px 1px #ccc'\n    },\n\n    subLinkStyle: {\n      lineType: 'round',\n      lineRadius: 5,\n      lineWidth: '1px',\n      lineColor: '#43a9ff'\n    }\n  }\n};\n","import { ThemeType } from '@blink-mind/core';\n\nexport const theme4: ThemeType = {\n  name: 'theme3',\n  randomColor: false,\n  background: '#CCFBFE',\n  highlightColor: '#50C9CE',\n  marginH: 50,\n  marginV: 20,\n\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n\n  linkStyle: {\n    lineRadius: 5\n  },\n\n  rootTopic: {\n    contentStyle: {\n      background: '#CD8987',\n      color: '#fff',\n      fontSize: '34px',\n      borderRadius: '5px',\n      padding: '16px 18px 16px 18px'\n    },\n\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      background: '#CDACA1',\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderColor: '#E4C1F9',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '14px',\n      padding: '6px 10px 5px 10px'\n    },\n\n    subLinkStyle: {\n      lineType: 'line',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n\n  normalTopic: {\n    contentStyle: {\n      background: '#CDCACC',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '13px',\n      padding: '3px 9px 4px',\n      boxShadow: '1px 1px 1px #ccc'\n    },\n\n    subLinkStyle: {\n      lineType: 'line',\n      lineRadius: 5,\n      lineWidth: '1px',\n      lineColor: '#43a9ff'\n    }\n  }\n};\n","import { defaultTheme, ModelModifier, ThemeType } from '@blink-mind/core';\nimport { themeRandomColorSquare } from './themes';\nimport { theme1 } from './themes';\nimport { theme2 } from './themes';\nimport { theme3 } from './themes';\nimport { theme4 } from './themes';\n\nexport function ThemeSelectorPlugin() {\n  const themeMap = new Map<string, ThemeType>([\n    ['default', defaultTheme],\n    ['random-color-square', themeRandomColorSquare],\n    ['theme1', theme1],\n    ['theme2', theme2],\n    ['theme3', theme3],\n    ['theme4', theme4]\n  ]);\n  let currentThemeKey: string = null;\n  return {\n    getAllThemes(props) {\n      return themeMap;\n    },\n\n    setTheme(props) {\n      const { model, controller, themeKey } = props;\n      currentThemeKey = themeKey;\n      const allTheme = controller.run('getAllThemes', props);\n      if (!allTheme.has(themeKey)) {\n        throw new Error('setTheme: the theme key is not correct!');\n      }\n      const theme = allTheme.get(themeKey);\n      const newModel = ModelModifier.setTheme({ model, theme });\n      controller.change(newModel);\n    }\n  };\n}\n","import { iconClassName, TopicBlockIcon } from '@blink-mind/renderer-react';\nimport * as React from 'react';\n\nimport {\n  BLOCK_TYPE_TOPOLOGY,\n  FOCUS_MODE_EDITING_TOPOLOGY,\n  OP_TYPE_START_EDITING_TOPOLOGY\n} from './utils';\n\nexport function TopicBlockTopology(props) {\n  const { controller, model, topicKey } = props;\n  const onClick = e => {\n    e.stopPropagation();\n    controller.run('operation', {\n      ...props,\n      opType: OP_TYPE_START_EDITING_TOPOLOGY\n    });\n  };\n  const isEditing =\n    model.focusKey === topicKey &&\n    model.focusMode === FOCUS_MODE_EDITING_TOPOLOGY;\n\n  const { block } = model.getTopic(topicKey).getBlock(BLOCK_TYPE_TOPOLOGY);\n\n  if (!isEditing && !block) return null;\n  const iconProps = {\n    className: iconClassName('topology'),\n    onClick,\n    tabIndex: -1\n  };\n\n  return <TopicBlockIcon {...iconProps} />;\n}\n","export const FOCUS_MODE_EDITING_TOPOLOGY = 'FOCUS_MODE_EDITING_TOPOLOGY';\nexport const OP_TYPE_START_EDITING_TOPOLOGY = 'OP_TYPE_START_EDITING_TOPOLOGY';\nexport const BLOCK_TYPE_TOPOLOGY = 'TOPOLOGY';\nexport const REF_KEY_TOPOLOGY_DIAGRAM = 'TOPOLOGY_DIAGRAM';\nexport const REF_KEY_TOPOLOGY_DIAGRAM_UTIL = 'TOPOLOGY_DIAGRAM_UTIL';\n","export const ToolsConfig = [\n  {\n    group: 'Basic',\n    children: [\n      {\n        name: 'rectangle',\n        icon: 'icon-rect',\n        data: {\n          text: 'Topology',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          paddingLeft: 10,\n          paddingRight: 10,\n          paddingTop: 10,\n          paddingBottom: 10,\n          name: 'rectangle',\n          icon: '\\ue64d',\n          iconFamily: 'topology',\n          iconColor: '#2f54eb'\n        }\n      },\n      {\n        name: 'rectangle',\n        icon: 'icon-rectangle',\n        data: {\n          text: 'rectangle',\n          rect: {\n            width: 200,\n            height: 50\n          },\n          paddingLeft: 10,\n          paddingRight: 10,\n          paddingTop: 10,\n          paddingBottom: 10,\n          borderRadius: 0.1,\n          name: 'rectangle'\n        }\n      },\n      {\n        name: 'circle',\n        icon: 'icon-circle',\n        data: {\n          text: 'circle',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'circle',\n          textMaxLine: 1\n        }\n      },\n      {\n        name: 'triangle',\n        icon: 'icon-triangle',\n        data: {\n          text: 'triangle',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'triangle'\n        }\n      },\n      {\n        name: 'diamond',\n        icon: 'icon-diamond',\n        data: {\n          text: 'diamond',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'diamond'\n        }\n      },\n      {\n        name: 'pentagon',\n        icon: 'icon-pentagon',\n        data: {\n          text: 'pentagon',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'pentagon'\n        }\n      },\n      {\n        name: 'hexagon',\n        icon: 'icon-hexagon',\n        data: {\n          text: 'hexagon',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          paddingTop: 10,\n          paddingBottom: 10,\n          name: 'hexagon'\n        }\n      },\n      {\n        name: 'pentagram',\n        icon: 'icon-pentagram',\n        data: {\n          text: 'pentagram',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'pentagram'\n        }\n      },\n      {\n        name: 'left arrow',\n        icon: 'icon-arrow-left',\n        data: {\n          text: '',\n          rect: {\n            width: 200,\n            height: 100\n          },\n          name: 'leftArrow'\n        }\n      },\n      {\n        name: 'right arrow',\n        icon: 'icon-arrow-right',\n        data: {\n          text: '',\n          rect: {\n            width: 200,\n            height: 100\n          },\n          name: 'rightArrow'\n        }\n      },\n      {\n        name: 'bidirectional arrow',\n        icon: 'icon-twoway-arrow',\n        data: {\n          text: '',\n          rect: {\n            width: 200,\n            height: 100\n          },\n          name: 'twowayArrow'\n        }\n      },\n      {\n        name: 'line',\n        icon: 'icon-line',\n        data: {\n          text: 'line',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'line'\n        }\n      },\n      {\n        name: 'cloud',\n        icon: 'icon-cloud',\n        data: {\n          text: 'cloud',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'cloud'\n        }\n      },\n      {\n        name: 'message',\n        icon: 'icon-msg',\n        data: {\n          text: 'message',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          paddingLeft: 10,\n          paddingRight: 10,\n          paddingTop: 10,\n          paddingBottom: 10,\n          name: 'message'\n        }\n      },\n      {\n        name: 'file',\n        icon: 'icon-file',\n        data: {\n          text: 'file',\n          rect: {\n            width: 80,\n            height: 100\n          },\n          paddingLeft: 10,\n          paddingRight: 10,\n          paddingTop: 10,\n          paddingBottom: 10,\n          name: 'file'\n        }\n      },\n      {\n        name: 'text',\n        icon: 'icon-text',\n        data: {\n          text: 'text',\n          rect: {\n            width: 160,\n            height: 30\n          },\n          name: 'text'\n        }\n      },\n      {\n        name: 'image',\n        icon: 'icon-image',\n        data: {\n          text: '',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'image',\n          image: '/assets/img/logo.png'\n        }\n      },\n      {\n        name: 'cube',\n        icon: 'icon-cube',\n        data: {\n          rect: {\n            width: 50,\n            height: 70\n          },\n          is3D: true,\n          z: 10,\n          zRotate: 15,\n          fillStyle: '#ddd',\n          name: 'cube',\n          icon: '\\ue63c',\n          iconFamily: 'topology',\n          iconColor: '#777',\n          iconSize: 30\n        }\n      },\n      {\n        name: 'people',\n        icon: 'icon-people',\n        data: {\n          rect: {\n            width: 70,\n            height: 100\n          },\n          name: 'people'\n        }\n      },\n      {\n        name: 'multi media',\n        icon: 'icon-pc',\n        data: {\n          text: 'multi media',\n          rect: {\n            width: 200,\n            height: 200\n          },\n          paddingLeft: 10,\n          paddingRight: 10,\n          paddingTop: 10,\n          paddingBottom: 10,\n          // strokeStyle: 'transparent',\n          name: 'div'\n        }\n      }\n    ]\n  },\n  {\n    group: 'Flow Graph',\n    children: [\n      {\n        name: 'start/end',\n        icon: 'icon-flow-start',\n        data: {\n          text: 'start',\n          rect: {\n            width: 120,\n            height: 40\n          },\n          borderRadius: 0.5,\n          name: 'rectangle'\n        }\n      },\n      {\n        name: 'flow',\n        icon: 'icon-rectangle',\n        data: {\n          text: 'flow',\n          rect: {\n            width: 120,\n            height: 40\n          },\n          name: 'rectangle'\n        }\n      },\n      {\n        name: 'judgement',\n        icon: 'icon-diamond',\n        data: {\n          text: 'judgement',\n          rect: {\n            width: 120,\n            height: 60\n          },\n          name: 'diamond'\n        }\n      },\n      {\n        name: 'data',\n        icon: 'icon-flow-data',\n        data: {\n          text: 'data',\n          rect: {\n            width: 120,\n            height: 50\n          },\n          name: 'flowData'\n        }\n      },\n      {\n        name: 'prepare',\n        icon: 'icon-flow-ready',\n        data: {\n          text: 'prepare',\n          rect: {\n            width: 120,\n            height: 50\n          },\n          name: 'hexagon'\n        }\n      },\n      {\n        name: 'sub flow',\n        icon: 'icon-flow-subprocess',\n        data: {\n          text: 'sub flow',\n          rect: {\n            width: 120,\n            height: 50\n          },\n          name: 'flowSubprocess'\n        }\n      },\n      {\n        name: 'database',\n        icon: 'icon-db',\n        data: {\n          text: 'database',\n          rect: {\n            width: 80,\n            height: 120\n          },\n          name: 'flowDb'\n        }\n      },\n      {\n        name: 'document',\n        icon: 'icon-flow-document',\n        data: {\n          text: 'document',\n          rect: {\n            width: 120,\n            height: 100\n          },\n          name: 'flowDocument'\n        }\n      },\n      {\n        name: 'internal storage',\n        icon: 'icon-internal-storage',\n        data: {\n          text: 'internal storage',\n          rect: {\n            width: 120,\n            height: 80\n          },\n          name: 'flowInternalStorage'\n        }\n      },\n      {\n        name: 'external storage',\n        icon: 'icon-extern-storage',\n        data: {\n          text: 'external storage',\n          rect: {\n            width: 120,\n            height: 80\n          },\n          name: 'flowExternStorage'\n        }\n      },\n      {\n        name: 'queue',\n        icon: 'icon-flow-queue',\n        data: {\n          text: 'queue',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'flowQueue'\n        }\n      },\n      {\n        name: 'input manually',\n        icon: 'icon-flow-manually',\n        data: {\n          text: 'input manually',\n          rect: {\n            width: 120,\n            height: 80\n          },\n          name: 'flowManually'\n        }\n      },\n      {\n        name: 'display',\n        icon: 'icon-flow-display',\n        data: {\n          text: 'display',\n          rect: {\n            width: 120,\n            height: 80\n          },\n          name: 'flowDisplay'\n        }\n      },\n      {\n        name: 'parallel',\n        icon: 'icon-flow-parallel',\n        data: {\n          text: 'parallel',\n          rect: {\n            width: 120,\n            height: 50\n          },\n          name: 'flowParallel'\n        }\n      },\n      {\n        name: 'comment',\n        icon: 'icon-flow-comment',\n        data: {\n          text: 'comment',\n          rect: {\n            width: 100,\n            height: 100\n          },\n          name: 'flowComment'\n        }\n      }\n    ]\n  },\n  {\n    group: 'Activity Diagram',\n    children: [\n      {\n        name: 'start',\n        icon: 'icon-inital',\n        data: {\n          text: '',\n          rect: {\n            width: 30,\n            height: 30\n          },\n          name: 'circle',\n          fillStyle: '#555',\n          strokeStyle: 'transparent'\n        }\n      },\n      {\n        name: 'end',\n        icon: 'icon-final',\n        data: {\n          text: '',\n          rect: {\n            width: 30,\n            height: 30\n          },\n          name: 'activityFinal'\n        }\n      },\n      {\n        name: 'action',\n        icon: 'icon-action',\n        data: {\n          text: 'action',\n          rect: {\n            width: 120,\n            height: 50\n          },\n          borderRadius: 0.25,\n          name: 'rectangle'\n        }\n      },\n      {\n        name: 'decision/merge',\n        icon: 'icon-diamond',\n        data: {\n          text: '决策',\n          rect: {\n            width: 120,\n            height: 50\n          },\n          name: 'diamond'\n        }\n      },\n      {\n        name: 'vertical swimming lane',\n        icon: 'icon-swimlane-v',\n        data: {\n          text: 'vertical swimming lane',\n          rect: {\n            width: 200,\n            height: 500\n          },\n          name: 'swimlaneV'\n        }\n      },\n      {\n        name: 'horizontal swimming lane',\n        icon: 'icon-swimlane-h',\n        data: {\n          text: 'horizontal swimming lane',\n          rect: {\n            width: 500,\n            height: 200\n          },\n          name: 'swimlaneH'\n        }\n      },\n      {\n        name: 'vertical fork/merge',\n        icon: 'icon-fork-v',\n        data: {\n          text: '',\n          rect: {\n            width: 10,\n            height: 150\n          },\n          name: 'forkV',\n          fillStyle: '#555',\n          strokeStyle: 'transparent'\n        }\n      },\n      {\n        name: 'horizontal fork/merge',\n        icon: 'icon-fork',\n        data: {\n          text: '',\n          rect: {\n            width: 150,\n            height: 10\n          },\n          name: 'forkH',\n          fillStyle: '#555',\n          strokeStyle: 'transparent'\n        }\n      }\n    ]\n  },\n  {\n    group: 'Sequence Diagram && Class Diagram',\n    children: [\n      {\n        name: 'lifeline',\n        icon: 'icon-lifeline',\n        data: {\n          text: 'lifeline',\n          rect: {\n            width: 150,\n            height: 400\n          },\n          name: 'lifeline'\n        }\n      },\n      {\n        name: 'activation',\n        icon: 'icon-focus',\n        data: {\n          text: '',\n          rect: {\n            width: 12,\n            height: 200\n          },\n          name: 'sequenceFocus'\n        }\n      },\n      {\n        name: 'simple class',\n        icon: 'icon-simple-class',\n        data: {\n          text: 'Topolgoy',\n          rect: {\n            width: 270,\n            height: 200\n          },\n          paddingTop: 40,\n          font: {\n            fontFamily: 'Arial',\n            color: '#222',\n            fontWeight: 'bold'\n          },\n          fillStyle: '#ffffba',\n          strokeStyle: '#7e1212',\n          name: 'simpleClass',\n          children: [\n            {\n              text: '- name: string\\n+ setName(name: string): void',\n              name: 'text',\n              paddingLeft: 10,\n              paddingRight: 10,\n              paddingTop: 10,\n              paddingBottom: 10,\n              rectInParent: {\n                x: 0,\n                y: 0,\n                width: '100%',\n                height: '100%',\n                rotate: 0\n              },\n              font: {\n                fontFamily: 'Arial',\n                color: '#222',\n                textAlign: 'left',\n                textBaseline: 'top'\n              }\n            }\n          ]\n        }\n      },\n      {\n        name: 'class',\n        icon: 'icon-class',\n        data: {\n          text: 'Topolgoy',\n          rect: {\n            width: 270,\n            height: 200\n          },\n          paddingTop: 40,\n          font: {\n            fontFamily: 'Arial',\n            color: '#222',\n            fontWeight: 'bold'\n          },\n          fillStyle: '#ffffba',\n          strokeStyle: '#7e1212',\n          name: 'interfaceClass',\n          children: [\n            {\n              text: '- name: string',\n              name: 'text',\n              paddingLeft: 10,\n              paddingRight: 10,\n              paddingTop: 10,\n              paddingBottom: 10,\n              rectInParent: {\n                x: 0,\n                y: 0,\n                width: '100%',\n                height: '50%',\n                rotate: 0\n              },\n              font: {\n                fontFamily: 'Arial',\n                color: '#222',\n                textAlign: 'left',\n                textBaseline: 'top'\n              }\n            },\n            {\n              text: '+ setName(name: string): void',\n              name: 'text',\n              paddingLeft: 10,\n              paddingRight: 10,\n              paddingTop: 10,\n              paddingBottom: 10,\n              rectInParent: {\n                x: 0,\n                y: '50%',\n                width: '100%',\n                height: '50%',\n                rotate: 0\n              },\n              font: {\n                fontFamily: 'Arial',\n                color: '#222',\n                textAlign: 'left',\n                textBaseline: 'top'\n              }\n            }\n          ]\n        }\n      }\n    ]\n  }\n];\n","import { BaseWidget } from '@blink-mind/renderer-react';\nimport * as React from 'react';\nimport { Topology } from 'topology-core';\nimport { registerNode } from 'topology-core/middles';\nimport { Options } from 'topology-core/options';\n\nimport {\n  flowComment,\n  flowCommentAnchors,\n  flowData,\n  flowDataAnchors,\n  flowDataIconRect,\n  flowDataTextRect,\n  flowDb,\n  flowDbIconRect,\n  flowDbTextRect,\n  flowDisplay,\n  flowDisplayAnchors,\n  flowDisplayIconRect,\n  flowDisplayTextRect,\n  flowDocument,\n  flowDocumentAnchors,\n  flowDocumentIconRect,\n  flowDocumentTextRect,\n  flowExternStorage,\n  flowExternStorageAnchors,\n  flowExternStorageIconRect,\n  flowExternStorageTextRect,\n  flowInternalStorage,\n  flowInternalStorageIconRect,\n  flowInternalStorageTextRect,\n  flowManually,\n  flowManuallyAnchors,\n  flowManuallyIconRect,\n  flowManuallyTextRect,\n  flowParallel,\n  flowParallelAnchors,\n  flowQueue,\n  flowQueueIconRect,\n  flowQueueTextRect,\n  flowSubprocess,\n  flowSubprocessIconRect,\n  flowSubprocessTextRect\n} from 'topology-flow-diagram';\nimport { ToolsConfig } from './tools-config';\n\nimport '@blink-mind/icons/iconfont/topology';\nimport styled from 'styled-components';\nimport {\n  activityFinal,\n  activityFinalIconRect,\n  activityFinalTextRect,\n  fork,\n  forkHAnchors,\n  forkIconRect,\n  forkTextRect,\n  forkVAnchors,\n  swimlaneH,\n  swimlaneHIconRect,\n  swimlaneHTextRect,\n  swimlaneV,\n  swimlaneVIconRect,\n  swimlaneVTextRect\n} from 'topology-activity-diagram';\nimport {\n  interfaceClass,\n  interfaceClassIconRect,\n  interfaceClassTextRect,\n  simpleClass,\n  simpleClassIconRect,\n  simpleClassTextRect\n} from 'topology-class-diagram';\nimport {\n  lifeline,\n  lifelineAnchors,\n  lifelineIconRect,\n  lifelineTextRect,\n  sequenceFocus,\n  sequenceFocusAnchors,\n  sequenceFocusIconRect,\n  sequenceFocusTextRect\n} from 'topology-sequence-diagram';\nimport { TopologyDiagramUtils } from './topology-diagram-utils';\nimport { BLOCK_TYPE_TOPOLOGY, REF_KEY_TOPOLOGY_DIAGRAM_UTIL } from './utils';\n\nconst Root = styled.div`\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 100%;\n`;\n\nconst Canvas = styled.div`\n  flex: 1;\n  width: initial;\n  position: relative;\n  overflow: auto;\n  background: #fff;\n`;\n\nconst Tools = styled.div`\n  flex-shrink: 0;\n  width: 1.75rem;\n  background-color: #f8f8f8;\n  border-right: 1px solid #d9d9d9;\n  overflow-y: auto;\n`;\n\nconst ToolTitle = styled.div`\n  color: #0d1a26;\n  font-weight: 600;\n  font-size: 0.12rem;\n  padding: 0.05rem 0.1rem;\n  margin-top: 0.08rem;\n  border-bottom: 1px solid #ddd;\n\n  &:first-child {\n    border-top: none;\n  }\n`;\n\nconst ToolbarButtons = styled.div`\n  padding: 0.1rem 0;\n  a {\n    display: inline-block;\n    color: @text-color;\n    line-height: 1;\n    width: 0.4rem;\n    height: 0.4rem;\n    text-align: center;\n    text-decoration: none !important;\n\n    .iconfont {\n      font-size: 0.24rem;\n    }\n  }\n`;\n\nexport class TopologyDiagram extends BaseWidget {\n  state = {\n    id: '',\n    data: null,\n    toolsConfig: ToolsConfig,\n    iconfont: { fontSize: '0.24rem' }\n  };\n  topology: Topology;\n\n  canvasOptions: Options = {};\n\n  canvasRegister() {\n    registerNode(\n      'flowData',\n      flowData,\n      flowDataAnchors,\n      flowDataIconRect,\n      flowDataTextRect\n    );\n    registerNode(\n      'flowSubprocess',\n      flowSubprocess,\n      null,\n      flowSubprocessIconRect,\n      flowSubprocessTextRect\n    );\n    registerNode('flowDb', flowDb, null, flowDbIconRect, flowDbTextRect);\n    registerNode(\n      'flowDocument',\n      flowDocument,\n      flowDocumentAnchors,\n      flowDocumentIconRect,\n      flowDocumentTextRect\n    );\n    registerNode(\n      'flowInternalStorage',\n      flowInternalStorage,\n      null,\n      flowInternalStorageIconRect,\n      flowInternalStorageTextRect\n    );\n    registerNode(\n      'flowExternStorage',\n      flowExternStorage,\n      flowExternStorageAnchors,\n      flowExternStorageIconRect,\n      flowExternStorageTextRect\n    );\n    registerNode(\n      'flowQueue',\n      flowQueue,\n      null,\n      flowQueueIconRect,\n      flowQueueTextRect\n    );\n    registerNode(\n      'flowManually',\n      flowManually,\n      flowManuallyAnchors,\n      flowManuallyIconRect,\n      flowManuallyTextRect\n    );\n    registerNode(\n      'flowDisplay',\n      flowDisplay,\n      flowDisplayAnchors,\n      flowDisplayIconRect,\n      flowDisplayTextRect\n    );\n    registerNode('flowParallel', flowParallel, flowParallelAnchors, null, null);\n    registerNode('flowComment', flowComment, flowCommentAnchors, null, null);\n\n    // activity\n    registerNode(\n      'activityFinal',\n      activityFinal,\n      null,\n      activityFinalIconRect,\n      activityFinalTextRect\n    );\n    registerNode(\n      'swimlaneV',\n      swimlaneV,\n      null,\n      swimlaneVIconRect,\n      swimlaneVTextRect\n    );\n    registerNode(\n      'swimlaneH',\n      swimlaneH,\n      null,\n      swimlaneHIconRect,\n      swimlaneHTextRect\n    );\n    registerNode('forkH', fork, forkHAnchors, forkIconRect, forkTextRect);\n    registerNode('forkV', fork, forkVAnchors, forkIconRect, forkTextRect);\n\n    // class\n    registerNode(\n      'simpleClass',\n      simpleClass,\n      null,\n      simpleClassIconRect,\n      simpleClassTextRect\n    );\n    registerNode(\n      'interfaceClass',\n      interfaceClass,\n      null,\n      interfaceClassIconRect,\n      interfaceClassTextRect\n    );\n\n    // sequence\n    registerNode(\n      'lifeline',\n      lifeline,\n      lifelineAnchors,\n      lifelineIconRect,\n      lifelineTextRect\n    );\n    registerNode(\n      'sequenceFocus',\n      sequenceFocus,\n      sequenceFocusAnchors,\n      sequenceFocusIconRect,\n      sequenceFocusTextRect\n    );\n  }\n\n  handleContextMenu = e => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  onMessage = (event, data) => {\n    const { getRef } = this.props;\n    const diagramUtil: TopologyDiagramUtils = getRef(\n      REF_KEY_TOPOLOGY_DIAGRAM_UTIL\n    );\n    switch (event) {\n      case 'resize':\n      case 'scale':\n      case 'locked':\n        if (this.topology && diagramUtil) {\n          diagramUtil.setCanvasData(this.topology.data);\n        }\n        break;\n    }\n  };\n\n  componentDidMount(): void {\n    this.canvasRegister();\n    this.canvasOptions.on = this.onMessage;\n    this.topology = new Topology('topology-canvas', this.canvasOptions);\n    this.openData();\n  }\n\n  componentDidUpdate(): void {\n    this.openData();\n  }\n\n  openData() {\n    const { model, topicKey } = this.props;\n    const topic = model.getTopic(topicKey);\n    const { block } = topic.getBlock(BLOCK_TYPE_TOPOLOGY);\n    if (block && block.data && block.data !== '') {\n      this.setState({\n        data: block.data\n      });\n      this.topology.open(block.data);\n    }\n  }\n\n  onDrag(event: React.DragEvent<HTMLAnchorElement>, node: any) {\n    event.dataTransfer.setData('Text', JSON.stringify(node.data));\n  }\n\n  renderTools() {\n    return (\n      <Tools>\n        {this.state.toolsConfig.map((item, index) => {\n          return (\n            <div key={index}>\n              <ToolTitle>{item.group}</ToolTitle>\n              <ToolbarButtons>\n                {//TODO\n                //@ts-ignore\n                item.children.map((btn, i) => {\n                  return (\n                    <a\n                      key={i}\n                      title={btn.name}\n                      draggable={true}\n                      onDragStart={ev => {\n                        this.onDrag(ev, btn);\n                      }}\n                    >\n                      <i\n                        className={'iconfont ' + btn.icon}\n                        style={this.state.iconfont}\n                      />\n                    </a>\n                  );\n                })}\n              </ToolbarButtons>\n            </div>\n          );\n        })}\n      </Tools>\n    );\n  }\n\n  render() {\n    return (\n      <Root>\n        {this.renderTools()}\n        <Canvas id=\"topology-canvas\" onContextMenu={this.handleContextMenu} />\n      </Root>\n    );\n  }\n}\n","import { OpType } from '@blink-mind/core';\nimport { BaseProps, Btn, Icon, IconName } from '@blink-mind/renderer-react';\nimport { Alert, Classes, Position, Tooltip } from '@blueprintjs/core';\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { Topology } from 'topology-core';\nimport { BLOCK_TYPE_TOPOLOGY, REF_KEY_TOPOLOGY_DIAGRAM } from './utils';\n\nconst Root = styled.div`\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  z-index: 3;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n`;\n\nconst Item_ = styled(Btn)`\n  margin: 10px;\n`;\n\nconst Item = props => {\n  return (\n    <Tooltip\n      content={props.tooltip}\n      position={Position.TOP}\n      className={Classes.ICON}\n    >\n      <Item_ onClick={props.onClick}>{props.children}</Item_>\n    </Tooltip>\n  );\n};\n\nconst ZoomFactorSpan = styled.span`\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n`;\ninterface State {\n  deleteConfirm: boolean;\n  canvasData: any;\n}\n\nexport class TopologyDiagramUtils extends React.Component<BaseProps, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      deleteConfirm: false,\n      canvasData: null\n    };\n  }\n\n  setCanvasData = canvasData => {\n    this.setState({ canvasData });\n  };\n\n  getTopology(): Topology {\n    const { getRef } = this.props;\n    return getRef(REF_KEY_TOPOLOGY_DIAGRAM).topology;\n  }\n\n  onClickResetZoom = e => {\n    const topology = this.getTopology();\n    topology.scaleTo(1);\n  };\n\n  render() {\n    const props = this.props;\n    const { controller } = props;\n\n    const onClickDelete = e => {\n      this.setState({ deleteConfirm: true });\n    };\n    const deleteAlertProps = {\n      isOpen: this.state.deleteConfirm,\n      cancelButtonText: 'cancel',\n      onConfirm: e => {\n        controller.run('operation', {\n          ...props,\n          opType: OpType.DELETE_TOPIC_BLOCK,\n          blockType: BLOCK_TYPE_TOPOLOGY\n        });\n      },\n      onCancel: e => {\n        this.setState({ deleteConfirm: false });\n      },\n      onClose: e => {\n        this.setState({ deleteConfirm: false });\n      }\n    };\n    const { canvasData } = this.state;\n    const scale = canvasData ? canvasData.scale : 1;\n    return (\n      <Root>\n        <Item onClick={this.onClickResetZoom} tooltip=\"reset zoom\">\n          <ZoomFactorSpan>{`zoom:${Math.floor(scale * 100)}%`}</ZoomFactorSpan>\n        </Item>\n        <Item onClick={onClickDelete} tooltip=\"delete this diagram\">\n          {Icon(IconName.TRASH)}\n        </Item>\n        <Alert {...deleteAlertProps}>\n          <p>Are you confirm to delete this topology diagram?</p>\n        </Alert>\n      </Root>\n    );\n  }\n}\n","import { cancelEvent, Icon } from '@blink-mind/renderer-react';\nimport { Drawer } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { TopologyDiagram } from './topology-diagram';\n\nimport { FocusMode, OpType } from '@blink-mind/core';\nimport styled from 'styled-components';\nimport { TopologyDiagramUtils } from './topology-diagram-utils';\nimport {\n  BLOCK_TYPE_TOPOLOGY,\n  REF_KEY_TOPOLOGY_DIAGRAM,\n  REF_KEY_TOPOLOGY_DIAGRAM_UTIL\n} from './utils';\n\nconst DiagramWrapper = styled.div`\n  position: relative;\n  overflow: auto;\n  padding: 0px 0px 0px 5px;\n  background: #88888850;\n  height: 100%;\n`;\n\nconst Title = styled.span`\n  padding: 0px 20px;\n`;\n\nexport function TopologyDrawer(props) {\n  const { controller, topicKey, getRef, saveRef } = props;\n  const onDiagramClose = e => {\n    e.stopPropagation();\n    // const key = `topic-topology-data-${topicKey}`;\n    // const topologyData = controller.run('deleteTempValue', { key });\n\n    const diagram: TopologyDiagram = getRef(REF_KEY_TOPOLOGY_DIAGRAM);\n    const topologyData = diagram.topology.data;\n    controller.run('operation', {\n      ...props,\n      opType: OpType.SET_TOPIC_BLOCK,\n      topicKey,\n      blockType: BLOCK_TYPE_TOPOLOGY,\n      data: topologyData,\n      focusMode: FocusMode.NORMAL\n    });\n  };\n  const diagramProps = {\n    ...props,\n    ref: saveRef(REF_KEY_TOPOLOGY_DIAGRAM)\n  };\n  const utilProps = {\n    ...props,\n    ref: saveRef(REF_KEY_TOPOLOGY_DIAGRAM_UTIL)\n  };\n  return (\n    <Drawer\n      title={<Title>Topology Diagram Editor</Title>}\n      icon={Icon('topology')}\n      isOpen\n      hasBackdrop\n      backdropClassName=\"backdrop\"\n      backdropProps={{ onMouseDown: cancelEvent }}\n      canOutsideClickClose={false}\n      isCloseButtonShown={true}\n      onClose={onDiagramClose}\n      size=\"100%\"\n    >\n      <DiagramWrapper onClick={cancelEvent} onDoubleClick={cancelEvent}>\n        <TopologyDiagram {...diagramProps} />\n        <TopologyDiagramUtils {...utilProps} />\n      </DiagramWrapper>\n    </Drawer>\n  );\n}\n","import { BaseModifierArg, ModelModifier } from '@blink-mind/core';\nimport { Icon } from '@blink-mind/renderer-react';\nimport { MenuDivider, MenuItem } from '@blueprintjs/core';\nimport * as React from 'react';\nimport { TopicBlockTopology } from './topic-block-topology';\nimport { TopologyDrawer } from './topology-drawer';\nimport {\n  BLOCK_TYPE_TOPOLOGY,\n  FOCUS_MODE_EDITING_TOPOLOGY,\n  OP_TYPE_START_EDITING_TOPOLOGY\n} from './utils';\n\nfunction startEditingTopology({ model, topicKey }: BaseModifierArg) {\n  const topic = model.getTopic(topicKey);\n  const { block } = topic.getBlock(BLOCK_TYPE_TOPOLOGY);\n  if (block == null || block.data == null) {\n    model = ModelModifier.setBlockData({\n      model,\n      topicKey,\n      blockType: BLOCK_TYPE_TOPOLOGY,\n      data: ''\n    });\n  }\n  model = ModelModifier.focusTopic({\n    model,\n    topicKey,\n    focusMode: FOCUS_MODE_EDITING_TOPOLOGY\n  });\n  return model;\n}\n\nexport default function TopologyDiagramPlugin() {\n  return {\n    renderTopicBlock(props, next) {\n      const { controller, block } = props;\n      if (block.type === BLOCK_TYPE_TOPOLOGY) {\n        return controller.run('renderTopicBlockTopology', props);\n      }\n      return next();\n    },\n\n    renderTopicBlockTopology(props) {\n      return <TopicBlockTopology {...props} />;\n    },\n\n    renderDrawer(props, next) {\n      const { model } = props;\n      if (model.focusMode === FOCUS_MODE_EDITING_TOPOLOGY) {\n        const topoProps = {\n          ...props,\n          topicKey: model.focusKey,\n          key: 'topology-drawer'\n        };\n        return <TopologyDrawer {...topoProps} />;\n      }\n      return next();\n    },\n\n    customizeTopicContextMenu(props, next) {\n      const { controller } = props;\n      function editTopology(e) {\n        controller.run('operation', {\n          ...props,\n          opType: OP_TYPE_START_EDITING_TOPOLOGY\n        });\n      }\n      return (\n        <>\n          {next()}\n          <MenuDivider />\n          <MenuItem\n            icon={Icon('topology')}\n            text=\"Edit Topology Diagram\"\n            onClick={editTopology}\n          />\n        </>\n      );\n    },\n\n    getOpMap(props, next) {\n      const opMap = next();\n      opMap.set(OP_TYPE_START_EDITING_TOPOLOGY, startEditingTopology);\n      return opMap;\n    }\n  };\n}\n","module.exports = __webpack_public_path__ + \"static/media/default.4f8c4983.jpg\";","module.exports = __webpack_public_path__ + \"static/media/theme1.2f59f00b.jpg\";","module.exports = __webpack_public_path__ + \"static/media/theme2.b18193fb.jpg\";","module.exports = __webpack_public_path__ + \"static/media/theme3.61c97910.jpg\";","module.exports = __webpack_public_path__ + \"static/media/theme4.1e21408c.jpg\";","import debug from 'debug';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nimport { List, Record, Map as Map$1 } from 'immutable';\nimport isPlainObject from 'is-plain-object';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n}\n\nfunction CorePlugin(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _a = options.plugins,\n      plugins = _a === void 0 ? [] : _a;\n  return __spread(plugins);\n}\n\nvar log = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  var e_1, _a;\n\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  try {\n    for (var middleware_1 = __values(middleware), middleware_1_1 = middleware_1.next(); !middleware_1_1.done; middleware_1_1 = middleware_1.next()) {\n      var fn = middleware_1_1.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (middleware_1_1 && !middleware_1_1.done && (_a = middleware_1.return)) _a.call(middleware_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller =\n/** @class */\nfunction () {\n  function Controller(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _a = options.plugins,\n        plugins = _a === void 0 ? [] : _a,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  Controller.prototype.run = function (key) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    var middleware = this.middleware;\n    var fns = middleware[key] || [];\n    warning(fns.length !== 0, \"the middleware function \" + key + \" is not found!\");\n    var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n    return composedFn.apply(void 0, __spread(args));\n  };\n\n  Controller.prototype.getValue = function (propKey, arg) {\n    return this.run('getValue', _assign(_assign({}, arg), {\n      propKey: propKey\n    }));\n  };\n\n  Controller.prototype.change = function (model, callback) {\n    this.onChange(model, callback);\n    this.currentModel = model;\n  };\n\n  return Controller;\n}();\n\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block =\n/** @class */\nfunction (_super) {\n  __extends(Block, _super);\n\n  function Block() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(Block.prototype, \"data\", {\n    get: function get() {\n      return this.get('data');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Block.prototype, \"type\", {\n    get: function get() {\n      return this.get('type');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Block.create = function (obj) {\n    return new Block(obj);\n  };\n\n  Block.createList = function (obj) {\n    if (List.isList(obj) || Array.isArray(obj)) {\n      // @ts-ignore\n      return List(obj.map(Block.create));\n    }\n\n    throw new Error(\"Block.createList only accepts Array or List, but you passed it: \" + obj);\n  };\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic =\n/** @class */\nfunction (_super) {\n  __extends(Topic, _super);\n\n  function Topic() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(Topic.prototype, \"key\", {\n    get: function get() {\n      return this.get('key');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"parentKey\", {\n    get: function get() {\n      return this.get('parentKey');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"collapse\", {\n    get: function get() {\n      return this.get('collapse');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"subKeys\", {\n    get: function get() {\n      return this.get('subKeys');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"blocks\", {\n    get: function get() {\n      return this.get('blocks');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"relations\", {\n    get: function get() {\n      return this.get('relations');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"style\", {\n    get: function get() {\n      return this.get('style');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Topic.prototype.getBlock = function (type) {\n    var index = this.blocks.findIndex(function (b) {\n      return b.type === type;\n    });\n    if (index === -1) return {\n      index: index,\n      block: null\n    };\n    return {\n      index: index,\n      block: this.blocks.get(index)\n    };\n  };\n\n  Topic.fromJSON = function (obj) {\n    var key = obj.key,\n        _a = obj.parentKey,\n        parentKey = _a === void 0 ? null : _a,\n        blocks = obj.blocks,\n        _b = obj.subKeys,\n        subKeys = _b === void 0 ? [] : _b,\n        _c = obj.collapse,\n        collapse = _c === void 0 ? false : _c;\n    return new Topic({\n      key: key,\n      parentKey: parentKey,\n      collapse: collapse,\n      subKeys: List(subKeys),\n      blocks: Block.createList(blocks)\n    });\n  };\n\n  Topic.create = function (_a) {\n    var key = _a.key,\n        _b = _a.parentKey,\n        parentKey = _b === void 0 ? null : _b,\n        _c = _a.content,\n        content = _c === void 0 ? '' : _c,\n        _d = _a.subKeys,\n        subKeys = _d === void 0 ? [] : _d,\n        _e = _a.collapse,\n        collapse = _e === void 0 ? false : _e;\n    var block = Block.create({\n      type: BlockType.CONTENT,\n      data: content,\n      key: null\n    });\n    var blocks = List([block]);\n    return new Topic({\n      key: key,\n      parentKey: parentKey,\n      blocks: blocks,\n      subKeys: List(subKeys),\n      collapse: collapse\n    });\n  };\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var subKeys = item.subKeys.toArray();\n    res.push.apply(res, __spread(subKeys));\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, __spread(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey, reverse) {\n  if (reverse === void 0) {\n    reverse = false;\n  }\n\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log$1 = debug('modifier');\n\nfunction toggleCollapse(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_a) {\n  var model = _a.model;\n  log$1('collapseAll');\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log$1(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  log$1(model);\n  return model;\n}\n\nfunction expandAll(_a) {\n  var model = _a.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log$1(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log$1(model);\n  return model;\n}\n\nfunction expandTo(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // 要让这个节点在视口中可见\n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      focusMode = _a.focusMode;\n  log$1('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_a) {\n  var model = _a.model,\n      focusMode = _a.focusMode;\n  log$1('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  log$1('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child_1 = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child_1.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child_1.key, child_1);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child_1.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx_1 = pItem.subKeys.indexOf(topicKey);\n    var sibling_1 = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling_1.key, sibling_1);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx_1 + 1, sibling_1.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling_1.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      blockType = _a.blockType,\n      focusMode = _a.focusMode,\n      data = _a.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _b = topic.getBlock(blockType),\n        index = _b.index,\n        block = _b.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      blockType = _a.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var index_1 = topic.getBlock(blockType).index;\n\n    if (index_1 !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index_1);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      style = _a.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction setTheme(_a) {\n  var model = _a.model,\n      theme = _a.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_a) {\n  var model = _a.model,\n      layoutDir = _a.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_a) {\n  var model = _a.model,\n      zoomFactor = _a.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config =\n/** @class */\nfunction (_super) {\n  __extends(Config, _super);\n\n  function Config() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(Config.prototype, \"layoutDir\", {\n    get: function get() {\n      return this.get('layoutDir');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Config.prototype, \"readOnly\", {\n    get: function get() {\n      return this.get('readOnly');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Config.prototype, \"allowUndo\", {\n    get: function get() {\n      return this.get('allowUndo');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Config.prototype, \"theme\", {\n    get: function get() {\n      return this.get('theme');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Config.fromJSON = function (obj) {\n    return new Config(obj);\n  };\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: null,\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model =\n/** @class */\nfunction (_super) {\n  __extends(Model, _super);\n\n  function Model() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Model.isModel = function (obj) {\n    return obj instanceof Model;\n  };\n\n  Model.create = function (attrs) {\n    if (attrs === void 0) {\n      attrs = null;\n    }\n\n    if (attrs == null) return Model.createEmpty();\n    var res;\n\n    if (Model.isModel(attrs)) {\n      res = attrs;\n    }\n\n    if (isPlainObject(attrs)) {\n      res = Model.fromJSON(attrs);\n    }\n\n    if (res) {\n      if (res.focusKey == null) {\n        res = res.set('focusKey', res.rootTopicKey);\n      }\n\n      if (res.focusMode == null) {\n        res = res.set('focusMode', FocusMode.NORMAL);\n      }\n\n      return res;\n    }\n\n    throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \" + attrs);\n  };\n\n  Model.createEmpty = function () {\n    var model = new Model();\n    var rootTopic = Topic.create({\n      key: createKey()\n    });\n    return model.update('topics', function (topics) {\n      return topics.set(rootTopic.key, rootTopic);\n    }).set('rootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n  };\n\n  Model.fromJSON = function (object) {\n    var model = new Model();\n    var _a = object.topics,\n        topics = _a === void 0 ? [] : _a,\n        _b = object.config,\n        config = _b === void 0 ? {} : _b,\n        rootTopicKey = object.rootTopicKey;\n    var editorRootTopicKey = object.editorRootTopicKey;\n    if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n    model = model.merge({\n      rootTopicKey: rootTopicKey,\n      editorRootTopicKey: editorRootTopicKey\n    });\n    model = model.withMutations(function (model) {\n      topics.forEach(function (topic) {\n        model.update('topics', function (topics) {\n          return topics.set(topic.key, Topic.fromJSON(topic));\n        });\n      });\n      model.set('config', Config.fromJSON(config));\n    });\n    return model;\n  };\n\n  Model.prototype.toJS = function () {\n    var obj = {\n      rootTopicKey: this.rootTopicKey,\n      topics: Object.values(this.topics.toJS()),\n      config: this.config,\n      extData: this.extData,\n      zoomFactor: this.zoomFactor\n    };\n    return obj;\n  };\n\n  Object.defineProperty(Model.prototype, \"extData\", {\n    get: function get() {\n      return this.get('extData');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"topics\", {\n    get: function get() {\n      return this.get('topics');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"config\", {\n    get: function get() {\n      return this.get('config');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"formatVersion\", {\n    get: function get() {\n      return this.get('formatVersion');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"rootTopicKey\", {\n    get: function get() {\n      return this.get('rootTopicKey');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"editorRootTopicKey\", {\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"focusKey\", {\n    get: function get() {\n      return this.get('focusKey');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"focusMode\", {\n    get: function get() {\n      return this.get('focusMode');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"editingContentKey\", {\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"editingDescKey\", {\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Model.prototype.getTopic = function (key) {\n    return this.topics.get(key);\n  };\n\n  Model.prototype.getExtDataItem = function (key, c) {\n    return this.extData.get(key) || new c();\n  };\n\n  Model.prototype.getParentTopic = function (key) {\n    var topic = this.getTopic(key);\n    return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n  };\n\n  Model.prototype.getTopicVisualLevel = function (key) {\n    var topic = this.getTopic(key);\n    var level = 0;\n\n    while (topic && topic.key !== this.editorRootTopicKey) {\n      level++;\n      topic = this.getParentTopic(topic.key);\n    }\n\n    return level;\n  };\n\n  Object.defineProperty(Model.prototype, \"rootTopic\", {\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"zoomFactor\", {\n    get: function get() {\n      return this.get('zoomFactor');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return Model;\n}(Record(defaultModelRecord));\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, modifiers as Modifiers, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import './iconfont.css';","import debug from 'debug';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nimport { IControllerOption } from './interfaces';\nimport { Model } from './models';\nimport { CorePlugin } from './plugins/core';\nimport { OnChangeFunction } from './types';\n\nconst log = debug('core:controller');\n\nfunction registerPlugin(controller: Controller, plugin: any) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(p => registerPlugin(controller, p));\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (const key in plugin) {\n    const fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n}\n\n// modified from koa-compose\nfunction compose(middleware) {\n  if (!Array.isArray(middleware))\n    throw new TypeError('Middleware stack must be an array!');\n  for (const fn of middleware) {\n    if (typeof fn !== 'function')\n      throw new TypeError('Middleware must be composed of functions!');\n  }\n\n  return function(context, next) {\n    // last called middleware #\n    let index = -1;\n    return dispatch(0);\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      let fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nexport class Controller {\n  middleware: Map<string, Function[]>;\n  private readonly onChange: OnChangeFunction;\n  public readOnly: boolean;\n  public currentModel: Model;\n\n  constructor(options: IControllerOption = {}) {\n    const { plugins = [], onChange, readOnly } = options;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    const corePlugin = CorePlugin({ plugins });\n    registerPlugin(this, corePlugin);\n  }\n\n  run(key: string, ...args: any[]) {\n    const { middleware } = this;\n    const fns = middleware[key] || [];\n    warning(fns.length !== 0, `the middleware function ${key} is not found!`);\n    const composedFn = memoizeOne(compose)(fns);\n    // @ts-ignore\n    return composedFn(...args);\n  }\n\n  getValue(propKey: string, arg?) {\n    return this.run('getValue', { ...arg, propKey });\n  }\n\n  change(model: Model, callback?: () => void) {\n    this.onChange(model, callback);\n    this.currentModel = model;\n  }\n}\n","import { Model } from '@blink-mind/core';\n\nexport type KeyType = string;\n\nexport type KeyPath = KeyType[];\n\nexport const TopicDirection = {\n  LEFT: 'L', // 从右向左\n  RIGHT: 'R', // 从左向右\n  BOTTOM: 'B', // 从上往下\n  MAIN: 'M' // root\n};\n\nexport enum DiagramLayoutType {\n  LEFT_TO_RIGHT,\n  RIGHT_TO_LEFT,\n  LEFT_AND_RIGHT,\n  TOP_TO_BOTTOM\n}\n\nexport const TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\n\nexport const BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\n\nexport const FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\n\nexport type OnChangeFunction = (model: Model, callback?: () => void) => void;\n\nexport const TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\n\nexport const OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\n","export function CorePlugin(options: any = {}) {\n  const { plugins = [] } = options;\n  return [...plugins];\n}\n","import { List, Record } from 'immutable';\nimport { KeyType } from '../types';\n\ntype BlockRecordType = {\n  type: string;\n  key?: KeyType;\n  data: any;\n};\n\nconst defaultBlockRecord: BlockRecordType = {\n  type: null,\n  key: null,\n  data: null\n};\n\nexport class Block extends Record(defaultBlockRecord) {\n  get data() {\n    return this.get('data');\n  }\n\n  get type() {\n    return this.get('type');\n  }\n\n  static create(obj: BlockRecordType): Block {\n    return new Block(obj);\n  }\n\n  static createList(obj: any): List<Block> {\n    if (List.isList(obj) || Array.isArray(obj)) {\n      // @ts-ignore\n      return List(obj.map(Block.create));\n    }\n    throw new Error(\n      `Block.createList only accepts Array or List, but you passed it: ${obj}`\n    );\n  }\n}\n","import { List, Record } from 'immutable';\nimport { BlockType, KeyType } from '../types';\nimport { Block } from './block';\nimport { Relation } from './relation';\n\ntype TopicRecordType = {\n  key: KeyType;\n  parentKey?: KeyType;\n  collapse?: boolean;\n  subKeys?: List<KeyType>;\n  blocks?: List<Block>;\n  relations?: List<Relation>;\n  style?: string;\n};\n\ntype CreateTopicArg = {\n  key: KeyType;\n  parentKey?: KeyType;\n  collapse?: boolean;\n  content?: any;\n  subKeys?: List<KeyType> | KeyType[];\n  style?: string;\n};\n\nconst defaultTopicRecord: TopicRecordType = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nexport class Topic extends Record(defaultTopicRecord) {\n  get key() {\n    return this.get('key');\n  }\n  get parentKey() {\n    return this.get('parentKey');\n  }\n  get collapse() {\n    return this.get('collapse');\n  }\n  get subKeys(): List<KeyType> {\n    return this.get('subKeys');\n  }\n  get blocks(): List<Block> {\n    return this.get('blocks');\n  }\n  get relations() {\n    return this.get('relations');\n  }\n  get style() {\n    return this.get('style');\n  }\n\n  getBlock(type: string): { index: number; block: Block } {\n    const index = this.blocks.findIndex(b => b.type === type);\n    if (index === -1) return { index, block: null };\n    return { index, block: this.blocks.get(index) };\n  }\n\n  static fromJSON(obj) {\n    const {\n      key,\n      parentKey = null,\n      blocks,\n      subKeys = [],\n      collapse = false\n    } = obj;\n    return new Topic({\n      key,\n      parentKey,\n      collapse,\n      subKeys: List(subKeys),\n      blocks: Block.createList(blocks)\n    });\n  }\n\n  static create({\n    key,\n    parentKey = null,\n    content = '',\n    subKeys = [],\n    collapse = false\n  }: CreateTopicArg): Topic {\n    const block = Block.create({\n      type: BlockType.CONTENT,\n      data: content,\n      key: null\n    });\n    const blocks = List([block]);\n    return new Topic({\n      key,\n      parentKey,\n      blocks,\n      subKeys: List(subKeys),\n      collapse\n    });\n  }\n}\n","import { KeyPath, KeyType, TopicRelationship } from '../../types';\nimport { Model } from '../model';\n\nexport function getAllSubTopicKeys(model: Model, topicKey: KeyType): KeyType[] {\n  const item = model.getTopic(topicKey);\n\n  let res = [];\n  if (item.subKeys.size > 0) {\n    const subKeys = item.subKeys.toArray();\n    res.push(...subKeys);\n    res = subKeys.reduce((acc, key) => {\n      acc.push(...getAllSubTopicKeys(model, key));\n      return acc;\n    }, res);\n  }\n  return res;\n}\n\nexport function getKeyPath(\n  model: Model,\n  topicKey: KeyType,\n  reverse: boolean = false\n): KeyPath {\n  const res = [topicKey];\n  let item = model.getTopic(topicKey);\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n  return res;\n}\n\nexport function getRelationship(\n  model: Model,\n  srcKey: KeyType,\n  dstKey: KeyType\n): string {\n  const srcTopic = model.getTopic(srcKey);\n  const dstTopic = model.getTopic(dstKey);\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey)\n      return TopicRelationship.SIBLING;\n    let pTopic = srcTopic;\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key)\n        return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n    pTopic = dstTopic;\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n  return TopicRelationship.NONE;\n}\n","import debug from 'debug';\nimport { FocusMode, TopicRelationship } from '../../types';\nimport { createKey } from '../../utils';\nimport { Block } from '../block';\nimport { Topic } from '../topic';\nimport { getAllSubTopicKeys, getKeyPath, getRelationship } from '../utils';\nimport {\n  BaseModifierArg,\n  DeleteBlockArg,\n  ModifierResult,\n  SetBlockDataArg,\n  SetFocusModeArg,\n  SetLayoutDirArg,\n  SetThemeArg,\n  SetTopicStyleArg,\n  SetZoomFactorArg\n} from './types';\n\nconst log = debug('modifier');\n\nfunction toggleCollapse({ model, topicKey }: BaseModifierArg): ModifierResult {\n  let topic = model.getTopic(topicKey);\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(\n      ['topics', topic.key, 'collapse'],\n      collapse => !collapse\n    );\n  }\n  model = focusTopic({ model, topicKey, focusMode: FocusMode.NORMAL });\n  return model;\n}\n\nfunction collapseAll({ model }: BaseModifierArg): ModifierResult {\n  log('collapseAll');\n  const topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(m => {\n    topicKeys.forEach(topicKey => {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandAll({ model }: BaseModifierArg): ModifierResult {\n  const topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(m => {\n    topicKeys.forEach(topicKey => {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo({ model, topicKey }: BaseModifierArg): ModifierResult {\n  const keys = getKeyPath(model, topicKey).filter(t => t !== topicKey);\n  model = model.withMutations(m => {\n    keys.forEach(topicKey => {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  // 要让这个节点在视口中可见\n  if (\n    getRelationship(model, topicKey, model.editorRootTopicKey) !==\n    TopicRelationship.DESCENDANT\n  ) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n  return model;\n}\n\nfunction focusTopic({\n  model,\n  topicKey,\n  focusMode\n}: SetFocusModeArg): ModifierResult {\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode({ model, focusMode }: SetFocusModeArg): ModifierResult {\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild({ model, topicKey }: BaseModifierArg): ModifierResult {\n  log('addChild:', topicKey);\n  let topic = model.getTopic(topicKey);\n  if (topic) {\n    const child = Topic.create({ key: createKey(), parentKey: topic.key });\n    topic = topic\n      .set('collapse', false)\n      .update('subKeys', subKeys => subKeys.push(child.key));\n    model = model.update('topics', topics =>\n      topics.set(topicKey, topic).set(child.key, child)\n    );\n    return focusTopic({\n      model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n  return model;\n}\n\nfunction addSibling({ model, topicKey }: BaseModifierArg): ModifierResult {\n  if (topicKey === model.rootTopicKey) return model;\n  const topic = model.getTopic(topicKey);\n  if (topic) {\n    const pItem = model.getTopic(topic.parentKey);\n    const idx = pItem.subKeys.indexOf(topicKey);\n    const sibling = Topic.create({ key: createKey(), parentKey: pItem.key });\n    model = model\n      .update('topics', topics => topics.set(sibling.key, sibling))\n      .updateIn(['topics', pItem.key, 'subKeys'], subKeys =>\n        subKeys.insert(idx + 1, sibling.key)\n      );\n    return focusTopic({\n      model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n  return model;\n}\n\nfunction deleteTopic({ model, topicKey }: BaseModifierArg): ModifierResult {\n  if (topicKey === model.editorRootTopicKey) return model;\n  const item = model.getTopic(topicKey);\n  if (item) {\n    model = model.withMutations(m => {\n      m.update('topics', topics => {\n        topics = topics.delete(topicKey);\n        const deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(t => {\n          deleteKeys.forEach(dKey => {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], subKeys =>\n        subKeys.delete(subKeys.indexOf(topicKey))\n      );\n      if (m.focusKey === topicKey)\n        m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n\n/**\n * setBlockData of one topic\n * @param model\n * @param topicKey\n * @param blockType\n * @param focusMode\n * @param data\n */\nfunction setBlockData({\n  model,\n  topicKey,\n  blockType,\n  focusMode,\n  data\n}: SetBlockDataArg): ModifierResult {\n  const topic = model.getTopic(topicKey);\n  if (topic) {\n    const { index, block } = topic.getBlock(blockType);\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], blocks =>\n        blocks.push(\n          Block.create({\n            type: blockType,\n            data: data\n          })\n        )\n      );\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(\n          ['topics', topicKey, 'blocks', index, 'data'],\n          dt => data\n        );\n      }\n    }\n    if (focusMode) {\n      model = focusTopic({\n        model,\n        topicKey,\n        focusMode\n      });\n    }\n  }\n  return model;\n}\n\nfunction deleteBlock({ model, topicKey, blockType }: DeleteBlockArg) {\n  const topic = model.getTopic(topicKey);\n  if (topic) {\n    const { index } = topic.getBlock(blockType);\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], blocks =>\n        blocks.delete(index)\n      );\n    }\n    model = focusTopic({\n      model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n  return model;\n}\n\nfunction setStyle({\n  model,\n  topicKey,\n  style\n}: SetTopicStyleArg): ModifierResult {\n  const topic = model.getTopic(topicKey);\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], s => style);\n    }\n  }\n  return model;\n}\n\nfunction setTheme({ model, theme }: SetThemeArg): ModifierResult {\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir({ model, layoutDir }: SetLayoutDirArg): ModifierResult {\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey({\n  model,\n  topicKey\n}: BaseModifierArg): ModifierResult {\n  if (model.editorRootTopicKey !== topicKey)\n    model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse)\n    model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor({\n  model,\n  zoomFactor\n}: SetZoomFactorArg): ModifierResult {\n  if (model.zoomFactor !== zoomFactor)\n    model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nexport default {\n  addChild,\n  addSibling,\n  toggleCollapse,\n  collapseAll,\n  expandAll,\n  expandTo,\n  focusTopic,\n  setFocusMode,\n  deleteTopic,\n  setBlockData,\n  deleteBlock,\n  setStyle,\n  setTheme,\n  setLayoutDir,\n  setEditorRootTopicKey,\n  setZoomFactor\n};\n","import { ThemeType } from './types';\n\nexport const defaultTheme: ThemeType = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\n","import { Record } from 'immutable';\nimport { defaultTheme, ThemeType } from '../configs/theme';\nimport { DiagramLayoutType } from '../types';\n\ntype ConfigRecordType = {\n  readOnly?: boolean;\n  allowUndo?: boolean;\n  layoutDir?: DiagramLayoutType;\n  theme?: ThemeType;\n};\n\nconst defaultConfigRecord: ConfigRecordType = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nexport class Config extends Record(defaultConfigRecord) {\n  get layoutDir(): DiagramLayoutType {\n    return this.get('layoutDir');\n  }\n\n  get readOnly(): boolean {\n    return this.get('readOnly');\n  }\n\n  get allowUndo(): boolean {\n    return this.get('allowUndo');\n  }\n\n  get theme(): ThemeType {\n    return this.get('theme');\n  }\n\n  static fromJSON(obj) {\n    return new Config(obj);\n  }\n}\n","import { Map, Record } from 'immutable';\nimport isPlainObject from 'is-plain-object';\nimport { FocusMode, KeyType } from '../types';\nimport { createKey } from '../utils';\nimport { Config } from './config';\nimport { Topic } from './topic';\n\nexport type ExtData = Map<string, any>;\n\ntype ModelRecordType = {\n  topics: Map<KeyType, Topic>;\n  extData: ExtData; //用于插件做数据扩展\n  config: Config;\n  rootTopicKey: KeyType;\n  editorRootTopicKey?: KeyType;\n  focusKey?: KeyType;\n  focusMode?: string;\n  zoomFactor: number;\n  formatVersion?: string;\n};\n\nconst defaultModelRecord: ModelRecordType = {\n  topics: Map(),\n  extData: Map(),\n  config: null,\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nexport class Model extends Record(defaultModelRecord) {\n  static isModel(obj) {\n    return obj instanceof Model;\n  }\n  static create(attrs: any = null): Model {\n    if (attrs == null) return Model.createEmpty();\n    let res: Model;\n    if (Model.isModel(attrs)) {\n      res = attrs;\n    }\n\n    if (isPlainObject(attrs)) {\n      res = Model.fromJSON(attrs);\n    }\n    if (res) {\n      if (res.focusKey == null) {\n        res = res.set('focusKey', res.rootTopicKey);\n      }\n      if (res.focusMode == null) {\n        res = res.set('focusMode', FocusMode.NORMAL);\n      }\n      return res;\n    }\n\n    throw new Error(\n      `\\`Value.create\\` only accepts objects or values, but you passed it: ${attrs}`\n    );\n  }\n\n  static createEmpty(): Model {\n    const model = new Model();\n    const rootTopic = Topic.create({ key: createKey() });\n    return model\n      .update('topics', topics => topics.set(rootTopic.key, rootTopic))\n      .set('rootTopicKey', rootTopic.key)\n      .set('focusKey', rootTopic.key)\n      .set('focusMode', FocusMode.NORMAL);\n  }\n\n  static fromJSON(object) {\n    let model = new Model();\n    const { topics = [], config = {}, rootTopicKey } = object;\n    let { editorRootTopicKey } = object;\n\n    if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n\n    model = model.merge({\n      rootTopicKey,\n      editorRootTopicKey\n    });\n\n    model = model.withMutations(model => {\n      topics.forEach(topic => {\n        model.update('topics', topics =>\n          topics.set(topic.key, Topic.fromJSON(topic))\n        );\n      });\n      model.set('config', Config.fromJSON(config));\n    });\n\n    return model;\n  }\n\n  toJS() {\n    const obj = {\n      rootTopicKey: this.rootTopicKey,\n      topics: Object.values(this.topics.toJS()),\n      config: this.config,\n      extData: this.extData,\n      zoomFactor: this.zoomFactor\n    };\n    return obj;\n  }\n\n  get extData(): Map<string, any> {\n    return this.get('extData');\n  }\n\n  get topics(): Map<KeyType, Topic> {\n    return this.get('topics');\n  }\n\n  get config(): Config {\n    return this.get('config');\n  }\n\n  get formatVersion(): string {\n    return this.get('formatVersion');\n  }\n\n  get rootTopicKey(): KeyType {\n    return this.get('rootTopicKey');\n  }\n\n  get editorRootTopicKey(): KeyType {\n    return this.get('editorRootTopicKey');\n  }\n\n  get focusKey(): KeyType {\n    return this.get('focusKey');\n  }\n\n  get focusMode(): KeyType {\n    return this.get('focusMode');\n  }\n\n  get editingContentKey(): KeyType {\n    return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n  }\n\n  get editingDescKey(): KeyType {\n    return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n  }\n\n  getTopic(key: KeyType): Topic {\n    return this.topics.get(key);\n  }\n\n  getExtDataItem<T>(key: string, c: new () => T): any {\n    return this.extData.get(key) || new c();\n  }\n\n  getParentTopic(key: KeyType): Topic {\n    const topic = this.getTopic(key);\n    return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n  }\n\n  getTopicVisualLevel(key: KeyType): number {\n    let topic = this.getTopic(key);\n    let level = 0;\n    while (topic && topic.key !== this.editorRootTopicKey) {\n      level++;\n      topic = this.getParentTopic(topic.key);\n    }\n    return level;\n  }\n\n  get rootTopic() {\n    return this.getTopic(this.rootTopicKey);\n  }\n\n  get zoomFactor() {\n    return this.get('zoomFactor');\n  }\n}\n","export type LinkStyle = {\n  lineType?: string;\n  lineWidth?: string;\n  lineColor?: string;\n  lineRadius?: number;\n};\n\nexport type TopicContentStyle = {\n  background?: string;\n  color?: string;\n  fontSize?: string;\n  lineHeight?: string;\n  borderRadius?: string;\n  borderWidth?: string;\n  borderStyle?: string;\n  borderColor?: string;\n  padding?: string;\n};\n\nexport type TopicStyle = {\n  contentStyle?: TopicContentStyle;\n  linkStyle?: LinkStyle;\n  subLinkStyle?: LinkStyle;\n};\n\nexport type ThemeType = {\n  name: string;\n  background: string;\n  highlightColor: string;\n  randomColor?: boolean;\n  marginH: number;\n  marginV: number;\n\n  contentStyle?: TopicContentStyle;\n  linkStyle?: LinkStyle;\n\n  rootTopic?: TopicStyle;\n  primaryTopic?: TopicStyle;\n  normalTopic?: TopicStyle;\n};\n\nexport function isThemeType(obj: any): boolean {\n  return (\n    obj.name != null && obj.background != null && obj.highlightColor != null\n  );\n}\n\nexport interface Themes {\n  [fieldName: string]: ThemeType;\n}\n","export const filterOptions = [\n    {\n        label: \"Calendar\",\n        value: \"calendar\"\n    },\n    {\n        label: \"Notes\",\n        value: \"notes\"\n    }\n]\n\nexport const navTimelineOptions = [\n    {\n        label: \"Previous\",\n        value: \"previous\"\n    },\n    {\n        label: \"Current\",\n        value: \"current\"\n    },\n    {\n        label: \"Next\",\n        value: \"next\"\n    }\n]\n\nexport const urls = {\n    base: \"http://localhost:3200/api\",\n    user: {\n        register: \"http://localhost:3200/api/user/register\",\n        login: \"http://localhost:3200/api/user/login\"\n    },\n    project: {\n        base: \"http://localhost:3200/api/project\",\n        create: \"http://localhost:3200/api/project/create\",\n        list: \"http://localhost:3200/api/project/list\"\n    },\n    upload: \"http://localhost:3200/api/upload\",\n    workspace: {\n        base: \"http://localhost:3200/api/workspace\",\n        create: \"http://localhost:3200/api/workspace/create\",\n        list: \"http://localhost:3200/api/workspace/list\"\n    }\n}\n\nexport function QueryStringToJSON() {            \n    var pairs = window.location.search.slice(1).split('&');\n    \n    var result = {};\n    pairs.forEach(function(pair) {\n        pair = pair.split('=');\n        result[pair[0]] = decodeURIComponent(pair[1] || '');\n    });\n\n    return JSON.parse(JSON.stringify(result));\n}\n\nexport const defaults = {\n    label: \"Work\",\n    status: \"Todo\"\n}","import { urls } from \"../utils/config\";\n\nexport function createWiki(workspace) {\n    let payload = {};\n    payload.user_id = localStorage.getItem(\"user_id\");\n    payload.name = workspace;\n    let url = urls.workspace.create;\n    return new Promise((resolve, reject) => {\n        fetch(url, {\n            method: 'POST',\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(payload)\n        })\n            .then((response) => {\n                if (response.ok) {\n                    return response.json();\n                } else {\n                    throw {\n                        msg: response.statusText,\n                        status: response.status\n                    }\n                }\n            })\n            .then((data) => {\n                // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n                // console.log('Create project response:', data, \"WITH parentProjectId\", parentProjectId);\n                resolve(data);\n            })\n            .catch((error) => {\n                console.error('Error:', error);\n                reject(error);\n            });\n    });\n}\n\nexport function getWorkspaces() {\n    return new Promise((resolve, reject) => {\n        fetch(urls.workspace.list + \"/\" + localStorage.getItem('user_id'), {\n            method: 'GET',\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                'Content-Type': 'application/json',\n            }\n        })\n            .then((response) => {\n                if (response.ok) {\n                    return response.json();\n                } else {\n                    throw {\n                        msg: response.statusText,\n                        status: response.status\n                    }\n                }\n            })\n            .then((data) => {\n                // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n                // console.log('Projects found list for this user logged in:', data);\n                resolve(data);\n            })\n            .catch((error) => {\n                console.log('Error:', error);\n                reject(error);\n            });\n    });\n}\n\nexport const deleteWorkspaceService = (id) => {\n    return new Promise((resolve, reject) => {\n        fetch(urls.workspace.base + \"/\" + localStorage.getItem(\"user_id\") + \"/delete/\" + id, {\n            method: 'DELETE',\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                'Content-Type': 'application/json',\n            }\n        })\n            .then((response) => {\n                if (response.ok) {\n                    return response.json();\n                } else {\n                    throw {\n                        msg: response.statusText,\n                        status: response.status\n                    }\n                }\n            })\n            .then((data) => {\n                // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n                // console.log('delete project response:', data);\n                resolve(data);\n            })\n            .catch((error) => {\n                console.error('Error:', error);\n                reject(error);\n            });\n    })\n} ","import { createWiki, deleteWorkspaceService } from \"../../services/workspace\";\nimport {\n    ADD_WORKSPACE,\n    SET_WORKSPACES,\n    SET_ACTIVE_WS_PROJECT,\n    DELETE_WORKSPACE\n} from \"../action-types/workspace\";\n\nexport const addWorkspace = (workspace, index) => ({\n    type: ADD_WORKSPACE,\n    workspace,\n    index\n});\n\nexport const addWorkspaceMW = (workspace, index) => (dispatch) => {\n    return new Promise((resolve, reject) => {\n        createWiki(workspace).then((res) => {\n            console.log(\"res from createWiki\", res);\n            let obj = {\n                name: workspace,\n                _id: res._id,\n                map: res.map ? res.map : {}\n            }\n            dispatch(addWorkspace(obj, index));\n            resolve(res);\n        })\n            .catch(e => {\n                console.log(\"e::\", e);\n                if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                    this.props.history.push(\"/\");\n                }\n                reject(e);\n            });\n    });\n}\n\nexport const setWorkspaces = (workspaces) => ({\n    type: SET_WORKSPACES,\n    workspaces\n});\n\nexport const setWorkspacesMw = (workspaces) => (dispatch) => {\n    dispatch(setWorkspaces(workspaces));\n};\n\nexport const setActiveWSProject = (workspace) => ({\n    type: SET_ACTIVE_WS_PROJECT,\n    activeWSProject: workspace,\n});\n\nexport const setActiveWSProjectMW = (workspace) => (dispatch) => {\n    dispatch(setActiveWSProject(workspace))\n}\n\nexport const deleteWorkspace = (workspace) => ({\n    type: DELETE_WORKSPACE,\n    index: workspace._id\n});\n\nexport const deleteWorkspaceMw = (workspace) => (dispatch) => {\n\n    return new Promise((resolve, reject) => {\n        deleteWorkspaceService(workspace._id).then(res => {\n            dispatch(deleteWorkspace(workspace));\n            resolve(res);\n        })\n            .catch(e => {\n                console.log(\"e::\", e);\n                if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                    this.props.history.push(\"/\");\n                }\n                reject(e);\n            });\n        // dispatch(deleteWorkspace(workspace));\n    })\n};","export const ADD_WORKSPACE = \"ADD_WORKSPACE\";\n\nexport const SET_WORKSPACES = \"SET_WORKSPACES\";\n\nexport const SET_ACTIVE_WS_PROJECT = \"SET_ACTIVE_WS_PROJECT\";\n\nexport const DELETE_WORKSPACE = \"DELETE_WORKSPACE\";","import { defaults } from \"../utils/config\";\n\n// TODO: MAKE THIS A CLASS THAT CAN BE INSTANTIATED\n// export const projectModel = {\n//     title: {\n//         quill: null,\n//         quillText: \"\",\n//         quillContent: null,\n//         value: \"\",\n//         toolbar: [[{ header: [1, 2, false] }],\n//             ['bold', 'italic', 'underline']],\n//         placeholder: \"Enter Title\"\n//     },\n//     description: {\n//         quill: null,\n//         quillText: \"\",\n//         quillContent: null,\n//         value: \"\",\n//         toolbar: [[{ header: [1, 2, false] }],\n//             ['bold', 'italic', 'underline']],\n//         placeholder: \"Enter Description\"\n//     },\n//     outcome: {\n//         quill: null,\n//         quillText: \"\",\n//         quillContent: null,\n//         value: \"\",\n//         toolbar: [[{ header: [1, 2, false] }],\n//             ['bold', 'italic', 'underline']],\n//         placeholder: \"Enter Outcome\"\n//     },\n//     reward: {\n//         quill: null,\n//         quillText: \"\",\n//         quillContent: null,\n//         value: \"\",\n//         toolbar: [[{ header: [1, 2, false] }],\n//             ['bold', 'italic', 'underline']],\n//         placeholder: \"Enter Reward\"\n//     },\n//     startTime: null,\n//     endTime: null,\n//     label: defaults.label,\n//     status: defaults.status,\n//     duration: \"\",\n//     reminders: null,\n//     progress: 0,\n//     tasks: 0,\n//     date: new Date()\n// }\n\nclass ProjectModel {\n    constructor(project) {\n        debugger;\n        let newProject = {\n            title: {\n                quill: null,\n                quillText: \"\",\n                quillContent: {},\n                toolbar: [[{ header: [1, 2, false] }],\n                ['bold', 'italic', 'underline']],\n                placeholder: \"Enter Title\"\n            },\n            description: {\n                quill: null,\n                quillText: \"\",\n                quillContent: {},\n                toolbar: [[{ header: [1, 2, false] }],\n                ['bold', 'italic', 'underline']],\n                placeholder: \"Enter Description\"\n            },\n            outcome: {\n                quill: null,\n                quillText: \"\",\n                quillContent: {},\n                toolbar: [[{ header: [1, 2, false] }],\n                ['bold', 'italic', 'underline']],\n                placeholder: \"Enter Outcome\"\n            },\n            reward: {\n                quill: null,\n                quillText: \"\",\n                quillContent: {},\n                toolbar: [[{ header: [1, 2, false] }],\n                ['bold', 'italic', 'underline']],\n                placeholder: \"Enter Reward\"\n            },\n            startTime: new Date(),\n            endTime: new Date(),\n            label: defaults.label,\n            status: defaults.status,\n            duration: \"\",\n            reminders: null,\n            progress: 0,\n            tasks: {},\n            tasksCount: 0,\n            date: new Date(),\n            isTask: false,\n            offsetForTz: localStorage.getItem(\"offsetForTz\")\n        };\n\n        if (Object.keys(project).length !== 0) {\n            this.project = Object.assign({}, {...newProject}, {...project});\n        } else {\n            this.project = Object.assign({}, {...project}, {...newProject});\n        }\n    }\n}\n\nexport default ProjectModel;\n","const projectProps = [\"title\", \"description\", \"outcome\", \"reward\"];\n\n// TODO: CAN THIS BE MOVED TO HANDLE AT BACKEND??\nexport function updateModel(umData) {\n    if (umData) {\n        let payload = Object.assign({}, umData);\n        // remove quill, quillContent, value, toolbar, placeholder\n        projectProps.forEach(prop => {\n            delete payload[prop].quill;\n            delete payload[prop].quillContent;\n            delete payload[prop].toolbar;\n            delete payload[prop].placeholder;\n        })\n        // remove duration, reminders\n        delete payload.duration;\n        delete payload.reminders;\n        return payload;\n    } else {\n        return {};\n    }\n}\n\nexport function matchModel(data) {\n    debugger\n    let tasksKeys = Object.keys(data.tasks ? data.tasks : {});\n    if ( tasksKeys.length > 0 ) {\n        tasksKeys.forEach(key => {\n            data.tasks[key] = updateModel(data.tasks[key]);\n        })\n    } \n    data = updateModel(data);\n    return data;\n}\n","import { urls } from \"../utils/config\";\nimport ProjectModel from \"../models/index\";\nimport { matchModel } from \"../utils/project\";\n\nexport function createProject(payload, workspace_id) {\n    payload.user_id = localStorage.getItem(\"user_id\");\n    payload.workspace_id = workspace_id;\n    let url = urls.project.base + \"/\" + localStorage.getItem(\"user_id\") + `/${workspace_id}` + \"/create\";\n    return new Promise((resolve, reject) => {\n            fetch(url, {\n                method: 'POST',\n                headers: {\n                    'Authorization': 'Bearer '+localStorage.getItem('token'),\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(payload)\n            })\n            .then((response) => {\n                if (response.ok) {\n                    return response.json();\n                } else {\n                    throw {\n                        msg: response.statusText,\n                        status: response.status\n                    }\n                }\n            })\n            .then((data) => {\n                resolve(data);\n            })\n            .catch((error) => {\n                console.error('Error:', error);\n                reject(error);\n            });\n        });\n}\n\nexport function getProjects(workspace_id) {\n    return new Promise((resolve, reject) => {\n        fetch(urls.project.base+\"/\"+localStorage.getItem('user_id')+`/${workspace_id}/`+\"list\", {\n            method: 'GET',\n            headers: {\n                'Authorization': 'Bearer '+localStorage.getItem('token'),\n                'Content-Type': 'application/json',\n            }\n        })\n        .then((response) => {\n            if (response.ok) {\n                return response.json();\n            } else {\n                throw {\n                    msg: response.statusText,\n                    status: response.status\n                }\n            }\n        })\n        .then((data) => {\n            // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n            // console.log('Projects found list for this user logged in:', data);\n            resolve(data);\n        })\n        .catch((error) => {\n            console.error('Error:', error);\n            reject(error);\n        });\n    });\n}","class TitleModel {\n    constructor(title={}) {\n        let ntitle = {\n            quill: null,\n            quillText: \"\",\n            quillContent: {},\n            value: \"\",\n            toolbar: [[{ header: [1, 2, false] }],\n            ['bold', 'italic', 'underline']],\n            placeholder: \"Enter Title\"\n        };\n\n        this.title = Object.assign({}, {...ntitle});\n    }\n}\n\nexport default TitleModel;","import { urls } from \"../utils/config\";\nimport { matchModel } from \"../utils/project\";\n\n/**\n  * throttle function that catches and triggers last invocation\n  * use time to see if there is a last invocation\n*/\nfunction throttle(callback, delay) {\n    let isThrottled = false, args, context;\n\n    function wrapper() {\n        if (isThrottled) {\n            args = arguments;\n            context = this;\n            return;\n        }\n\n        isThrottled = true;\n        callback.apply(this, arguments);\n\n        setTimeout(() => {\n            isThrottled = false;\n            if (args) {\n                wrapper.apply(context, args);\n                args = context = null;\n            }\n        }, delay);\n    }\n\n    return wrapper;\n}\n\nexport function updateProject(payload, workspace_id, project_id) {\n    payload.user_id = localStorage.getItem(\"user_id\");\n    // payload = matchModel(payload);\n    // debugger;\n    if (payload) {\n        return new Promise((resolve, reject) => {\n            fetch(urls.base + \"/project/\" + localStorage.getItem(\"user_id\") + \"/\" + workspace_id + \"/update/\" + project_id, {\n                method: 'PUT',\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(payload)\n            })\n                .then((response) => {\n                    if (response.ok) {\n                        return response.json();\n                    } else {\n                        throw {\n                            msg: response.statusText,\n                            status: response.status\n                        }\n                    }\n                })\n                .then((data) => {\n                    // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n                    // console.log('Create project response:', data);\n                    resolve(data);\n                })\n                .catch((error) => {\n                    console.error('Error:', error);\n                    reject(error);\n                });\n        });\n        //     var ID = function () {\n        //         // Math.random should be unique because of its seeding algorithm.\n        //         // Convert it to base 36 (numbers + letters), and grab the first 9 characters\n        //         // after the decimal.\n        //         return '_' + Math.random().toString(36).substr(2, 9);\n        //       };\n        //     setTimeout(() => {\n        //         resolve({id: ID()})\n        //     }, 0)\n        // });\n    }\n}\n\nexport const updateProjectService = throttle((payload) => {\n    debugger\n    updateProject(payload)\n    .then(res => console.log(\"res after updating project in updateProject service call\", res))\n    .catch(e => {\n        console.log(\"e::\", e);\n        if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n            this.props.history.push(\"/\");\n        }\n    });\n}, 3500)\n// throttle(function() {\n//     updateProject(payload)\n// }, 100)\n// updateProject(payload);\n// }\n\nexport const deleteProjectService = (id, workspace_id) => {\n    return new Promise((resolve, reject) => {\n        fetch(urls.project.base+\"/\"+localStorage.getItem('user_id')+`/${workspace_id}/`+ \"delete/\" + id, {\n            method: 'DELETE',\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                'Content-Type': 'application/json',\n            }\n        })\n            .then((response) => {\n                if (response.ok) {\n                    return response.json();\n                } else {\n                    throw {\n                        msg: response.statusText,\n                        status: response.status\n                    }\n                }\n            })\n            .then((data) => {\n                // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n                // console.log('delete project response:', data);\n                resolve(data);\n            })\n            .catch((error) => {\n                console.error('Error:', error);\n                reject(error);\n            });\n    })\n} \n\nexport function getProject(workspaceId, projectId) {\n    console.log(\"in service\", workspaceId);\n    return new Promise((resolve, reject) => {\n        fetch(urls.project.base+\"/\"+localStorage.getItem('user_id')+\"/get/\"+workspaceId+\"/project/\"+projectId, {\n            method: 'GET',\n            headers: {\n                'Authorization': 'Bearer '+localStorage.getItem('token'),\n                'Content-Type': 'application/json',\n            }\n        })\n        .then((response) => {\n            if (response.ok) {\n                return response.json();\n            } else {\n                throw {\n                    msg: response.statusText,\n                    status: response.status\n                }\n            }\n        })\n        .then((data) => {\n            // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n            // console.log('Projects found list for this user logged in:', data);\n            resolve(data);\n        })\n        .catch((error) => {\n            console.error('Error:', error);\n            reject(error);\n        });\n    })\n}\n\nexport function updateWSProject(ws_id, payload) {\n    payload.user_id = localStorage.getItem(\"user_id\");\n    debugger;\n    if (payload) {\n        return new Promise((resolve, reject) => {\n            fetch(urls.project.base + \"/\" + localStorage.getItem(\"user_id\") + \"/\" + ws_id + \"/update/\" + payload._id, {\n                method: 'PUT',\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token'),\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(payload)\n            })\n                .then((response) => {\n                    if (response.ok) {\n                        return response.json();\n                    } else {\n                        throw {\n                            msg: response.statusText,\n                            status: response.status\n                        }\n                    }\n                })\n                .then((data) => {\n                    // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n                    // console.log('Create project response:', data);\n                    resolve(data);\n                })\n                .catch((error) => {\n                    console.error('Error:', error);\n                    reject(error);\n                });\n        });\n    }\n}","// import { createKey } from \"../../views/project/map/packages/core/lib/main\";\nimport ProjectModel from \"../../models/index\";\nimport TitleModel from \"../../models/title\";\nimport { createProject } from \"../../services/dashboard\";\nimport { updateProjectService, deleteProjectService } from \"../../services/project\";\nimport lodash from \"lodash\";\n\nexport const addProject = (_id, tid, project) => ({\n    type: 'ADD_PROJECT',\n    _id,\n    tid,\n    project\n});\n\nexport const addProjectMW = (id, tid, project) => (dispatch) => {\n    dispatch(addProject(id, tid, project));\n}\n\n\nexport const delProject = (id, workspace_id) => ({\n    type: 'DEL_PROJECT',\n    id,\n    workspace_id\n});\n\nexport const delProjectMW = (id, workspace_id) => (dispatch) => {\n    deleteProjectService(id, workspace_id).then((res) => {\n        // console.log(\"about to delete from redux, successfully removed deleted from backend\", res);\n        dispatch(delProject(id, workspace_id));\n    })\n    .catch(e => {\n        console.log(\"e::\", e);\n        if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n            this.props.history.push(\"/\");\n        }\n    });\n}\n\nexport const clearSTs = (id) => ({\n    type: 'CLEAR_STs',\n    id\n})\n\nexport const clearSubtasksMW = (id) => (dispatch) => {\n    dispatch(clearSTs(id))\n}\n\nexport const editProject = (index, meta) => ({\n    type: 'EDIT_PROJECT',\n    index,\n    ...meta\n});\n\nexport const editProjectMW = (index) => (dispatch) => {\n    dispatch(editProject(index));\n}\n\nexport const updateProject = (meta) => ({\n    type: \"UPDATE_PROJECT\",\n    ...meta\n})\n\nexport const updateProjectTask = (meta) => ({\n    type: \"UPDATE_PROJECT_TASK\",\n    ...meta\n})\n\nconst bindMapToTrack = () => (dispatch, getState) => {\n    const {\n        projects\n    } = getState();\n    let activeProjectId = projects.activeProjectId;\n    let activeProject = projects.list[activeProjectId];\n    debugger\n    activeProject.map.topics.forEach((tp, i) => {\n        if (tp.parentKey != null) {\n            debugger\n            // create a new project model with quillText being updated \n            if (tp.task_id == null) {\n                let newProject = new TitleModel();\n                // newProject.id = tkey;\n                // newProject.title = {\n                //     quill: null,\n                //     quillText: tp.blocks[0].data,\n                //     quillContent: {},\n                //     value: \"\",\n                //     toolbar: [[{ header: [1, 2, false] }],\n                //     ['bold', 'italic', 'underline']],\n                //     placeholder: \"Enter Title\"\n                //     // quillContent: title.quill.setText(mmData.topics[index].blocks[0].data)\n                // }\n                debugger\n                newProject.title.quillText = tp.blocks[0].data;\n                newProject.title.topicKey = tp.key;\n                newProject.title.parentKey = tp.parentKey;\n                let projModelInstance = new ProjectModel(newProject);\n                createProject(projModelInstance.project, activeProject._id).then(res => {\n                    debugger\n                    projModelInstance.project._id = res._id;\n                    // add task_id to map topics item for later updates like saving to avoid redundant save calls\n                    tp.task_id = res._id;\n                    // call dispatching mw\n                    dispatch(addProject(activeProjectId, res._id, projModelInstance.project));\n                    // set a counter update which is used for updates in track phase\n                    dispatch(updateProject({\n                        id: activeProjectId,\n                        key: \"tasksCount\",\n                        val: projects.list[projects.activeProjectId].tasksCount + 1\n                    }));\n                })\n                .catch(e => {\n                    console.log(\"e::\", e);\n                    if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                        this.props.history.push(\"/\");\n                    }\n                });\n            } else {\n                // handle updating here\n                // console.log(\"this task already exists, so this should be updated::\", tp);\n                debugger;\n                let taskProj = activeProject.tasks[tp.task_id];\n                // get the active project title\n                let title = taskProj.title;\n                // update the title.quilltext\n                title.quillText = tp.blocks[0].data;\n                if (title.quill) {\n                    title.quillContent = title.quill.setText(tp.blocks[0].data);\n                }\n                // call the mw to update the title\n                dispatch(updateProjectTask({\n                    id: activeProjectId,\n                    tid: tp.task_id,\n                    key: \"title\",\n                    val: title\n                }));\n                // update the data \n                debugger;\n                console.log(\"calling update service from bindMapToTrack function\");\n                updateProjectService(lodash.cloneDeep(projects.list[activeProjectId].tasks[tp.task_id]));\n            }\n        } else {\n            // root node\n            let taskProj = activeProject;\n            // get the active project title\n            let title = taskProj.title;\n            // update the title.quilltext\n            title.quillText = tp.blocks[0].data;\n            if (title.quill) {\n                title.quillContent = title.quill.setText(tp.blocks[0].data);\n            }\n            // call the mw to update the title\n            dispatch(updateProject({\n                id: activeProjectId,\n                key: \"title\",\n                val: title\n            }));\n            // update the data \n            debugger;\n            console.log(\"calling update service from bindMapToTrack function, updating root nide title\");\n            updateProjectService(lodash.cloneDeep(projects.list[activeProjectId]))\n        }\n    });\n    // update the map as well, since there has been an update to topics with created project id\n    dispatch(updateProject({\n        id: activeProjectId,\n        key: \"map\",\n        val: activeProject.map\n    }));\n}\n\nconst bindTrackToMap = (meta) => (dispatch, getState) => {\n    // console.log(\"inside bindTrackToMap func\", meta);\n    // get map from state\n    let {\n        projects\n    } = getState();\n    let activeProjectId = projects.activeProjectId;\n    let activeProject = projects.list[activeProjectId];\n    let {\n        map\n    } = activeProject;\n    // get the topicKey and parentKey of that sub task\n    let tk = meta.val.topicKey;\n    // console.log(\"get the topicKey from meta:\", meta.val.topicKey, \"what is this used for?\");\n    // console.log(\"tk:\", tk, \"is used to identify the node from map.topics based tk==topic.key logic\");\n    // check if tk is available in map topics array\n    let filteredTopic = map.topics.filter(t => {\n        if ( t.key == tk) {\n            return t;\n        }\n    });\n    // console.log(\"filtered topic/found node is:\", filteredTopic);\n    // get parent-root node from map.topics\n    let rootNode = map.topics.filter(rt => {\n        if ( rt.parentKey == null) {\n            return rt;\n        }\n    });\n    // console.log(\"found rootNode\", rootNode);\n    debugger;\n    // if filteredTopic length is > 0; node already exists, just update the content\n    if (filteredTopic.length > 0) {\n        // console.log(\"dispatch is being performed on an existing node\");\n        filteredTopic[0].blocks[0].data = meta.val.quillText;\n        // console.log(\"update node's blocks[0].data with text\");\n        map.topics.forEach((item) => {\n            if (item.key == filteredTopic[0].key) {\n                item.blocks[0].data = filteredTopic[0].blocks[0].data;\n            }\n        });\n        // console.log(\"update the map object's topic with updated text from above and dispatch map to be saved\");\n        dispatch(updateProject({\n            id: meta.id,\n            key: \"map\",\n            val: map\n        }));\n        console.log(\"calling update service from BINDTRACKTOMAP function\");\n        // update the map, this is important\n        updateProjectService(lodash.cloneDeep(projects.list[activeProjectId]))\n    } else {\n        // console.log(\"no match found in map.topics array for tk:\", tk);\n        // console.log(\"THIS SHOULD NOT HAPPEN, SOMETHING IS WRONG---DEBUG FURTHER\");\n        // console.log(`why this should not happen?--because at the time of creating a node only we deal \n        // with creating new key and pushing it map.topics array`);\n        // // node does not exist in map phase, create a new node by \n        // // 1. creating a key using createKey and \n        // let nKey = createKey();\n        // // 2. pushing it to the parent node's sub keys\n        // rootNode[0].subKeys.push(nKey);\n        // // 3. push it into map.topics array\n        // map.topics.push({\n        //     key: nKey,\n        //     blocks: [{ type: \"CONTENT\", data: meta.val.quillText }],\n        //     task_id: meta.tid,\n        //     parentKey: rootNode[0].key\n        // });\n        // dispatch(updateProject({\n        //     id: meta.id,\n        //     key: \"map\",\n        //     val: map,\n        //     topicKey: nKey,\n        //     parentKey: rootNode[0].key\n        // }));\n    }\n}\n\nexport const updateProjectMW = (meta) => (dispatch, getState) => {\n    const {\n        projects\n    } = getState();\n    // console.log(\"inside updateProjectM-meta:\", meta);\n    debugger\n    if (meta.tid != undefined) {\n        // console.log(\"updating the project-task, NOT PROJECT\");\n        dispatch(updateProjectTask(meta));\n        // update the task\n        console.log(\"calling update service from UPDATEPROJECMW, when meta.tid exists function-> it updates task\");\n        updateProjectService(lodash.cloneDeep(projects.list[meta.id].tasks[meta.tid]))\n        if (meta.key == \"title\") {\n            debugger;\n            // console.log(\"since dispatch deals with updating project title, calling bindTrackToMap function\");\n            dispatch(bindTrackToMap(meta));\n        }\n        if (meta.key == \"status\") {\n            let obj = {};\n            obj.key = \"timeTaken\";\n            if (meta.val.toLowerCase() == \"done\")\n                obj.val = new Date();\n            else\n                obj.val = null;\n            obj.id = meta.id;\n            obj.tid = meta.tid;\n            dispatch(updateProjectTask(obj));\n            // update the data \n            // debugger;\n            // console.log(\"calling update service from UPDATEPROJECMW, when meta.tid exists function --> this updates status--thinking this is not necessary\");\n            // updateProjectService(lodash.cloneDeep(projects.list[meta.id].tasks[meta.tid]))\n        }\n    } else {\n        dispatch(updateProject(meta));\n        if (meta.key == \"status\") {\n            let obj = {};\n            obj.key = \"timeTaken\";\n            if (meta.val.toLowerCase() == \"done\")\n                obj.val = new Date();\n            else\n                obj.val = null;\n            obj.id = meta.id;\n            dispatch(updateProject(obj));\n        }\n\n        if (meta.key === \"map\") {\n            dispatch(bindMapToTrack());\n        }\n        // // update the data \n        // debugger\n        // console.log(\"calling update service from UPDATEPROJECMW, when meta.tid Does not exist function --> this updates the actual project\");\n        // updateProjectService(lodash.cloneDeep(projects.list[meta.id]))\n    }\n}\n\nexport const setActiveProject = (id) => ({\n    type: 'SET_ACTIVE_PROJECT',\n    id\n});\n\nexport const setActiveProjectMW = (id) => (dispatch) => {\n    dispatch(setActiveProject(id));\n}\n\nexport const setProjects = (meta) => ({\n    type: \"SET_PROJECTS\",\n    ...meta\n})\n\nexport const setProjectsMW = (meta) => (dispatch) => {\n    dispatch(setProjects(meta));\n}","import React, { Component } from \"react\";\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport { getWorkspaces, deleteWorkspaceService } from \"../../../services/workspace\";\nimport { addWorkspaceMW, setWorkspacesMw, setActiveWSProjectMW, deleteWorkspaceMw } from \"../../../store/actions/workspace\";\nimport { getProjects } from \"../../../services/dashboard\";\nimport { delProjectMW, setProjectsMW } from \"../../../store/actions/projects\";\n\nimport \"./index.scss\";\n\nclass WorkspaceDD extends Component {\n    state = {\n        toggleWsModal: false,\n        workspace: \"\",\n        data: [],\n        allData: [],\n        isLblHovered: null,\n        activeWsName: \"N/A\"\n    }\n\n    showWsModal = () => {\n        this.setState({\n            toggleWsModal: !this.state.toggleWsModal\n        });\n    }\n\n    labelInpChange = (e) => {\n        this.setState({ workspace: e.target.value });\n        if (e.target.value) {\n            console.log(\"e.target.value:\", e.target.value);\n            // replace the complete list of labels of with searched result, if not found\n            // add it\n            let name = e.target.value;\n            let allData = this.state.allData;\n            // let data = this.props.workspaces;\n            let updatedData = allData.filter(item => {\n                if (item.name.toLowerCase().includes(name.toLowerCase())) {\n                    return item;\n                } else {\n                    return null;\n                }\n            });\n            // // debugger;\n            this.setState({ data: updatedData });\n        } else {\n            // if the text search is cleared, set back the list to full complete list\n            this.setState({ data: this.state.allData });\n        }\n    }\n\n    hoverIn(i) {\n        this.setState({ isLblHovered: i });\n    }\n\n    hoverOut(i) {\n        this.setState({ isLblHovered: null });\n    }\n\n    handleWsClick = (ws) => {\n        console.log(\"ws::\", ws);\n        this.props.setActiveWSProjectMW({\n            ...ws\n        });\n        this.props.setProjectsMW({});\n        getProjects(ws._id).then(res => {\n            // console.log(\"res from get project list api-hide loader-set store with the latest list\", res);\n            this.setState({ loading: false });\n            let list = {};\n            if (res.list && res.list.length > 0) {\n                res.list.forEach(element => {\n                    list[element._id] = element;\n                });\n            }\n            this.props.setProjectsMW({ list });\n            let wsMeta = {};\n            if (res.workspace && res.workspace.length > 0) {\n                wsMeta = res.workspace[0];\n            }\n            this.setState({\n                activeWsName: wsMeta\n            })\n            this.props.setActiveWSProjectMW({\n                ...wsMeta\n            });\n            this.showWsModal();\n            this.props.history.push(\"/workspace/\" + ws._id + \"/dashboard\")\n        })\n            .catch(e => {\n                console.log(\"e::\", e);\n                if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                    this.props.history.push(\"/\");\n                }\n            });\n    }\n\n    addToWorkspaces = () => {\n        const {\n            workspace,\n            allData\n        } = this.state;\n\n        this.props.addWorkspaceMW(workspace).then(createdWs => {\n            allData.push({\n                name: workspace,\n                _id: createdWs._id\n            });\n            this.setState({\n                workspace: \"\",\n                data: allData,\n                allData\n            }, () => {\n                console.log(\"allData:\", allData)\n            });\n        })\n        .catch(e => {\n            console.log(\"error in creating workspace:\", e);\n        });\n    }\n\n    deleteWorkspace = (e, w) => {\n        e.stopPropagation();\n        this.props.deleteWorkspaceMw(w);\n        // deleteWorkspaceService(ws._id).then(res => {\n        //     this.props.deleteWorkspaceMw(ws);\n        // })\n        // .catch(e => {\n        //     console.log(\"e::\", e);\n        //     if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n        //         this.props.history.push(\"/\");\n        //     }\n        // });\n        const {\n            workspaces\n        } = this.props;\n        let foundWs = workspaces.filter(ws => ws._id == w._id);\n        let index;\n        if (foundWs.length == 1) {\n            index = workspaces.indexOf(foundWs[0]);\n            console.log(\"FOUND INDEX::\", index);\n        }\n        this.setState({\n            data: [\n                ...workspaces.slice(0, index),\n                ...workspaces.slice(index + 1)\n            ]\n        })\n    }\n\n    componentDidMount() {\n        console.log(\"inside workspace dd component\");\n        let wsName = \"\";\n        // get list of workspaces\n        getWorkspaces().then(res => {\n            console.log(\"res from getWorkspaces\", res);\n            this.props.setWorkspacesMw(res.list);\n            for (let i = 0; i < res.list.length; i++) {\n                let w = res.list[i];\n                if (this.props.match.params.workspace_id == w._id) {\n                    // this.props.setActiveWSProjectMW({\n                    //     ...w\n                    // });\n                    wsName = w;\n                }\n            }\n            this.setState({\n                data: res.list,\n                allData: res.list,\n                activeWsName: wsName\n            })\n        })\n            .catch(e => {\n                console.log(\"e::\", e);\n                if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                    this.props.history.push(\"/\");\n                }\n            });\n    }\n\n    render() {\n        const {\n            toggleWsModal,\n            workspace,\n            data,\n            activeWsName\n        } = this.state;\n\n        return (\n            <>\n                <button className=\"ws-btn\" onClick={this.showWsModal}>\n                    <span>\n                        {\n                            activeWsName.name\n                        }\n                    </span>\n                    <img className=\"dropdown\" src=\"/assets/web/tthroo-dropdown.svg\" alt=\"dropdown-icon\" />\n                </button>\n                {toggleWsModal && <div className=\"label-dd\">\n                    <img\n                        className=\"i-close l-close\"\n                        src=\"/assets/web/tthroo-close-icon.svg\"\n                        onClick={this.showWsModal}\n                        alt=\"close-icon\" />\n\n                    <div>\n                        <div>\n                            <h2 className=\"lm-h\">Workspaces</h2>\n                        </div>\n                        <div className=\"em\">\n                            <input type=\"text\" name=\"workspace\"\n                                className=\"lm-inp\"\n                                placeholder=\"enter a workspace\"\n                                onChange={this.labelInpChange}\n                                value={workspace} />\n                            <button className=\"add-ws\" onClick={this.addToWorkspaces}\n                                // disabled={data && data.length !== 0 ? false : true}    \n                            >\n                                {data && data.length == 0 && <img className=\"lm-ai\" src=\"/assets/web/tthroo-add-icon.svg\" alt=\"add-icon\" />}\n                            </button>\n                        </div>\n                        <div className=\"em\">\n                            <ul>\n                                {data && data.length !== 0 ? data.map((item, index) => {\n                                    {/* {workspaces && workspaces.length !== 0 ? workspaces.map((item, index) => { */ }\n                                    return <li\n                                        key={item._id}\n                                        className={activeWsName._id === item._id ? \"active\" : \"\"}\n                                        onMouseEnter={() => this.hoverIn(index)}\n                                        onMouseLeave={() => this.hoverOut(index)}\n                                        onClick={() => this.handleWsClick(item)}\n                                    >\n                                        {item.name}\n                                        {/* {(isLblHovered === index) &&\n                                            <img className=\"lm-di\" onClick={($event) => this.deleteWorkspace($event, item)} src=\"/assets/web/tthroo-del-icon.svg\" alt=\"del-icon\" />\n                                        } */}\n                                    </li>\n                                }) :\n                                    <div>\n                                        No Workspace Found. Try adding a new label.\n                                  </div>\n                                }\n                            </ul>\n                        </div>\n                    </div>\n                </div>}\n            </>\n        )\n    }\n\n}\n\nconst mapStateToProps = state => {\n    return {\n        activeWSProject: state.wikis.activeWSProject,\n        workspaces: state.wikis.workspaces\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        addWorkspaceMW,\n        setWorkspacesMw,\n        setActiveWSProjectMW,\n        deleteWorkspaceMw,\n        setProjectsMW\n    }\n)(WorkspaceDD));","import React from \"react\";\nimport WorkspaceDD from \"./workspace-dd\";\n\nimport \"./header.scss\";\n\nconst Header = () => {\n    return (\n        <header class=\"main-header\">\n\n            <div className=\"hdr-container\">\n                <div className=\"tthroo-logo-container\">\n                    <img className=\"tthroo-logo\" src=\"/assets/web/tthroo-logo.svg\" alt=\"TThroo.io\" />\n                    <span className=\"tthroo\">TThroo</span>\n                </div>\n                <div className=\"s-ws-container\">\n                    <WorkspaceDD />\n                </div>\n                <div className=\"profile-c\">\n                    <img className=\"profile\" src=\"/assets/web/default-profile.svg\" alt=\"profile-icon\" />\n                </div>\n            </div>\n        </header>\n    )\n}\n\nexport default Header;","import React, { Component } from \"react\";\nimport { connect } from 'react-redux';\n\nimport \"./label-dd.scss\";\nimport { setLabelMW, addLabelMW, deleteLabelMW } from \"../../../store/actions/label\";\nimport { setStatusMW, addStatusMW, deleteStatusMW } from \"../../../store/actions/status\";\nimport { updateProject, updateProjectTask } from \"../../../store/actions/projects\";\n\nclass LabelDD extends Component {\n\n    constructor (props) {\n        super(props);\n        this.deleteLabel = this.deleteLabel.bind(this);\n    }\n\n    state = {\n        showLabelModal: false,\n        labelInp: \"\",\n        data: [],\n        isLblHovered: null\n    }\n\n    toggleLabelModal() {\n        this.setState({ showLabelModal: !this.state.showLabelModal });\n        if (this.props.modalClickHandler)\n            this.props.modalClickHandler();\n    }\n\n    labelInpChange(e) {\n        this.setState({ labelInp: e.target.value });\n        if (e.target.value) {\n            // replace the complete list of labels of with searched result, if not found\n            // add it\n            let label = e.target.value\n            let data = this.state.data;\n            let updatedData = data.filter(item => {\n                if (item.label.toLowerCase().includes(label.toLowerCase())) {\n                    return item;\n                } else {\n                    return null;\n                }\n            });\n            // // debugger;\n            this.setState({ data: updatedData });\n        } else {\n            // if the text search is cleared, set back the list to full complete list\n\n        }\n    }\n\n    addLabel() {\n        const {\n            labelInp\n        } = this.state;\n\n        if (this.props.mode === \"label\") {\n            this.props.addLabelMW(labelInp);\n        }\n        else {\n            this.props.addStatusMW(labelInp);\n        }\n        this.setState({ labelInp: \"\" });\n    }\n\n    hoverIn(i) {\n        this.setState({ isLblHovered: i });\n    }\n\n    hoverOut(i) {\n        this.setState({ isLblHovered: null });\n    }\n\n    deleteLabel(e, i) {\n        // console.log(\"e, i\", e, i);\n        e.stopPropagation();\n        if (this.props.mode === \"label\") {\n            this.props.deleteLabelMW(i);\n        } else {\n            this.props.deleteStatusMW(i);\n        }\n    }\n\n    changeLabel = (e) => {\n        e.persist();\n        let {\n            activeProjectId,\n            tid,\n            updateProjectTask,\n            updateProject\n        } = this.props;\n\n        debugger;\n\n        if (tid !== undefined) {\n            debugger\n            let key = \"\";\n            if (this.props.mode === \"label\")\n                key = \"label\";\n            else \n                key = \"status\";\n            updateProjectTask({ id: activeProjectId, tid, key, val: e.target.innerText });\n        } else if (activeProjectId !== undefined) {\n            let key = \"\";\n            if (this.props.mode === \"label\")\n                key = \"label\";\n            else \n                key = \"status\";\n            updateProject({ id: activeProjectId, key, val: e.target.innerText });\n        } else {\n            if (this.props.mode === \"label\")\n                this.props.setLabelMW(e);\n            else\n                this.props.setStatusMW(e);\n        }\n\n        this.setState({ showLabelModal: !this.state.showLabelModal });\n        if (this.props.modalClickHandler)\n            this.props.modalClickHandler();\n    }\n\n    componentDidUpdate() {\n        this.refData = this.props.data; // complete list\n        if (!this.state.data || (this.props.data.length !== this.state.data.length && !this.state.labelInp))\n            this.setState({ data: this.props.data })\n    }\n\n    componentDidMount() {\n        const {\n            onlyModal\n        } = this.props;\n\n        if (Boolean(onlyModal)) {\n            this.setState({ showLabelModal: !this.state.showLabelModal });\n        }\n    }\n\n    render() {\n\n        const {\n            showLabelModal,\n            labelInp,\n            data,\n            isLblHovered\n        } = this.state;\n\n        const {\n            active,\n            onlyInput,\n            onlyModal,\n            modalView,\n            mode,\n            value\n        } = this.props;\n\n        // console.log(\"active::\", active);\n\n        return (\n            <>\n                {\n                    !onlyInput &&\n                    <>\n                        {\n                            mode === \"label\" ?\n                                <div className=\"sb-lbl\">\n                                    Labels\n                            </div> :\n                                <div className=\"sb-lbl\">\n                                    Status\n                            </div>\n                        }\n                    </>\n                }\n                {\n                    !onlyModal && \n                    <label onClick={this.toggleLabelModal.bind(this)}>\n                        <button className={modalView ? \"modal-bg sb-btn em\" : \"sb-btn em\"}>\n                            <span className=\"btn-inr\">\n                                <span>{value ? value : active}</span>\n                                <img className=\"dropdown\" src=\"/assets/web/tthroo-dropdown.svg\" alt=\"dropdown-icon\" />\n                            </span>\n                        </button>\n                    </label>\n                }\n                {showLabelModal && <div className=\"label-dd\">\n                    <img\n                        className=\"i-close l-close\"\n                        src=\"/assets/web/tthroo-close-icon.svg\"\n                        onClick={this.toggleLabelModal.bind(this)} \n                        alt=\"close-icon\" />\n\n                    <div>\n                        {\n                            mode === \"label\" ?\n                                <h2 className=\"lm-h\">Labels</h2> :\n                                <h2 className=\"lm-h\">Status</h2>\n                        }\n                        <div className=\"em\">\n                            <input type=\"text\" name={mode}\n                                className=\"lm-inp\"\n                                placeholder=\"enter a label\"\n                                onChange={this.labelInpChange.bind(this)}\n                                value={labelInp} />\n                            <span>\n                                <img className=\"lm-ai\" onClick={this.addLabel.bind(this)} src=\"/assets/web/tthroo-add-icon.svg\" alt=\"add-icon\" />\n                            </span>\n                        </div>\n                        <div className=\"em\">\n                            <ul>\n                                {data && data.length !== 0 ? data.map((item, index) => {\n                                    return <li\n                                        // className={active === item.label ? \"active\" : \"\"}\n                                        className={value === item.label ? \"active\" : \"\"}\n                                        onMouseEnter={() => this.hoverIn(index)}\n                                        onMouseLeave={() => this.hoverOut(index)}\n                                        onClick={this.changeLabel}\n                                    >\n                                        {item.label}\n                                        {(isLblHovered === index) &&\n                                            <img className=\"lm-di\" onClick={($event) => this.deleteLabel($event, index)} src=\"/assets/web/tthroo-del-icon.svg\" alt=\"del-icon\" />\n                                        }\n                                    </li>\n                                }) :\n                                    <div>\n                                        No Label Found. Try adding a new label.\n                                  </div>\n                                }\n                            </ul>\n                        </div>\n                    </div>\n                </div>}\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n    // // console.log(\"inside mapStateToPros func in container component: label-dd::ownPross::\", ownPros);\n    if (ownProps.mode === \"label\") {\n        return {\n            data: state.sideBar.label.data,\n            active: state.sideBar.label.active\n        }\n    } else {\n        return {\n            data: state.sideBar.status.data,\n            active: state.sideBar.status.active\n        }\n    }\n}\n\nexport default connect(\n    mapStateToProps,\n    {\n        addLabelMW,\n        deleteLabelMW,\n        setLabelMW,\n        setStatusMW,\n        addStatusMW,\n        deleteStatusMW,\n        updateProjectTask,\n        updateProject\n    }\n)(LabelDD);","export const setLabel = (value) => ({\n    type: 'SET_LABEL',\n    activeLabel: value\n});\n\nexport const addLabel = (value) => ({\n    type: 'ADD_LABEL',\n    label: value\n})\n\nexport const deleteLabel = (index) => ({\n    type: 'DELETE_LABEL',\n    index\n})\n\nexport const setLabelMW = (e) => (dispatch) => {\n    let status = e.target.innerText;\n    // console.log(\"value inside setLabelMW func\", e);\n    dispatch(setLabel(status));\n}\n\nexport const addLabelMW = (value) => (dispatch) => {\n    let label = value\n    dispatch(addLabel(label));\n};\n\nexport const deleteLabelMW = (index) => (dispatch) => {\n    dispatch(deleteLabel(index));\n};","export const setStatus = (value) => ({\n    type: 'SET_STATUS',\n    activeStatus: value\n});\n\nexport const setStatusMW = (e) => (dispatch) => {\n    let status;\n    if (typeof e === \"object\")\n        status = e.target.innerText;\n    else\n        status = e;\n    // console.log(\"value inside setStatusMW func\", e);\n    dispatch(setStatus(status));\n}\n\nexport const addStatus = (value) => ({\n    type: 'ADD_STATUS',\n    label: value\n})\n\nexport const addStatusMW = (value) => (dispatch) => {\n    let label = value;\n    dispatch(addStatus(label));\n};\n\nexport const deleteStatus = (index) => ({\n    type: 'DELETE_STATUS',\n    index\n})\n\nexport const deleteStatusMW = (index) => (dispatch) => {\n    dispatch(deleteStatus(index));\n};\n","import React, { Component } from \"react\";\nimport { connect } from 'react-redux';\nimport LabelDD from \"../../../fragments/edit-dropdowns/label-dd\";\nimport { withRouter } from \"react-router-dom\";\n\nimport \"./index.scss\";\n// import 'react-calendar/dist/Calendar.css';\n\nexport class Sidebar extends Component {\n\n    constructor (props) {\n        super(props);\n        this.createProject = this.createProject.bind(this);\n    }\n\n    createProject() {\n        const {\n            toggleCPModal\n        } = this.props;\n        toggleCPModal();\n    }\n\n    navToWSDashboard = () => {\n        this.props.history.push(\"/workspaces\")\n    }\n\n    render() {\n\n        return <div className=\"sidebar\">\n            <div>\n                <button className=\"sb-btn\" onClick={this.navToWSDashboard}>\n                    Back\n                </button>\n            </div>\n            <div>\n                <button\n                    className=\"sb-btn em c-p\"\n                    onClick={this.createProject}\n                >\n                    Create Project\n                </button>\n            </div>\n            {/* <div className=\"em\">\n                <LabelDD\n                    mode=\"status\"\n                />\n            </div>\n            <div className=\"em\">\n                <LabelDD\n                    mode=\"label\"\n                />\n            </div> */}\n        </div>\n    }\n}\n\nconst mapStateToProps = state => {\n    return { }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    { }\n)(Sidebar));\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst Checkbox = ({ type = 'checkbox', name, checked = false, onChange }) => (\n  <input type={type} name={name} checked={checked} onChange={onChange} />\n);\n\nCheckbox.propTypes = {\n  type: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  checked: PropTypes.bool,\n  onChange: PropTypes.func.isRequired,\n}\n\nexport default Checkbox;","import React, { Component } from \"react\";\nimport { createProject } from \"../../../../services/dashboard\";\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport Checkbox from \"../../../fragments/checkbox/index\";\n\nimport \"./modal.scss\";\n\nclass ProjectModal extends Component {\n\n    state = {\n        title: \"\",\n        description: \"\",\n        projectType: \"map\",\n        checkedTypes: new Map(),\n        projectTypes: [{\n            name: 'roadmap',\n            key: 'roadmap',\n            label: 'Roadmap',\n          },\n          {\n            name: 'map',\n            key: 'map',\n            label: 'Mindmap',\n          },\n          {\n            name: 'analyse',\n            key: 'analyse',\n            label: 'Analyse',\n          },\n          {\n            name: 'reminders',\n            key: 'reminders',\n            label: 'Reminders',\n          }]\n    }\n\n    handleInpChange = (e) => {\n        this.setState({\n            [e.target.name]: e.target.value\n        });\n    }\n\n    getProjectType = () => {\n\n        const {\n            checkedTypes,\n            projectTypes\n        } = this.state;\n\n        let pt = \"map\";\n\n        projectTypes.forEach(t => {\n            if(checkedTypes.get(t.name) && t.name !== \"map\") {\n                pt = pt + \"+\" + t.name;\n            }\n        });\n\n        return pt;\n    }\n\n    createProject = () => {\n        console.log(\"this.state\", this.state);\n        let projectType = this.getProjectType();\n        const {\n            title,\n            description\n        } = this.state;\n        let payload = {\n            title: {\n                quillText: title\n            },\n            description: {\n                quillText: description\n            },\n            projectType\n        }\n        createProject(payload, this.props.match.params.workspace_id).then(res => {\n            let data = { ...res };\n            delete data.status;\n            delete data.statusCode;\n            let proj = {\n                [res._id]: {\n                    ...data,\n                    _id: res._id\n                }\n            }\n            console.log(\"project has been created successfuly, need to update the store now\", proj);\n            this.props.toggleProject(true, proj);\n        })\n            .catch(e => {\n                console.log(\"e::\", e);\n                if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                    this.props.history.push(\"/\");\n                }\n            });\n    }\n\n\n    handleChange = (e) => {\n        e.persist();\n        console.log(\"this.props in handleChange func\", e.target.name, e.target.checked, this.state);\n        const item = e.target.name;\n        const isChecked = e.target.checked;\n        this.setState(prevState => ({ checkedTypes: prevState.checkedTypes.set(item, isChecked) }));\n    }\n\n    render() {\n\n        const {\n            toggleProject\n        } = this.props;\n\n        const {\n            title,\n            description,\n            projectType,\n            projectTypes,\n            checkedTypes\n        } = this.state\n\n        return (\n            <div id=\"myModal\" class=\"modal\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <span class=\"close\" onClick={toggleProject}>&times;</span>\n                        <h2>Create project</h2>\n                    </div>\n                    <div class=\"modal-body\">\n                        <div>Title:</div>\n                        <input type=\"text\" name=\"title\" placeholder=\"Enter Project Title...\"\n                            onChange={this.handleInpChange}\n                        />\n                        <div>Description:</div>\n                        <textarea name=\"description\" placeholder=\"Enter description...(optional)\"\n                            onChange={this.handleInpChange}></textarea>\n                        {/* <div onChange={($e) => this.handleChange($e)}>Project Type: (select the following to include them in your project)\n                        <div>\n                                <input type=\"checkbox\" id=\"tthroo-map\" value=\"roadmap\"\n                                    // checked={projectType === \"roadmap\"}\n                                />\n                                <label for=\"map\">Roadmap</label>\n                            </div>\n                            <div>\n                                <input type=\"checkbox\" id=\"tthroo-map\" value=\"map\"\n                                    defaultChecked\n                                    // checked={projectType === \"map\"}\n                                />\n                                <label for=\"map\">Mindmap</label>\n                            </div>\n                            <div>\n                                <input type=\"checkbox\" id=\"tthroo-map+analyse\" value=\"analyse\"\n                                    // checked={projectType === \"analyse\"}\n                                />\n                                <label for=\"analyse\">Notes</label>\n                            </div>\n                            <div>\n                                <input type=\"checkbox\" id=\"tthroo-map+reminders\"\n                                    value=\"reminders\"\n                                    // checked={projectType === \"reminders\"}\n                                />\n                                <label for=\"reminders\">Reminders</label>\n                            </div>\n                        </div> */}\n                        {\n                            projectTypes.map(item => (\n                                <label key={item.key}>\n                                {item.name}\n                                <Checkbox name={item.name} checked={checkedTypes.get(item.name)} onChange={this.handleChange} />\n                                </label>\n                            ))\n                        }\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button onClick={this.createProject}>\n                            Create\n                        </button>\n                        <button onClick={toggleProject}>\n                            Close\n                        </button>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default withRouter(connect(null, {})(ProjectModal));","import React, { Component } from \"react\";\n// import CircleProgressBar from \"../../../fragments/circular-progress-bar/index\";\nimport { connect } from 'react-redux';\n// import { convertIsoToFormat } from \"../../../../utils/date\";\nimport { withRouter } from 'react-router-dom';\nimport { delProjectMW, setProjectsMW } from \"../../../../store/actions/projects\";\nimport { setActiveWSProjectMW } from \"../../../../store/actions/workspace\";\nimport { getProjects } from \"../../../../services/dashboard\";\n// import activeProject from \"store/reducers/edit-project\";\nimport ProjectModal from \"./modal\";\n\nimport \"./index.scss\";\n\nclass ProjectsList extends Component {\n\n    constructor (props) {\n        super(props);\n        this.hoverIn = this.hoverIn.bind(this);\n        this.hoverOut = this.hoverOut.bind(this);\n        this.toggleEdit = this.toggleEdit.bind(this);\n        this.switchToProject = this.switchToProject.bind(this);\n    }\n\n    state = {\n        showEditIcon: -1,\n        showActionsDD: false,\n        loading: false,\n        toggleProjectModal: false\n    }\n\n    hoverIn(i) {\n        console.log(\"i::\", i)\n        this.setState({ showEditIcon: i });\n    }\n\n    hoverOut(i) {\n        this.setState({ showEditIcon: -1, showActionsDD: false });\n    }\n\n    toggleEdit(e) {\n        e.stopPropagation();\n        this.setState({ showActionsDD: !this.state.showActionsDD });\n    }\n\n    getProjProgress = (proj) => {\n        // console.log(\"proj::\", proj);\n        // get the tasks length\n        // get the done status project count\n        // divide them and get percentage.\n        if (proj.tasks && Object.keys(proj.tasks).length > 0) {\n            let l = Object.keys(proj.tasks).length;\n            let reducer = (accumulator, currentValue) => proj.tasks[currentValue].status && proj.tasks[currentValue].status.toLowerCase() === \"done\" ? accumulator + 1 : accumulator;\n            let dl = Object.keys(proj.tasks).reduce(reducer, 0);\n            return Math.ceil((dl / l) * 100);\n        } else {\n            return proj.status.toLowerCase() === \"done\" ? 100 : 0;\n        }\n    }\n\n    switchToProject(index, fromEdit, e, item) {\n        if (Boolean(fromEdit)) {\n            e.stopPropagation();\n        }\n        // console.log(\"this.props in swithcToProject\", this.props, \"index\", index, \"this.props.histroy.push\", this.props.history.push);\n        this.props.setActiveWSProjectMW(item);\n        this.props.history.push(`/workspace/${this.props.match.params.workspace_id}/project/${index}/edit`);\n    }\n\n    deleteProject = (index, e) => {\n        debugger\n        e.stopPropagation();\n        this.props.delProjectMW(index, this.props.match.params.workspace_id);\n        this.setState({ showEditIcon: -1, showActionsDD: false });\n    }\n\n    toggleProject = (onCreate, updatedList) => {\n\n        const {\n            projects\n        } = this.props;\n\n        this.setState({\n            toggleProjectModal: !this.state.toggleProjectModal\n        });\n        if (onCreate) {\n            console.log(\"this.projects\", projects);\n            this.props.setProjectsMW({list: {...projects, ...updatedList}});\n        }\n    }\n\n    componentDidMount() {\n        getProjects(this.props.match.params.workspace_id).then(res => {\n            // console.log(\"res from get project list api-hide loader-set store with the latest list\", res);\n            this.setState({ loading: false });\n            let list = {};\n            if (res.list && res.list.length > 0) {\n                res.list.forEach(element => {\n                    list[element._id] = element;\n                });\n            }\n            this.props.setProjectsMW({list});\n            let wsMeta = {};\n            if (res.workspace && res.workspace.length > 0) {\n                wsMeta = res.workspace[0];\n            }\n            this.props.setActiveWSProjectMW({\n                ...wsMeta\n            });\n        })\n        .catch(e => {\n            console.log(\"e::\", e);\n            if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                this.props.history.push(\"/\");\n            }\n        });\n    }\n\n    getActiveProjects = () => {\n\n        const {\n            projects\n        } = this.props;\n\n        let keys = Object.keys(projects ? projects : {}), activeProjects = [];\n\n        // eslint-disable-next-line\n        if (keys.length > 0) {\n            activeProjects = keys.map(item => projects[item]);\n        }\n\n        return activeProjects;\n    }\n\n    render() {\n\n        const {\n            showEditIcon,\n            showActionsDD,\n            loading,\n            toggleProjectModal\n        } = this.state;\n\n        const {\n            activeWSProject\n        } = this.props;\n\n        let activeProjects = this.getActiveProjects();\n\n        return (\n            <>\n            <div className=\"ls-h\">\n                <h1 className=\"tthroo-p\">\n                    {activeWSProject && activeWSProject.name}/Projects\n                </h1>\n                <button className=\"cp\" onClick={this.toggleProject}>Create Project</button>\n            </div>\n            <div className=\"ls\">\n                {loading ?\n                    <div>Loading</div> :\n                    <>\n                        <div className=\"p-c\">\n                            {\n                                Object.keys(activeProjects).length > 0 ?\n                                    activeProjects.map((item, index) => <div className=\"ls-data\"\n                                        onMouseEnter={() => this.hoverIn(item._id)}\n                                        onMouseLeave={() => this.hoverOut(item._id)}\n                                        onClick={() => this.switchToProject(item._id, null, null, item)}\n                                    >\n                                        {\n                                            showEditIcon === item._id &&\n                                            <div className=\"edit-dd\">\n                                                <img className=\"dropdown\" src=\"/assets/web/tthroo-dropdown.svg\" onClick={this.toggleEdit} alt=\"dropdown-icon\" />\n                                                {\n                                                    showActionsDD &&\n                                                    <div className=\"action-proj-dd\">\n                                                        <ul>\n                                                            <li onClick={(e) => this.switchToProject(item._id, \"edit\", e, item)}>\n                                                                <span className=\"action-lbl\">Edit</span>\n                                                            </li>\n                                                            <li onClick={(e) => this.deleteProject(item._id, e)}>\n                                                                <span className=\"action-lbl\">Delete</span>\n                                                            </li>\n                                                        </ul>\n                                                    </div>\n                                                }\n                                            </div>\n                                        }\n                                        <div className=\"p-c-d\">\n                                            <div className=\"title\">\n                                                <h4>\n                                                    {item.title && item.title.quillText ? \n                                                        (item.title.quillText.length < 38 ? item.title.quillText : item.title.quillText.substring(0, 38) + \"...\") :\n                                                        item.title ? (item.title) : \"N/A\"\n                                                    }\n                                                </h4>\n                                                <h6>This is a demo description.</h6>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    ) :\n                                    <div className=\"no-projects-lbl\">No Projects Available, Try Creating New Projects.</div>\n                            }\n                        </div>\n                    </>\n                }\n            </div>\n            {\n                toggleProjectModal && \n                <ProjectModal \n                    toggleProject={this.toggleProject}\n                />\n            }\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        projects: state.projects.list,\n        activeWSProject: state.wikis.activeWSProject\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        delProjectMW,\n        setProjectsMW,\n        setActiveWSProjectMW\n    }\n)(ProjectsList));","export function getDuration(startTime, endTime) {\n    debugger\n    // for the 'startDate' and 'endDate', \n    // getState should be used to caculate duration\n    // let {\n    //     startTime,\n    //     endTime\n    // } = activeProject\n    // Find the distance between now and the count down date\n    if (endTime == null) {\n        return {\n            val: \"Not yet finished\"\n        }\n    } else {\n        debugger\n        var distance = (new Date(endTime).getTime() - new Date(startTime).getTime());\n\n        // if (this.timer) {\n        //     clearInterval(this.timer);\n        // }\n\n        // if (distance <= 0) {\n        //     clearInterval(this.timer);\n        // } else {\n        // Update the count down every 1 second\n        // this.timer = setInterval(() => {\n        //     debugger;\n        // Time calculations for days, hours, minutes and seconds\n        var days = Math.floor(distance / (1000 * 60 * 60 * 24));\n        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));\n        var seconds = Math.floor((distance % (1000 * 60)) / 1000);\n        // Output the result in an element with id=\"demo\"\n        // console.log(days + \"d \" + hours + \"h \" + minutes + \"m \" + seconds + \"s \");\n        // If the count down is over, write some text \n        // if (distance < 0) {\n        //     clearInterval(this.timer);\n        // }\n        let obj = {\n            val: days + \"d \" + hours + \"h \" + minutes + \"m \" + seconds + \"s \"\n        }\n\n        // distance = distance - 1000;\n        // }, 1000);\n        // }\n\n        return obj;\n    }\n}","import React, { Component } from \"react\";\n\nclass Select extends Component {\n    constructor (props) {\n        super();\n        this.state = {\n            tech: 'select'\n        };\n    }\n    render() {\n        return (\n            <div>\n                <select id=\"lang\" onChange={this.props.handleProjectTypeChange} value={this.props.projectType}>\n                    <option value=\"select\">Select Project Type</option>\n                    <option value=\"map\">Map</option>\n                    <option value=\"map+analyse\">Map + Analyse</option>\n                    <option value=\"map+analyse+reminders\">Map + Analyse + Reminders</option>\n                </select>\n            </div>\n        )\n    }\n}\n\nexport default Select;","import React, { Component } from \"react\";\nimport LabelDD from \"../../fragments/edit-dropdowns/label-dd\";\nimport * as Datetime from 'react-datetime';\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { setActiveProjectMW, updateProjectMW, addProjectMW } from \"../../../store/actions/projects\";\nimport Quill from \"quill\";\nimport ProjectModel from \"../../../models/index\";\nimport { getDuration } from \"../../../services/analyse\";\n// import { updateProjectService } from \"../../../services/project\";\nimport { createProject } from \"../../../services/dashboard\";\n// import cloneDeep from \"clone-deep\";\nimport lodash from \"lodash\";\nimport Select from \"../../fragments/select\";\n\nimport \"./index.scss\";\nimport \"react-datetime/css/react-datetime.css\";\nimport \"quill/dist/quill.bubble.css\";\nimport \"../common/layout.scss\";\n\nclass EditComponent extends Component {\n\n    constructor (props) {\n        super(props);\n\n        this.state = {\n            modalView: false,\n            duration: \"\",\n            activeProject: {}\n        }\n\n        this.saveContent = this.saveContent.bind(this);\n        this.editorContainerIds = [\"title\", \"description\", \"outcome\", \"reward\"];\n        this.toggleModal = this.toggleModal.bind(this);\n        this.ws = null;\n        this.meta = {};\n    }\n\n    toggleModal(e) {\n        // e.stopPropagation();\n        this.setState({ modalView: !this.state.modalView });\n    }\n\n    getDeepClonedObj = (obj) => {\n        let clonedObj = lodash.cloneDeep(obj);\n        // console.log(\"CLONEDOBJ::::\", clonedObj);\n        return clonedObj;\n    } \n\n    saveContent(item, currentContent, tid, topicKey, parentKey) {\n        currentContent.topicKey = topicKey;\n        currentContent.parentKey = parentKey;\n        debugger\n        this.props.updateProjectMW({\n            id: this.props.match.params.id,\n            tid,\n            key: item,\n            val: Object.assign({}, currentContent)\n            // val: this.getDeepClonedObj(currentContent)\n        });\n    }\n\n    initializeProjEditor(initContent) {\n        // quilljs initialization\n        let Delta = Quill.import('delta');\n        this.editorContainerIds.forEach(item => {\n            let quill = new Quill('#' + item, {\n                modules: {\n                    toolbar: item.toolbar\n                },\n                scrollingContainer: '#scrolling-container',\n                placeholder: this.meta[item].placeholder,\n                theme: 'bubble'\n            });\n            let nItem = this.meta[item];\n            nItem.quill = quill;\n            if (initContent) {\n                let content = { ...this.meta[item].quillContent };\n                this.meta[item].quill.setContents(content, 'api');\n                if (this.meta[item].quillText.length >= 0) {\n                    this.meta[item].quill.setText(this.meta[item].quillText);\n                }\n            }\n            // register text cchange listener\n            this.meta[item].quill.on('text-change', (delta) => {\n                let change = new Delta();\n                let eItem = { ...this.meta[item] };\n                eItem.change = change.compose(delta);\n                let currentContent = this.meta[item];\n                currentContent.quillContent = currentContent.quill.getContents();\n                currentContent.quillText = currentContent.quill.getText();\n                eItem.change = new Delta();\n            });\n        });\n\n        this.setState({\n            activeProject: this.meta\n        });\n    }\n\n    calcDuration(activeProject) {\n        this.setState({ duration: getDuration(new Date(activeProject.startTime), new Date(activeProject.endTime)).val });\n    }\n\n    componentDidMount() {\n\n        const {\n            topic\n        } = this.props;\n\n        console.log(\"topic in edit.js componentDidMount function{}::**\", topic);\n\n        // get params\n        const { id } = this.props.match.params;\n        \n        let project = {};\n\n        if (topic && topic.properties) {\n            // bind the topic.blocks[0].data label with title.quillText\n            topic.properties.title.quillText = topic.blocks[0].data;\n            project = topic.properties;\n        } else {\n            project = {};\n        }\n\n        if (Boolean(project && project.title)) {\n            this.meta = {};\n            let projModelInstance = new ProjectModel(project);\n            this.meta = projModelInstance.project;\n            this.initializeProjEditor(true);\n            this.calcDuration(this.meta);\n        } else {\n            this.meta = {};\n            let newProject = {};\n            newProject._id = id;\n            const {\n                status\n            } = this.props;\n            if (status)\n                newProject.status = status;\n            let projModelInstance = new ProjectModel(newProject);\n            this.meta = projModelInstance.project;\n            this.initializeProjEditor(false);\n            this.calcDuration(this.meta);\n            // if the new item is added, \n            // create a key, push it to the root node in map array\n        }\n    }\n\n    componentWillUnmount() {\n        this.editorContainerIds.forEach(item => {\n            if (this.meta[item] && this.meta[item].quill) {\n                this.meta[item].quill.off('text-change', (delta) => {\n                    // console.log(\"inside unmount\")\n                });\n            }\n        });\n        clearInterval(this.timer);\n    }\n\n    createProject = () => {\n        console.log(\"this.meta\", this.meta);\n        // updateProjectService(lodash.cloneDeep(this.meta));\n        createProject(this.meta, null, this.props.match.params.workspace_id).then(res => {\n            console.log(\"succesfully created project\", res);\n            this.props.addProjectMW(res._id, null, this.meta);\n            this.props.toggleEditModal();\n        })\n        .catch(e => {\n            console.log(\"e::\", e);\n            if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                this.props.history.push(\"/\");\n            }\n        });\n    }\n\n    handleProjectTypeChange = (e) => {\n        // this.setState({\n        //     tech: e.target.value\n        // })\n        this.meta.projectType = e.target.value;\n    }\n\n    render() {\n\n        const {\n            modalView,\n            duration,\n            activeProject\n        } = this.state;\n\n        const {\n            meta,\n            activeProjectId,\n            tid,\n            mode,\n            toggleEditModal,\n            status,\n            isSidebarOpen,\n            topic,\n            updateProperties\n        } = this.props;\n\n        // let activeProject = {};\n        // debugger\n        // if (tid == undefined)\n        //     activeProject = meta.list[activeProjectId];\n        // else\n        //     activeProject = meta.list[activeProjectId].tasks[tid];\n\n        // console.log(\"activeProject in editjs file\", modalView);\n\n        return (\n            <div className={mode === \"track\" ? \"track-dv\" : modalView ?  (isSidebarOpen ? \"dv modal-bg\" : \"dv toggle\") : (isSidebarOpen ? \"dv\" : \"dv toggle\")}>\n                {/* className={isSidebarOpen ? \"dv\" : \"dv toggle\"} */}\n                <div className={modalView ? \"modal-bg edit-content\" : \"edit-content\"}>\n                    {\n                        mode === \"track\" && <img\n                            className=\"i-close edit-close\"\n                            src=\"/assets/web/tthroo-close-icon.svg\"\n                            onClick={toggleEditModal}\n                            alt=\"close-icon\" />\n                    }\n                    <div className=\"dv-hdr\">\n                        Project Details\n                        </div>\n                    <div className=\"e-c-items\">\n                        <div className=\"item title-c\">\n                            <div className=\"lbl\">\n                                Title\n                                </div>\n                            <div id=\"scrolling-container\">\n                                <div id=\"title\"></div>\n                                {/* <input name=\"title\" type=\"text\"\n                                        value={title}\n                                        onChange={this.handleTextInp}\n                                    /> */}\n                            </div>\n                        </div>\n                        <div className=\"item label\">\n                            <div className=\"lbl\">\n                                Status\n                                </div>\n                            {/* <StatusDD \n                                    onlyInput={true}\n                                    modalView={modalView}\n                                    modalClickHandler={modalClickHandler}\n                                /> */}\n                            <LabelDD\n                                mode=\"status\"\n                                onlyInput={true}\n                                modalView={modalView}\n                                modalClickHandler={this.toggleModal}\n                                activeProjectId={activeProjectId}\n                                tid={tid}\n                                value={status ? status : (activeProject && activeProject.status ? activeProject.status : null)}\n                            />\n                        </div>\n                        <div className=\"item label\">\n                            <div className=\"lbl\">\n                                Label\n                                </div>\n                            <LabelDD\n                                mode=\"label\"\n                                onlyInput={true}\n                                modalView={modalView}\n                                modalClickHandler={this.toggleModal}\n                                activeProjectId={activeProjectId}\n                                tid={tid}\n                                value={activeProject && activeProject.label ? activeProject.label : null}\n                            />\n                        </div>\n                        <div className=\"item\">\n                            <div className=\"lbl\">\n                                Project Type\n                            </div>  \n                            <div>\n                                <Select \n                                    handleProjectTypeChange={this.handleProjectTypeChange}\n                                    projectType={this.meta.projectType}\n                                />\n                            </div>\n                        </div>\n                        <div className=\"item\">\n                            <div className=\"lbl\">\n                                Start Time\n                                </div>\n                            <div>\n                                {/* <input type=\"text\" /> */}\n                                <Datetime\n                                    viewMode=\"time\"\n                                    timeFormat={true}\n                                    value={activeProject ? activeProject.startTime : null}\n                                    inputProps={{ placeholder: \"Enter start time\", readOnly: true, className: modalView ? \"modal-bg\" : \"\" }}\n                                    disabled={modalView}\n                                    onChange={(value) => {\n                                        this.props.updateProjectMW({ id: this.props.id, tid, key: \"startTime\", val: value.toDate() });\n                                        this.calcDuration({ ...activeProject, startTime: value.toDate() });\n                                    }}\n                                />\n                            </div>\n                        </div>\n                        <div className=\"item\">\n                            <div className=\"lbl\">\n                                End Time\n                                </div>\n                            <div>\n                                {/* <input type=\"text\" /> */}\n                                <Datetime\n                                    viewMode=\"time\"\n                                    value={activeProject ? activeProject.endTime : null}\n                                    inputProps={{ placeholder: \"Enter end time\", readOnly: true, className: modalView ? \"modal-bg\" : \"\" }}\n                                    className={modalView ? \"modal-bg\" : \"\"}\n                                    disabled={modalView}\n                                    onChange={(value) => {\n                                        this.props.updateProjectMW({ id: this.props.id, tid, key: \"endTime\", val: value.toDate() });\n                                        this.calcDuration({ ...activeProject, endTime: value.toDate() });\n                                    }}\n                                />\n                            </div>\n                        </div>\n                        <div className=\"item\">\n                            <div className=\"lbl\">\n                                Duration\n                                </div>\n                            <div>\n                                <input className={modalView ? \"modal-bg\" : \"\"} type=\"text\" value={duration ? duration : 0} readOnly={true} />\n                            </div>\n                        </div>\n                        <div className=\"item description-c\">\n                            <div className=\"lbl\">\n                                Description\n                                </div>\n                            <div>\n                                {/* <textarea name=\"description\" \n                                        value={description}\n                                        onChange={this.handleTextInp}    \n                                    >\n                                    </textarea> */}\n                                <div id=\"scrolling-container\">\n                                    <div id=\"description\"></div>\n                                    {/* <input name=\"title\" type=\"text\"\n                                            value={title}\n                                            onChange={this.handleTextInp}\n                                        /> */}\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"item outcome-c\">\n                            <div className=\"lbl\">\n                                Outcome\n                                </div>\n                            <div>\n                                {/* <textarea name=\"outcome\" \n                                        value={outcome}\n                                        onChange={this.handleTextInp}\n                                    >\n                                    </textarea> */}\n                                <div id=\"scrolling-container\">\n                                    <div id=\"outcome\"></div>\n                                    {/* <input name=\"title\" type=\"text\"\n                                            value={title}\n                                            onChange={this.handleTextInp}\n                                        /> */}\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"item reward-c\">\n                            <div className=\"lbl\">\n                                Treat Yourself With\n                                </div>\n                            <div>\n                                {/* <textarea name=\"reward\" value={reward}\n                                        onChange={this.handleTextInp}\n                                    >\n                                    </textarea> */}\n                                <div id=\"scrolling-container\">\n                                    <div id=\"reward\"></div>\n                                    {/* <input name=\"title\" type=\"text\"\n                                            value={title}\n                                            onChange={this.handleTextInp}\n                                        /> */}\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"item ctas\">\n                            { \n                                topic == null || Object.keys(topic).length == 0  ?\n                                <button className=\"c-p-btn create\" onClick={this.createProject}>Create</button> :\n                                <button className=\"c-p-btn create\" onClick={() => updateProperties(topic, this.meta)}>Update</button>\n                            }\n                            <button className=\"c-p-btn cancel\">\n                                Cancel\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    // console.log(\"state:::\", state);\n    return {\n        id: state.projects.activeProjectId,\n        meta: state.projects,\n        activeProjectId: state.projects.activeProjectId\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        updateProjectMW,\n        setActiveProjectMW,\n        addProjectMW\n    }\n)(EditComponent));","import React, { Component } from \"react\";\nimport Sidebar from \"./sidebar\";\nimport ProjectsList from \"./list\";\n// import Modal from \"../../fragments/modal\";\nimport EditComponent from \"../../project/edit/edit\";\n\nimport \"./index.scss\";\n\nclass DashboardBody extends Component {\n\n    // register a collapsible function\n    constructor (props) {\n        super(props);\n        this.state = {\n            open: true,\n            cpModal: false\n        }\n        this.togglePanel = this.togglePanel.bind(this);\n        this.toggleCPModal = this.toggleCPModal.bind(this);\n    }\n\n    togglePanel(e) {\n        debugger\n        this.setState({ open: !this.state.open })\n    }\n\n    toggleCPModal() {\n        this.setState({\n            cpModal: !this.state.cpModal\n        });\n    }\n\n    render() {\n\n        const {\n            open,\n            cpModal,\n            workspace_id\n        } = this.state;\n\n        return (\n            <div className=\"container\">\n                <ProjectsList \n                    isSidebarOpen={open}\n                />\n            </div>\n        )\n    }\n}\n\nexport default DashboardBody;","import React, { Component } from \"react\";\nimport Header from \"../fragments/header\";\nimport DashboardBody from \"./body\";\n\nimport \"./index.scss\";\n\nclass Dashboard extends Component {\n\n    render() {\n        return (\n            <>\n                <Header />\n                <DashboardBody />\n            </>\n        )\n    }\n}\n\nexport default Dashboard;","import React from \"react\";\nimport WorkspaceDD from \"../../../fragments/workspace-dd\";\nimport { NavLink } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { setActiveProjectMW } from \"../../../../store/actions/projects\";\n\nimport \"./index.scss\";\n\nconst Header = (props) => {\n    const { \n        workspace_id\n    } = props.match.params;\n    const {\n        title\n    } = props;\n\n    const resetId = (e) => {\n        props.setActiveProjectMW(null);\n    }\n\n    return (\n        <header class=\"main-header\">\n\n            <div className=\"hdr-container\">\n                <NavLink \n                    to={`/workspace/${workspace_id}/dashboard`}\n                    onClick={resetId}\n                    className=\"back-btn\"\n                    >\n                        <img alt=\"analyse\" src=\"/assets/web/back-nav.svg\" />\n                </NavLink>\n                <h1>{title && title.quillText ? title.quillText : \"Loading\"}</h1>\n                <div className=\"s-ws-container\">\n                    <WorkspaceDD />\n                </div>\n                <div className=\"profile-c\">\n                    <img className=\"profile\" src=\"/assets/web/default-profile.svg\" alt=\"profile-icon\" />\n                </div>\n            </div>\n        </header>\n    )\n}\n\nexport default withRouter(connect(null,{\n    setActiveProjectMW\n})(Header));","import React, { Component } from \"react\";\nimport { NavLink } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { setActiveProjectMW } from \"../../../../store/actions/projects\";\nimport { withRouter } from \"react-router-dom\";\n\nimport \"./index.scss\";\n\nclass Sidebar extends Component {\n\n    resetId = (e) => {\n        this.props.setActiveProjectMW(null);\n    }\n\n    // return an array from projectType string split based on \"+\"\n    getProjectType = (pt) => {\n        // if (pt && pt === \"map\") {\n        //     return \"m\";\n        // } else if (pt && pt === \"map+analyse\") {\n        //     return \"ma\";\n        // } else if (pt && pt ===\"map+analyse+reminders\") {\n        //     return \"mar\";\n        // }\n        if (Boolean(pt))\n            return pt.split(\"+\");\n        else \n            return [];\n    }\n\n    render() {\n\n        const {\n            activeWSProject\n        } = this.props;\n\n        const { \n            workspace_id\n        } = this.props.match.params;\n\n        // console.log(\"activeWSProject in sidebar\", activeWSProject);\n\n\n        let projectType;\n        if (activeWSProject) {\n            projectType = this.getProjectType(activeWSProject.projectType);\n        }\n\n        console.log(\"projectType::\", projectType, \"projectType.indexOf('map')\", projectType.indexOf(\"map\"));\n\n        return (\n            <div className=\"sidebar\">\n                {/* <div className=\"btd\">\n                    <NavLink \n                        to={`/workspace/${workspace_id}/dashboard`}\n                        onClick={this.resetId}\n                        className=\"back-btn\"\n                        >\n                            <img alt=\"analyse\" src=\"/assets/web/back-nav.svg\" />\n                    </NavLink>\n                </div> */}\n                <div className=\"contents\">\n                    {   \n                        projectType.indexOf(\"roadmap\") != -1 &&\n                        <NavLink \n                            to=\"roadmap\" \n                            activeClassName=\"proj-tab active\"\n                            className=\"proj-tab\">\n                                <img alt=\"edit-project\" src=\"/assets/web/roadmap.svg\" />\n                        </NavLink>\n                    }\n                    {   \n                        projectType.indexOf(\"map\") != -1 &&\n                        <NavLink \n                            to=\"edit\" \n                            activeClassName=\"proj-tab active\"\n                            className=\"proj-tab\">\n                                <img alt=\"edit-project\" src=\"/assets/web/edit-project.svg\" />\n                        </NavLink>\n                    }\n                    {\n                        projectType.indexOf(\"analyse\") != -1 &&\n                        <NavLink \n                            to=\"assess\"\n                            activeClassName=\"proj-tab active\"\n                            className={!(projectType && projectType.includes(\"a\")) ? \"proj-tab\" : \"proj-tab\"}\n                            >\n                            <img alt=\"analyse\" src=\"/assets/web/assessment.svg\" />\n                        </NavLink>\n                    }\n                    {\n                        projectType.indexOf(\"reminders\") != -1 &&\n                        <NavLink \n                            to=\"reminders\"\n                            activeClassName=\"proj-tab active\"\n                            className={!(projectType && projectType.includes(\"a\") && projectType.includes(\"r\")) ? \"proj-tab\" : \"proj-tab\"}>\n                            <img alt=\"reminders\" src=\"/assets/web/reminders.svg\" />\n                        </NavLink>\n                    }\n                </div>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    // console.log(\"inside mapStateToPros func in EDIT PAGE\", state);\n    return {\n        activeWSProject: state.wikis.activeWSProject\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        setActiveProjectMW\n    }\n)(Sidebar))","import React from \"react\";\nimport { iconClassName, browserOpenFile } from \"@blink-mind/renderer-react\";\n\nexport function ToolbarItemOpen(props) {\n  const onClickOpenFile = e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller } = diagramProps;\n    browserOpenFile(\".json,.blinkmind,.bm\").then(txt => {\n      let obj = JSON.parse(txt);\n      let model = controller.run(\"deserializeModel\", { controller, obj });\n      diagram.openNewModel(model);\n    });\n  };\n  return (\n    <div\n      className={`bm-toolbar-item ${iconClassName(\"openfile\")}`}\n      onClick={onClickOpenFile}\n    />\n  );\n}\n","import React from \"react\";\nimport { DiagramLayoutType } from \"@blink-mind/core\";\nimport cx from \"classnames\";\nimport { Icon, iconClassName } from \"@blink-mind/renderer-react\";\nimport { Menu, MenuItem, Popover } from \"@blueprintjs/core\";\n\nexport function ToolbarItemLayout(props) {\n  const layoutDirs = [\n    [\n      DiagramLayoutType.LEFT_AND_RIGHT,\n      \"Left And Right\",\n      \"layout-left-and-right\"\n    ],\n    [DiagramLayoutType.LEFT_TO_RIGHT, \"Only Right\", \"layout-right\"],\n    [DiagramLayoutType.RIGHT_TO_LEFT, \"Only Left\", \"layout-left\"]\n  ];\n\n  const onClickSetLayout = layoutDir => e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller } = diagramProps;\n    controller.run(\"setLayoutDir\", { ...diagramProps, layoutDir });\n  };\n\n  return (\n    <div\n      className={cx(\"bm-toolbar-item\", iconClassName(\"layout-left-and-right\"))}\n    >\n      <Popover enforceFocus={false}>\n        <div className=\"bm-toolbar-popover-target\" />\n        <Menu>\n          {layoutDirs.map(dir => (\n            <MenuItem\n              key={dir[1]}\n              icon={Icon(dir[2])}\n              text={dir[1]}\n              onClick={onClickSetLayout(dir[0])}\n            />\n          ))}\n        </Menu>\n      </Popover>\n    </div>\n  );\n};\n","import defaultThemeImg from \"../../images/default.jpg\";\nimport theme1Img from \"../../images/theme1.jpg\";\nimport theme2Img from \"../../images/theme2.jpg\";\nimport theme3Img from \"../../images/theme3.jpg\";\nimport theme4Img from \"../../images/theme4.jpg\";\nimport cx from \"classnames\";\nimport { iconClassName } from \"@blink-mind/renderer-react\";\nimport { Popover } from \"@blueprintjs/core\";\nimport React from \"react\";\n\nexport function ToolbarItemTheme(props) {\n  const onClickSetTheme = themeKey => e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller } = diagramProps;\n    controller.run(\"setTheme\", { ...diagramProps, themeKey });\n  };\n  const themes = [\n    [\"default\", defaultThemeImg],\n    [\"theme1\", theme1Img],\n    [\"theme2\", theme2Img],\n    [\"theme3\", theme3Img],\n    [\"theme4\", theme4Img]\n  ];\n\n  return (\n    <div className={cx(\"bm-toolbar-item\", iconClassName(\"theme\"))}>\n      <Popover enforceFocus={false}>\n        <div className=\"bm-toolbar-popover-target\" />\n        <div className=\"bm-popover-theme\">\n          {themes.map(theme => (\n            <div\n              key={theme[0]}\n              className=\"bm-theme-item\"\n              onClick={onClickSetTheme(theme[0])}\n            >\n              <img className=\"bm-theme-img\" src={theme[1]} alt={theme[0]} />\n            </div>\n          ))}\n        </div>\n      </Popover>\n    </div>\n  );\n}\n","import cx from \"classnames\";\nimport { iconClassName } from \"@blink-mind/renderer-react\";\nimport { Menu, MenuDivider, MenuItem, Popover } from \"@blueprintjs/core\";\nimport React from \"react\";\nimport { downloadFile } from \"../../utils\";\n\nexport function ToolbarItemExport(props) {\n  const onClickExportJson = e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller, model } = diagramProps;\n\n    const json = controller.run(\"serializeModel\", diagramProps);\n    const jsonStr = JSON.stringify(json);\n    const url = `data:text/plain,${encodeURIComponent(jsonStr)}`;\n    const title = controller.run(\"getTopicTitle\", {\n      ...diagramProps,\n      topicKey: model.rootTopicKey\n    });\n    downloadFile(url, `${title}.blinkmind`);\n  };\n\n  return (\n    <div className={cx(\"bm-toolbar-item\", iconClassName(\"export\"))}>\n      <Popover enforceFocus={false}>\n        <div className=\"bm-toolbar-popover-target\" />\n        <Menu>\n          <MenuItem text=\"JSON(.json)\" onClick={onClickExportJson} />\n          <MenuDivider />\n        </Menu>\n      </Popover>\n    </div>\n  );\n}\n","// import { Model, createKey } from \"@blink-mind/core\";\nimport { Model, createKey } from \"../packages/core/lib/main\";\nimport { act } from \"react-dom/test-utils\";\n\n\nexport const downloadFile = (url, filename) => {\n  const link = document.createElement(\"a\");\n  link.href = url;\n  link.download = filename;\n  link.click();\n};\n\nexport function generateSimpleModel(activeWSProject, workspaces = []) {\n  const rootKey = createKey();\n\n  let obj = {\n    rootTopicKey: rootKey,\n    topics: [\n      {\n        key: rootKey,\n        blocks: [{ type: \"CONTENT\", data: \"MainTopic\" }]\n      }\n    ],\n    properties: {\n      title: {\n        quillText: \"MainTopic\"\n      }\n    }\n  };\n\n  let foundWs;\n  // console.log(\"inside geterante simple model\", activeWSProject)\n  if (typeof activeWSProject == \"string\") {\n    foundWs = workspaces.filter(ws => ws._id == activeWSProject._id);\n    if (foundWs.length == 1) {\n      if (foundWs[0] && foundWs[0].map && Object.keys(foundWs[0].map).length > 0) {\n        obj = foundWs[0].map;\n      }\n    }\n  } else if (typeof activeWSProject == \"object\" && activeWSProject.map) {\n    obj = activeWSProject.map;\n  }\n\n  // console.log(\"obj\", obj)\n\n  return Model.create(obj);\n}\n","import { OpType, FocusMode, getAllSubTopicKeys, ModelModifier } from '@blink-mind/core';\nimport { ZIndex, Flex, PropKey, cancelEvent, iconClassName, TopicBlockIcon, StyledCheckbox, Icon } from '@blink-mind/renderer-react';\nimport { Button, Alert, PopoverInteractionKind, Popover, MenuDivider, MenuItem } from '@blueprintjs/core';\nimport { createElement, useState, Fragment } from 'react';\nimport styled from 'styled-components';\nimport { List, Map, Record } from 'immutable';\nimport { Omnibar } from '@blueprintjs/select';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar FOCUS_MODE_SET_REFERENCE_TOPICS = 'FOCUS_MODE_SET_REFERENCE_TOPICS'; // 添加引用的Topic\n\nvar OP_TYPE_START_SET_REFERENCE_TOPICS = 'OP_TYPE_START_SET_REFERENCE_TOPICS';\nvar OP_TYPE_SET_REFERENCE_TOPICS = 'OP_TYPE_SET_REFERENCE_TOPICS';\nvar EXT_DATA_KEY_TOPIC_REFERENCE = 'TOPIC_REFERENCE';\nvar EXT_KEY_TOPIC_REFERENCE = 'EXT_KEY_TOPIC_REFERENCE';\nvar Root = styled(ZIndex)(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  position: absolute;\\n  left: calc(50% - 150px);\\n  top: 30px;\\n  width: 300px;\\n  background: white;\\n  padding: 10px;\\n  user-select: none;\\n\"], [\"\\n  position: absolute;\\n  left: calc(50% - 150px);\\n  top: 30px;\\n  width: 300px;\\n  background: white;\\n  padding: 10px;\\n  user-select: none;\\n\"])));\nvar Title = styled.div(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n  margin-bottom: 10px;\\n\"], [\"\\n  margin-bottom: 10px;\\n\"])));\n\nfunction AddReferenceTopicPanel(props) {\n  var zIndex = props.zIndex,\n      controller = props.controller,\n      topicKey = props.topicKey;\n\n  var onClickCancel = function onClickCancel(e) {\n    controller.run('clearSelectedReferenceKeys', props);\n    controller.run('enableOperation', props);\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FocusMode.NORMAL\n    }));\n  };\n\n  var onClickConfirm = function onClickConfirm(e) {\n    var referenceKeys = controller.run('getSelectedReferenceKeys', props);\n    controller.run('enableOperation', props);\n    controller.run('operation', _assign(_assign({}, props), {\n      opArray: [{\n        opType: OP_TYPE_SET_REFERENCE_TOPICS,\n        topicKey: topicKey,\n        referenceKeys: referenceKeys\n      }, {\n        opType: OpType.FOCUS_TOPIC,\n        topicKey: topicKey,\n        focusMode: FocusMode.NORMAL\n      }]\n    }));\n    controller.run('clearSelectedReferenceKeys', props);\n  };\n\n  return createElement(Root, {\n    zIndex: zIndex\n  }, createElement(Title, null, \"Please select the topics you want to reference. After selection, click the confirm button.\"), createElement(Flex, {\n    justifyContent: 'space-around'\n  }, createElement(Button, {\n    onClick: onClickConfirm\n  }, \"Confirm\"), createElement(Button, {\n    onClick: onClickCancel\n  }, \"Cancel\")));\n}\n\nvar templateObject_1, templateObject_2;\nvar defaultReferenceRecord = {\n  keyList: List(),\n  dataMap: Map()\n};\n\nvar ReferenceRecord =\n/** @class */\nfunction (_super) {\n  __extends(ReferenceRecord, _super);\n\n  function ReferenceRecord() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(ReferenceRecord.prototype, \"keyList\", {\n    get: function get() {\n      return this.get('keyList');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ReferenceRecord.prototype, \"dataMap\", {\n    get: function get() {\n      return this.get('dataMap');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ReferenceRecord;\n}(Record(defaultReferenceRecord));\n\nvar defaultExtDataReferenceRecord = {\n  reference: Map()\n};\n\nvar ExtDataReference =\n/** @class */\nfunction (_super) {\n  __extends(ExtDataReference, _super);\n\n  function ExtDataReference() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(ExtDataReference.prototype, \"reference\", {\n    get: function get() {\n      return this.get('reference');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ExtDataReference.prototype.getReferenceKeys = function (topicKey) {\n    if (this.reference.has(topicKey)) {\n      return this.reference.get(topicKey).keyList.toArray();\n    }\n\n    return [];\n  };\n\n  ExtDataReference.prototype.getReferencedKeys = function (topicKey) {\n    var res = [];\n    this.reference.forEach(function (v, k) {\n      if (v.keyList.includes(topicKey)) {\n        res.push(k);\n      }\n    });\n    return res;\n  };\n\n  return ExtDataReference;\n}(Record(defaultExtDataReferenceRecord)); // TODO 能否优化这个函数的写法\n\n\nfunction setReferenceTopicKeys(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      referenceKeys = _a.referenceKeys;\n  var extData = model.getExtDataItem(EXT_DATA_KEY_TOPIC_REFERENCE, ExtDataReference);\n  var referenceRecord = extData.reference.get(topicKey) || new ReferenceRecord();\n  referenceRecord = referenceRecord.set('keyList', List(referenceKeys));\n  extData = extData.setIn(['reference', topicKey], referenceRecord);\n  model = model.setIn(['extData', EXT_DATA_KEY_TOPIC_REFERENCE], extData);\n  return model;\n}\n\nvar Root$1 = styled.div(templateObject_1$1 || (templateObject_1$1 = __makeTemplateObject([\"\\n  display: flex;\\n  width: 380px;\\n  margin: 10px;\\n  justify-content: center;\\n  align-items: center;\\n\"], [\"\\n  display: flex;\\n  width: 380px;\\n  margin: 10px;\\n  justify-content: center;\\n  align-items: center;\\n\"])));\nvar Content = styled.div(templateObject_2$1 || (templateObject_2$1 = __makeTemplateObject([\"\\n  width: 300px;\\n  text-decoration: underline;\\n  cursor: pointer;\\n\"], [\"\\n  width: 300px;\\n  text-decoration: underline;\\n  cursor: pointer;\\n\"])));\nvar ButtonPlace = styled.div(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n  width: 80px;\\n\"], [\"\\n  width: 80px;\\n\"])));\n\nfunction ReferenceTopicThumbnail(props) {\n  var controller = props.controller,\n      refKey = props.refKey,\n      refType = props.refType,\n      removeHandler = props.removeHandler;\n\n  var _a = __read(useState(false), 2),\n      deleteConfirm = _a[0],\n      setDeleteConfirm = _a[1];\n\n  var onClick = function onClick(e) {\n    e.stopPropagation();\n    controller.run('focusTopicAndMoveToCenter', _assign(_assign({}, props), {\n      topicKey: refKey\n    }));\n  };\n\n  var onClickRemove = function onClickRemove(e) {\n    setDeleteConfirm(true);\n  };\n\n  var content = controller.getValue(PropKey.TOPIC_TITLE, _assign(_assign({}, props), {\n    topicKey: refKey,\n    maxLength: 100\n  }));\n  var deleteAlertProps = {\n    isOpen: deleteConfirm,\n    cancelButtonText: 'cancel',\n    onConfirm: function onConfirm(e) {\n      removeHandler(e);\n    },\n    onCancel: function onCancel(e) {\n      setDeleteConfirm(false);\n    },\n    onClose: function onClose(e) {\n      setDeleteConfirm(false);\n    }\n  };\n  return createElement(Root$1, null, createElement(Content, {\n    onClick: onClick\n  }, content), createElement(ButtonPlace, null, refType === 'reference' && createElement(Fragment, null, createElement(Button, {\n    onClick: onClickRemove\n  }, \"Remove\"), createElement(Alert, _assign({}, deleteAlertProps), createElement(\"p\", null, \"Are you confirm to remove this reference?\")))));\n}\n\nvar templateObject_1$1, templateObject_2$1, templateObject_3;\nvar Root$2 = styled.div(templateObject_1$2 || (templateObject_1$2 = __makeTemplateObject([\"\"], [\"\"])));\nvar Group = styled.div(templateObject_2$2 || (templateObject_2$2 = __makeTemplateObject([\"\\n  padding: 10px;\\n\"], [\"\\n  padding: 10px;\\n\"])));\nvar GroupList = styled.div(templateObject_3$1 || (templateObject_3$1 = __makeTemplateObject([\"\\n  max-height: 200px;\\n  overflow: auto;\\n\"], [\"\\n  max-height: 200px;\\n  overflow: auto;\\n\"])));\nvar GroupTitle = styled.div(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n  font-size: 20px;\\n  color: #106ba3;\\n\"], [\"\\n  font-size: 20px;\\n  color: #106ba3;\\n\"])));\nvar GotoBtn = styled.div(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n  text-decoration: underline;\\n  color: #106ba3;\\n  cursor: pointer;\\n\"], [\"\\n  text-decoration: underline;\\n  color: #106ba3;\\n  cursor: pointer;\\n\"])));\n\nfunction ReferenceTopicList(props) {\n  var topicKey = props.topicKey,\n      controller = props.controller,\n      model = props.model;\n  var extData = model.extData.get(EXT_DATA_KEY_TOPIC_REFERENCE);\n\n  var removeReference = function removeReference(refKey) {\n    return function (e) {\n      e.stopPropagation();\n      var keyList = extData.reference.get(topicKey).keyList;\n      controller.run('operation', _assign(_assign({}, props), {\n        opArray: [{\n          opType: OP_TYPE_SET_REFERENCE_TOPICS,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL,\n          referenceKeys: keyList.delete(keyList.indexOf(refKey)).toArray()\n        }]\n      }));\n    };\n  };\n\n  var referenceKeys = extData.getReferenceKeys(topicKey);\n  var referenceGroup = referenceKeys.length === 0 ? null : createElement(Group, null, createElement(GroupTitle, null, \"Reference Topics:\"), createElement(GroupList, null, referenceKeys.map(function (key) {\n    var thumbProps = _assign(_assign({}, props), {\n      key: key,\n      refKey: key,\n      refType: 'reference',\n      removeHandler: removeReference(key)\n    }); //@ts-ignore\n\n\n    return createElement(ReferenceTopicThumbnail, _assign({}, thumbProps));\n  })));\n  var referencedKeys = extData.getReferencedKeys(topicKey);\n  var referencedGroup = referencedKeys.length === 0 ? null : createElement(Group, null, createElement(GroupTitle, null, \"Referenced Topics:\"), createElement(GroupList, null, referencedKeys.map(function (key) {\n    var thumbProps = _assign(_assign({}, props), {\n      key: key,\n      refKey: key,\n      refType: 'referenced'\n    }); //@ts-ignore\n\n\n    return createElement(ReferenceTopicThumbnail, _assign({}, thumbProps));\n  })));\n\n  var onClickGotoOriginTopic = function onClickGotoOriginTopic(e) {\n    e.stopPropagation();\n    controller.run('focusTopicAndMoveToCenter', props);\n  };\n\n  var currentTopic = model.focusKey !== topicKey && createElement(Group, null, createElement(GotoBtn, {\n    onClick: onClickGotoOriginTopic\n  }, \"Goto Origin Topic\"));\n  return createElement(Root$2, {\n    onMouseDown: cancelEvent\n  }, referenceGroup, referencedGroup, currentTopic);\n}\n\nvar templateObject_1$2, templateObject_2$2, templateObject_3$1, templateObject_4, templateObject_5;\n\nfunction TopicExtReference(props) {\n  var model = props.model,\n      topicKey = props.topicKey;\n  var extData = model.extData.get(EXT_DATA_KEY_TOPIC_REFERENCE) || new ExtDataReference();\n  var refRecord = extData.reference.get(topicKey);\n  var referencedKeys = [];\n  extData.reference.forEach(function (v, k) {\n    if (v.keyList.includes(topicKey)) referencedKeys.push(k);\n  });\n  if ((refRecord == null || refRecord.keyList.size === 0) && referencedKeys.length === 0) return null;\n  var iconProps = {\n    className: iconClassName('reference'),\n    tabIndex: -1\n  };\n  var icon = createElement(TopicBlockIcon, _assign({}, iconProps));\n  var tooltipContent = createElement(ReferenceTopicList, _assign({}, props));\n  var tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.CLICK,\n    hoverOpenDelay: 500\n  };\n  return createElement(Popover, _assign({}, tooltipProps));\n}\n\nfunction TopicReferenceCheckbox(props) {\n  var topicKey = props.topicKey,\n      selectedTopicKeys = props.selectedTopicKeys;\n  var a = selectedTopicKeys.has(topicKey);\n\n  var _a = __read(useState(a), 2),\n      checked = _a[0],\n      setChecked = _a[1];\n\n  var checkboxProps = {\n    checked: checked,\n    onChange: function onChange() {\n      if (selectedTopicKeys.has(topicKey)) {\n        selectedTopicKeys.delete(topicKey);\n      } else {\n        selectedTopicKeys.add(topicKey);\n      }\n\n      setChecked(!checked);\n    }\n  };\n  return createElement(StyledCheckbox, _assign({}, checkboxProps));\n}\n\nfunction TopicReferencePlugin() {\n  var selectedTopicKeys = new Set();\n\n  function startSetReferenceTopics(_a) {\n    var model = _a.model,\n        topicKey = _a.topicKey;\n    var extData = model.getExtDataItem(EXT_DATA_KEY_TOPIC_REFERENCE, ExtDataReference);\n    selectedTopicKeys = new Set(extData.getReferenceKeys(topicKey));\n    model = ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FOCUS_MODE_SET_REFERENCE_TOPICS\n    });\n    return model;\n  }\n\n  return {\n    customizeTopicContextMenu: function customizeTopicContextMenu(props, next) {\n      var controller = props.controller;\n\n      function onClickSetReferenceTopics(e) {\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OP_TYPE_START_SET_REFERENCE_TOPICS\n        }));\n        controller.run('disableOperation', _assign(_assign({}, props), {\n          whiteList: [OpType.TOGGLE_COLLAPSE]\n        }));\n      }\n\n      return createElement(Fragment, null, next(), createElement(MenuDivider, null), createElement(MenuItem, {\n        key: EXT_KEY_TOPIC_REFERENCE,\n        icon: Icon('reference'),\n        text: \"Set Reference Topics\",\n        onClick: onClickSetReferenceTopics\n      }));\n    },\n    getOpMap: function getOpMap(props, next) {\n      var opMap = next();\n      opMap.set(OP_TYPE_START_SET_REFERENCE_TOPICS, startSetReferenceTopics);\n      opMap.set(OP_TYPE_SET_REFERENCE_TOPICS, setReferenceTopicKeys);\n      return opMap;\n    },\n    beforeOpFunction: function beforeOpFunction(props, next) {\n      var model = next();\n      var opType = props.opType,\n          topicKey = props.topicKey; // 注意是在beforeOpFunction里面操作\n\n      if (opType === OpType.DELETE_TOPIC && topicKey !== model.editorRootTopicKey) {\n        var allDeleteKeys = getAllSubTopicKeys(model, topicKey);\n        allDeleteKeys.push(topicKey);\n        var extData_1 = model.getExtDataItem(EXT_DATA_KEY_TOPIC_REFERENCE, ExtDataReference);\n        var reference_1 = extData_1.reference; // 注意这里要处理所有被删除的Key\n\n        allDeleteKeys.forEach(function (deleteKey) {\n          var referencedKeys = extData_1.getReferencedKeys(deleteKey); // 处理被引用的部分\n\n          reference_1 = reference_1.withMutations(function (reference) {\n            referencedKeys.forEach(function (v) {\n              reference.updateIn([v, 'keyList'], function (keyList) {\n                return keyList.delete(keyList.indexOf(deleteKey));\n              });\n            });\n          }); // 处理引用的部分\n\n          if (reference_1.has(deleteKey)) {\n            reference_1 = reference_1.delete(deleteKey);\n          }\n        });\n        extData_1 = extData_1.set('reference', reference_1);\n        model = model.setIn(['extData', EXT_DATA_KEY_TOPIC_REFERENCE], extData_1);\n      }\n\n      return model;\n    },\n    renderDiagramCustomize: function renderDiagramCustomize(props, next) {\n      var model = props.model,\n          controller = props.controller;\n      var zIndex = controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX) + 2;\n      var res = next();\n\n      if (model.focusMode === FOCUS_MODE_SET_REFERENCE_TOPICS) {\n        var panelProps = _assign(_assign({}, props), {\n          zIndex: zIndex,\n          topicKey: model.focusKey,\n          key: 'AddReferenceTopicPanel'\n        });\n\n        res.push(createElement(AddReferenceTopicPanel, _assign({}, panelProps)));\n      }\n\n      return res;\n    },\n    renderTopicContentOthers: function renderTopicContentOthers(props, next) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller;\n      var res = next();\n      res.push(controller.run('renderTopicExtReference', _assign(_assign({}, props), {\n        key: EXT_KEY_TOPIC_REFERENCE + '-icon'\n      })));\n\n      if (model.focusMode === FOCUS_MODE_SET_REFERENCE_TOPICS && model.focusKey !== topicKey) {\n        var checkBoxProps = _assign(_assign({}, props), {\n          key: 'checkbox',\n          selectedTopicKeys: selectedTopicKeys\n        });\n\n        var checkbox = createElement(TopicReferenceCheckbox, _assign({}, checkBoxProps));\n        res.push(checkbox);\n      }\n\n      return res;\n    },\n    renderTopicExtReference: function renderTopicExtReference(props, next) {\n      return createElement(TopicExtReference, _assign({}, props));\n    },\n    clearSelectedReferenceKeys: function clearSelectedReferenceKeys() {\n      selectedTopicKeys.clear();\n    },\n    getSelectedReferenceKeys: function getSelectedReferenceKeys() {\n      return Array.from(selectedTopicKeys);\n    },\n    //TODO\n    deserializeExtDataItem: function deserializeExtDataItem(props, next) {\n      var extDataKey = props.extDataKey,\n          extDataItem = props.extDataItem;\n\n      if (extDataKey === EXT_DATA_KEY_TOPIC_REFERENCE) {\n        var extDataReference = new ExtDataReference();\n\n        var _loop_1 = function _loop_1(key) {\n          var item = extDataItem.reference[key];\n          var referenceRecord = new ReferenceRecord({\n            keyList: List(item.keyList),\n            dataMap: Map(item.dataMap)\n          });\n          extDataReference = extDataReference.update('reference', function (reference) {\n            return reference.set(key, referenceRecord);\n          });\n        };\n\n        for (var key in extDataItem.reference) {\n          _loop_1(key);\n        }\n\n        return extDataReference;\n      }\n\n      return next();\n    }\n  };\n}\n\nvar NavOmniBar = Omnibar.ofType();\nvar StyledNavOmniBar = styled(NavOmniBar)(templateObject_1$3 || (templateObject_1$3 = __makeTemplateObject([\"\\n  top: 20%;\\n  left: 25% !important;\\n  width: 50% !important;\\n\"], [\"\\n  top: 20%;\\n  left: 25% !important;\\n  width: 50% !important;\\n\"])));\nvar TopicTitle = styled.div(templateObject_2$3 || (templateObject_2$3 = __makeTemplateObject([\"\\n  margin: 0 5px;\\n  padding: 10px 5px;\\n  width: 100%;\\n  font-size: 16px;\\n  cursor: pointer;\\n  &:hover {\\n    background: #e3e8ec;\\n  }\\n\"], [\"\\n  margin: 0 5px;\\n  padding: 10px 5px;\\n  width: 100%;\\n  font-size: 16px;\\n  cursor: pointer;\\n  &:hover {\\n    background: #e3e8ec;\\n  }\\n\"])));\nvar StyledPopover = styled(Popover)(templateObject_3$2 || (templateObject_3$2 = __makeTemplateObject([\"\\n  display: block;\\n\"], [\"\\n  display: block;\\n\"])));\nvar Tip = styled.div(templateObject_4$1 || (templateObject_4$1 = __makeTemplateObject([\"\\n  padding: 10px;\\n  font-size: 16px;\\n  //max-width: 800px;\\n  //max-height: 600px;\\n  overflow: auto;\\n\"], [\"\\n  padding: 10px;\\n  font-size: 16px;\\n  //max-width: 800px;\\n  //max-height: 600px;\\n  overflow: auto;\\n\"])));\nvar TipContent = styled.div(templateObject_5$1 || (templateObject_5$1 = __makeTemplateObject([\"\\n  white-space: break-spaces;\\n\"], [\"\\n  white-space: break-spaces;\\n\"])));\nvar INPUT_PROPS = {\n  placeholder: 'Search'\n};\n\nfunction SearchPanel(props) {\n  var model = props.model,\n      setSearchWord = props.setSearchWord,\n      controller = props.controller;\n\n  var onClose = function onClose() {\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FocusMode.NORMAL\n    }));\n  };\n\n  var getAllSections = function getAllSections() {\n    var res = [];\n    model.topics.forEach(function (topic, topicKey) {\n      res.push({\n        key: topicKey,\n        title: controller.run('getTopicTitle', _assign(_assign({}, props), {\n          topicKey: topicKey\n        }))\n      });\n    });\n    return res;\n  };\n\n  var navigateToTopic = function navigateToTopic(topicKey) {\n    return function (e) {\n      controller.run('focusTopicAndMoveToCenter', _assign(_assign({}, props), {\n        topicKey: topicKey\n      }));\n    };\n  };\n\n  var renderItem = function renderItem(section, props) {\n    // const pathElements = section.path.reduce<React.ReactChild[]>(\n    //   (elems, el) => {\n    //     elems.push(el, <Icon key={el} icon=\"caret-right\" />);\n    //     return elems;\n    //   },\n    //   []\n    // );\n    var key = section.key,\n        sectionTitle = section.title;\n    var maxLength = 100;\n    var needTip = sectionTitle.length > maxLength;\n    var title = needTip ? sectionTitle.substr(0, maxLength) + '...' : sectionTitle;\n    var titleProps = {\n      key: key,\n      onClick: navigateToTopic(key)\n    };\n    var titleEl = createElement(TopicTitle, _assign({}, titleProps), title);\n    var tip = createElement(Tip, null, createElement(TipContent, null, sectionTitle));\n    var popoverProps = {\n      key: key,\n      target: titleEl,\n      content: tip,\n      fill: true,\n      interactionKind: PopoverInteractionKind.HOVER_TARGET_ONLY,\n      hoverOpenDelay: 1000\n    };\n    return needTip ? createElement(StyledPopover, _assign({}, popoverProps)) : titleEl;\n  };\n\n  var filterMatches = function filterMatches(query, items) {\n    return items.filter(function (item) {\n      return item.title.toLowerCase().includes(query.toLowerCase());\n    });\n  };\n\n  var sections = getAllSections();\n  return createElement(StyledNavOmniBar, {\n    inputProps: INPUT_PROPS,\n    itemListPredicate: filterMatches,\n    isOpen: true,\n    items: sections,\n    itemRenderer: renderItem,\n    // onItemSelect={handleItemSelect}\n    onClose: onClose,\n    resetOnSelect: true\n  });\n}\n\nvar templateObject_1$3, templateObject_2$3, templateObject_3$2, templateObject_4$1, templateObject_5$1;\nvar HOT_KEY_NAME_SEARCH = 'DEFAULT_SEARCH';\nvar FOCUS_MODE_SEARCH = 'FOCUS_MODE_SEARCH';\n\nfunction SearchPlugin() {\n  var setSearchWorld = function setSearchWorld(s) {};\n\n  return {\n    customizeHotKeys: function customizeHotKeys(props, next) {\n      var controller = props.controller,\n          model = props.model;\n      var hotKeys = next();\n      hotKeys.globalHotKeys.set(HOT_KEY_NAME_SEARCH, {\n        label: 'search',\n        combo: 'ctrl + f',\n        onKeyDown: function onKeyDown() {\n          controller.run('operation', _assign(_assign({}, props), {\n            opType: OpType.FOCUS_TOPIC,\n            topicKey: model.focusKey,\n            focusMode: FOCUS_MODE_SEARCH\n          }));\n        }\n      });\n      return hotKeys;\n    },\n    renderDiagramCustomize: function renderDiagramCustomize(props, next) {\n      var res = next();\n      var model = props.model;\n\n      if (model.focusMode === FOCUS_MODE_SEARCH) {\n        var searchPanelProps = _assign(_assign({\n          key: 'search-panel'\n        }, props), {\n          setSearchWorld: setSearchWorld\n        });\n\n        res.push(createElement(SearchPanel, _assign({}, searchPanelProps)));\n      }\n\n      return res;\n    }\n  };\n}\n\nexport { FOCUS_MODE_SEARCH, HOT_KEY_NAME_SEARCH, SearchPlugin, TopicReferencePlugin };","import React from \"react\";\nimport { OpType } from \"@blink-mind/core\";\nimport { FOCUS_MODE_SEARCH } from \"@blink-mind/plugins\";\nimport { iconClassName, IconName } from \"@blink-mind/renderer-react\";\n\nexport function ToolbarItemSearch(props) {\n  const onClickSearch = e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller } = diagramProps;\n\n    controller.run(\"operation\", {\n      ...diagramProps,\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FOCUS_MODE_SEARCH\n    });\n  };\n  return (\n    <div\n      className={`bm-toolbar-item ${iconClassName(IconName.SEARCH)}`}\n      onClick={onClickSearch}\n    />\n  );\n}\n","import React from \"react\";\nimport cx from \"classnames\";\nimport \"./Toolbar.css\";\nimport { iconClassName } from \"@blink-mind/renderer-react\";\nimport { ToolbarItemOpen } from \"./toolbar-item-open\";\nimport { ToolbarItemLayout } from \"./toolbar-item-layout\";\nimport { ToolbarItemTheme } from \"./toolbar-item-theme\";\nimport { ToolbarItemExport } from \"./toolbar-item-export\";\nimport { ToolbarItemSearch } from \"./toolbar-item-search\";\n\n// import debug from \"debug\";\n// const log = debug(\"app\");\n\nexport class Toolbar extends React.PureComponent {\n  render() {\n    const props = this.props;\n\n    const { onClickUndo, onClickRedo, canUndo, canRedo, updateWsMap, navBack } = props;\n\n    return (\n      <div className=\"bm-toolbar\">\n        <ToolbarItemOpen {...props} />\n        <ToolbarItemExport {...props} />\n        <ToolbarItemTheme {...props} />\n        <ToolbarItemLayout {...props} />\n        <ToolbarItemSearch {...props} />\n\n        <div\n          className={cx(\"bm-toolbar-item\", iconClassName(\"undo\"), {\n            \"bm-toolbar-item-disabled\": !canUndo\n          })}\n          onClick={onClickUndo}\n        />\n\n        <div\n          className={cx(\"bm-toolbar-item\", iconClassName(\"redo\"), {\n            \"bm-toolbar-item-disabled\": !canRedo\n          })}\n          onClick={onClickRedo}\n        />\n        <div className=\"bm-toolbar-item iconfont\" onClick={updateWsMap}>\n          <button className=\"save-map\">SAVE</button>\n        </div>\n\n        {/* <div className=\"bm-toolbar-item nav-back\" onClick={navBack}>\n          <button>Back</button>\n        </div> */}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\n// // import { Diagram } from \"@blink-mind/renderer-react\";\n// import { Diagram } from \"../packages/renderer-react/lib/main\";\n// // import RichTextEditorPlugin from \"@blink-mind/plugin-rich-text-editor\";\n// import RichTextEditorPlugin from \"../packages/plugin-rich-text-editor/lib/main\";\n// // import { JsonSerializerPlugin } from \"@blink-mind/plugin-json-serializer\";\n// import { JsonSerializerPlugin } from \"../packages/plugin-json-serializer/lib/main\";\n// import { ThemeSelectorPlugin } from \"@blink-mind/plugin-theme-selector\";\n// import TopologyDiagramPlugin from \"@blink-mind/plugin-topology-diagram\";\n// import { TopicReferencePlugin, SearchPlugin } from \"@blink-mind/plugins\";\n// import { Toolbar } from \"./toolbar/toolbar\";\n// import { generateSimpleModel } from \"../utils\";\n// import \"@blink-mind/renderer-react/lib/main.css\";\nimport { Diagram } from \"../packages/renderer-react/lib/main\";\nimport RichTextEditorPlugin from \"../packages/plugin-rich-text-editor/lib/main\";\nimport { JsonSerializerPlugin } from \"../packages/plugin-json-serializer/lib/main\";\nimport { ThemeSelectorPlugin } from \"../packages/plugin-theme-selector/lib/main\";\nimport TopologyDiagramPlugin from \"../packages/plugin-topology-diagram/lib/main\";\nimport { TopicReferencePlugin, SearchPlugin } from \"../packages/plugins/lib/main\";\nimport { Toolbar } from \"./toolbar/toolbar\";\nimport { generateSimpleModel } from \"../utils\";\nimport \"../packages/renderer-react/lib/main.css\";\nimport debug from \"debug\";\nimport { updateWSProject } from \"../../../../../services/project\";\nimport { BlockType, ModelModifier } from \"../packages/core/lib/main\";\n\nconst log = debug(\"app\");\n\nconst plugins = [\n  RichTextEditorPlugin(),\n  ThemeSelectorPlugin(),\n  TopicReferencePlugin(),\n  SearchPlugin(),\n  TopologyDiagramPlugin(),\n  JsonSerializerPlugin()\n];\n\nexport class Mindmap extends React.Component {\n  constructor (props) {\n    super(props);\n    this.initModel();\n    window[\"TThroo\"] = {\n      editNode: this.editNode,\n      bindUpdatedTitle: this.bindUpdatedTitle,\n      getMap: this.getMap\n    }\n  }\n\n  editNode = (enModel) => {\n    console.log(\"node in editNode func\", enModel);\n    const props = this.diagram.getDiagramProps();\n    const { controller, model } = props;\n    const json = controller.run(\"serializeTopic\", { ...props, topic: enModel.model.getTopic(enModel.topicKey) });\n    const jsonStr = JSON.stringify(json);\n    let parsedTopic = JSON.parse(jsonStr);\n    // // this.updateWsMap();\n    // debugger;\n    // let parsedTopic = this.getTopicFromMap(this.props.activeWSProject.map, node);\n    // console.log(\"parsedTopic in EDITNODE\", parsedTopic);\n    this.props.togglePropertiesModal(parsedTopic);\n  }\n\n  diagram;\n  diagramRef = ref => {\n    this.diagram = ref;\n    this.setState({});\n  };\n\n  initModel() {\n    const {\n      workspaces,\n      activeWorkspace,\n      activeWSProject\n    } = this.props;\n    const model = generateSimpleModel(activeWSProject, workspaces);\n    this.state = { model };\n  }\n\n  bindUpdatedTitle = (tk, data, tProps) => {\n    console.log(\"inside bindUpdateTitle function::tk::\", tk, \"data::\", data)\n    const props = this.diagram.getDiagramProps();\n    const { model } = props;\n    debugger;\n    // update node title\n    let umodel = ModelModifier.setBlockData({\n      model: model,\n      topicKey: tk,\n      blockType: BlockType.CONTENT,\n      data\n    });\n    // update node properties...TODO: this is not working. CHeck again.\n    // umodel = umodel.updateIn(['topics', tk, 'properties'], properties => tProps);\n    umodel = ModelModifier.setProperties({\n      model: model,\n      topicKey: tk,\n      properties: tProps\n    })\n    this.setState(\n      {\n        model: umodel\n      }\n    );\n  }\n\n  onClickUndo = e => {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    controller.run(\"undo\", props);\n  };\n\n  onClickRedo = e => {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    controller.run(\"redo\", props);\n  };\n\n  renderDiagram() {\n    return (\n      <Diagram\n        ref={this.diagramRef}\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={plugins}\n      />\n    );\n  }\n\n  updateWsMap = () => {\n    let {\n      activeWSProject,\n      activeWorkspace\n    } = this.props;\n    activeWSProject.map = this.getMap();\n    console.log(\"activeWSProject.map\", activeWSProject.map);\n    updateWSProject(activeWorkspace, activeWSProject)\n      .then(res => {\n        console.log(\"res in updateWSProject\");\n      })\n      .catch(e => {\n        console.log(\"e::\", e);\n        if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n          this.props.history.push(\"/\");\n        }\n      });\n  }\n\n  navBack = () => {\n    this.props.navBack();\n  }\n\n  renderToolbar() {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    const canUndo = controller.run(\"canUndo\", props);\n    const canRedo = controller.run(\"canRedo\", props);\n    const toolbarProps = {\n      diagram: this.diagram,\n      onClickUndo: this.onClickUndo,\n      onClickRedo: this.onClickRedo,\n      canUndo,\n      canRedo,\n      updateWsMap: this.updateWsMap,\n      navBack: this.navBack\n    };\n    return <Toolbar {...toolbarProps} />;\n  }\n\n  onChange = (model, callback) => {\n    this.setState(\n      {\n        model\n      },\n      callback\n    );\n  };\n\n  componentDidUpdate() {\n    this.initModel();\n  }\n\n  getMap = () => {\n    const props = this.diagram.getDiagramProps();\n    const {\n      controller\n    } = props;\n    const json = controller.run(\"serializeModel\", props);\n    const jsonStr = JSON.stringify(json);\n    let map = JSON.parse(jsonStr);\n    return map;\n  }\n\n  getTopicFromMap = (map, node) => {\n    for (let i = 0; i < map.topics.length; i++) {\n      let t = map.topics[i];\n      if (t.key == node.topicKey) {\n        return t;\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"mindmap\">\n        {this.diagram && this.renderToolbar()}\n        {this.renderDiagram()}\n      </div>\n    );\n  }\n}\n\nexport default Mindmap;\n","import React, { Component } from \"react\";\n// import Header from \"../../fragments/header\";\n// import Sidebar from \"../common/sidebar\";\n// import Quill from \"quill\";\n// import { setActiveProjectMW, updateProjectMW, addProjectMW } from \"../../../store/actions/projects\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport EditComponent from \"./edit\";\nimport Mindmap from \"../../workspaces/workspace/map/component/mindmap\";\n// import { projectModel } from \"../../../../../../models\";\n// import { defaults } from \"../../../../../../utils/config\";\nimport { setActiveWSProjectMW } from \"../../../store/actions/workspace\";\nimport { getProject, updateWSProject } from \"../../../services/project\";\nimport { updateModel } from \"../../../utils/project\";\n\nimport \"../../workspaces/workspace/map/component/mindmap.scss\";\n\nclass EditProject extends Component {\n\n    state = {\n        togglePropertiesModalSt: false,\n        topic: {}\n    }\n\n    componentDidMount() {\n        // get params\n        const { \n                workspace_id,\n                id\n            } = this.props.match.params;\n        console.log(\"workspace_id\", workspace_id);\n\n        const {\n            activeWSProject\n        } = this.props;\n\n        // if activeWorkspace is null, it means there is a page refresh, because we set activeProject\n        // at the time of navigation from dashborad to workspace view\n        console.log(\"about to get worksapcce data, activeWS\", activeWSProject);\n        if (typeof activeWSProject == \"object\" && Object.keys(activeWSProject).length == 0) {\n            getProject(workspace_id, id).then(res => {\n                console.log(\"calling the middle ware now\", res);\n                if (res && res.list && res.list[0]) {\n                    this.props.setActiveWSProjectMW(res.list[0]);\n                }\n            })\n            .catch(e => {\n                console.log(\"e::\", e);\n                if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                    this.props.history.push(\"/\");\n                }\n            });\n        }\n    }\n\n    navBack = () => {\n        this.props.history.push(`/workspace/${this.props.match.params.workspace_id}/dashboard`);\n    }\n\n    togglePropertiesModal = (topic) => {\n        // get topic data clicked from model\n        console.log(\"topic in edit module::\", topic);\n        this.setState({\n            togglePropertiesModalSt: !this.state.togglePropertiesModalSt,\n            topic: topic\n        })\n    }\n\n    updateProperties = (topic, tProps) => {\n        // console.log(\"inside updateProperties::topic::\", topic, \"tProps::\", tProps, 'map::', this.props.activeWSProject);\n        // let map = this.props.activeWSProject.map;\n        let map = window[\"TThroo\"].getMap();\n        for (let i=0; i < map.topics.length; i++) {\n            let t = map.topics[i];\n            if (t.key == topic.key) {\n                t.properties = updateModel(tProps);\n                break;\n            }\n        }\n        console.log(\"updated map properties, this should have properties updated and should be saved::\", map);\n        let activeWSProject = this.props.activeWSProject;\n        activeWSProject.map = map;\n        this.props.setActiveWSProjectMW(activeWSProject);\n        // call initModel in mindmap.js func\n        window[\"TThroo\"].bindUpdatedTitle(topic.key, tProps.title.quillText, tProps);\n        updateWSProject(this.props.match.params.workspace_id, activeWSProject)\n        .then(res => {\n            console.log(\"res in updateWSProject\");\n        })\n        .catch(e => {\n            console.log(\"e::\", e);\n            if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                this.props.history.push(\"/\");\n            }\n        });\n        this.setState({\n            topic\n        });\n    }\n\n    render() {     \n\n        const {\n            // modalView,\n            togglePropertiesModalSt,\n            topic\n        } = this.state;\n\n        const {\n            activeWSProject\n        } = this.props;\n\n        console.log(\"activeWSProject--##???\", activeWSProject);\n\n        return (\n            <>\n                {\n                    Object.keys(activeWSProject).length != 0 \n                    ? \n                    <Mindmap \n                        workspaces={[]}\n                        activeWorkspace={this.props.match.params.workspace_id}\n                        activeWSProject={this.props.activeWSProject}\n                        projectId={this.props.match.params.id}\n                        navBack={this.navBack}\n                        togglePropertiesModal={this.togglePropertiesModal}\n                    /> :\n                    <div className=\"mindmap\">Loading...</div>\n                }\n\n                { \n                    togglePropertiesModalSt && \n                    <EditComponent\n                        mode=\"track\"\n                        toggleEditModal={this.togglePropertiesModal}\n                        topic={topic}\n                        updateProperties={this.updateProperties}\n                    />\n                }\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    // console.log(\"inside mapStateToPros func in EDIT PAGE\", state);\n    return {\n        activeWSProject: state.wikis.activeWSProject\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        setActiveWSProjectMW\n     }\n)(EditProject));","import React, { Component } from \"react\";\nimport Notification from 'react-web-notification';\n\nclass Notify extends Component {\n    constructor (props) {\n        super(props);\n        this.state = {\n            ignore: true,\n            title: ''\n        };\n    }\n\n    handlePermissionGranted() {\n        console.log('Permission Granted');\n        this.setState({\n            ignore: false\n        });\n    }\n    handlePermissionDenied() {\n        console.log('Permission Denied');\n        this.setState({\n            ignore: true\n        });\n    }\n    handleNotSupported() {\n        console.log('Web Notification not Supported');\n        this.setState({\n            ignore: true\n        });\n    }\n\n    handleNotificationOnClick(e, tag) {\n        console.log(e, 'Notification clicked tag:' + tag);\n    }\n\n    handleNotificationOnError(e, tag) {\n        console.log(e, 'Notification error tag:' + tag);\n    }\n\n    handleNotificationOnClose(e, tag) {\n        console.log(e, 'Notification closed tag:' + tag);\n    }\n\n    handleNotificationOnShow(e, tag) {\n        this.playSound();\n        console.log(e, 'Notification shown tag:' + tag);\n    }\n\n    playSound(filename) {\n        document.getElementById('sound').play();\n    }\n\n    handleButtonClick() {\n        this.notify(\"On Click Reminder\");\n    }\n\n    notify = (notifyTitle) => {\n        if (this.state.ignore) {\n            return;\n        }\n\n        const now = Date.now();\n\n        const title = notifyTitle;\n        const body = 'Hello' + new Date();\n        const tag = now;\n        const icon = 'http://localhost:3000/assets/web/tthroo-logo.png';\n        // const icon = 'http://localhost:3000/Notifications_button_24.png';\n\n        // Available options\n        // See https://developer.mozilla.org/en-US/docs/Web/API/Notification/Notification\n        const options = {\n            tag: tag,\n            body: body,\n            icon: icon,\n            lang: 'en',\n            dir: 'ltr',\n            sound: './sound.mp3'  // no browsers supported https://developer.mozilla.org/en/docs/Web/API/notification/sound#Browser_compatibility\n        }\n        this.setState({\n            title: title,\n            options: options\n        });\n    }\n\n    handleButtonClick2() {\n        this.props.swRegistration.getNotifications({}).then(function (notifications) {\n            console.log(notifications);\n        });\n    }\n\n    ws = null;\n\n    componentDidMount() {\n        // this.timer = setTimeout(() => {\n        //     this.notify(\"Project Reminder - Sometimes Project title can be huge, need to dig in how this one appears now\");\n        // }, 3000);\n        this.ws = new WebSocket(\"ws://localhost:3200\");\n        this.ws.onopen = (event) => {\n            console.log(\"Browser client has established connection with server, sending user_id, project_id to websocket\");\n            let wsInitObj = {\n                user_id: localStorage.getItem(\"user_id\"),\n                project_id: this.props.id\n            }\n            this.ws.send(JSON.stringify(wsInitObj)); \n        };\n        this.ws.onmessage = (event) => {\n            console.log(\"message received from server, this is about an alert, see for task_id and alert notification\", event.data);\n            this.notify(\"Project Reminder - Sometimes Project title can be huge, need to dig in how this one appears now\");\n        }\n    }\n\n    componentWillUnmount() {\n        this.ws.send(\"close\"); \n        this.ws.close();\n    }\n\n    render() {\n        return (\n            <div>\n                <button onClick={this.handleButtonClick.bind(this)}>Notif!</button>\n                {document.title === 'swExample' && <button onClick={this.handleButtonClick2.bind(this)}>swRegistration.getNotifications</button>}\n                <Notification\n                    ignore={this.state.ignore && this.state.title !== ''}\n                    notSupported={this.handleNotSupported.bind(this)}\n                    onPermissionGranted={this.handlePermissionGranted.bind(this)}\n                    onPermissionDenied={this.handlePermissionDenied.bind(this)}\n                    onShow={this.handleNotificationOnShow.bind(this)}\n                    onClick={this.handleNotificationOnClick.bind(this)}\n                    onClose={this.handleNotificationOnClose.bind(this)}\n                    onError={this.handleNotificationOnError.bind(this)}\n                    timeout={5000}\n                    title={this.state.title}\n                    options={this.state.options}\n                    swRegistration={this.props.swRegistration}\n                />\n                <audio id='sound' preload='auto'>\n                    <source src='/reminders-sound/sound.mp3' type='audio/mpeg' />\n                    <source src='/reminders-sound/sound.ogg' type='audio/ogg' />\n                    <embed hidden={true} autostart='false' loop={false} src='./sound.mp3' />\n                </audio>\n            </div>\n        )\n    }\n};\n\nexport default Notify;","import React, { Component } from \"react\";\n// import Header from \"../../fragments/header\";\n// import Sidebar from \"../common/sidebar\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { setActiveProjectMW, updateProjectMW } from \"../../../store/actions/projects\";\nimport Notify from \"./notify\";\nimport { getDuration } from \"../../../services/analyse\";\nimport * as Datetime from 'react-datetime';\n\nimport \"./index.scss\";\n\nclass Reminders extends Component {\n    \n    ws = null;\n\n    componentDidMount() {\n        const {\n            setActiveProjectMW\n        } = this.props;\n        // get params\n        const { id } = this.props.match.params;\n        setActiveProjectMW(id);        \n    }\n\n    formatAMPM = (d) => {\n        let minutes = d.getMinutes().toString().length == 1 ? '0' + d.getMinutes() : d.getMinutes(),\n            hours = d.getHours().toString().length == 1 ? '0' + d.getHours() : d.getHours(),\n            ampm = d.getHours() >= 12 ? 'pm' : 'am',\n            months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n            days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n        return days[d.getDay()] + ' ' + months[d.getMonth()] + ' ' + d.getDate() + ' ' + d.getFullYear() + ' ' + hours + ':' + minutes + ampm;\n    }\n\n    calcDuration(activeProject) {\n        this.setState({ duration: getDuration(activeProject.startTime, activeProject.endTime).val });\n    }\n\n    render() {\n        const {\n            isSidebarOpen,\n            projects,\n            activeProjectId,\n            updateProjectMW\n        } = this.props;\n        let tasks = projects[activeProjectId].tasks;\n        let taskKeys = Object.keys(projects[activeProjectId].tasks);\n        return (\n            <>\n                {/* <Header />\n                <Sidebar />                 */}\n                <div className={isSidebarOpen ? \"dv\" : \"dv toggle\"}>\n                    <div className=\"reminders\">\n                        <table>\n                            <tr>\n                                <th>Task</th>\n                                <th>Start Time</th>\n                                <th>End Time</th>\n                                <th>Duration</th>\n                                <th>Remind me at</th>\n                            </tr>\n                            {\n                                taskKeys.map((key) => <tr>\n                                        <td className=\"title-col-width\">{tasks[key].title.quillText}</td>\n                                        <td>\n                                            {/* {this.formatAMPM(tasks[key].startTime)} */}\n                                            <Datetime\n                                                viewMode=\"time\"\n                                                timeFormat={true}\n                                                value={tasks[key].startTime}\n                                                inputProps={{ placeholder: \"Enter start time\", readOnly: true}}\n                                                onChange={(value) => {\n                                                    updateProjectMW({ id: this.props.match.params.id, tid: tasks[key].id, key: \"startTime\", val: value.toDate() });\n                                                }}\n                                            />\n                                        </td>\n                                        <td>\n                                            {/* {this.formatAMPM(tasks[key].endTime)} */}\n                                            <Datetime\n                                                viewMode=\"time\"\n                                                timeFormat={true}\n                                                value={tasks[key].endTime}\n                                                inputProps={{ placeholder: \"Enter end time\", readOnly: true}}\n                                                onChange={(value) => {\n                                                    updateProjectMW({ id: this.props.match.params.id, tid: tasks[key].id, key: \"endTime\", val: value.toDate() });\n                                                }}\n                                            />\n                                        </td>\n                                        <td>{getDuration(tasks[key].startTime, tasks[key].endTime).val}</td>\n                                        <td>\n                                            {/* {this.formatAMPM(tasks[key].endTime)} */}\n                                            <Datetime\n                                                viewMode=\"time\"\n                                                timeFormat={true}\n                                                value={tasks[key].endTime}\n                                                inputProps={{ placeholder: \"Enter start time\", readOnly: true, disabled: true}}\n                                                // onChange={(value) => {\n                                                //     this.props.updateProjectMW({ id: this.props.id, tid, key: \"startTime\", val: value.toDate() });\n                                                //     this.calcDuration({ ...activeProject, startTime: value.toDate() });\n                                                // }}\n                                            />\n                                        </td>\n                                    </tr>\n                                )\n                            }\n                        </table>\n                        <Notify\n                            id={this.props.match.params.id}\n                        // title={}\n                        // body={}\n                        // startTime={}\n                        // endTime={}\n                        />\n                    </div>\n                </div>\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        projects: state.projects.list,\n        activeProjectId: state.projects.activeProjectId,\n        tasksCount: state.projects.list[state.projects.activeProjectId].tasksCount\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        setActiveProjectMW,\n        updateProjectMW\n    }\n)(Reminders));","import React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { getProject } from \"../../../services/project\";\nimport { setActiveWSProjectMW } from \"../../../store/actions/workspace\";\n\nimport \"./index.scss\";\n\nclass Assess extends Component {\n\n    componentDidMount() {\n        // get params\n        const {\n            workspace_id,\n            id\n        } = this.props.match.params;\n        console.log(\"workspace_id\", workspace_id);\n\n        const {\n            activeWSProject\n        } = this.props;\n\n        // if activeWorkspace is null, it means there is a page refresh, because we set activeProject\n        // at the time of navigation from dashborad to workspace view\n        console.log(\"about to get worksapcce data, activeWS\", activeWSProject);\n        if (typeof activeWSProject == \"object\" && Object.keys(activeWSProject).length == 0) {\n            getProject(workspace_id, id).then(res => {\n                console.log(\"calling the middle ware now\", res);\n                if (res && res.list && res.list[0]) {\n                    this.props.setActiveWSProjectMW(res.list[0]);\n                }\n            })\n                .catch(e => {\n                    console.log(\"e::\", e);\n                    if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                        this.props.history.push(\"/\");\n                    }\n                });\n        }\n    }\n\n    render() {\n\n        const {\n            activeWSProject\n        } = this.props;\n\n        const {\n            title,\n            map\n        } = activeWSProject;\n\n        let topics;\n\n        if (map != null && map.topics) {\n            topics = map.topics;\n        }\n\n        console.log(\"topics:\", topics);\n\n        return (\n            <div className=\"dv assess\">\n                {\n                    Object.keys(activeWSProject).length != 0 ?\n                        <div className=\"assess-container\">\n                            <h1>\n                                {title && title.quillText}\n                            </h1>\n                            <div className=\"assess-topics-container\">\n                                <table>\n                                    <tr>\n                                        <th>Title</th>\n                                        <th>Status</th>\n                                        <th>Start Time</th>\n                                        <th>End Time</th>\n                                        <th>Duration</th>\n                                        <th>Reward</th>\n                                    </tr>\n\n                                    {\n                                        topics && topics.map(t =>\n                                            <tr>\n                                                <td>\n                                                    {t.blocks[0].data}\n                                                </td>\n                                                <td>\n                                                    -\n                                                </td>\n                                                <td>\n                                                    -\n                                                </td>\n                                                <td>\n                                                    -\n                                                </td>\n                                                <td>\n                                                    {/* {getDuration(t.properties.endTime)} */}duration\n                                                </td>\n                                                <td>\n                                                    -\n                                                </td>\n                                            </tr>)\n                                    }\n                                </table>\n                            </div>\n                        </div> :\n                        <div>\n                            Loading...\n                    </div>\n                }\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        activeWSProject: state.wikis.activeWSProject\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        setActiveWSProjectMW\n    }\n)(Assess));","import React, { Component } from 'react';\nimport { gantt } from 'dhtmlx-gantt';\nimport 'dhtmlx-gantt/codebase/dhtmlxgantt.css';\n\nexport default class Gantt extends Component {\n\n  constructor (props) {\n    super(props);\n    this.initZoom();\n  }\n\n  // instance of gantt.dataProcessor\n  dataProcessor = null;\n\n  initZoom() {\n    gantt.ext.zoom.init({\n      levels: [\n        {\n          name: 'Hours',\n          scale_height: 60,\n          min_column_width: 30,\n          scales: [\n            { unit: 'day', step: 1, format: '%d %M' },\n            { unit: 'hour', step: 1, format: '%H' }\n          ]\n        },\n        {\n          name: 'Days',\n          scale_height: 60,\n          min_column_width: 70,\n          scales: [\n            { unit: 'week', step: 1, format: 'Week #%W' },\n            { unit: 'day', step: 1, format: '%d %M' }\n          ]\n        },\n        {\n          name: 'Months',\n          scale_height: 60,\n          min_column_width: 70,\n          scales: [\n            { unit: \"month\", step: 1, format: '%F' },\n            { unit: 'week', step: 1, format: '#%W' }\n          ]\n        },\n        {\n          name: 'Quarter',\n          height: 50,\n          min_column_width: 90,\n          scales: [\n            { unit: \"month\", step: 1, format: \"%M\" },\n            {\n              unit: \"quarter\", step: 1, format: function (date) {\n                var dateToStr = gantt.date.date_to_str(\"%M\");\n                var endDate = gantt.date.add(gantt.date.add(date, 3, \"month\"), -1, \"day\");\n                return dateToStr(date) + \" - \" + dateToStr(endDate);\n              }\n            }]\n        },\n        {\n          name: 'Year',\n          scale_height: 50,\n          min_column_width: 30,\n          scales:[\n            {unit: \"year\", step: 1, format: \"%Y\"}\n          ]\n        }\n      ]\n    });\n  }\n\n  setZoom(value) {\n    gantt.ext.zoom.setLevel(value);\n  }\n\n  specifyColumns = () => {\n\n    var textEditor = { type: \"text\", map_to: \"text\" };\n    var dateEditor = { type: \"date\", map_to: \"start_date\", min: new Date(2018, 0, 1) };\n    var durationEditor = { type: \"number\", map_to: \"duration\", min: 0, max: 100 };\n\n    gantt.config.columns = [\n      // { name: \"text\", tree: true, width: '*', resize: true, editor: textEditor },\n      // { name: \"start_date\", align: \"center\", resize: true, editor: dateEditor },\n      // { name: \"duration\", label: \"Duration (in Hours)\", align: \"center\", editor: durationEditor },\n      // { name: \"add\", width: 44 }\n      {name:\"text\",       label:\"Task name\",  tree:true, width:\"*\", editor: textEditor },\n      {name:\"start_date\", label:\"Start Date\", width: 120, align:\"center\", editor: dateEditor  },\n      // {name:\"end_date\",   label:\"End date\",   width: 120, align:\"center\", editor: dateEditor  },\n      { name: \"duration\", label: \"Duration\", align: \"center\", editor: durationEditor },\n      // {name:\"progress\",   label:\"Progress\",   align:\"center\" },\n      { name: \"add\", width: 44 }\n    ];\n\n    // specify minimum task duration\n    gantt.config.min_duration = 60*60*1000;\n  }\n\n  setupQuickInfo = () => {\n    gantt.config.quickinfo_buttons=[\"icon_delete\",\"icon_edit\", \"view_mindmap\"];\n    gantt.locale.labels[\"view_mindmap\"] = \"View Mindmap\";\n\n    // register click event on advacned info\n    gantt.$click.buttons.view_mindmap=function(id){\n      alert(\"These are view_mindmap details\");\n      return false; //blocks the default behavior\n    };\n  }\n\n  initGanttDataProcessor() {\n    /**\n     * type: \"task\"|\"link\"\n     * action: \"create\"|\"update\"|\"delete\"\n     * item: data object object\n     */\n    const onDataUpdated = this.props.onDataUpdated;\n    this.dataProcessor = gantt.createDataProcessor((type, action, item, id) => {\n      return new Promise((resolve, reject) => {\n        if (onDataUpdated) {\n          onDataUpdated(type, action, item, id);\n        }\n\n        // if onDataUpdated changes returns a permanent id of the created item, you can return it from here so dhtmlxGantt could apply it\n        // resolve({id: databaseId});\n        return resolve();\n      });\n    });\n  }\n\n  shouldComponentUpdate(nextProps) {\n    return this.props.zoom !== nextProps.zoom;\n  }\n\n  componentDidMount() {\n    gantt.config.xml_date = \"%Y-%m-%d %H:%i\";\n    const { tasks } = this.props;\n    console.log(\"gantt:\", gantt);\n    gantt.plugins({ \n      // tooltip: true ,\n      tooltip: true,\n      quick_info: true\n    }); \n    this.specifyColumns();\n    this.setupQuickInfo();\n    gantt.init(this.ganttContainer);\n    gantt.templates.tooltip_text = function(start,end,task){\n      return \"<b>Task:</b> \"+task.text+\"<br/><b>Start date:</b> \" + \n      gantt.templates.tooltip_date_format(start)+ \n      \"<br/><b>End date:</b> \"+gantt.templates.tooltip_date_format(end);\n    };\n    gantt.config.lightbox.sections=[\n      {name:\"description\", height:70, map_to:\"text\", type:\"textarea\",focus:true},\n      {name:\"period\",      height:72, map_to:\"auto\", type:\"time\", time_format:[\"%H:%i\",\"%d\",\"%m\",\"%Y\"]}, \n    ];\n    gantt.locale.labels.section_period = \"Time period\";\n    // duration unit\n    // gantt.config.duration_unit = \"hour\";\n    this.initGanttDataProcessor();\n    gantt.parse(tasks);\n  }\n\n  componentWillUnmount() {\n    if (this.dataProcessor) {\n      this.dataProcessor.destructor();\n      this.dataProcessor = null;\n    }\n  }\n\n  render() {\n    const { zoom } = this.props;\n    this.setZoom(zoom);\n    return (\n      <div\n        ref={(input) => { this.ganttContainer = input }}\n        style={{ width: '100%', height: '100%' }}\n      ></div>\n    );\n  }\n}\n","import Gantt from './Gantt';\nimport './Gantt.css';\nexport default Gantt;","import React, { Component } from 'react';\nexport default class Toolbar extends Component {\n  handleZoomChange = (e) => {\n    if (this.props.onZoomChange) {\n      this.props.onZoomChange(e.target.value)\n    }\n  }\n  render() {\n    const zoomRadios = ['Hours', 'Days', 'Months', 'Quarter', 'Year'].map((value) => {\n      const isActive = this.props.zoom === value;\n      return (\n        <label key={ value } className={ `radio-label ${isActive ? 'radio-label-active': ''}` }>\n          <input type='radio'\n            checked={ isActive }\n            onChange={ this.handleZoomChange }\n            value={ value }/>\n          { value }\n        </label>\n      );\n    });\n\n    return (\n      <div className=\"tool-bar\">\n        <b>Zoom: </b>\n          { zoomRadios }\n      </div>\n    );\n  }\n}\n","import Toolbar from './Toolbar';\nimport './Toolbar.css';\nexport default Toolbar;","import React, { Component } from 'react';\n\nclass MessageArea extends Component {\n  render() {\n    const messages = this.props.messages.map(({ message }) => {\n      return <li key={ Math.random() }>{message}</li>\n    });\n\n    return (\n      <div className=\"message-area\">\n        <h3>Messages:</h3>\n        <ul>\n          {messages}\n        </ul>\n      </div>\n    );\n  }\n}\n\nMessageArea.defaultProps = {\n  messages: []\n};\n\nexport default MessageArea;\n","import React, { Component } from 'react';\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { gantt } from 'dhtmlx-gantt';\n\nimport Gantt from './components/Gantt';\nimport Toolbar from './components/Toolbar';\nimport MessageArea from './components/MessageArea';\nimport { getProject, updateProject } from \"../../services/project\";\nimport { setActiveWSProjectMW } from \"../../store/actions/workspace\";\n\nimport './index.scss';\n\nconst data = {\n  data: [\n    // { id: 1, text: 'Task #1', start_date: '2020-02-12', duration: 3, progress: 0.6 },\n    // { id: 2, text: 'Task #2', start_date: '2020-02-16', duration: 3, progress: 0.4 }\n    {\n      \"!nativeeditor_status\": \"inserted\",\n      duration: 1,\n      end_date: \"2020-08-15 00:00\",\n      id: 1597290817777,\n      parent: 0,\n      progress: 0,\n      start_date: \"2020-08-14 00:00\",\n      text: \"New task\"\n    }\n  ],\n  links: [\n    // { id: 1, source: 1, target: 2, type: '0' }\n  ]\n};\nclass Roadmap extends Component {\n  state = {\n    currentZoom: 'Days',\n    messages: [],\n    roadmap: {\n      data: [\n      //   {\n      //   // \"!nativeeditor_status\": \"inserted\",\n      //   duration: 1,\n      //   end_date: \"2020-08-15 00:00\",\n      //   id: 1597290817777,\n      //   parent: 0,\n      //   progress: 0,\n      //   start_date: \"2020-08-14 00:00\",\n      //   text: \"New task\"\n      // }\n    ],\n      links: []\n    }\n  };\n\n  // addMessage(message) {\n  //   const maxLogLength = 5;\n  //   const newMessate = { message };\n  //   const messages = [\n  //     newMessate,\n  //     ...this.state.messages\n  //   ];\n\n  //   if (messages.length > maxLogLength) {\n  //     messages.length = maxLogLength;\n  //   }\n  //   this.setState({ messages });\n  // }\n\n  updateRoadmap = (type, action, item, id) => {\n    const {\n      roadmap\n    } = this.state;\n    if (type == \"task\") {\n      if (action == \"create\") {\n        let data = {\n          ...item\n        }\n        roadmap.data.push(data);\n      } else if (action == \"update\") {\n        for (let i = 0; i < roadmap.data.length; i++) {\n          debugger;\n          if (id == roadmap.data[i].id) {\n            roadmap.data[i] = item;\n            break;\n          }\n        }\n      }\n    } else if (type == \"link\") {\n      // todo\n    }\n    this.setState({\n      roadmap\n    }, () => {\n      const { workspace_id, id } = this.props.match.params;\n      updateProject({roadmap}, workspace_id, id);\n    });\n  }\n\n  logDataUpdate = (type, action, item, id) => {\n    console.log(\"type:\", type, \"action:\", action, \"item:\", item, \"id:\", id);\n    // let text = item && item.text ? ` (${item.text})` : '';\n    // let message = `${type} ${action}: ${id} ${text}`;\n    // if (type === 'link' && action !== 'delete') {\n    //   message += ` ( source: ${item.source}, target: ${item.target} )`;\n    // }\n    // this.addMessage(message);\n    delete action[\"!nativeeditor_status\"];\n    this.updateRoadmap(type, action, item, id);\n  }\n\n  handleZoomChange = (zoom) => {\n    this.setState({\n      currentZoom: zoom\n    });\n  }\n\n  handleRoadmapGanttParse = (roadmap) => {\n    if (roadmap && Object.keys(roadmap).includes(\"data\")) {\n      this.setState({\n        roadmap\n      });\n      gantt.parse(roadmap);\n    }\n  }\n\n  componentDidMount() {\n    // get params\n    const { \n            workspace_id,\n            id\n        } = this.props.match.params;\n    console.log(\"workspace_id\", workspace_id);\n\n    const {\n        activeWSProject\n    } = this.props;\n\n    // if activeWorkspace is null, it means there is a page refresh, because we set activeProject\n    // at the time of navigation from dashborad to workspace view\n    console.log(\"about to get worksapcce data, activeWS\", activeWSProject);\n    if (typeof activeWSProject == \"object\" && Object.keys(activeWSProject).length == 0) {\n        getProject(workspace_id, id).then(res => {\n            console.log(\"calling the middle ware now\", res);\n            if (res && res.list && res.list[0]) {\n                this.props.setActiveWSProjectMW(res.list[0]);\n                this.handleRoadmapGanttParse(res.list[0].roadmap);\n            }\n        })\n        .catch(e => {\n            console.log(\"e::\", e);\n            if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                this.props.history.push(\"/\");\n            }\n        });\n    } else {\n      this.handleRoadmapGanttParse(activeWSProject.roadmap);\n    }\n}\n\n  render() {\n    const { currentZoom, messages, roadmap } = this.state;\n    console.log(\"roadmap set?:\", roadmap);\n    return (\n      <div className=\"tthroo-roadmap\">\n        <div className=\"zoom-bar\">\n          <Toolbar\n            zoom={currentZoom}\n            onZoomChange={this.handleZoomChange}\n          />\n        </div>\n        <div className=\"gantt-container\">\n          <Gantt\n            tasks={roadmap}\n            zoom={currentZoom}\n            onDataUpdated={this.logDataUpdate}\n          />\n        </div>\n        {/* <MessageArea\n          messages={messages}\n        /> */}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  // console.log(\"inside mapStateToPros func in EDIT PAGE\", state);\n  return {\n    activeWSProject: state.wikis.activeWSProject\n  }\n}\n\nexport default withRouter(connect(\n  mapStateToProps,\n  {\n      setActiveWSProjectMW\n   }\n)(Roadmap));\n\n","import React, { Component } from \"react\";\nimport Header from \"./common/header/index\";\nimport Sidebar from \"./common/sidebar\";\nimport { setActiveProjectMW } from \"../../store/actions/projects\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport EditProject from \"./edit\";\nimport Reminders from \"./reminders/index\";\nimport Assess from \"./assess/index\";\nimport Roadmap from \"../roadmap/index\";\n\nimport \"./index.scss\";\n\nclass Project extends Component {\n\n    componentDidMount() {\n        // get params\n        const { id } = this.props.match.params;\n        setActiveProjectMW(id);\n    }\n\n\n    render() {\n        const {\n            phase\n        } = this.props.match.params;\n\n        const {\n            activeWSProject\n        } = this.props;\n\n        let View = null;\n        if (phase == \"edit\")\n            View = <EditProject />;\n        else if (phase == \"assess\")\n            View = <Assess />;\n        else if (phase == \"reminders\")\n            View = <Reminders />;\n        else if (phase == \"roadmap\")\n            View = <Roadmap />\n        return (\n            <>\n                <Header \n                    title={activeWSProject && activeWSProject.title ? activeWSProject.title : null}\n                />\n                <div className=\"project-sb-w\">\n                    <Sidebar />\n                </div>\n                {View ? View : <div>Page you are looking for is not found.</div>}\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    // console.log(\"inside mapStateToPros func in EDIT PAGE\", state);\n    return {\n        meta: state.projects,\n        activeProjectId: state.projects.activeProjectId,\n        activeWSProject: state.wikis.activeWSProject\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        setActiveProjectMW\n    }\n)(Project));","import React, { useState } from 'react';\nimport { login, register } from \"../../services/user\";\nimport Cookies from 'universal-cookie';\nimport { useHistory } from \"react-router-dom\";\n\nconst Login = () => {\n\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [cpassword, setCpassword] = useState(\"\");\n    const [pwdMismatch, setPwdMismatch] = useState(false);\n    const [isLogin, setIsLogin] = useState(true);\n    const cookies = new Cookies();\n    let history = useHistory();\n    \n    const handleInput = (e) => {\n        if (e.target.name === \"email\") {\n            setEmail(e.target.value);\n        } else if (e.target.name === \"password\") {\n            setPassword(e.target.value);\n        } else {\n            setCpassword(e.target.value);\n        }\n    }\n\n    const handleView = (mode) => {\n        if (mode === \"register\") {\n            setIsLogin(false);\n        } else {\n            setIsLogin(true);\n        }\n    }\n\n    const handleSubmit = (e, type) => {\n        e.preventDefault();\n\n        let payload = {\n            email,\n            password\n        }\n        \n        if (type === \"register\") {\n            if (password !== cpassword) {\n                setPwdMismatch(true);\n                // console.log(\"pwd mismatch\");\n            } else {\n                payload.offsetForTz = new Date().getTimezoneOffset();\n                // make register fetch request\n                register(payload).then(res => {\n                    // console.log(\"successfully registered\", res);\n                    cookies.set(\"token\", res.token);\n                    storeCredsLocally(res);\n                })\n                .catch(e => {\n                    console.log(\"e::\", e);\n                    if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                        this.props.history.push(\"/\");\n                    }\n                });\n            }\n        } else {\n            // make login fetch request\n            login(payload).then(res => {\n                // console.log(\"successfully logged in\", res);\n                storeCredsLocally(res);\n                history.push(\"/workspaces\");\n            })\n            .catch(e => {\n                console.log(\"e::\", e);\n                if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                    this.props.history.push(\"/\");\n                }\n            });\n        }\n    }\n\n    const storeCredsLocally = (res) => {\n        debugger;\n        localStorage.setItem(\"token\", res.token);\n        localStorage.setItem(\"user_id\", res.user_id);\n        localStorage.setItem(\"offsetForTz\", res.offsetForTz);\n    }\n\n    return (<div>\n        {isLogin ?\n            <form onSubmit={($event) => handleSubmit($event, \"login\")}>\n                <span>Login:</span>\n                <div>\n                    <label>\n                        Email:\n            </label>\n                    <input type=\"email\"\n                        name=\"email\"\n                        value={email}\n                        onChange={handleInput}\n                        required\n                    />\n                </div>\n                <div>\n                    <label>\n                        Password:\n            </label>\n                    <input type=\"password\"\n                        name=\"password\"\n                        value={password}\n                        onChange={handleInput}\n                        required\n                    />\n                </div>\n                <div>\n                    <input type=\"submit\" value=\"Submit\" />\n                </div>\n                <span onClick={() => handleView(\"register\")}>New to tthroo? register</span>\n            </form> :\n            <form onSubmit={($event) => handleSubmit($event, \"register\")}>\n                <span>Register:</span>\n                <div>\n                    <label>\n                        Email:\n                </label>\n                    <input type=\"email\"\n                        name=\"email\"\n                        value={email}\n                        onChange={handleInput}\n                        required\n                    />\n                </div>\n                <div>\n                    <label>\n                        Password:\n                </label>\n                    <input type=\"password\"\n                        name=\"password\"\n                        value={password}\n                        onChange={handleInput}\n                        required\n                    />\n                </div>\n                <div>\n                    <label>\n                        Confirm Password:\n                    </label>\n                    <input type=\"password\"\n                        name=\"cpassword\"\n                        value={cpassword}\n                        onChange={handleInput}\n                        required\n                    />\n                </div>\n                <input type=\"submit\" value=\"Submit\" />\n                {pwdMismatch ? <div>Passwords won't match, Please check again.</div> : null}\n                <span onClick={() => handleView(\"login\")}>Existing User? Login.</span>\n            </form>\n        }\n    </div>)\n}\n\nexport default Login;","import { urls } from \"../utils/config\";\n\nexport const login = (payload) => {\n    return new Promise((resolve, reject) => {\n        fetch(urls.user.login, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(payload),\n        })\n            .then((response) => {\n                if (response.ok) {\n                    return response.json();\n                } else {\n                    throw {\n                        msg: response.statusText,\n                        status: response.status\n                    }\n                }\n            })\n            .then((data) => {\n                console.log('Success login:', data);\n                resolve(data);\n            })\n            .catch((error) => {\n                console.error('Error:', error);\n                reject(error);\n            });\n    });\n}\n\nexport const register = (payload) => {\n    return new Promise((resolve, reject) => {\n        fetch(urls.user.register, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(payload),\n        })\n        .then((response) => {\n            if (response.ok) {\n                return response.json();\n            } else {\n                throw {\n                    msg: response.statusText,\n                    status: response.status\n                }\n            }\n        })\n        .then((data) => {\n            // TODO: HANDLE .ok CHECK AND THRW ERROR - BEST PRACTISE\n            console.log('Success register:', data);\n            resolve(data);\n        })\n        .catch((error) => {\n            console.error('Error:', error);\n            reject(error);\n        });\n    });\n}","import React, { Component } from \"react\";\nimport { addWorkspaceMW, setWorkspacesMw, setActiveWSProjectMW, deleteWorkspaceMw } from \"../../../store/actions/workspace\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { getWorkspaces, deleteWorkspaceService } from \"../../../services/workspace\";\n\nimport \"./index.scss\";\n\nclass WorkspacesDashboard extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            workspace: \"\"\n        }\n    }\n\n    handleChange = (e) => {\n        // update state\n        this.setState({\n            workspace: e.target.value\n        });\n    }\n\n    addToWorkspaces = () => {\n        const {\n            workspace\n        } = this.state;\n\n        const {\n            workspaces\n        } = this.props;\n\n        let index = workspaces.length;\n\n        this.props.addWorkspaceMW(workspace, index);\n        this.setState({\n            workspace: \"\"\n        });\n    }\n\n    handleWsClick = (ws) => {\n        console.log(\"ws::\", ws);\n        this.props.setActiveWSProjectMW(ws);\n        this.props.history.push(\"/workspace/\"+ws._id+\"/dashboard\")\n    }\n\n    deleteWorkspace = (e, ws) => {\n        e.stopPropagation();\n        deleteWorkspaceService(ws._id).then(res => {\n            this.props.deleteWorkspaceMw(ws);\n        })\n        .catch(e => {\n            console.log(\"e::\", e);\n            if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                this.props.history.push(\"/\");\n            }\n        });\n    }\n\n    componentDidMount() {\n        // get list of workspaces\n        getWorkspaces().then(res => {\n            console.log(\"res from getWorkspaces\", res);\n            this.props.setWorkspacesMw(res.list);\n        })\n        .catch(e => {\n            console.log(\"e::\", e);\n            if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                this.props.history.push(\"/\");\n            }\n        });\n    }\n\n    render() {\n\n        const {\n            workspace\n        } = this.state;\n\n        const {\n            workspaces \n        } = this.props;\n\n        return (\n            <>\n            <div>\n                <span>Workspaces:</span>\n                <span>\n                    <input type=\"text\" value={workspace} onChange={this.handleChange} /> \n                    <button onClick={this.addToWorkspaces}>Add</button>\n                </span>\n            </div>\n            <ul className=\"ws-ls\">\n                {\n                    workspaces.map(ws => <li className=\"ws-list\" onClick={() => this.handleWsClick(ws)}>\n                        <span>{ws.name}</span>\n                        <button className=\"del-ws\" onClick={($e) => this.deleteWorkspace($e, ws)}>Delete</button>    \n                    </li>)\n                }\n            </ul>\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    // console.log(\"inside mapStateToPros func in EDIT PAGE\", state);\n    return {\n        activeWorkspace: state.wikis.activeWorkspace,\n        workspaces: state.wikis.workspaces\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        addWorkspaceMW,\n        setWorkspacesMw,\n        setActiveWSProjectMW,\n        deleteWorkspaceMw\n    }\n)(WorkspacesDashboard));","import React, { Component } from \"react\";\nimport Mindmap from \"./map/component/mindmap\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { getProject } from \"../../../services/project\";\nimport { setActiveWSProjectMW } from \"../../../store/actions/workspace\";\n\nclass Workspace extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    componentDidMount() {\n        // get params\n        const { workspace_id } = this.props.match.params;\n        console.log(\"workspace_id\", workspace_id);\n\n        const {\n            workspaces,\n            activeWorkspace,\n            activeWSProject\n        } = this.props;\n\n        // if activeWorkspace is null, it means there is a page refresh, because we set activeProject\n        // at the time of navigation from dashborad to workspace view\n        console.log(\"about to get worksapcce data, activeWS\", activeWSProject);\n        if (typeof activeWSProject == \"object\" && Object.keys(activeWSProject).length == 0) {\n            getProject(workspace_id).then(res => {\n                console.log(\"calling the middle ware now\", res);\n                if (res && res.list && res.list[0]) {\n                    this.props.setActiveWSProjectMW(res.list[0]);\n                }\n            })\n            .catch(e => {\n                console.log(\"e::\", e);\n                if (e.status == 401 && e.msg.toLowerCase() == \"unauthorized\") {\n                    this.props.history.push(\"/\");\n                }\n            });\n        }\n    }\n\n    navBack = () => {\n        this.props.history.push(\"/workspaces\");\n    }\n\n    render() {\n        const {\n            workspaces,\n            activeWorkspace,\n            activeWSProject\n        } = this.props;\n        \n        return (\n            <div>\n                {\n                    Object.keys(activeWSProject).length != 0 ?\n                        <Mindmap \n                            workspaces={workspaces}\n                            activeWorkspace={activeWorkspace}\n                            navBack={this.navBack}\n                        /> : \n                        <div>\n                            Loading...\n                        </div>\n                }\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    // console.log(\"inside mapStateToPros func in EDIT PAGE\", state);\n    return {\n        activeWorkspace: state.wikis.activeWSProject,\n        workspaces: state.wikis.workspaces\n    }\n}\n\nexport default withRouter(connect(\n    mapStateToProps,\n    {\n        setActiveWSProjectMW\n    }\n)(Workspace));","import React from 'react';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route\n} from \"react-router-dom\";\nimport Dashboard from \"./views/dashboard\";\nimport Project from \"./views/project/index\";\nimport Login from \"./views/login/index\";\nimport WorkspacesDashboard from \"./views/workspaces/dashboard/index\";\nimport Workspace from \"./views/workspaces/workspace/index\";\n// import EditProject from \"./views/project/edit\";\n// import AppDemo from \"./views/project/map/index\";\n// import Track from \"./views/project/track/index\";\n// import Analyse from \"./views/project/analyse/index\";\n// import Reminders from \"./views/project/reminders/index\";\n\nimport './App.scss';\n\nfunction App() {\n  return (\n    <Router>\n      {/* <div className=\"tthroo-app\"> */}\n        <Switch>\n          <Route exact path=\"/\">\n            <Login />\n          </Route>\n          {/* <Route path=\"/calendar\">\n            <TthrooCalendarContainer />\n          </Route>\n          <Route path=\"/notes\">\n            <NotesView />\n          </Route> */}\n          <Route path=\"/workspace/:workspace_id/dashboard\">\n            <Dashboard />\n          </Route>\n          <Route path=\"/workspace/:workspace_id/project/:id/:phase\">\n            <Project />\n          </Route>\n          <Route path=\"/workspaces\">\n            <WorkspacesDashboard />\n          </Route>\n          <Route path=\"/workspace/:workspace_id\">\n            <Workspace />\n          </Route>\n          {/* <Route path=\"/map\">\n            <AppDemo />\n          </Route> */}\n          {/* <Route path=\"/project/:id/edit\">\n            <EditProject />\n          </Route>\n          <Route path=\"/project/:id/track\">\n            <Track />\n          </Route>\n          <Route path=\"/project/:id/map\">\n            <Map />\n          </Route>\n          <Route path=\"/project/:id/analyse\">\n            <Analyse />\n          </Route>\n          <Route path=\"/project/:id/reminders\">\n            <Reminders />\n          </Route> */}\n        </Switch>\n        {/* {\n          filter.value === \"calendar\" ?\n          <TthrooCalendarContainer /> :\n          <NotesView />\n        } */}\n      {/* </div> */}\n    </Router>\n  )\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","const tasks = (state = [], action) => {\n  switch (action.type) {\n    case 'ADD_TASK':\n      return [\n        ...state,\n        {\n          id: action.id,\n          text: action.text,\n          completed: false\n        }\n      ]\n    default:\n      return state\n  }\n}\n\nexport default tasks","const events = (state = [], action) => {\n    switch (action.type) {\n        case 'UPDATE_EVENTS':\n            // console.log(\"action:\", action);\n            return [\n                ...state,\n                ...action.events\n            ]\n        case 'ADD_EVENT':\n            // console.log(\"inside ADD_EVENT state:\", state);\n            return [\n                ...state,\n                ...[action.event]\n            ]\n        default:\n            return state\n    }\n}\n\nexport default events","const filter = (state = {value: \"calendar\"}, action) => {\n    switch (action.type) {\n        case 'APPLY_FILTER':\n            return {\n                ...state,\n                value: action.filter\n            }\n        default:\n            return state\n    }\n}\n\nexport default filter;","let initState = {\n    nto: [],\n    dtCount: 0,\n    date: new Date()\n}\n\nconst notes = (state = initState, action) => {\n    switch (action.type) {\n        case 'GET_NAV_OPT':\n            return {\n                ...state,\n                nto: [...action.tlOptions]\n            }\n        case 'UPDATE_DT_COUNT':\n            return {\n                ...state,\n                dtCount: action.value === 0 ? action.value : state.dtCount + action.value\n            }\n        case 'UPDATE_DT':\n            return {\n                ...state,\n                date: action.date\n            }\n        default:\n            return state\n    }\n}\n\nexport default notes","export const defaultState = {\n    label: {\n        active: \"Work\",\n        data: [{\n            label: \"Work\"\n        }, {\n            label: \"TThroo\"\n        }]\n    },\n    status: {\n        active: \"Todo\",\n        data: [{\n            label: \"Todo\"\n        }, {\n            label: \"Doing\"\n        }, {\n            label: \"Done\"\n        }]\n    },\n    date: {\n        activeDate: new Date()\n    }\n}\n\nconst sideBar = (state = defaultState, action) => {\n    switch (action.type) {\n        case 'SET_DATE':\n            return {\n                ...state,\n                date: {...state.date, activeDate: action.activeDate}\n            }\n        case 'SET_STATUS':\n            return {\n                ...state,\n                status: {...state.status, active: action.activeStatus}\n            }\n        case 'SET_LABEL':\n            return {\n                ...state,\n                label: {...state.label, active: action.activeLabel}\n            }\n        case 'ADD_LABEL':\n            return {\n                ...state,\n                label: {...state.label, data: [...state.label.data, {label: action.label}]}\n            }\n        case 'DELETE_LABEL':\n\n            let nextActiveLbl;\n                \n            nextActiveLbl = action.index > 0 ? state.label.data[action.index-1] : state.label.data[action.index+1];\n\n            // console.log(\"nextActive for LABEL\", nextActiveLbl);\n\n                return {\n                    ...state,\n                    label: {\n                        ...state.label, \n                        data: state.label.data.filter((item, i) => i !== action.index),\n                        active: nextActiveLbl && nextActiveLbl.label ? nextActiveLbl.label : null \n                    }   \n                }\n        case 'ADD_STATUS':\n            return {\n                ...state,\n                status: {...state.status, data: [...state.status.data, {label: action.label}]}\n            }\n        case 'DELETE_STATUS':\n\n                let nextActive;\n                \n                nextActive = action.index > 0 ? state.status.data[action.index-1] : state.status.data[action.index+1];\n\n                // console.log(\"nextActive for status\", nextActive);\n\n                return {\n                    ...state,\n                    status: {\n                        ...state.status, \n                        data: state.status.data.filter((item, i) => i !== action.index),\n                        // active: nextActive && nextActive.label ? nextActive.label : null \n                    },\n                }\n        default:\n            return state\n    }\n}\n\nexport default sideBar;","import lodash from \"lodash\";\n\nconst defaultState = {\n    list: {},\n    activeProjectId: null,\n    interval: null\n}\n\nconst projects = (state = defaultState, action) => {\n    switch (action.type) {\n        case \"SET_ACTIVE_PROJECT\":\n            return {\n                ...state,\n                activeProjectId: action.id\n            }\n        case \"ADD_PROJECT\":\n            let newState = { ...state };\n            debugger\n            if (action.tid == undefined) {\n                // let newArray = newState.list.slice();\n                // newArray.splice(action.id, 0, action.project);\n                action.project._id = action._id;\n                newState.list[action._id] = Object.assign({}, action.project);\n                return newState;\n            } else {\n                // let newArray = newState.list[action.id].tasks.slice();\n                // newArray.splice(newState.list[action.id].tasks.length, 0, action.project);\n                // debugger\n                newState.list[action._id].tasks[action.tid] = Object.assign({}, action.project);\n                return newState;\n            }\n        case \"UPDATE_PROJECT\":\n            let uState = { ...state };\n            uState.list[action.id] = {\n                ...uState.list[action.id],\n                [action.key]: action.val\n            };\n            if (action.interval) {\n                uState.list[action.id] = {\n                    ...uState.list[action.id],\n                    interval: action.interval\n                };\n            }\n            if (Boolean(action.id))\n                return uState;\n            else\n                return state;\n        case \"UPDATE_PROJECT_TASK\":\n            let utState = { ...state };\n            debugger\n            let {\n                tid\n            } = action;\n            // tid = tid > 1 ? tid-1 : 0;\n            utState.list[action.id].tasks[tid] = {\n                ...utState.list[action.id].tasks[tid],\n                [action.key]: action.val\n            };\n            if (action.interval) {\n                utState.list[action.id].tasks[tid] = {\n                    ...utState.list[action.id].tasks[tid],\n                    interval: action.interval\n                };\n            }\n            // debugger\n            if (action.id != null)\n                return utState;\n            else\n                return state;\n        case \"DEL_PROJECT\":\n            let dState = {...state};\n            debugger\n            delete dState.list[action.id]; // TODO: test\n            return dState;\n        case \"CLEAR_STs\":\n            let cState = Object.assign({}, state);\n            cState.list[action.id].tasks = {};\n            return cState;\n        case \"SET_PROJECTS\":\n            let spState = lodash.cloneDeep(state);\n            spState.list = action.list;\n            return spState;\n        default:\n            return state;\n    }\n}\n\nexport default projects;","let defaultState = {\n    id: \"\",\n    meta: {\n        isSet: false,\n        title: {\n            quill: null,\n            quillContent: [],\n            quillText: null,\n            value: \"\",\n            toolbar: [[{ header: [1, 2, false] }],\n                ['bold', 'italic', 'underline']],\n            placeholder: \"Enter Title\"\n        },\n        description: {\n            quill: null,\n            quillContent: [],\n            quillText: null,\n            value: \"\",\n            toolbar: [[{ header: [1, 2, false] }],\n                ['bold', 'italic', 'underline']],\n            placeholder: \"Enter Description\"\n        },\n        outcome: {\n            quill: null,\n            quillContent: [],\n            quillText: null,\n            value: \"\",\n            toolbar: [[{ header: [1, 2, false] }],\n                ['bold', 'italic', 'underline']],\n            placeholder: \"Enter Outcome\"\n        },\n        reward: {\n            quill: null,\n            quillContent: [],\n            quillText: null,\n            value: \"\",\n            toolbar: [[{ header: [1, 2, false] }],\n                ['bold', 'italic', 'underline']],\n            placeholder: \"Enter Reward\"\n        },\n        startTime: null,\n        endTime: null,\n        label: \"\",\n        status: \"\",\n        duration: null,\n        reminders: null\n    },\n    map: {\n\n    },\n    track: {\n\n    },\n    analyse: {\n\n    }\n}\n\nconst activeProject = (state = defaultState, action) => {\n    switch(action.type) {\n        case \"SET_META\":\n            return {\n                ...state,\n                meta: action.meta\n            }\n        case \"SET_META_OBJ\":\n            // debugger;\n            return {\n                ...state,\n                meta: {...state.meta, [action.key]: action.val}\n            } \n        default:\n            return state;\n    }\n}\n\nexport default activeProject;","import { ADD_WORKSPACE, SET_WORKSPACES, SET_ACTIVE_WS_PROJECT, DELETE_WORKSPACE } from \"../action-types/workspace\";\n\nexport const defaultState = {\n    activeWSProject: {},\n    workspaces: []\n}\n\nconst wikis = (state = defaultState, action) => {\n    const {\n        workspaces\n    } = state;\n    switch (action.type) {\n        case ADD_WORKSPACE:\n            if (action.index == undefined) {\n                action.index = workspaces.length;\n            }\n            return {\n                ...state,\n                workspaces: [\n                    ...workspaces.slice(0, action.index),\n                    action.workspace,\n                    ...workspaces.slice(action.index)\n                  ]\n            }\n        case SET_WORKSPACES:\n            return {\n                ...state,\n                workspaces: action.workspaces\n            }\n        case SET_ACTIVE_WS_PROJECT:\n            return {\n                ...state,\n                activeWSProject: {...action.activeWSProject}\n            }\n        case DELETE_WORKSPACE:\n            let foundWs = workspaces.filter(ws => ws._id == action.index);\n            let index;\n            if (foundWs.length == 1) {\n                index = workspaces.indexOf(foundWs[0]);\n                console.log(\"FOUND INDEX::\", index);\n            }\n            return {\n                ...state,\n                workspaces: [\n                    ...workspaces.slice(0, index), \n                    ...workspaces.slice(index + 1)\n                ]\n            }\n        default:\n            return state\n    }\n}\n\nexport default wikis;","import { UPDATE_PROJECT_MODAL } from \"../action-types/project-modal\";\n\nconst defaultState = {\n    title: \"\",\n    description: \"\",\n    projectType: \"map\"\n}\n\nconst projectModal = (state = defaultState, action) => {\n    switch (action.type) {\n        case UPDATE_PROJECT_MODAL:\n            return {\n                ...state,\n                ...action.meta\n            }\n        default:\n            return state;\n    }\n}\n\nexport default projectModal;","export const UPDATE_PROJECT_MODAL = \"UPDATE_PROJECT_MODAL\"","import { combineReducers } from 'redux';\nimport tasks from './add-task';\nimport events from \"./events\";\nimport filter from \"./filter\";\nimport notes from \"./notes\";\n// import status from \"./status\";\n// import label from \"./label\";\nimport sideBar from \"./sidebar\";\nimport projects from \"./projects\";\nimport activeProject from \"./edit-project\";\nimport wikis from \"./workspace\";\nimport projectModal from \"./project-modal\";\n\nexport default combineReducers({\n    tasks,\n    events,\n    filter,\n    notes,\n    // status,\n    // \n    sideBar,\n    projects,\n    activeProject,\n    wikis,\n    projectModal\n})","import { createStore, applyMiddleware } from 'redux'\nimport thunk from 'redux-thunk'\nimport { createLogger } from 'redux-logger'\nimport rootReducer from './reducers'\n\nconst middleware = [ thunk ];\nif (process.env.NODE_ENV !== 'production') {\n  middleware.push(createLogger());\n}\n\nconst store = createStore(\n  rootReducer,\n  applyMiddleware(...middleware)  \n);\n\nexport default store;","import React from 'react';\nimport { render } from 'react-dom';\nimport { Provider } from 'react-redux'\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport store from \"./store\";\n\nimport './index.scss';\n\nrender(\n  // <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  // </React.StrictMode>\n  ,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nimport isObject from 'isobject';\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nexport default function isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObjectObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n};\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\nexport default function isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n"],"sourceRoot":""}