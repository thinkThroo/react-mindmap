(window["webpackJsonpreact-mindmap"]=window["webpackJsonpreact-mindmap"]||[]).push([[0],{214:function(e,t,n){"use strict";n.r(t);n(8),n(394),n(40);var o,r=n(16),i=n(17),a=n(20),c=n(19),l=n(3),s=n(18),u=n.n(s),p=n(172);n(68),n(77);!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(o||(o={}));var d="CONTENT",f="DESC",m="NORMAL",h="EDITING_CONTENT",y="EDITING_DESC",g="SET_TOPIC_BLOCK",v=function(e){Object(a.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"data",get:function(){return this.get("data")}},{key:"type",get:function(){return this.get("type")}}],[{key:"create",value:function(e){return new n(e)}},{key:"createList",value:function(e){if(l.List.isList(e)||Array.isArray(e))return Object(l.List)(e.map(n.create));throw new Error("Block.createList only accepts Array or List, but you passed it: ".concat(e))}}]),n}(Object(l.Record)({type:null,key:null,data:null}));var T={readOnly:!1,allowUndo:!0,layoutDir:o.LEFT_AND_RIGHT,theme:{name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}}},b=function(e){Object(a.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"layoutDir",get:function(){return this.get("layoutDir")}},{key:"readOnly",get:function(){return this.get("readOnly")}},{key:"allowUndo",get:function(){return this.get("allowUndo")}},{key:"theme",get:function(){return this.get("theme")}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(Object(l.Record)(T));function E(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var O=function(e){Object(a.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}}},{key:"key",get:function(){return this.get("key")}},{key:"parentKey",get:function(){return this.get("parentKey")}},{key:"collapse",get:function(){return this.get("collapse")}},{key:"subKeys",get:function(){return this.get("subKeys")}},{key:"blocks",get:function(){return this.get("blocks")}},{key:"relations",get:function(){return this.get("relations")}},{key:"style",get:function(){return this.get("style")}}],[{key:"fromJSON",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,i=e.blocks,a=e.subKeys,c=void 0===a?[]:a,s=e.collapse;return new n({key:t,parentKey:r,collapse:void 0!==s&&s,subKeys:Object(l.List)(c),blocks:v.createList(i)})}},{key:"create",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,i=e.content,a=void 0===i?"":i,c=e.subKeys,s=void 0===c?[]:c,u=e.collapse,p=void 0!==u&&u,f=v.create({type:d,data:a,key:null});return new n({key:t,parentKey:r,blocks:Object(l.List)([f]),subKeys:Object(l.List)(s),collapse:p})}}]),n}(Object(l.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));u()("modifier");var k={topics:Object(l.Map)(),extData:Object(l.Map)(),config:new b,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1};Object(l.Record)(k);u()("core:controller");var x=n(0),C=n(112),S=n(49),w=n(11),D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function _(e,t){function n(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var j=function(){return(j=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var R,L,I,P=u()("node:text-editor"),M=w.default.div(I||(R=["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n  min-width: 50px;\n"],L=["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n  min-width: 50px;\n"],Object.defineProperty?Object.defineProperty(R,"raw",{value:L}):R.raw=L,I=R),(function(e){return e.readOnly?null:"white"}),(function(e){return e.readOnly?"pointer":"text"})),K=function(e){function t(t){var n=e.call(this,t)||this;return n.state={content:null},n.onMouseDown=function(e){e.stopPropagation()},n.onMouseMove=function(e){},n.onKeyDown=function(e){},n._handleClick=function(e){!n.root.contains(e.target)&&n.onClickOutSide(e)},n.rootRef=function(e){return function(t){e(t),n.root=t}},n.initState(),n}return _(t,e),t.prototype.onChange=function(e){var t=e.value;P("onChange",t),this.setState({content:t})},t.prototype.componentDidMount=function(){this.props.readOnly||document.addEventListener("click",this._handleClick)},t.prototype.componentWillUnmount=function(){this.props.readOnly||document.removeEventListener("click",this._handleClick)},t.prototype.onClickOutSide=function(e){},t.prototype.getCustomizeProps=function(){return null},t.prototype.getContent=function(){var e=this.getCustomizeProps().block.data;return null==e?null:("string"===typeof e&&(e=C.a.deserialize(e)),e)},t.prototype.initState=function(){var e=this.getContent();this.state={content:e}},t.prototype.render=function(){var e=this.props,t=e.topicKey,n=e.saveRef,o=this.getCustomizeProps(),r=o.readOnly,i=o.getRefKeyFunc,a=o.placeholder,c=o.style;P(r);var l=i(t),s=r?this.getContent():this.state.content,u=this.onMouseDown,p=this.onMouseMove,d=this.onKeyDown,f={value:s,readOnly:r,onChange:this.onChange.bind(this),placeholder:a,style:c},m={key:l,readOnly:r,ref:this.rootRef(n(l)),onMouseDown:u,onMouseMove:p,onKeyDown:d};return Object(x.createElement)(M,j({},m),Object(x.createElement)(S.Editor,j({},f,{autoFocus:!0})))},t}(x.PureComponent),N=u()("node:topic-content-editor");function A(e){return"content-editor-"+e}var F=function(e){function t(t){var n=e.call(this,t)||this;return n.onKeyDown=function(e){e.nativeEvent.ctrlKey&&"Enter"===e.nativeEvent.code&&n.save()},n}return _(t,e),t.prototype.getCustomizeProps=function(){var e=this.props,t=e.model,n=e.topicKey,o=e.readOnly;return{block:t.getTopic(n).getBlock(d).block,readOnly:o,getRefKeyFunc:A,placeholder:"new",style:{whiteSpace:"pre"}}},t.prototype.onClickOutSide=function(e){N("onClickOutSide"),this.save()},t.prototype.save=function(){var e=this.props,t=e.model,n=e.topicKey;t.editingContentKey!==n||this.props.controller.run("operation",j(j({},this.props),{opType:g,blockType:d,data:this.state.content,focusMode:m}))},t}(K),B=u()("node:topic-desc-editor");function W(e){return"desc-editor-"+e}var z=function(e){function t(t){var n=e.call(this,t)||this;return B("constructor"),n}return _(t,e),t.prototype.initState=function(){e.prototype.initState.call(this);var t=this.props,n=t.controller,o="topic-desc-data-"+t.topicKey,r=this.state.content;n.run("setTempValue",{key:o,value:r})},t.prototype.getCustomizeProps=function(){var e=this.props,t=e.model,n=e.topicKey;return{block:t.getTopic(n).getBlock(f).block,readOnly:t.editingDescKey!==n,getRefKeyFunc:W,placeholder:"write topic notes here"}},t.prototype.onChange=function(e){var t=e.value;B("onChange");var n=this.props,o=n.controller,r=n.topicKey;if(!(n.model.editingDescKey!==r)){var i="topic-desc-data-"+r;o.run("setTempValue",{key:i,value:t}),this.setState({content:t})}},t}(K);t.default=function(){return{getTopicTitle:function(e){var t=e.model,n=e.controller,o=e.topicKey,r=e.maxLength,i=t.getTopic(o).getBlock(d).block,a=n.run("serializeBlockData",j(j({},e),{block:i}));return null!=r&&(a=a.length>r?a.substr(0,r)+"...":a),a},renderTopicContentEditor:function(e){return Object(x.createElement)(F,j({},e))},renderTopicDescEditor:function(e){return Object(x.createElement)(z,j({},e))},isBlockEmpty:function(e,t){var n=e.block,o=e.controller;return n.type===d||n.type===f?null==n.data||""===o.run("serializeBlockData",e):t()},serializeBlockData:function(e,t){var n=e.block;return n.type===d||n.type===f?"string"===typeof n.data?n.data:C.a.serialize(n.data):t()}}}},226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(6),i=n(32),a=n(4),c=n(0),l=(o=n(11))&&"object"===typeof o&&"default"in o?o.default:o,s=n(3),u=n(143),p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function d(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var f=function(){return(f=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function m(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function h(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var y,g,v=l(i.ZIndex)(y||(y=h(["\n  position: absolute;\n  left: calc(50% - 150px);\n  top: 30px;\n  width: 300px;\n  background: white;\n  padding: 10px;\n  user-select: none;\n"],["\n  position: absolute;\n  left: calc(50% - 150px);\n  top: 30px;\n  width: 300px;\n  background: white;\n  padding: 10px;\n  user-select: none;\n"]))),T=l.div(g||(g=h(["\n  margin-bottom: 10px;\n"],["\n  margin-bottom: 10px;\n"])));function b(e){var t=e.zIndex,n=e.controller,o=e.topicKey;return c.createElement(v,{zIndex:t},c.createElement(T,null,"Please select the topics you want to reference. After selection, click the confirm button."),c.createElement(i.Flex,{justifyContent:"space-around"},c.createElement(a.Button,{onClick:function(t){var i=n.run("getSelectedReferenceKeys",e);n.run("enableOperation",e),n.run("operation",f(f({},e),{opArray:[{opType:"OP_TYPE_SET_REFERENCE_TOPICS",topicKey:o,referenceKeys:i},{opType:r.OpType.FOCUS_TOPIC,topicKey:o,focusMode:r.FocusMode.NORMAL}]})),n.run("clearSelectedReferenceKeys",e)}},"Confirm"),c.createElement(a.Button,{onClick:function(t){n.run("clearSelectedReferenceKeys",e),n.run("enableOperation",e),n.run("operation",f(f({},e),{opType:r.OpType.SET_FOCUS_MODE,focusMode:r.FocusMode.NORMAL}))}},"Cancel")))}var E={keyList:s.List(),dataMap:s.Map()},O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),Object.defineProperty(t.prototype,"keyList",{get:function(){return this.get("keyList")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataMap",{get:function(){return this.get("dataMap")},enumerable:!0,configurable:!0}),t}(s.Record(E)),k={reference:s.Map()},x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),Object.defineProperty(t.prototype,"reference",{get:function(){return this.get("reference")},enumerable:!0,configurable:!0}),t.prototype.getReferenceKeys=function(e){return this.reference.has(e)?this.reference.get(e).keyList.toArray():[]},t.prototype.getReferencedKeys=function(e){var t=[];return this.reference.forEach((function(n,o){n.keyList.includes(e)&&t.push(o)})),t},t}(s.Record(k));function C(e){var t=e.model,n=e.topicKey,o=e.referenceKeys,r=t.getExtDataItem("TOPIC_REFERENCE",x),i=r.reference.get(n)||new O;return i=i.set("keyList",s.List(o)),r=r.setIn(["reference",n],i),t=t.setIn(["extData","TOPIC_REFERENCE"],r)}var S,w,D,_=l.div(S||(S=h(["\n  display: flex;\n  width: 380px;\n  margin: 10px;\n  justify-content: center;\n  align-items: center;\n"],["\n  display: flex;\n  width: 380px;\n  margin: 10px;\n  justify-content: center;\n  align-items: center;\n"]))),j=l.div(w||(w=h(["\n  width: 300px;\n  text-decoration: underline;\n  cursor: pointer;\n"],["\n  width: 300px;\n  text-decoration: underline;\n  cursor: pointer;\n"]))),R=l.div(D||(D=h(["\n  width: 80px;\n"],["\n  width: 80px;\n"])));function L(e){var t=e.controller,n=e.refKey,o=e.refType,r=e.removeHandler,l=m(c.useState(!1),2),s=l[0],u=l[1],p=t.getValue(i.PropKey.TOPIC_TITLE,f(f({},e),{topicKey:n,maxLength:100})),d={isOpen:s,cancelButtonText:"cancel",onConfirm:function(e){r(e)},onCancel:function(e){u(!1)},onClose:function(e){u(!1)}};return c.createElement(_,null,c.createElement(j,{onClick:function(o){o.stopPropagation(),t.run("focusTopicAndMoveToCenter",f(f({},e),{topicKey:n}))}},p),c.createElement(R,null,"reference"===o&&c.createElement(c.Fragment,null,c.createElement(a.Button,{onClick:function(e){u(!0)}},"Remove"),c.createElement(a.Alert,f({},d),c.createElement("p",null,"Are you confirm to remove this reference?")))))}var I,P,M,K,N,A=l.div(I||(I=h([""],[""]))),F=l.div(P||(P=h(["\n  padding: 10px;\n"],["\n  padding: 10px;\n"]))),B=l.div(M||(M=h(["\n  max-height: 200px;\n  overflow: auto;\n"],["\n  max-height: 200px;\n  overflow: auto;\n"]))),W=l.div(K||(K=h(["\n  font-size: 20px;\n  color: #106ba3;\n"],["\n  font-size: 20px;\n  color: #106ba3;\n"]))),z=l.div(N||(N=h(["\n  text-decoration: underline;\n  color: #106ba3;\n  cursor: pointer;\n"],["\n  text-decoration: underline;\n  color: #106ba3;\n  cursor: pointer;\n"])));function G(e){var t=e.topicKey,n=e.controller,o=e.model,a=o.extData.get("TOPIC_REFERENCE"),l=a.getReferenceKeys(t),s=0===l.length?null:c.createElement(F,null,c.createElement(W,null,"Reference Topics:"),c.createElement(B,null,l.map((function(o){var i,l=f(f({},e),{key:o,refKey:o,refType:"reference",removeHandler:(i=o,function(o){o.stopPropagation();var c=a.reference.get(t).keyList;n.run("operation",f(f({},e),{opArray:[{opType:"OP_TYPE_SET_REFERENCE_TOPICS",topicKey:t,focusMode:r.FocusMode.NORMAL,referenceKeys:c.delete(c.indexOf(i)).toArray()}]}))})});return c.createElement(L,f({},l))})))),u=a.getReferencedKeys(t),p=0===u.length?null:c.createElement(F,null,c.createElement(W,null,"Referenced Topics:"),c.createElement(B,null,u.map((function(t){var n=f(f({},e),{key:t,refKey:t,refType:"referenced"});return c.createElement(L,f({},n))})))),d=o.focusKey!==t&&c.createElement(F,null,c.createElement(z,{onClick:function(t){t.stopPropagation(),n.run("focusTopicAndMoveToCenter",e)}},"Goto Origin Topic"));return c.createElement(A,{onMouseDown:i.cancelEvent},s,p,d)}function H(e){var t=e.model,n=e.topicKey,o=t.extData.get("TOPIC_REFERENCE")||new x,r=o.reference.get(n),l=[];if(o.reference.forEach((function(e,t){e.keyList.includes(n)&&l.push(t)})),(null==r||0===r.keyList.size)&&0===l.length)return null;var s={className:i.iconClassName("reference"),tabIndex:-1},u=c.createElement(i.TopicBlockIcon,f({},s)),p={autoFocus:!1,content:c.createElement(G,f({},e)),target:u,interactionKind:a.PopoverInteractionKind.CLICK,hoverOpenDelay:500};return c.createElement(a.Popover,f({},p))}function V(e){var t=e.topicKey,n=e.selectedTopicKeys,o=n.has(t),r=m(c.useState(o),2),a=r[0],l=r[1],s={checked:a,onChange:function(){n.has(t)?n.delete(t):n.add(t),l(!a)}};return c.createElement(i.StyledCheckbox,f({},s))}var U,Y,Z,q,J,X=l(u.Omnibar.ofType())(U||(U=h(["\n  top: 20%;\n  left: 25% !important;\n  width: 50% !important;\n"],["\n  top: 20%;\n  left: 25% !important;\n  width: 50% !important;\n"]))),Q=l.div(Y||(Y=h(["\n  margin: 0 5px;\n  padding: 10px 5px;\n  width: 100%;\n  font-size: 16px;\n  cursor: pointer;\n  &:hover {\n    background: #e3e8ec;\n  }\n"],["\n  margin: 0 5px;\n  padding: 10px 5px;\n  width: 100%;\n  font-size: 16px;\n  cursor: pointer;\n  &:hover {\n    background: #e3e8ec;\n  }\n"]))),$=l(a.Popover)(Z||(Z=h(["\n  display: block;\n"],["\n  display: block;\n"]))),ee=l.div(q||(q=h(["\n  padding: 10px;\n  font-size: 16px;\n  //max-width: 800px;\n  //max-height: 600px;\n  overflow: auto;\n"],["\n  padding: 10px;\n  font-size: 16px;\n  //max-width: 800px;\n  //max-height: 600px;\n  overflow: auto;\n"]))),te=l.div(J||(J=h(["\n  white-space: break-spaces;\n"],["\n  white-space: break-spaces;\n"]))),ne={placeholder:"Search"};function oe(e){var t=e.model,n=(e.setSearchWord,e.controller),o=function(t){return function(o){n.run("focusTopicAndMoveToCenter",f(f({},e),{topicKey:t}))}},i=function(){var o=[];return t.topics.forEach((function(t,r){o.push({key:r,title:n.run("getTopicTitle",f(f({},e),{topicKey:r}))})})),o}();return c.createElement(X,{inputProps:ne,itemListPredicate:function(e,t){return t.filter((function(t){return t.title.toLowerCase().includes(e.toLowerCase())}))},isOpen:!0,items:i,itemRenderer:function(e,t){var n=e.key,r=e.title,i=r.length>100,l=i?r.substr(0,100)+"...":r,s={key:n,onClick:o(n)},u=c.createElement(Q,f({},s),l),p={key:n,target:u,content:c.createElement(ee,null,c.createElement(te,null,r)),fill:!0,interactionKind:a.PopoverInteractionKind.HOVER_TARGET_ONLY,hoverOpenDelay:1e3};return i?c.createElement($,f({},p)):u},onClose:function(){n.run("operation",f(f({},e),{opType:r.OpType.SET_FOCUS_MODE,focusMode:r.FocusMode.NORMAL}))},resetOnSelect:!0})}t.FOCUS_MODE_SEARCH="FOCUS_MODE_SEARCH",t.HOT_KEY_NAME_SEARCH="DEFAULT_SEARCH",t.SearchPlugin=function(){var e=function(e){};return{customizeHotKeys:function(e,t){var n=e.controller,o=e.model,i=t();return i.globalHotKeys.set("DEFAULT_SEARCH",{label:"search",combo:"ctrl + f",onKeyDown:function(){n.run("operation",f(f({},e),{opType:r.OpType.FOCUS_TOPIC,topicKey:o.focusKey,focusMode:"FOCUS_MODE_SEARCH"}))}}),i},renderDiagramCustomize:function(t,n){var o=n();if("FOCUS_MODE_SEARCH"===t.model.focusMode){var r=f(f({key:"search-panel"},t),{setSearchWorld:e});o.push(c.createElement(oe,f({},r)))}return o}}},t.TopicReferencePlugin=function(){var e=new Set;function t(t){var n=t.model,o=t.topicKey,i=n.getExtDataItem("TOPIC_REFERENCE",x);return e=new Set(i.getReferenceKeys(o)),n=r.ModelModifier.focusTopic({model:n,topicKey:o,focusMode:"FOCUS_MODE_SET_REFERENCE_TOPICS"})}return{customizeTopicContextMenu:function(e,t){var n=e.controller;return c.createElement(c.Fragment,null,t(),c.createElement(a.MenuDivider,null),c.createElement(a.MenuItem,{key:"EXT_KEY_TOPIC_REFERENCE",icon:i.Icon("reference"),text:"Set Reference Topics",onClick:function(t){n.run("operation",f(f({},e),{opType:"OP_TYPE_START_SET_REFERENCE_TOPICS"})),n.run("disableOperation",f(f({},e),{whiteList:[r.OpType.TOGGLE_COLLAPSE]}))}}))},getOpMap:function(e,n){var o=n();return o.set("OP_TYPE_START_SET_REFERENCE_TOPICS",t),o.set("OP_TYPE_SET_REFERENCE_TOPICS",C),o},beforeOpFunction:function(e,t){var n=t(),o=e.opType,i=e.topicKey;if(o===r.OpType.DELETE_TOPIC&&i!==n.editorRootTopicKey){var a=r.getAllSubTopicKeys(n,i);a.push(i);var c=n.getExtDataItem("TOPIC_REFERENCE",x),l=c.reference;a.forEach((function(e){var t=c.getReferencedKeys(e);(l=l.withMutations((function(n){t.forEach((function(t){n.updateIn([t,"keyList"],(function(t){return t.delete(t.indexOf(e))}))}))}))).has(e)&&(l=l.delete(e))})),c=c.set("reference",l),n=n.setIn(["extData","TOPIC_REFERENCE"],c)}return n},renderDiagramCustomize:function(e,t){var n=e.model,o=e.controller.getValue(i.PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX)+2,r=t();if("FOCUS_MODE_SET_REFERENCE_TOPICS"===n.focusMode){var a=f(f({},e),{zIndex:o,topicKey:n.focusKey,key:"AddReferenceTopicPanel"});r.push(c.createElement(b,f({},a)))}return r},renderTopicContentOthers:function(t,n){var o=t.model,r=t.topicKey,i=t.controller,a=n();if(a.push(i.run("renderTopicExtReference",f(f({},t),{key:"EXT_KEY_TOPIC_REFERENCE-icon"}))),"FOCUS_MODE_SET_REFERENCE_TOPICS"===o.focusMode&&o.focusKey!==r){var l=f(f({},t),{key:"checkbox",selectedTopicKeys:e}),s=c.createElement(V,f({},l));a.push(s)}return a},renderTopicExtReference:function(e,t){return c.createElement(H,f({},e))},clearSelectedReferenceKeys:function(){e.clear()},getSelectedReferenceKeys:function(){return Array.from(e)},deserializeExtDataItem:function(e,t){var n=e.extDataKey,o=e.extDataItem;if("TOPIC_REFERENCE"===n){var r=new x,i=function(e){var t=o.reference[e],n=new O({keyList:s.List(t.keyList),dataMap:s.Map(t.dataMap)});r=r.update("reference",(function(t){return t.set(e,n)}))};for(var a in o.reference)i(a);return r}return t()}}}},275:function(e,t,n){"use strict";n.r(t);n(475)},32:function(e,t,n){"use strict";n.r(t),n.d(t,"BaseWidget",(function(){return B})),n.d(t,"Btn",(function(){return X})),n.d(t,"CloseIcon",(function(){return $})),n.d(t,"DefaultPlugin",(function(){return fo})),n.d(t,"Diagram",(function(){return mo})),n.d(t,"DragScrollWidget",(function(){return H})),n.d(t,"EventKey",(function(){return Te})),n.d(t,"Flex",(function(){return Y})),n.d(t,"HotKeyName",(function(){return Pe})),n.d(t,"HotKeyPlugin",(function(){return Me})),n.d(t,"Icon",(function(){return le})),n.d(t,"IconBg",(function(){return J})),n.d(t,"IconName",(function(){return ae})),n.d(t,"Margin",(function(){return Z})),n.d(t,"PanelTabRoot",(function(){return oe})),n.d(t,"PropKey",(function(){return be})),n.d(t,"RefKey",(function(){return ve})),n.d(t,"SaveRef",(function(){return U})),n.d(t,"ShowMenuIcon",(function(){return q})),n.d(t,"StyledCheckbox",(function(){return Q})),n.d(t,"Title",(function(){return ee})),n.d(t,"TopicBlockIcon",(function(){return te})),n.d(t,"ZIndex",(function(){return ne})),n.d(t,"browserDownloadFile",(function(){return Oe})),n.d(t,"browserDownloadText",(function(){return ke})),n.d(t,"browserOpenFile",(function(){return xe})),n.d(t,"cancelEvent",(function(){return Ee})),n.d(t,"center",(function(){return Re})),n.d(t,"centerPointX",(function(){return _e})),n.d(t,"centerPointY",(function(){return je})),n.d(t,"centerX",(function(){return De})),n.d(t,"centerY",(function(){return we})),n.d(t,"collapseRefKey",(function(){return ye})),n.d(t,"contentEditorRefKey",(function(){return ue})),n.d(t,"contentRefKey",(function(){return se})),n.d(t,"descEditorRefKey",(function(){return pe})),n.d(t,"dropAreaRefKey",(function(){return ge})),n.d(t,"getLinkKey",(function(){return Se})),n.d(t,"getRelativeRect",(function(){return Le})),n.d(t,"getRelativeVector",(function(){return Ie})),n.d(t,"iconClassName",(function(){return ce})),n.d(t,"linksRefKey",(function(){return me})),n.d(t,"linksSvgRefKey",(function(){return he})),n.d(t,"paddingCss",(function(){return Ce})),n.d(t,"topicRefKey",(function(){return fe})),n.d(t,"topicWidgetRefKey",(function(){return de}));var o=n(0),r=n(109),i=n(11),a=n(18),c=n.n(a),l=n(4),s=n(6),u=(n(275),n(276),n(68)),p=n(214),d=n(3),f=n(5),m=n.n(f),h=n(173),y=n(213),g=n(44),v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function T(e,t){function n(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var b=function(){return(b=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function E(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function O(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function k(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function x(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(x(arguments[t]));return e}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var w,D,_,j,R,L,I,P,M,K,N,A,F,B=function(e){function t(t){return e.call(this,t)||this}return T(t,e),t.prototype.operation=function(e,t){this.props.controller.run("operation",b({opType:e},t))},t.prototype.run=function(e,t){this.props.controller.run(e,t)},Object.defineProperty(t.prototype,"topic",{get:function(){return this.props.model.getTopic(this.props.topicKey)},enumerable:!0,configurable:!0}),t}(o.PureComponent),W=c()("node:drag-scroll-widget"),z=i.default.div(w||(w=S(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"],["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"]))),G=i.default.div(D||(D=S(["\n  position: relative;\n  width: max-content;\n"],["\n  position: relative;\n  width: max-content;\n"]))),H=function(e){function t(t){var n=e.call(this,t)||this;return n.contentResizeCallback=function(e,t){if(n.oldContentRect){var o={width:n.content.clientWidth+2*n.viewBox.clientWidth,height:n.content.clientHeight+2*n.viewBox.clientHeight};n.bigView.style.width=o.width+"px",n.bigView.style.height=o.height+"px"}n.oldContentRect=e[0].contentRect},n.contentResizeObserver=new r.default(n.contentResizeCallback),n.contentRef=function(e){e&&(n.content=e,n.contentResizeObserver.observe(n.content))},n.viewBoxRef=function(e){e&&(n.viewBox=e,n.props.enableMouseWheel||(W("addEventListener onwheel"),n.viewBox.addEventListener("wheel",(function(e){W("onwheel"),(e.ctrlKey||e.altKey)&&e.preventDefault()}),{passive:!1})),n.setViewBoxScroll(n.viewBox.clientWidth,n.viewBox.clientHeight))},n.bigViewRef=function(e){e&&(n.bigView=e)},n.setWidgetStyle=function(){n.content&&n.viewBox&&n.bigView&&(n.bigView.style.width=2*(n.content.clientWidth+n.viewBox.clientWidth)+"px",n.bigView.style.height=2*(n.content.clientHeight+n.viewBox.clientHeight)+"px",n.content.style.left=n.viewBox.clientWidth+"px",n.content.style.top=n.viewBox.clientHeight+"px")},n.setViewBoxScroll=function(e,t){W("setViewBoxScroll "+e+" "+t),n.viewBox&&(n.viewBox.scrollLeft=e,n.viewBox.scrollTop=t)},n.setViewBoxScrollDelta=function(e,t){W("setViewBoxScrollDelta "+e+" "+t),n.viewBox&&(n.viewBox.scrollLeft+=e,n.viewBox.scrollTop+=t)},n.onMouseDown=function(e){var t=n.props,o=t.mouseKey,r=t.needKeyPressed,i=t.canDragFunc;if((!i||i())&&(0===e.button&&"left"===o||2===e.button&&"right"===o)){if(r&&!e.ctrlKey)return;n._lastCoordX=n.viewBox.scrollLeft+e.nativeEvent.clientX,n._lastCoordY=n.viewBox.scrollTop+e.nativeEvent.clientY;var a=n.viewBox;a.addEventListener("mousemove",n.onMouseMove),a.addEventListener("mouseup",n.onMouseUp)}},n.onMouseUp=function(e){var t=n.viewBox;t.removeEventListener("mousemove",n.onMouseMove),t.removeEventListener("mouseup",n.onMouseUp)},n.onMouseMove=function(e){n.viewBox.scrollLeft=n._lastCoordX-e.clientX,n.viewBox.scrollTop=n._lastCoordY-e.clientY},n.handleContextMenu=function(e){e.preventDefault()},n.state={widgetStyle:{width:"10000px",height:"10000px"}},n}return T(t,e),t.prototype.componentDidMount=function(){this.setWidgetStyle(),document.addEventListener("contextmenu",this.handleContextMenu)},t.prototype.componentWillUnmount=function(){document.removeEventListener("contextmenu",this.handleContextMenu)},t.prototype.setZoomFactor=function(e){this.bigView.style.transform="scale("+e+")",this.bigView.style.transformOrigin="50% 50%"},t.prototype.render=function(){var e=b({},this.state.widgetStyle);return Object(o.createElement)(z,{ref:this.viewBoxRef,onMouseDown:this.onMouseDown},Object(o.createElement)("div",{style:e,ref:this.bigViewRef},Object(o.createElement)(G,{ref:this.contentRef,style:this.state.contentStyle},this.props.children(this.setViewBoxScroll,this.setViewBoxScrollDelta))))},t.defaultProps={mouseKey:"left",needKeyPressed:!1},t}(o.Component),V=c()("node:save-ref"),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getRef=function(e){return V(t),t[e]},t.saveRef=function(e){return function(n){n&&(t[e]=n,t.fireListener(e,n))}},t.deleteRef=function(e){V("deleteRef:",e),delete t[e]},t.observers=new Map,t.fireListener=function(e,n){var o,r;if(t.observers.has(e)){var i=t.observers.get(e);try{for(var a=k(i),c=a.next();!c.done;c=a.next()){(0,c.value)(e,n)}}catch(l){o={error:l}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}}},t.registerRefListener=function(e,n){t.observers.has(e)?t.observers.get(e).push(n):t.observers.set(e,[n])},t}return T(t,e),t.prototype.render=function(){return this.props.children(this.saveRef,this.getRef,this.deleteRef,this.registerRefListener.bind(this))},t}(o.Component),Y=i.default.div(_||(_=S(["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"],["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"])),(function(e){return e.flexDirection?e.flexDirection:"row"}),(function(e){return e.alignItems}),(function(e){return e.justifyContent})),Z=i.default.div(j||(j=S(["\n  margin: ",";\n"],["\n  margin: ",";\n"])),(function(e){return e.margin})),q=i.default.a(R||(R=S(["\n  font-size: 20px !important;\n"],["\n  font-size: 20px !important;\n"]))),J=i.default.div(L||(L=S(["\n  padding: 5px;\n  cursor: pointer;\n"],["\n  padding: 5px;\n  cursor: pointer;\n"]))),X=i.default.div(I||(I=S(["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"],["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"]))),Q=Object(i.default)(l.Checkbox)(P||(P=S(["\n  margin-bottom: 0px !important;\n"],["\n  margin-bottom: 0px !important;\n"]))),$=Object(i.default)(X)(M||(M=S(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"],["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"]))),ee=i.default.div(K||(K=S(["\n  height: 16px;\n"],["\n  height: 16px;\n"]))),te=i.default.span(N||(N=S(["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"],["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"]))),ne=i.default.div(A||(A=S(["\n  z-index: ",";\n"],["\n  z-index: ",";\n"])),(function(e){return e.zIndex})),oe=i.default.div(F||(F=S(["\n  min-width: 360px;\n  max-height: 470px;\n  overflow: auto;\n"],["\n  min-width: 360px;\n  max-height: 470px;\n  overflow: auto;\n"]))),re=c()("plugin:event");function ie(){var e={};return{handleTopicClick:function(e){re("handleTopicClick");var t=e.controller,n=e.model,o=e.topicKey;re(n.zoomFactor),null===n.editingDescKey&&n.editingContentKey!==o&&(n.focusKey===o&&n.focusMode===s.FocusMode.EDITING_CONTENT||t.run("operation",b(b({},e),{opType:s.OpType.FOCUS_TOPIC,focusMode:s.FocusMode.NORMAL})))},handleTopicDoubleClick:function(e){var t=e.controller;null===e.model.editingDescKey&&t.run("operation",b(b({},e),{opType:s.OpType.FOCUS_TOPIC,focusMode:s.FocusMode.EDITING_CONTENT}))},handleTopicContextMenu:function(e){e.controller.run("operation",b(b({},e),{opType:s.OpType.FOCUS_TOPIC,focusMode:s.FocusMode.SHOW_POPUP}))},handleActiveModalClose:function(e){var t=e.controller,n=t.run("getActiveModalProps",e);return null==n?null:"edit-desc"===n.name?function(){t.run("operation",b(b({},e),{focusMode:s.FocusMode.NORMAL,opType:s.OpType.FOCUS_TOPIC}))}:void 0},addEventListener:function(t){var n=t.key,o=t.listener,r=t.once,i=t.controller;function a(){o(),i.run("removeEventListener",{key:n,listener:o})}e[n]||(e[n]=[]),r?(a.origin=o,e[n].push(a)):e[n].push(o)},removeEventListener:function(t){var n=t.key,o=t.listener;e[n]&&(e[n]=e[n].filter((function(e){return e!==o&&e.origin!==o})))},fireEvent:function(t){var n=t.key;e[n]&&e[n].forEach((function(e){return e()}))}}}var ae={SHOW_MENU:"show-menu",CLOSE:"close",COLOR_PICKER:"color-picker",NOTES:"notes",PLUS:"plus",MINUS:"minus",COLLAPSE_ALL:"collapse",EXPAND_ALL:"expand",CENTER:"center",TRASH:"trash",SEARCH:"search",THEME:"theme",EXPORT:"export",OPEN_FILE:"openfile"};function ce(e){return"icon iconfont bm-"+e}function le(e){return Object(o.createElement)("span",{className:ce(e)})}function se(e){return"content-"+e}function ue(e){return"content-editor-"+e}function pe(e){return"desc-editor-"+e}function de(e){return"topic-widget-"+e}function fe(e){return"topic-"+e}function me(e){return"links-"+e}function he(e){return"links-svg-"+e}function ye(e){return"collapse-"+e}function ge(e,t){return"dropArea-"+t+"-"+e}var ve={DIAGRAM_ROOT_KEY:"DIAGRAM-ROOT",DRAG_SCROLL_WIDGET_KEY:"DragScrollWidget",SVG_HIGHLIGHT_KEY:"svg-highlight",FOCUS_HIGHLIGHT_KEY:"focus-highlight",DROP_EFFECT_KEY:"drop-effect"},Te={CENTER_ROOT_TOPIC:"CENTER_ROOT_TOPIC"},be={DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:"DIAGRAM_CUSTOMIZE_BASE_Z_INDEX",TOPIC_CONTEXT_MENU_ENABLED:"TOPIC_CONTEXT_MENU_ENABLED",TOPIC_TITLE:"TOPIC_TITLE"},Ee=function(e){e.stopPropagation()};function Oe(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}function ke(e,t){Oe("data:text/plain,"+encodeURIComponent(e),t)}function xe(e){var t=document.createElement("input");return t.type="file",t.accept=e,new Promise((function(e,n){t.addEventListener("change",(function(t){var o=t.target.files[0],r=new FileReader;r.onload=function(t){var n=t.target.result;e(n)},r.onerror=function(e){n(e.target.error)},r.readAsText(o)})),t.click()}))}function Ce(e){var t=e.top,n=void 0===t?0:t,o=e.right,r=void 0===o?0:o,i=e.bottom,a=void 0===i?0:i,c=e.left;return n+"px "+r+"px "+a+"px "+(void 0===c?0:c)+"px"}function Se(e,t){return"link-"+e+"-"+t}function we(e){return(e.top+e.bottom)/2}function De(e){return(e.left+e.right)/2}function _e(e,t){return(e.x+t.x)/2}function je(e,t){return(e.y+t.y)/2}function Re(e){return[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Le(e,t,n){void 0===n&&(n=1);var o=e.getBoundingClientRect(),r=Re(t.getBoundingClientRect()),i=Re(o);i[0]=(i[0]-r[0])/n,i[1]=(i[1]-r[1])/n;var a=o.width/n,c=o.height/n;return{left:i[0]-a/2,right:i[0]+a/2,top:i[1]-c/2,bottom:i[1]+c/2,width:a,height:c}}function Ie(e,t){var n=e.getBoundingClientRect(),o=Re(t.getBoundingClientRect()),r=Re(n);return[r[0]-o[0],r[1]-o[1]]}var Pe={ADD_CHILD:"ADD_CHILD",ADD_SIBLING:"ADD_SIBLING",DELETE_TOPIC:"DELETE_TOPIC",EDIT_CONTENT:"EDIT_CONTENT",EDIT_NOTES:"EDIT_NOTES",SET_EDITOR_ROOT:"SET_EDITOR_ROOT"};function Me(){return{customizeHotKeys:function(e){var t=function(t){return function(n){!function(e,t){var n=t.topicKey,o=t.model,r=t.controller;void 0===n&&(t=b(b({},t),{topicKey:o.focusKey})),r.run("operation",b(b({},t),{opType:e}))}(t,e)}};return{topicHotKeys:new Map([[Pe.ADD_CHILD,{label:"add child",combo:"tab",onKeyDown:t(s.OpType.ADD_CHILD)}],[Pe.ADD_SIBLING,{label:"add sibling",combo:"enter",onKeyDown:t(s.OpType.ADD_SIBLING)}],[Pe.DELETE_TOPIC,{label:"delete topic",combo:"del",onKeyDown:t(s.OpType.DELETE_TOPIC)}],[Pe.EDIT_CONTENT,{label:"edit content",combo:"space",onKeyDown:t(s.OpType.START_EDITING_CONTENT)}],[Pe.EDIT_NOTES,{label:"edit notes",combo:"alt + d",onKeyDown:t(s.OpType.START_EDITING_DESC)}],[Pe.SET_EDITOR_ROOT,{label:"set editor root",combo:"alt + shift + f",onKeyDown:t(s.OpType.SET_EDITOR_ROOT)}]]),globalHotKeys:new Map}}}}var Ke=c()("plugin:operation");function Ne(){var e=new Map([[s.OpType.TOGGLE_COLLAPSE,s.ModelModifier.toggleCollapse],[s.OpType.COLLAPSE_ALL,s.ModelModifier.collapseAll],[s.OpType.EXPAND_ALL,s.ModelModifier.expandAll],[s.OpType.EXPAND_TO,s.ModelModifier.expandTo],[s.OpType.ADD_CHILD,s.ModelModifier.addChild],[s.OpType.ADD_SIBLING,s.ModelModifier.addSibling],[s.OpType.DELETE_TOPIC,s.ModelModifier.deleteTopic],[s.OpType.FOCUS_TOPIC,s.ModelModifier.focusTopic],[s.OpType.SET_FOCUS_MODE,s.ModelModifier.setFocusMode],[s.OpType.SET_STYLE,s.ModelModifier.setStyle],[s.OpType.SET_THEME,s.ModelModifier.setTheme],[s.OpType.SET_TOPIC_BLOCK,s.ModelModifier.setBlockData],[s.OpType.DELETE_TOPIC_BLOCK,s.ModelModifier.deleteBlock],[s.OpType.START_EDITING_CONTENT,function(e){var t=e.model,n=e.topicKey;return s.ModelModifier.focusTopic({model:t,topicKey:n,focusMode:s.FocusMode.EDITING_CONTENT})}],[s.OpType.START_EDITING_DESC,function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock(s.BlockType.DESC);return null!=o.block&&null!=o.block.data||(t=s.ModelModifier.setBlockData({model:t,topicKey:n,blockType:s.BlockType.DESC,data:""})),t=s.ModelModifier.focusTopic({model:t,topicKey:n,focusMode:s.FocusMode.EDITING_DESC})}],[s.OpType.DRAG_AND_DROP,function(e){var t=e.srcKey,n=e.dstKey,o=e.dropDir,r=e.model,i=r.getTopic(t),a=r.getTopic(n),c=i.parentKey,l=r.getTopic(c).subKeys,s=l.indexOf(t);if(l=l.delete(s),"in"===o){var u=a.subKeys;u=u.push(t),r=r.withMutations((function(e){e.setIn(["topics",c,"subKeys"],l).setIn(["topics",t,"parentKey"],n).setIn(["topics",n,"subKeys"],u).setIn(["topics",n,"collapse"],!1)}))}else{var p=a.parentKey,f=r.getTopic(p).subKeys,m=f.indexOf(n);if(c===p){var h=Object(d.List)();f.forEach((function(e){e!==t&&(h=e===n?"prev"===o?h.push(t).push(e):h.push(e).push(t):h.push(e))})),r=r.withMutations((function(e){e.setIn(["topics",p,"subKeys"],h)}))}else"prev"===o?f=f.insert(m,t):"next"===o&&(f=f.insert(m+1,t)),r=r.withMutations((function(e){e.setIn(["topics",c,"subKeys"],l).setIn(["topics",t,"parentKey"],p).setIn(["topics",p,"subKeys"],f).setIn(["topics",p,"collapse"],!1)}))}return r}],[s.OpType.SET_EDITOR_ROOT,s.ModelModifier.setEditorRootTopicKey]]),t=Object(d.Stack)(),n=Object(d.Stack)(),o=!0,r=new Set;return{isOperationEnabled:function(e){return o},enableOperation:function(){o=!0},disableOperation:function(e){var t=e.whiteList;o=!1,t?r=new Set(t):r.clear()},getOpMap:function(t){return e},getAllowUndo:function(e){var t=e.model,n=e.opType;if(n)switch(n){case s.OpType.FOCUS_TOPIC:case s.OpType.START_EDITING_CONTENT:case s.OpType.START_EDITING_DESC:return!1}switch(t.focusMode){case"EDITING_DESC":case"EDITING_CONTENT":return!1}return t.config.allowUndo},getUndoRedoStack:function(){return{undoStack:t,redoStack:n}},setUndoStack:function(e){Ke("setUndoStack",e.undoStack),t=e.undoStack},setRedoStack:function(e){Ke("setRedoStack",e.redoStack),n=e.redoStack},canUndo:function(e){var t=e.controller,n=t.run("getUndoRedoStack",e).undoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},canRedo:function(e){var t=e.controller,n=t.run("getUndoRedoStack",e).redoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},undo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,i=o.redoStack,a=r.peek();a&&(t.run("setUndoStack",b(b({},e),{undoStack:r.shift()})),t.run("setRedoStack",b(b({},e),{redoStack:i.push(n)})),Ke(a),t.change(a))}},redo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,i=o.redoStack,a=i.peek();a&&(t.run("setUndoStack",b(b({},e),{undoStack:r.push(n)})),t.run("setRedoStack",b(b({},e),{redoStack:i.shift()})),t.change(a))}},operation:function(e){var t=e.controller,n=e.opType,o=e.model,i=e.opArray,a=e.callback;if(null!=i&&!Array.isArray(i))throw new Error("operation: the type of opArray must be array!");if(null!=n&&null!=i)throw new Error("operation: opType and opArray conflict!");if(!t.run("isOperationEnabled",e)){if(0===r.size)return;if(null!=i){var c=i.filter((function(e){return!r.has(e.opType)}));if(c&&c.length>0)return}else if(!r.has(n))return}Ke("operation:",n),Ke("operation:",o),Ke("operation:",e);var l,s=t.run("getOpMap",e);if(t.run("beforeOperation",e),t.run("getAllowUndo",e)){var u=t.run("getUndoRedoStack",e).undoStack;t.run("setUndoStack",b(b({},e),{undoStack:u.push(o)}))}if(null!=i)l=i.reduce((function(e,n){var o=n.opType;if(!s.has(o))throw new Error("opType:"+o+" not exist!");var r=s.get(o),i=b(b({controller:t},n),{model:e}),a=t.run("beforeOpFunction",i);return a=r(b(b({},i),{model:a})),a=t.run("afterOpFunction",b(b({},i),{model:a}))}),o);else{if(!s.has(n))throw new Error("opType:"+n+" not exist!");var p=s.get(n);l=t.run("beforeOpFunction",e),l=p(b(b({},e),{model:l})),l=t.run("afterOpFunction",b(b({},e),{model:l}))}Ke("newModel:",l),t.change(l,a),t.run("afterOperation",e)},deleteRefKey:function(e){var t,n,o=e.model,r=e.topicKey,i=e.deleteRef,a=Object(s.getAllSubTopicKeys)(o,r);a.push(r);try{for(var c=k(a),l=c.next();!l.done;l=c.next()){var u=l.value;i(me(u)),i(he(u)),i(se(u)),i(ue(u)),i(pe(u)),i(de(u)),i(fe(u)),i(ye(u)),i(ge(u,"next")),i(ge(u,"prev"))}}catch(p){t={error:p}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}},beforeOperation:function(e){},afterOperation:function(e){},beforeOpFunction:function(e){var t=e.controller,n=e.opType,o=e.model,r=e.topicKey;return n===s.OpType.DELETE_TOPIC&&r!==o.editorRootTopicKey&&t.run("deleteRefKey",e),o},afterOpFunction:function(e){return e.model}}}var Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.render=function(){var e=this.props.controller;return Object(o.createElement)(l.Menu,null,e.run("customizeTopicContextMenu",this.props))},t}(B),Fe=[{icon:"edit",label:"edit",shortcut:"Space",rootCanUse:!0,opType:s.OpType.START_EDITING_CONTENT},{icon:"add-sibling",label:"add sibling",shortcut:"Enter",opType:s.OpType.ADD_SIBLING},{icon:"add-child",label:"add child",shortcut:"Tab",rootCanUse:!0,opType:s.OpType.ADD_CHILD},{icon:"notes",label:"edit notes",shortcut:"Alt + D",rootCanUse:!0,opType:s.OpType.START_EDITING_DESC},{icon:"delete-node",label:"delete node",shortcut:"Del",opType:s.OpType.DELETE_TOPIC},{icon:"root",label:"set as editor root",shortcut:"Alt + Shift + F",opType:s.OpType.SET_EDITOR_ROOT}];var Be,We,ze=c()("node:topic-drop-effect"),Ge=i.default.svg(Be||(Be=S(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),He=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={content:null},t}return T(t,e),t.prototype.layout=function(){var e=this.props,t=this.props,n=t.getRef,r=t.model,i=t.zoomFactor,a=t.controller.run("getDragTargetProps",e),c=a.key,l=a.dropDir;if(ze("layout",l),null!==c){var s=n("in"===l?se(c):ge(c,l)),u=n("svg-drop-effect"),p=n(ve.DRAG_SCROLL_WIDGET_KEY).bigView,d=Le(s,p,i),f=Le(u,p,i),m=d.left-f.left-3,h=d.top-f.top-3,y=d.width+6,g=d.height+6;this.setState({content:Object(o.createElement)("g",null,Object(o.createElement)("rect",{x:m,y:h,width:y,height:g,fill:"none",stroke:r.config.theme.highlightColor,strokeDasharray:"5,5",strokeWidth:2}))})}else this.setState({content:null})},t.prototype.render=function(){var e=this.props.saveRef;return Object(o.createElement)(Ge,{ref:e("svg-drop-effect")},this.state.content)},t}(B),Ve=c()("plugin:drag-and-drop"),Ue=i.default.div(We||(We=S(["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"],["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"])),(function(e){return e.height+"px"}));function Ye(){var e=null,t=null;return{renderTopicDropArea:function(e){var t=e.topicKey,n=e.dropDir,r=e.saveRef,i=e.controller,a=e.model,c={onDragEnter:function(o){Ve("onDragEnter",t,n),i.run("handleTopicDragEnter",b(b({},e),{ev:o,dropDir:n}))},onDragLeave:function(o){Ve("onDragLeave",t,n),i.run("handleTopicDragLeave",b(b({},e),{ev:o,dropDir:n}))},onDragOver:function(e){e.preventDefault()},onDrop:function(o){Ve("onDrop",t,n),i.run("handleTopicDrop",b(b({},e),{ev:o,dropDir:n}))}};return Object(o.createElement)(Ue,b({height:a.config.theme.marginV/2,ref:r(ge(t,n))},c))},renderDragAndDropEffect:function(e){Ve("renderDragAndDropEffect");var t=e.saveRef;return Object(o.createElement)(He,b({ref:t(ve.DROP_EFFECT_KEY)},e))},getDragTargetProps:function(n){return{key:e,dropDir:t}},handleTopicDragStart:function(e){var t=e.controller;e.ev.stopPropagation(),t.run("operation",b(b({},e),{opType:s.OpType.FOCUS_TOPIC,focusMode:s.FocusMode.DRAGGING}))},canDrop:function(e){var t=e.srcKey,n=e.dstKey,o=e.model,r=e.dropDir;return t!==o.editorRootTopicKey&&t!==n&&Object(s.getRelationship)(o,t,n)!==s.TopicRelationship.ANCESTOR&&((n!==o.editorRootTopicKey||"in"===r)&&(o.getTopic(t).parentKey!==n||"in"!==r))},handleTopicDragEnter:function(n){var o=n.dropDir,r=n.topicKey,i=n.controller,a=n.model;Ve("handleTopicDragEnter:",r,o),i.run("canDrop",b(b({},n),{srcKey:a.focusKey,dstKey:r}))&&(e=r,t=o,i.change(a))},handleTopicDragLeave:function(n){var o=n.controller,r=n.model,i=n.topicKey,a=n.dropDir,c=n.getRef,l=n.ev.nativeEvent.relatedTarget;Ve("handleTopicDragLeave:",i,a);var s=c(se(i));s==l||s.contains(l)||(e=null,t=null,o.change(r))},handleTopicDrop:function(n){Ve("handleTopicDrop");var o=n.controller,r=n.topicKey,i=n.model;n=b(b({},n),{srcKey:i.focusKey,dstKey:r}),e=null,t=null,o.run("canDrop",n)&&o.run("operation",b(b({},n),{opType:s.OpType.DRAG_AND_DROP}))}}}var Ze,qe,Je,Xe,Qe,$e,et,tt,nt,ot,rt,it=Object(i.default)(ne)(Ze||(Ze=S(["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"],["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"]))),at=i.default.div(qe||(qe=S(["\n  max-width: 600px;\n"],["\n  max-width: 600px;\n"]))),ct=i.default.span(Je||(Je=S([""],[""]))),lt=function(e){function t(t){var n=e.call(this,t)||this;return n.setEditorRootTopicKey=function(e){return function(){var t=n.props,o=t.model,r=t.controller;o.editorRootTopicKey!==e&&r.change(s.ModelModifier.setEditorRootTopicKey({model:o,topicKey:e}))}},n.breadcrumbRenderer=function(e){var t=e.text,n=E(e,["text"]),r=t.length>8,i=r?t.substr(0,8)+"...":t,a={content:Object(o.createElement)(at,null,t),position:l.PopoverPosition.BOTTOM_RIGHT},c=Object(o.createElement)(l.Breadcrumb,b({},n),Object(o.createElement)(ct,null,i));return r?Object(o.createElement)(l.Tooltip,b({},a),c):c},n.state={show:!1},n}return T(t,e),t.prototype.render=function(){var e=this.props,t=e.model,n=e.controller,r=e.zIndex,i=t.editorRootTopicKey;if(i===t.rootTopicKey)return null;for(var a=[],c=t.getTopic(i);null!=c;){var s=n.getValue(be.TOPIC_TITLE,b(b({},e),{topicKey:c.key}));a.unshift({text:s,onClick:this.setEditorRootTopicKey(c.key)}),c=t.getTopic(c.parentKey)}var u={items:a,breadcrumbRenderer:this.breadcrumbRenderer};return Object(o.createElement)(it,{zIndex:r},Object(o.createElement)(l.Breadcrumbs,b({},u)))},t}(B),st=i.default.div(Xe||(Xe=S(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"],["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"]))),ut=i.default.div(Qe||(Qe=S(["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"],["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"])),(function(e){return e.theme.background})),pt=function(e){function t(t){var n=e.call(this,t)||this;return n.setZoomFactor=function(e){n.dragScrollWidget.setZoomFactor(e)},n.onWheel=function(e){if(e.altKey||e.ctrlKey){var t=n.props.controller,o=t.run("getZoomFactor",n.props);(o-=e.nativeEvent.deltaY>0?.1:-.1)<.5&&(o=.5),o>4&&(o=4),t.run("setZoomFactor",b(b({},n.props),{zoomFactor:o}))}},n}return T(t,e),t.prototype.renderHotkeys=function(){var e=this.props,t=e.controller,n=e.model,r=t.run("customizeHotKeys",e);if(null===r)return null;if(!(r.topicHotKeys instanceof Map&&r.globalHotKeys instanceof Map))throw new TypeError("topicHotKeys and globalHotKeys must be a Map");var i=[];return n.focusMode!==s.FocusMode.NORMAL&&n.focusMode!==s.FocusMode.SHOW_POPUP||r.topicHotKeys.forEach((function(e,t){i.push(Object(o.createElement)(l.Hotkey,b({key:t},e,{global:!0})))})),r.globalHotKeys.forEach((function(e,t){i.push(Object(o.createElement)(l.Hotkey,b({key:t},e,{global:!0})))})),Object(o.createElement)(l.Hotkeys,null,i)},t.prototype.componentDidMount=function(){var e=this.props,t=e.getRef,n=e.model;e.controller.run("addZoomFactorChangeEventListener",b(b({},this.props),{listener:this.setZoomFactor}));var o=t(fe(n.editorRootTopicKey)),r=t("node-layer"),i=o.getBoundingClientRect(),a=r.getBoundingClientRect();this.dragScrollWidget.setViewBoxScrollDelta(0,i.top-a.top-this.dragScrollWidget.viewBox.getBoundingClientRect().height/2+i.height),this.layout()},t.prototype.componentWillUnmount=function(){this.props.controller.run("removeZoomFactorChangeEventListener",b(b({},this.props),{listener:this.setZoomFactor}))},Object.defineProperty(t.prototype,"dragScrollWidget",{get:function(){return this.props.getRef(ve.DRAG_SCROLL_WIDGET_KEY)},enumerable:!0,configurable:!0}),t.prototype.componentDidUpdate=function(){this.props.controller.run("fireEvent",b(b({},this.props),{key:Te.CENTER_ROOT_TOPIC})),this.layout()},t.prototype.layout=function(){this.props.controller.run("layout",this.props)},t.prototype.render=function(){var e=this,t=this.props,n=t.saveRef,r=t.model,i=t.controller,a=r.editorRootTopicKey;return Object(o.createElement)(ut,{onWheel:this.onWheel},Object(o.createElement)(H,b({},this.state,{enableMouseWheel:!1,zoomFactor:r.zoomFactor,ref:n(ve.DRAG_SCROLL_WIDGET_KEY)}),(function(t,r){var c=b(b({},e.props),{topicKey:a,setViewBoxScroll:t,setViewBoxScrollDelta:r});return Object(o.createElement)(st,{ref:n("node-layer")},i.run("renderRootWidget",c))})))},t=O([l.HotkeysTarget],t)}(o.Component),dt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClose=function(){var e=t.props.controller.run("handleActiveModalClose",t.props);e&&e()},t}return T(t,e),t.prototype.render=function(){var e=this.props.controller,t=e.run("renderModal",this.props),n=e.run("getActiveModalProps",this.props);return Object(o.createElement)(l.Dialog,{onClose:this.handleClose,isOpen:null!==t,autoFocus:!0,enforceFocus:!0,usePortal:!0,title:n&&n.title,style:n&&n.style},Object(o.createElement)("div",{className:l.Classes.DIALOG_BODY,style:{minHeight:0}},t))},t}(B),ft=i.default.svg($e||($e=S(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),mt=c()("node:root-sub-links"),ht=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={curves:[]},t}return T(t,e),t.prototype.layout=function(){var e,t,n=this.props,r=n.model,i=n.getRef,a=n.topicKey,c=n.zoomFactor,l=n.controller,s=r.getTopic(a),u=i(se(a)),p=i(he(a)),d=i(ve.DRAG_SCROLL_WIDGET_KEY).bigView,f=Le(u,d,c),m=Le(p,d,c);e={x:De(f)-m.left,y:we(f)-m.top};var h=[];s.subKeys.forEach((function(r){var a,s=l.run("getLinkStyle",b(b({},n),{topicKey:r})),u=s.lineType,p=Le(i(se(r)),d,c);if(t={x:(t=p.left>f.right?{x:p.left,y:we(p)}:{x:p.right,y:we(p)}).x-m.left,y:t.y-m.top},"curve"===u)a="M "+e.x+" "+e.y+" C "+e.x+" "+je(e,t)+" "+_e(e,t)+" "+t.y+" "+t.x+" "+t.y;else if("line"===u)a="M "+e.x+" "+e.y+" L "+t.x+" "+t.y;else if("round"===u){var y=t.y>e.y?1:-1,g=t.x>e.x?1:-1,v=s.lineRadius;if(null==v)throw new Error("link line type is round, but lineRadius is not provided!");a=t.y===e.y?"M "+e.x+" "+e.y+" H "+t.x:"M "+e.x+" "+e.y+"  V "+(t.y-y*v)+" A "+v+" "+v+" 0 0 "+(y*g===1?0:1)+" "+(e.x+v*g)+" "+t.y+" H "+t.x}h.push(Object(o.createElement)("path",{key:"link-"+r,d:a,strokeWidth:s.lineWidth,stroke:s.lineColor,fill:"none"}))})),this.setState({curves:h})},t.prototype.render=function(){mt("render");var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(ft,{ref:n(he(t))},Object(o.createElement)("g",null,this.state.curves))},t}(B),yt=c()("RootNode"),gt=i.default.div(et||(et=S(["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"],["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"])),(function(e){return e.topicDirection===s.TopicDirection.LEFT?"flex-end":"flex-start"}),(function(e){return e.topicDirection===s.TopicDirection.LEFT?"15px 60px 15px 0px":"15px 0px 15px 60px"})),vt=i.default.div(tt||(tt=S(["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"],["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"]))),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.renderPartTopics=function(e,t){var n=this.props,r=n.controller,i=n.saveRef,a=r.run("createSubTopics",b(b({},this.props),{dir:t,isRoot:!0,topics:e}));if(!a)return null;var c=a.subTopics,l="bm-layer-"+(t===s.TopicDirection.LEFT?"left":"right");return Object(o.createElement)(gt,{topicDirection:t,ref:i(l)},c)},t.prototype.render=function(){yt("render");var e=this.props,t=e.model,n=e.topicKey,r=e.saveRef,i=e.controller,a=i.run("getTopicContentStyle",e),c=t.config,l=i.run("renderTopicContent",b(b({},e),{topicStyle:a,dir:s.TopicDirection.MAIN})),u=i.run("getPartTopics",{layout:c.layoutDir,model:t,topicKey:n}),p=Object(o.createElement)(vt,{ref:r(fe(n))},l),d=i.run("renderRootWidgetOtherChildren",e);switch(c.layoutDir){case s.DiagramLayoutType.LEFT_AND_RIGHT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),p,this.renderPartTopics(u.R,"R"),d);case s.DiagramLayoutType.LEFT_TO_RIGHT:return Object(o.createElement)(o.Fragment,null,p,this.renderPartTopics(u.R,"R"),d);case s.DiagramLayoutType.RIGHT_TO_LEFT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),p,d);case s.DiagramLayoutType.TOP_TO_BOTTOM:return Object(o.createElement)(o.Fragment,null,p,this.renderPartTopics(u.B,"B"),d)}return null},t}(o.Component),bt=i.default.div(rt||(rt=S(["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"],["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"])),(function(e){var t=e.dir;return t===s.TopicDirection.RIGHT?Object(i.css)(nt||(nt=S(["\n        right: -25px;\n      "],["\n        right: -25px;\n      "]))):t===s.TopicDirection.LEFT?Object(i.css)(ot||(ot=S(["\n        left: -25px;\n      "],["\n        left: -25px;\n      "]))):void 0}),(function(e){return e.background}));function Et(e){var t,n=e.model,r=e.topicKey,i=e.topicStyle,a=e.dir,c=e.saveRef,l=e.onClickCollapse,s=n.getTopic(r);return s.subKeys.size>0?Object(o.createElement)(bt,{ref:c(ye(r)),onClick:l,background:i.background,dir:a,className:m()((t={icon:!0,iconfont:!0},t["bm-"+(s.collapse?"plus":"minus")]=!0,t))}):null}var Ot,kt,xt=c()("node:topic-content2"),Ct=i.default.div(Ot||(Ot=S(["\n  position: relative;\n"],["\n  position: relative;\n"]))),St=i.default.div(kt||(kt=S(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"],["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"]))),wt=function(e){xt("cancelEvent"),e.preventDefault(),e.stopPropagation()};function Dt(e){var t,n=e.controller,i=e.model,a=e.topicKey,c=e.getRef,l=i.editingContentKey!==a,s=n.run("renderTopicContentEditor",b(b({},e),{readOnly:l}));if(l)t=s;else{var u,p={width:50,height:40},d=c("content-editor-"+a);d&&(p=d.getBoundingClientRect());var f=new r.default((function(e,t){var n=e[0].contentRect;u.style.left=(p.width-n.width)/2+"px",u.style.top=(p.height-n.height)/2+"px"}));xt(p),t=Object(o.createElement)(o.Fragment,null,Object(o.createElement)("div",{style:{width:p.width,height:p.height}}),Object(o.createElement)(St,{ref:function(e){e&&(u=e,f.observe(u))}},s))}return Object(o.createElement)(Ct,{onDragEnter:wt,onDragOver:wt},t)}var _t,jt,Rt,Lt=c()("node:topic-content-widget"),It=i.default.div(_t||(_t=S(["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"],["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"]))),Pt=i.default.div(jt||(jt=S(["\n  position: relative;\n"],["\n  position: relative;\n"]))),Mt=function(e){function t(t){var n=e.call(this,t)||this;return n.onDragStart=function(e){n.run("handleTopicDragStart",b(b({},n.props),{ev:e}))},n.onDragOver=function(e){e.preventDefault()},n.onDragEnter=function(e){Lt("onDragEnter",n.props.topicKey),n.run("handleTopicDragEnter",b(b({},n.props),{ev:e,dropDir:"in"}))},n.onDragLeave=function(e){n.run("handleTopicDragLeave",b(b({},n.props),{ev:e,dropDir:"in"}))},n.onDrop=function(e){Lt("onDrop"),n.run("handleTopicDrop",b(b({},n.props),{ev:e,dropDir:"in"}))},n.onClick=function(e){var t=n.props.controller;n.handleTopicClickTimeout=setTimeout((function(){t.run("handleTopicClick",b(b({},n.props),{ev:e}))}),200)},n.onDoubleClick=function(e){clearTimeout(n.handleTopicClickTimeout),n.props.controller.run("handleTopicDoubleClick",b(b({},n.props),{ev:e}))},n.needRelocation=!1,n.onClickCollapse=function(e){e.stopPropagation();var t=n.props,o=t.topicKey,r=t.getRef;n.needRelocation=!0;var i=r(ye(o)).getBoundingClientRect();Lt("oldRect",i),n.oldCollapseIconVector=[i.left+i.width/2,i.top+i.height/2],Lt("oldCollapseIconVector",n.oldCollapseIconVector),n.operation(s.OpType.TOGGLE_COLLAPSE,n.props)},n.state={dragEnter:!1},n}return T(t,e),t.prototype.renderContextMenu=function(){var e=this.props.controller;if(e.getValue(be.TOPIC_CONTEXT_MENU_ENABLED,b({},this.props)))return this.operation(s.OpType.FOCUS_TOPIC,b(b({},this.props),{focusMode:s.FocusMode.SHOW_POPUP})),e.run("renderTopicContextMenu",this.props)},t.prototype.onContextMenuClose=function(){},t.prototype.componentDidUpdate=function(){if(this.needRelocation){var e=this.props,t=e.getRef,n=e.topicKey,o=e.setViewBoxScrollDelta,r=t(ye(n)).getBoundingClientRect(),i=[r.left+r.width/2,r.top+r.height/2];Lt("newVector:",i),Lt("oldVector:",this.oldCollapseIconVector);var a=[i[0]-this.oldCollapseIconVector[0],i[1]-this.oldCollapseIconVector[1]];Lt("vector",a),o(a[0],a[1]),this.needRelocation=!1}},t.prototype.render=function(){var e=this.props,t=e.saveRef,n=e.topicKey,r=e.model,i=e.controller,a=e.topicStyle,c=e.dir;Lt("render",n,r.focusMode);var l=i.run("isOperationEnabled",e)&&r.editingContentKey!==n,u=i.run("renderTopicCollapseIcon",b(b({},e),{onClickCollapse:this.onClickCollapse.bind(this)})),p=i.run("renderTopicDropArea",b(b({},e),{dropDir:"prev"})),d=i.run("renderTopicDropArea",b(b({},e),{dropDir:"next"})),f={onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop};return Object(o.createElement)(Pt,null,p,Object(o.createElement)(It,b({style:a,draggable:l,ref:t(se(n)),onDragStart:this.onDragStart,onClick:this.onClick,onDoubleClick:this.onDoubleClick},f),i.run("renderTopicBlocks",e),i.run("renderTopicContentOthers",e)),d,c!==s.TopicDirection.MAIN&&u)},t=O([l.ContextMenuTarget],t)}(B),Kt=c()("node:topic-desc"),Nt=i.default.div(Rt||(Rt=S(["\n  overflow: auto;\n"],["\n  overflow: auto;\n"])));function At(e){var t=e.controller,n=e.model,r=e.topicKey,i=e.getRef,a=n.editingDescKey===r;Kt("isEditing",a);var c=n.getTopic(r).getBlock(s.BlockType.DESC);if(!a&&t.run("isBlockEmpty",b(b({},e),{block:c.block})))return null;var u=t.run("renderTopicDescEditor",e),p=i(ve.DIAGRAM_ROOT_KEY),d={maxWidth:"800px",maxHeight:"600px"};if(p){var f=p.getBoundingClientRect();d.maxWidth=.6*f.width+"px",d.maxHeight=.8*f.height+"px"}var m={autoFocus:!1,content:Object(o.createElement)(Nt,{onClick:Ee,classname:l.Classes.POPOVER_DISMISS,style:d},u),target:Object(o.createElement)(te,{onClick:function(n){n.stopPropagation(),t.run("operation",b(b({},e),{opType:s.OpType.START_EDITING_DESC}))},className:ce(ae.NOTES),tabIndex:-1}),interactionKind:l.PopoverInteractionKind.HOVER,hoverOpenDelay:500};return c.block&&Object(o.createElement)(l.Popover,b({},m))}var Ft,Bt,Wt,zt,Gt,Ht,Vt,Ut,Yt,Zt=i.default.svg(Ft||(Ft=S(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),qt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={content:null},t}return T(t,e),t.prototype.layout=function(){var e=this.props,t=e.getRef,n=e.model,r=e.zoomFactor,i=n.focusKey,a=n.focusMode;if(i&&a!==s.FocusMode.EDITING_CONTENT){var c=t(se(i)),l=t(ve.DRAG_SCROLL_WIDGET_KEY).bigView,u=t(ve.SVG_HIGHLIGHT_KEY),p=Le(c,l,r),d=Le(u,l,r),f=p.left-d.left-3,m=p.top-d.top-3,h=p.width+6,y=p.height+6;this.setState({content:Object(o.createElement)("rect",{x:f,y:m,width:h,height:y,fill:"none",stroke:n.config.theme.highlightColor,strokeWidth:2})})}else this.setState({content:null})},t.prototype.render=function(){var e=this.props.saveRef;return Object(o.createElement)(Zt,{ref:e(ve.SVG_HIGHLIGHT_KEY)},this.state.content)},t}(B),Jt=i.default.svg(Bt||(Bt=S(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),Xt=c()("node:topic-sub-links"),Qt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={curves:[]},t}return T(t,e),t.prototype.layout=function(){var e,t,n,r=this.props,i=r.model,a=r.getRef,c=r.topicKey,l=r.dir,u=r.controller,p=u.run("getZoomFactor",r),d=i.getTopic(c),f=a(se(c)),m=a(he(c)),h=a(ye(c)),y=a(ve.DRAG_SCROLL_WIDGET_KEY).bigView,g=Le(m,y,p),v=Le(h,y,p),T=Le(f,y,p);Xt(c),Xt("svgRect",g),Xt("collapseRect",v),Xt("contentRect",T),l===s.TopicDirection.RIGHT?(e={x:0,y:we(T)-g.top},t={x:v.right-g.left+10,y:e.y}):l===s.TopicDirection.LEFT&&(e={x:g.right-g.left,y:we(T)-g.top},t={x:v.left-g.left-10,y:e.y});var E=[];d.subKeys.forEach((function(i){var c,f=u.run("getLinkStyle",b(b({},r),{topicKey:i})),m=a(se(i));if(m){var h=Le(m,y,p);l===s.TopicDirection.RIGHT&&(n={x:h.left-g.left,y:we(h)-g.top}),l===s.TopicDirection.LEFT&&(n={x:h.right-g.left,y:we(h)-g.top});var v=f.lineType;if("curve"===v)c="M "+e.x+" "+e.y+" L "+t.x+" "+t.y+" C "+t.x+" "+je(t,n)+" "+_e(t,n)+" "+n.y+" "+n.x+" "+n.y;else if("round"===v){var T=n.y>e.y?1:-1,O=n.x>e.x?1:-1,k=f.lineRadius;c=1===d.subKeys.size||Math.abs(n.y-e.y)<=1?"M "+e.x+" "+e.y+" L "+n.x+" "+n.y:"M "+e.x+" "+e.y+" H "+t.x+" V "+(n.y-T*k)+" A "+k+" "+k+" 0 0 "+(T*O===1?0:1)+" "+(t.x+k*O)+" "+n.y+" H "+n.x}else"line"===v&&(c="M "+e.x+" "+e.y+" H "+t.x+" L "+n.x+" "+n.y);E.push(Object(o.createElement)("path",{key:"link-"+i,d:c,strokeWidth:f.lineWidth,stroke:f.lineColor,fill:"none"}))}})),this.setState({curves:E})},t.prototype.render=function(){var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(Jt,{ref:n(he(t))},Object(o.createElement)("g",null,this.state.curves))},t}(B),$t=c()("node:topic-widget"),en=i.default.div(Wt||(Wt=S(["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"],["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===s.TopicDirection.RIGHT?"row":"row-reverse"})),tn=i.default.div(zt||(zt=S(["\n  position: relative;\n  padding: ",";\n"],["\n  position: relative;\n  padding: ",";\n"])),(function(e){return e.dir===s.TopicDirection.RIGHT?"0 0 0 "+e.marginH+"px":"0 "+e.marginH+"px 0 0"})),nn=i.default.div(Gt||(Gt=S(["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"],["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===s.TopicDirection.RIGHT?"row":"row-reverse"})),on=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.renderSubTopics=function(){var e=this.props,t=e.controller,n=e.model,r=e.topicKey,i=e.dir,a=n.getTopic(r).subKeys.toArray(),c=t.run("createSubTopics",b(b({},e),{topics:a}));if(!c)return null;var l=c.subTopics,s=t.run("renderSubLinks",e);return Object(o.createElement)(tn,{dir:i,marginH:n.config.theme.marginH},l," ",s)},t.prototype.layoutLinks=function(){var e=this.props,t=e.getRef,n=e.topicKey,o=e.model.getTopic(n);if(0!==o.subKeys.size&&!o.collapse){$t("layoutLinks",n);var r=t(me(n));r&&r.layout()}},t.prototype.render=function(){var e=this.props,t=e.controller,n=e.topicKey,r=e.dir,i=e.saveRef;$t("render",n);var a=t.run("getTopicContentStyle",e),c=b(b({},e),{topicStyle:a}),l=t.run("renderTopicContent",c);return Object(o.createElement)(en,{topicDirection:r},Object(o.createElement)(nn,{topicDirection:r,ref:i(fe(n))},l),this.renderSubTopics())},t}(o.Component),rn=c()("node:view-port-viewer"),an=Object(i.default)(ne)(Ht||(Ht=S(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"]))),cn=Object(i.default)(X)(Vt||(Vt=S(["\n  margin: 10px;\n"],["\n  margin: 10px;\n"]))),ln=i.default.span(Ut||(Ut=S(["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"],["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"]))),sn=function(e){return Object(o.createElement)(l.Tooltip,{content:e.tooltip,position:l.Position.TOP,className:l.Classes.ICON},Object(o.createElement)(cn,{onClick:e.onClick,tabIndex:-1},e.children))},un=function(e){function t(t){var n=e.call(this,t)||this;return n.zoomFactorChange=function(e){rn("zoomFactorChange",e),n.setState({zoomFactor:e})},n.onClickResetZoom=function(e){var t=n.props;t.controller.run("setZoomFactor",b(b({},t),{zoomFactor:1}))},n.onClickAddZoom=function(e){var t=n.props,o=t.controller,r=o.run("getZoomFactor",t);o.run("setZoomFactor",b(b({},t),{zoomFactor:r+.1}))},n.onClickMinusZoom=function(e){var t=n.props,o=t.controller,r=o.run("getZoomFactor",t);o.run("setZoomFactor",b(b({},t),{zoomFactor:r-.1}))},n.onClickCollapseAll=function(e){var t=n.props,o=t.controller;o.run("addEventListener",b(b({},t),{key:Te.CENTER_ROOT_TOPIC,listener:n.centerRootTopic,once:!0})),o.run("operation",b(b({},t),{opType:s.OpType.COLLAPSE_ALL}))},n.onClickExpandAll=function(e){var t=n.props,o=t.controller;o.run("addEventListener",b(b({},t),{key:Te.CENTER_ROOT_TOPIC,listener:n.centerRootTopic,once:!0})),o.run("operation",b(b({},t),{opType:s.OpType.EXPAND_ALL}))},n.centerRootTopic=function(){var e=n.props,t=e.model;e.controller.run("moveTopicToCenter",b(b({},n.props),{topicKey:t.editorRootTopicKey}))},n}return T(t,e),t.prototype.componentDidMount=function(){var e=this.props;e.controller.run("addZoomFactorChangeEventListener",b(b({},e),{listener:this.zoomFactorChange}))},t.prototype.componentWillUnmount=function(){var e=this.props;e.controller.run("removeZoomFactorChangeEventListener",b(b({},e),{listener:this.zoomFactorChange}))},t.prototype.render=function(){rn("render");var e=this.props,t=e.controller,n=e.zIndex,r=t.run("getZoomFactor",e);return Object(o.createElement)(an,{zIndex:n},Object(o.createElement)(sn,{onClick:this.onClickCollapseAll,tooltip:"collapse all"},le(ae.COLLAPSE_ALL)),Object(o.createElement)(sn,{onClick:this.onClickExpandAll,tooltip:"expand all"},le(ae.EXPAND_ALL)),Object(o.createElement)(sn,{onClick:this.centerRootTopic,tooltip:"center root topic"},le(ae.CENTER)),Object(o.createElement)(sn,{onClick:this.onClickMinusZoom,tooltip:"zoom in"},le(ae.MINUS)),Object(o.createElement)(sn,{onClick:this.onClickResetZoom,tooltip:"reset zoom"},Object(o.createElement)(ln,null,"zoom:"+Math.floor(100*r)+"%")),Object(o.createElement)(sn,{onClick:this.onClickAddZoom,tooltip:"zoom out"},le(ae.PLUS)))},t}(B),pn=i.default.div(Yt||(Yt=S(["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"],["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"])));function dn(e){var t=e.controller,n=e.model,r=e.topicKey;if(n.focusMode===s.FocusMode.EDITING_DESC){var i=t.run("renderTopicDescEditor",e);return Object(o.createElement)(l.Drawer,{key:"drawer",title:"Edit Notes",icon:le("note"),isOpen:!0,hasBackdrop:!0,backdropProps:{onMouseDown:Ee},isCloseButtonShown:!1,onClose:function(n){n.stopPropagation();var o="topic-desc-data-"+r,i=t.run("deleteTempValue",{key:o});t.run("operation",b(b({},e),{opType:s.OpType.SET_TOPIC_BLOCK,topicKey:r,blockType:s.BlockType.DESC,data:i,focusMode:s.FocusMode.NORMAL}))},size:"70%"},Object(o.createElement)(pn,null,i))}}function fn(e){var t=e.theme,n=e.children;return Object(o.createElement)(i.ThemeProvider,{theme:t},Object(o.createElement)(o.Fragment,null,n))}var mn,hn=c()("plugin:rendering");function yn(){var e,t=i.default.div(mn||(mn=S(["\n    width: 100%;\n    height: 100%;\n    background: ",";\n    position: relative;\n  "],["\n    width: 100%;\n    height: 100%;\n    background: ",";\n    position: relative;\n  "])),(function(e){return e.theme.background}));return{getDiagramProps:function(){return e},renderDiagram:function(n){var r=n.model,i=n.controller;return Object(o.createElement)(U,null,(function(a,c,l){return e=b(b({},n),{saveRef:a,getRef:c,deleteRef:l}),hn("renderDiagram",r),Object(o.createElement)(fn,{theme:r.config.theme},Object(o.createElement)(t,{ref:a(ve.DIAGRAM_ROOT_KEY)},Object(o.createElement)(pt,b({},e)),i.run("renderDiagramCustomize",e)))}))},renderDrawer:dn,renderDiagramCustomize:function(e){var t=e.controller,n=e.model,o=t.getValue(be.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX),r=b(b({},e),{zIndex:o,topicKey:n.focusKey});return[t.run("renderEditorRootBreadcrumbs",r),t.run("renderRightTopPanel",r),t.run("renderModals",b(b({},r),{zIndex:o+1})),t.run("renderDrawer",b(b({},r),{zIndex:o+1})),t.run("renderViewPortViewer",r)]},renderEditorRootBreadcrumbs:function(e){return Object(o.createElement)(lt,b({key:"EditorRootBreadcrumbs"},e))},renderModals:function(e){return Object(o.createElement)(dt,b({key:"modals"},e))},renderModal:function(e){return null},getActiveModalProps:function(e){return null},renderDoc:function(e){return e.children},renderRootWidget:function(e){return Object(o.createElement)(Tt,b({},e))},renderTopicWidget:function(e){return Object(o.createElement)(on,b({},e))},renderTopicContent:function(e){return Object(o.createElement)(Mt,b({},e))},renderTopicCollapseIcon:function(e){return Object(o.createElement)(Et,b({},e))},renderTopicContentOthers:function(e){return[]},renderTopicBlocks:function(e){var t=e.model,n=e.topicKey,r=e.controller,i=t.getTopic(n).blocks,a=[],c=0;return i.forEach((function(t){var n=r.run("renderTopicBlock",b(b({},e),{block:t,blockKey:"block-"+c}));n&&(a.push(Object(o.createElement)(o.Fragment,{key:"block-"+c},n)),c++)})),a},renderTopicBlock:function(e){var t=e.controller;switch(e.block.type){case s.BlockType.CONTENT:return t.run("renderTopicBlockContent",e);case s.BlockType.DESC:return t.run("renderTopicBlockDesc",e)}return null},renderTopicBlockContent:function(e){return Object(o.createElement)(Dt,b({},e))},renderTopicBlockDesc:function(e){return Object(o.createElement)(At,b({},e))},renderSubLinks:function(e){var t=e.saveRef,n=e.topicKey,r=e.model.getTopic(n);return 0===r.subKeys.size||r.collapse?null:Object(o.createElement)(Qt,b({ref:t(me(n))},e))},renderRootSubLinks:function(e){var t=e.saveRef,n=e.topicKey;return Object(o.createElement)(ht,b({ref:t(me(n))},e))},renderFocusItemHighlight:function(e){var t=e.saveRef;return Object(o.createElement)(qt,b({ref:t(ve.FOCUS_HIGHLIGHT_KEY)},e))},renderRootWidgetOtherChildren:function(e){var t=e.controller,n=t.run("getZoomFactor",e);return e=b(b({},e),{zoomFactor:n}),Object(o.createElement)(o.Fragment,null,t.run("renderRootSubLinks",e),t.run("renderFocusItemHighlight",e),t.run("renderDragAndDropEffect",e))},renderViewPortViewer:function(e){return Object(o.createElement)(un,b({key:"view-port-viewer"},e))}}}var gn,vn,Tn=Object(i.default)(ne)(gn||(gn=S(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"]))),bn=Object(i.default)(l.Tabs)(vn||(vn=S(["\n  padding: 0px 10px;\n"],["\n  padding: 0px 10px;\n"])));function En(e){var t=e.controller,n=e.zIndex,r=e.selectedTabId,i=e.handleTabIdChange,a=x(Object(o.useState)(!1),2),c=a[0],l=a[1];return c?Object(o.createElement)(Tn,{zIndex:n},Object(o.createElement)(ee,null,Object(o.createElement)($,{className:ce(ae.CLOSE),onClick:function(){return l(!1)}})),Object(o.createElement)(bn,{id:r,onChange:i},t.run("renderRightTopPanelTabs",e))):Object(o.createElement)(Tn,{zIndex:n},Object(o.createElement)(J,{onClick:function(){return l(!0)}},Object(o.createElement)(q,{className:ce(ae.SHOW_MENU)})))}var On,kn,xn,Cn,Sn,wn,Dn,_n=i.default.div(On||(On=S(["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"],["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"]))),jn=i.default.span(kn||(kn=S(["\n  margin: 0px 10px 0px 0px;\n"],["\n  margin: 0px 10px 0px 0px;\n"]))),Rn=i.default.div(xn||(xn=S(["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"],["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"]))),Ln=Object(i.default)(jn)(Cn||(Cn=S([""],[""]))),In=i.default.div(Sn||(Sn=S(["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"],["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"]))),Pn=i.default.div(wn||(wn=S(["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"],["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"])),(function(e){return e.color})),Mn=i.default.div(Dn||(Dn=S(["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"],["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"])));function Kn(e){return Object(o.createElement)("div",null,e.children,Object(o.createElement)(l.Divider,{style:{margin:"10px 0"}}))}function Nn(e){var t=e.color,n=e.handleColorChange;return Object(o.createElement)(jn,null,Object(o.createElement)(l.Popover,null,Object(o.createElement)(Mn,null,Object(o.createElement)("div",{className:ce(ae.COLOR_PICKER)}),Object(o.createElement)(Pn,{color:t})),Object(o.createElement)("div",null,Object(o.createElement)(y.SketchPicker,{color:t,onChangeComplete:function(e){return n(e.hex)}}))))}function An(e){var t=e.title,n=e.handleClick;return Object(o.createElement)(jn,null,Object(o.createElement)(l.Button,{onClick:n},t))}function Fn(e){var t=e.layout,n=void 0===t?"h":t,r=e.title,i=E(e,["layout","title"]),a={flexDirection:"h"===n?"row":"column",alignItems:"center"};return Object(o.createElement)(jn,null,Object(o.createElement)(Y,b({},a),Object(o.createElement)(Z,{margin:"0 5px 0 0"},r),Object(o.createElement)(l.NumericInput,b({},i))))}function Bn(e){var t=e.text,n=e.items,r=e.itemRenderer,i=e.onItemSelect,a=h.a.ofType(),c={items:n,itemRenderer:r,onItemSelect:i,filterable:!1};return Object(o.createElement)(jn,null,Object(o.createElement)(a,b({},c),Object(o.createElement)(l.Button,{text:t})))}var Wn=function(e){return function(t,n){var r=n.handleClick;return Object(o.createElement)(l.MenuItem,{text:""+t+e,key:t,onClick:r})}},zn=(h.a.ofType(),C(Array(7).keys())),Gn=C(Array(7).keys()),Hn=[0,5,10,15,20,25,30,35],Vn=["none","solid","dotted","dashed","double"];function Un(e){var t=e.contentStyle,n=e.setContentStyle;return Object(o.createElement)(Kn,null,Object(o.createElement)(_n,null,"Border"),Object(o.createElement)("div",null,Object(o.createElement)(Bn,{text:"width: "+(t.borderWidth?t.borderWidth:"0px"),items:Gn,itemRenderer:Wn("px"),onItemSelect:function(e){n({borderWidth:e+"px"})}}),Object(o.createElement)(Bn,{text:"style: "+(t.borderStyle?t.borderStyle:"none"),items:Vn,itemRenderer:Wn(""),onItemSelect:function(e){n({borderStyle:e})}}),Object(o.createElement)(Bn,{text:"radius: "+t.borderRadius,items:Hn,itemRenderer:Wn("px"),onItemSelect:function(e){n({borderRadius:e+"px"})}}),Object(o.createElement)(Nn,{color:t.borderColor,handleColorChange:function(e){n({borderColor:e})}})))}var Yn=["curve","round","line"],Zn=function(e,t){var n=t.handleClick;t.modifiers,t.query;return Object(o.createElement)(l.MenuItem,{text:""+e,key:e,onClick:n})};function qn(e){var t=e.showLinkStyle,n=void 0===t||t,r=e.showSubLinkStyle,i=void 0===r||r,a=e.linkStyle,c=void 0===a?{}:a,l=e.subLinkStyle,s=void 0===l?{}:l,u=e.setLinkStyle,p=e.setSubLinkStyle;return Object(o.createElement)(Kn,null,Object(o.createElement)(_n,null,"Link"),n&&Object(o.createElement)(In,{alignItems:"center"},Object(o.createElement)(Z,{margin:"0 5px 0 0"},"LinkToParent: "),Object(o.createElement)(Bn,{text:"width: "+(c?c.lineWidth:"0px"),items:zn,itemRenderer:Wn("px"),onItemSelect:function(e){u({lineWidth:e+"px"})}}),Object(o.createElement)(Bn,{text:"lineType: "+c.lineType,items:Yn,itemRenderer:Zn,onItemSelect:function(e){u({lineType:e})}}),Object(o.createElement)(Nn,{color:c.lineColor,handleColorChange:function(e){u({lineColor:e})}})),i&&Object(o.createElement)(In,{alignItems:"center"},Object(o.createElement)(Z,{margin:"0 5px 0 0"},"SubLinks: "),Object(o.createElement)(Bn,{text:"width: "+(s?s.lineWidth:"0px"),items:zn,itemRenderer:Wn("px"),onItemSelect:function(e){p({lineWidth:e+"px"})}}),Object(o.createElement)(Bn,{text:"lineType: "+s.lineType,items:Yn,itemRenderer:Zn,onItemSelect:function(e){p({lineType:e})}}),Object(o.createElement)(Nn,{color:s.lineColor,handleColorChange:function(e){p({lineColor:e})}})))}function Jn(e){var t=e.contentStyle,n=e.setContentStyle,r={title:"FontSize:",min:12,max:100,value:parseInt(t.fontSize),style:{width:50},onValueChange:function(e){n({fontSize:e})}},i={style:{width:50},value:t.lineHeight||"",onChange:function(e){n({lineHeight:e.target.value})}};return Object(o.createElement)(Kn,null,Object(o.createElement)(_n,null,"Text Editor"),Object(o.createElement)(Y,null,Object(o.createElement)(Fn,b({},r)),Object(o.createElement)(jn,null,Object(o.createElement)(Y,{alignItems:"center"},Object(o.createElement)(Z,{margin:"0 5px 0 0"},"LineHeight: "),Object(o.createElement)(l.InputGroup,b({},i)))),Object(o.createElement)(Nn,{color:t.color,handleColorChange:function(e){n({color:e})}})))}var Xn,Qn=c()("node:style-editor");function $n(e){var t=e.controller,n=e.model,r=e.topicKey,i=n.getTopic(r),a=function(n){t.run("setTopicContentStyle",b(b({},e),{style:n}))};if(!n.focusKey)return null;var c=t.run("getTopicContentStyle",e),u={linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e),setLinkStyle:function(n){t.run("setLinkStyle",b(b({},e),{linkStyle:n}))},setSubLinkStyle:function(n){t.run("setSubLinkStyle",b(b({},e),{subLinkStyle:n}))}},p={contentStyle:c,setContentStyle:a};return Object(o.createElement)(oe,null,Object(o.createElement)(Un,b({},p)),Object(o.createElement)(Jn,b({},p)),Object(o.createElement)(Kn,null,Object(o.createElement)(_n,null,"Background"),Object(o.createElement)(Nn,{color:c.background,handleColorChange:function(e){a({background:e})}})),Object(o.createElement)(qn,b({},u)),Object(o.createElement)(Kn,null,Object(o.createElement)(An,{title:"Clear Topic Style",handleClick:function(){i.style&&t.run("operation",b(b({},e),{opType:s.OpType.SET_STYLE,style:null}))}}),Object(o.createElement)(An,{title:"Copy Style",handleClick:function(){Xn=t.run("getTopicStyle",e),Qn(Xn)}}),Object(o.createElement)(An,{title:"Paste Style",handleClick:function(){Xn&&t.run("operation",b(b({},e),{opType:s.OpType.SET_STYLE,style:JSON.stringify(Xn)}))}})),function(e){var t=e.controller;return Object(o.createElement)(Kn,null,Object(o.createElement)(jn,null,Object(o.createElement)(l.Button,{onClick:function(n){t.run("clearAllCustomStyle",e)}},"Clear All Custom Styles")))}(e))}var eo=n(314);function to(e){var t=e.contentStyle,n=e.setContentStyle,r=eo("padding",t.padding||"0"),i={layout:"v",min:0,max:99,style:{width:38}},a=parseInt(r["padding-top"]),c=parseInt(r["padding-right"]),l=parseInt(r["padding-bottom"]),s=parseInt(r["padding-left"]),u={top:a,right:c,bottom:l,left:s},p=function(e){return function(t){var o;n({padding:Ce(b(b({},u),(o={},o[e]=t,o)))})}},d=b(b({},i),{title:"top",value:a,onValueChange:p("top")}),f=b(b({},i),{title:"right",value:c,onValueChange:p("right")}),m=b(b({},i),{title:"bottom",value:l,onValueChange:p("bottom")}),h=b(b({},i),{title:"left",value:s,onValueChange:p("left")});return Object(o.createElement)(Kn,null,Object(o.createElement)(_n,null,"Padding"),Object(o.createElement)(In,null,Object(o.createElement)(Fn,b({},d)),Object(o.createElement)(Fn,b({},f)),Object(o.createElement)(Fn,b({},m)),Object(o.createElement)(Fn,b({},h))))}var no,oo=i.default.div(no||(no=S(["\n  height: 250px;\n  overflow: auto;\n"],["\n  height: 250px;\n  overflow: auto;\n"])));function ro(e){var t=e.topicStyle,n=e.setTopicStyle,r=t.contentStyle,i=void 0===r?{}:r,a=t.linkStyle,c=void 0===a?{}:a,l=t.subLinkStyle,s=function(e){n({contentStyle:e})},u={contentStyle:i,setContentStyle:s},p={showLinkStyle:!1,linkStyle:c,subLinkStyle:void 0===l?{}:l,setLinkStyle:function(e){n({linkStyle:e})},setSubLinkStyle:function(e){n({subLinkStyle:e})}};return Object(o.createElement)(oo,null,Object(o.createElement)(Un,b({},u)),Object(o.createElement)(to,b({},u)),Object(o.createElement)(Jn,b({},u)),Object(o.createElement)(Kn,null,Object(o.createElement)(_n,null,"Background"),Object(o.createElement)(Nn,{color:i.background,handleColorChange:function(e){s({background:e})}})),Object(o.createElement)(qn,b({},p)))}var io="normal";function ao(e){var t,n=x(Object(o.useState)(!1),2),r=(n[0],n[1],x(Object(o.useState)(!1),2)),i=r[0],a=r[1],c=e.model,u=e.controller,p=c.config.theme,d=p.rootTopic,f=p.primaryTopic,m=p.normalTopic,h=function(t){u.run("operation",b(b({},e),{opType:s.OpType.SET_THEME,theme:Object(g.clone)(t)}))},y=(t=function(e){h(Object(g.merge)(p,{randomColor:e}))},function(e){return t(e.target.checked)}),v={topicStyle:d,setTopicStyle:function(e){h(Object(g.merge)(p,{rootTopic:e}))}},T=Object(o.createElement)(ro,b({},v)),E={topicStyle:f,setTopicStyle:function(e){h(Object(g.merge)(p,{primaryTopic:e}))}},O=Object(o.createElement)(ro,b({},E)),k={topicStyle:m,setTopicStyle:function(e){h(Object(g.merge)(p,{normalTopic:e}))}},C=Object(o.createElement)(ro,b({},k)),S={id:io,handleTabIdChange:function(e){io=e}},w=Object(o.createElement)(Rn,null,Object(o.createElement)(l.Tabs,b({},S),Object(o.createElement)(l.Tab,{id:"normal",title:"NormalTopic",panel:C}),Object(o.createElement)(l.Tab,{id:"primary",title:"PrimaryTopic",panel:O}),Object(o.createElement)(l.Tab,{id:"root",title:"RootTopic",panel:T}))),D={isOpen:i,onClose:function(e){a(!1)}},_=Object(o.createElement)(l.Alert,b({},D),Object(o.createElement)("p",null,"File format error"));return Object(o.createElement)(oe,null,Object(o.createElement)(Kn,null,Object(o.createElement)(_n,null,"Global"),Object(o.createElement)(In,null,Object(o.createElement)(Ln,null,"Background:"),Object(o.createElement)(Nn,{color:p.background,handleColorChange:function(e){h(Object(g.merge)(p,{background:e}))}}),Object(o.createElement)(Ln,null,"Highlight:"),Object(o.createElement)(Nn,{color:p.highlightColor,handleColorChange:function(e){h(Object(g.merge)(p,{highlightColor:e}))}}),Object(o.createElement)(Ln,null,"Random Color:"),Object(o.createElement)(Q,{checked:p.randomColor,onChange:y}))),w,Object(o.createElement)(Kn,null,Object(o.createElement)(An,{title:"Export Theme",handleClick:function(e){ke(JSON.stringify(p),"blink-mind-theme.json")}}),Object(o.createElement)(An,{title:"Import Theme",handleClick:function(e){xe(".json,.txt").then((function(e){var t=JSON.parse(e);Object(s.isThemeType)(t)?h(t):a(!0)}))}})),_)}function co(){var e="topic-style",t=function(t){e=t};return{renderRightTopPanel:function(n){var r=b(b({},n),{key:"right-top-panel",selectedTabId:e,handleTabIdChange:t});return Object(o.createElement)(En,b({},r))},renderRightTopPanelTabs:function(e){var t=e.controller;return[t.run("renderTopicStyleEditor",e),t.run("renderThemeEditor",e)]},renderTopicStyleEditor:function(e){var t={id:"topic-style",key:"topic-style",title:"TopicStyle",panel:Object(o.createElement)($n,b({},e))};return Object(o.createElement)(l.Tab,b({},t))},renderThemeEditor:function(e){var t={id:"theme-editor",key:"theme-editor",title:"Theme",panel:Object(o.createElement)(ao,b({},e))};return Object(o.createElement)(l.Tab,b({},t))}}}var lo=c()("plugin:utils");function so(){var e=new Map,t=new Map;return{addTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)||t.set(n,[]),t.get(n).push(o)},removeTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)&&(t[n]=t.get(n).filter((function(e){return e!==o})))},getTempValue:function(t){var n=t.key;return lo("getTempValue",n),e.get(n)},setTempValue:function(n){var o,r,i=n.key,a=n.value;if(lo("setTempValue",i),e.set(i,a),t.has(i)){var c=t.get(i);try{for(var l=k(c),s=l.next();!s.done;s=l.next()){(0,s.value)(a)}}catch(u){o={error:u}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(o)throw o.error}}}},deleteTempValue:function(t){var n=t.key;lo("deleteTempValue",n);var o=e.get(n);return e.delete(n),o}}}var uo=c()("plugin:StylePlugin");function po(){var e=new Map,t=0;return{getTopicStyle:function(e){var t=e.controller;return{contentStyle:t.run("getTopicContentStyle",e),linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e)}},getTopicContentStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;uo("getTopicContentStyle:",t,n);var r,i=n.getTopicVisualLevel(t),a=n.config.theme;if(r=i===s.TopicVisualLevel.ROOT?a.rootTopic:i===s.TopicVisualLevel.PRIMARY?a.primaryTopic:a.normalTopic,r=b(b({},a.contentStyle),r.contentStyle),a.randomColor){var c=o.run("getRandomColor",e);r=b(b({},r),{background:c,borderColor:c,subLinkStyle:b(b({},r.subLinkStyle),{lineColor:c})})}var l=n.getTopic(t);if(!l.style)return r;var u=JSON.parse(l.style);return b(b({},r),u.contentStyle)},getLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;uo("getLinkStyle",t);var r,i=n.getTopicVisualLevel(t),a=n.config.theme,c=a.linkStyle;r=i===s.TopicVisualLevel.ROOT?a.rootTopic.linkStyle:i===s.TopicVisualLevel.PRIMARY?a.primaryTopic.linkStyle:a.normalTopic.linkStyle,c=b(b({},c),r);var l=n.getTopic(t);if(null!=l.parentKey){var u=o.run("getSubLinkStyle",b(b({},e),{topicKey:l.parentKey}));c=b(b({},c),u)}if(!l.style)return c;var p=JSON.parse(l.style);return b(b({},c),p.linkStyle)},getSubLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;uo("getLinkStyle",t);var r,i=n.getTopicVisualLevel(t),a=n.config.theme,c=a.linkStyle;r=i===s.TopicVisualLevel.ROOT?a.rootTopic.subLinkStyle:i===s.TopicVisualLevel.PRIMARY?a.primaryTopic.subLinkStyle:a.normalTopic.subLinkStyle,c=b(b({},c),r);var l=n.getTopic(t);if(a.randomColor){var u=o.run("getRandomColor",e);uo(u),c=b(b({},c),{lineColor:u})}if(!l.style)return c;var p=JSON.parse(l.style);return b(b({},c),p.subLinkStyle)},setTopicContentStyle:function(e){var t=e.topicKey,n=e.controller,o=e.style,r=e.model.getTopic(t).style,i=r?JSON.parse(r):{},a=b(b({},i),{contentStyle:b(b({},i.contentStyle),o)});if(!Object(g.isEqual)(i,a)){var c=JSON.stringify(a);n.run("operation",b(b({},e),{opType:s.OpType.SET_STYLE,style:c}))}},setLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.linkStyle,r=e.model.getTopic(t).style,i=r?JSON.parse(r):{},a=b(b({},i),{linkStyle:b(b({},i.linkStyle),o)});if(!Object(g.isEqual)(i,a)){var c=JSON.stringify(a);n.run("operation",b(b({},e),{opType:s.OpType.SET_STYLE,style:c}))}},setSubLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.subLinkStyle,r=e.model.getTopic(t).style,i=r?JSON.parse(r):{},a=b(b({},i),{subLinkStyle:b(b({},i.subLinkStyle),o)});if(!Object(g.isEqual)(i,a)){var c=JSON.stringify(a);n.run("operation",b(b({},e),{opType:s.OpType.SET_STYLE,style:c}))}},getTopicThemeStyle:function(e){var t=e.topicKey,n=e.model,o=n.getTopicVisualLevel(t),r=n.config.theme;return o===s.TopicVisualLevel.ROOT?r.rootTopic:o===s.TopicVisualLevel.PRIMARY?r.primaryTopic:r.normalTopic},getRandomColor:function(n){var o=n.topicKey;if(e.has(o))return e.get(o);var r=["#00CC99","#FFEE88","#A167A5","#E5F993","#F5C396","#DB995A","#83BCFF","#ED7B84","#739E82","#D3BCC0","#FFA0FD","#EFD3D7","#C6878F"],i=r[++t%r.length];return e.set(o,i),uo("getRandomColor",o,i),i},clearAllCustomStyle:function(e){var t=e.model,n=e.controller,o=t.withMutations((function(e){e.topics.keySeq().forEach((function(t){e.setIn(["topics",t,"style"],null)}))}));n.change(o)}}}function fo(){return[[yn(),so(),{renderTopicContextMenu:function(e){return Object(o.createElement)(Ae,b({},e))},customizeTopicContextMenu:function(e){var t=e.topicKey,n=e.model,r=e.controller,i=t===n.editorRootTopicKey;function a(t){return function(n){t.opType&&r.run("operation",b(b({},e),{opType:t.opType}))}}return Fe.map((function(e){return i&&!e.rootCanUse?null:Object(o.createElement)(l.MenuItem,{key:e.label,icon:le(e.icon),text:e.label,labelElement:Object(o.createElement)("kbd",null,e.shortcut),onClick:a(e)})}))}},co(),Ye()],{getPartTopics:function(e){var t=e.layout,n=e.model,o=e.topicKey,r=n.getTopic(o),i=r.subKeys.size,a=r.subKeys.toArray();switch(t){case s.DiagramLayoutType.LEFT_TO_RIGHT:return{R:a};case s.DiagramLayoutType.RIGHT_TO_LEFT:return{L:a};case s.DiagramLayoutType.LEFT_AND_RIGHT:return{L:a.slice(Math.ceil(i/2),i),R:a.slice(0,Math.ceil(i/2))};case s.DiagramLayoutType.TOP_TO_BOTTOM:return{B:a}}},createSubTopics:function(e){var t=e.model,n=e.topicKey,o=e.controller,r=e.topics,i=e.saveRef,a=t.getTopic(n);if(0===r.size||a.collapse)return null;var c=[];return r.forEach((function(t){var n=b(b({},e),{topicKey:t,key:t,ref:i(de(t))});c.push(o.run("renderTopicWidget",n))})),{subTopics:c}},layout:function(e){var t=e.getRef,n=e.model,o=t(me(n.editorRootTopicKey)),r=t(ve.FOCUS_HIGHLIGHT_KEY),i=t(ve.DROP_EFFECT_KEY);o&&o.layout(),r&&r.layout(),i&&i.layout(),function e(o){var r,i;if(o.key!==n.editorRootTopicKey){var a=t(de(o.key));a&&a.layoutLinks()}if(!o.collapse)try{for(var c=k(o.subKeys),l=c.next();!l.done;l=c.next()){var s=l.value;e(n.getTopic(s))}}catch(u){r={error:u}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}(n.getTopic(n.editorRootTopicKey))},setLayoutDir:function(e){var t=e.layoutDir,n=e.model;e.controller.change(s.ModelModifier.setLayoutDir({model:n,layoutDir:t}))},getRelativeRect:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return Le(t,o(ve.DRAG_SCROLL_WIDGET_KEY).bigView,r)},getRelativeRectFromViewPort:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return Le(t,o(ve.DRAG_SCROLL_WIDGET_KEY).viewBox,r)},getRelativeVectorFromViewPort:function(e){return Ie(e.element,(0,e.getRef)(ve.DRAG_SCROLL_WIDGET_KEY).viewBox)},addZoomFactorChangeEventListener:function(e){e.controller.run("addTempValueChangeListener",b({key:"ZoomFactor"},e))},removeZoomFactorChangeEventListener:function(e){e.controller.run("removeTempValueChangeListener",b({key:"ZoomFactor"},e))},setZoomFactor:function(e){var t=e.controller,n=e.zoomFactor;return t.run("setTempValue",{key:"ZoomFactor",value:n})},getZoomFactor:function(e){return e.controller.run("getTempValue",{key:"ZoomFactor"})||1},moveTopicToCenter:function(e){var t=e.getRef,n=e.topicKey,o=e.model;if(o.editorRootTopicKey!==n&&Object(s.getRelationship)(o,n,o.editorRootTopicKey)!==s.TopicRelationship.DESCENDANT)throw new Error("moveTopicToCenter error: topicKey "+n+" is not the DESCENDANT of editor root topic");var r=t(fe(n)),i=t(ve.DRAG_SCROLL_WIDGET_KEY),a=i.viewBox;if(!r||!a)throw new Error("moveTopicToCenter error: topic or viewBox is null");var c=Ie(r,a);i.setViewBoxScrollDelta(c[0],c[1])},focusTopicAndMoveToCenter:function(e){var t=e.controller,n=e.topicKey;t.run("operation",b(b({},e),{opArray:[{opType:s.OpType.FOCUS_TOPIC,topicKey:n,focusMode:s.FocusMode.NORMAL},{opType:s.OpType.EXPAND_TO,topicKey:n}],callback:function(){t.run("moveTopicToCenter",b(b({},e),{topicKey:n}))}}))}},Ne(),po(),ie(),Me(),{getValue:function(e,t){var n=e.propKey,o=e.controller;switch(n){case be.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:return 3;case be.TOPIC_CONTEXT_MENU_ENABLED:return o.run("isOperationEnabled",e);case be.TOPIC_TITLE:return o.run("getTopicTitle",e)}return t()}},Object(p.default)()]}c()("node:Diagram");var mo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resolveController=Object(u.default)((function(e,n){void 0===e&&(e=[]);var o=n();t.controller=new s.Controller({plugins:[e,o],construct:!1,onChange:t.props.onChange})})),t}return T(t,e),t.prototype.getDiagramProps=function(){return this.controller.run("getDiagramProps")},t.prototype.openNewModel=function(e){var t=this,n=this.getDiagramProps(),o=n.model,r=n.controller;r.run("deleteRefKey",b(b({},n),{topicKey:o.rootTopicKey})),r.run("operation",b(b({},n),{opType:s.OpType.EXPAND_TO,topicKey:e.focusKey,model:e,callback:function(){var e=t.getDiagramProps(),n=e.model;r.run("moveTopicToCenter",b(b({},e),{topicKey:n.focusKey}))}}))},t.prototype.render=function(){var e=this.props.plugins;return this.resolveController(e,fo),this.diagramProps=b(b({},this.props),{controller:this.controller}),this.controller.run("renderDiagram",this.diagramProps)},t}(o.Component)},389:function(e,t,n){"use strict";function o(e){return e&&"object"===typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=o(n(109)),a=n(11),c=o(a),l=o(n(18)),s=n(4),u=n(6);n(275),n(276);var p=o(n(68)),d=o(n(214)),f=n(3),m=o(n(5)),h=n(143),y=n(213),g=n(44),v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function T(e,t){function n(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var b=function(){return(b=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function E(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function O(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function k(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function x(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(x(arguments[t]));return e}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var w,D,_,j,R,L,I,P,M,K,N,A,F,B=function(e){function t(t){return e.call(this,t)||this}return T(t,e),t.prototype.operation=function(e,t){this.props.controller.run("operation",b({opType:e},t))},t.prototype.run=function(e,t){this.props.controller.run(e,t)},Object.defineProperty(t.prototype,"topic",{get:function(){return this.props.model.getTopic(this.props.topicKey)},enumerable:!0,configurable:!0}),t}(r.PureComponent),W=l("node:drag-scroll-widget"),z=c.div(w||(w=S(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"],["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"]))),G=c.div(D||(D=S(["\n  position: relative;\n  width: max-content;\n"],["\n  position: relative;\n  width: max-content;\n"]))),H=function(e){function t(t){var n=e.call(this,t)||this;return n.contentResizeCallback=function(e,t){if(n.oldContentRect){var o={width:n.content.clientWidth+2*n.viewBox.clientWidth,height:n.content.clientHeight+2*n.viewBox.clientHeight};n.bigView.style.width=o.width+"px",n.bigView.style.height=o.height+"px"}n.oldContentRect=e[0].contentRect},n.contentResizeObserver=new i(n.contentResizeCallback),n.contentRef=function(e){e&&(n.content=e,n.contentResizeObserver.observe(n.content))},n.viewBoxRef=function(e){e&&(n.viewBox=e,n.props.enableMouseWheel||(W("addEventListener onwheel"),n.viewBox.addEventListener("wheel",(function(e){W("onwheel"),(e.ctrlKey||e.altKey)&&e.preventDefault()}),{passive:!1})),n.setViewBoxScroll(n.viewBox.clientWidth,n.viewBox.clientHeight))},n.bigViewRef=function(e){e&&(n.bigView=e)},n.setWidgetStyle=function(){n.content&&n.viewBox&&n.bigView&&(n.bigView.style.width=2*(n.content.clientWidth+n.viewBox.clientWidth)+"px",n.bigView.style.height=2*(n.content.clientHeight+n.viewBox.clientHeight)+"px",n.content.style.left=n.viewBox.clientWidth+"px",n.content.style.top=n.viewBox.clientHeight+"px")},n.setViewBoxScroll=function(e,t){W("setViewBoxScroll "+e+" "+t),n.viewBox&&(n.viewBox.scrollLeft=e,n.viewBox.scrollTop=t)},n.setViewBoxScrollDelta=function(e,t){W("setViewBoxScrollDelta "+e+" "+t),n.viewBox&&(n.viewBox.scrollLeft+=e,n.viewBox.scrollTop+=t)},n.onMouseDown=function(e){var t=n.props,o=t.mouseKey,r=t.needKeyPressed,i=t.canDragFunc;if((!i||i())&&(0===e.button&&"left"===o||2===e.button&&"right"===o)){if(r&&!e.ctrlKey)return;n._lastCoordX=n.viewBox.scrollLeft+e.nativeEvent.clientX,n._lastCoordY=n.viewBox.scrollTop+e.nativeEvent.clientY;var a=n.viewBox;a.addEventListener("mousemove",n.onMouseMove),a.addEventListener("mouseup",n.onMouseUp)}},n.onMouseUp=function(e){var t=n.viewBox;t.removeEventListener("mousemove",n.onMouseMove),t.removeEventListener("mouseup",n.onMouseUp)},n.onMouseMove=function(e){n.viewBox.scrollLeft=n._lastCoordX-e.clientX,n.viewBox.scrollTop=n._lastCoordY-e.clientY},n.handleContextMenu=function(e){e.preventDefault()},n.state={widgetStyle:{width:"10000px",height:"10000px"}},n}return T(t,e),t.prototype.componentDidMount=function(){this.setWidgetStyle(),document.addEventListener("contextmenu",this.handleContextMenu)},t.prototype.componentWillUnmount=function(){document.removeEventListener("contextmenu",this.handleContextMenu)},t.prototype.setZoomFactor=function(e){this.bigView.style.transform="scale("+e+")",this.bigView.style.transformOrigin="50% 50%"},t.prototype.render=function(){var e=b({},this.state.widgetStyle);return r.createElement(z,{ref:this.viewBoxRef,onMouseDown:this.onMouseDown},r.createElement("div",{style:e,ref:this.bigViewRef},r.createElement(G,{ref:this.contentRef,style:this.state.contentStyle},this.props.children(this.setViewBoxScroll,this.setViewBoxScrollDelta))))},t.defaultProps={mouseKey:"left",needKeyPressed:!1},t}(r.Component),V=l("node:save-ref"),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getRef=function(e){return V(t),t[e]},t.saveRef=function(e){return function(n){n&&(t[e]=n,t.fireListener(e,n))}},t.deleteRef=function(e){V("deleteRef:",e),delete t[e]},t.observers=new Map,t.fireListener=function(e,n){var o,r;if(t.observers.has(e)){var i=t.observers.get(e);try{for(var a=k(i),c=a.next();!c.done;c=a.next()){(0,c.value)(e,n)}}catch(l){o={error:l}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}}},t.registerRefListener=function(e,n){t.observers.has(e)?t.observers.get(e).push(n):t.observers.set(e,[n])},t}return T(t,e),t.prototype.render=function(){return this.props.children(this.saveRef,this.getRef,this.deleteRef,this.registerRefListener.bind(this))},t}(r.Component),Y=c.div(_||(_=S(["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"],["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"])),(function(e){return e.flexDirection?e.flexDirection:"row"}),(function(e){return e.alignItems}),(function(e){return e.justifyContent})),Z=c.div(j||(j=S(["\n  margin: ",";\n"],["\n  margin: ",";\n"])),(function(e){return e.margin})),q=c.a(R||(R=S(["\n  font-size: 20px !important;\n"],["\n  font-size: 20px !important;\n"]))),J=c.div(L||(L=S(["\n  padding: 5px;\n  cursor: pointer;\n"],["\n  padding: 5px;\n  cursor: pointer;\n"]))),X=c.div(I||(I=S(["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"],["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"]))),Q=c(s.Checkbox)(P||(P=S(["\n  margin-bottom: 0px !important;\n"],["\n  margin-bottom: 0px !important;\n"]))),$=c(X)(M||(M=S(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"],["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"]))),ee=c.div(K||(K=S(["\n  height: 16px;\n"],["\n  height: 16px;\n"]))),te=c.span(N||(N=S(["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"],["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"]))),ne=c.div(A||(A=S(["\n  z-index: ",";\n"],["\n  z-index: ",";\n"])),(function(e){return e.zIndex})),oe=c.div(F||(F=S(["\n  min-width: 360px;\n  max-height: 470px;\n  overflow: auto;\n"],["\n  min-width: 360px;\n  max-height: 470px;\n  overflow: auto;\n"]))),re=l("plugin:event");function ie(){var e={};return{handleTopicClick:function(e){re("handleTopicClick");var t=e.controller,n=e.model,o=e.topicKey;re(n.zoomFactor),null===n.editingDescKey&&n.editingContentKey!==o&&(n.focusKey===o&&n.focusMode===u.FocusMode.EDITING_CONTENT||t.run("operation",b(b({},e),{opType:u.OpType.FOCUS_TOPIC,focusMode:u.FocusMode.NORMAL})))},handleTopicDoubleClick:function(e){var t=e.controller;null===e.model.editingDescKey&&t.run("operation",b(b({},e),{opType:u.OpType.FOCUS_TOPIC,focusMode:u.FocusMode.EDITING_CONTENT}))},handleTopicContextMenu:function(e){e.controller.run("operation",b(b({},e),{opType:u.OpType.FOCUS_TOPIC,focusMode:u.FocusMode.SHOW_POPUP}))},handleActiveModalClose:function(e){var t=e.controller,n=t.run("getActiveModalProps",e);return null==n?null:"edit-desc"===n.name?function(){t.run("operation",b(b({},e),{focusMode:u.FocusMode.NORMAL,opType:u.OpType.FOCUS_TOPIC}))}:void 0},addEventListener:function(t){var n=t.key,o=t.listener,r=t.once,i=t.controller;function a(){o(),i.run("removeEventListener",{key:n,listener:o})}e[n]||(e[n]=[]),r?(a.origin=o,e[n].push(a)):e[n].push(o)},removeEventListener:function(t){var n=t.key,o=t.listener;e[n]&&(e[n]=e[n].filter((function(e){return e!==o&&e.origin!==o})))},fireEvent:function(t){var n=t.key;e[n]&&e[n].forEach((function(e){return e()}))}}}var ae={SHOW_MENU:"show-menu",CLOSE:"close",COLOR_PICKER:"color-picker",NOTES:"notes",PLUS:"plus",MINUS:"minus",COLLAPSE_ALL:"collapse",EXPAND_ALL:"expand",CENTER:"center",TRASH:"trash",SEARCH:"search",THEME:"theme",EXPORT:"export",OPEN_FILE:"openfile"};function ce(e){return"icon iconfont bm-"+e}function le(e){return r.createElement("span",{className:ce(e)})}function se(e){return"content-"+e}function ue(e){return"content-editor-"+e}function pe(e){return"desc-editor-"+e}function de(e){return"topic-widget-"+e}function fe(e){return"topic-"+e}function me(e){return"links-"+e}function he(e){return"links-svg-"+e}function ye(e){return"collapse-"+e}function ge(e,t){return"dropArea-"+t+"-"+e}var ve={DIAGRAM_ROOT_KEY:"DIAGRAM-ROOT",DRAG_SCROLL_WIDGET_KEY:"DragScrollWidget",SVG_HIGHLIGHT_KEY:"svg-highlight",FOCUS_HIGHLIGHT_KEY:"focus-highlight",DROP_EFFECT_KEY:"drop-effect"},Te={CENTER_ROOT_TOPIC:"CENTER_ROOT_TOPIC"},be={DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:"DIAGRAM_CUSTOMIZE_BASE_Z_INDEX",TOPIC_CONTEXT_MENU_ENABLED:"TOPIC_CONTEXT_MENU_ENABLED",TOPIC_TITLE:"TOPIC_TITLE"},Ee=function(e){e.stopPropagation()};function Oe(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}function ke(e,t){Oe("data:text/plain,"+encodeURIComponent(e),t)}function xe(e){var t=document.createElement("input");return t.type="file",t.accept=e,new Promise((function(e,n){t.addEventListener("change",(function(t){var o=t.target.files[0],r=new FileReader;r.onload=function(t){var n=t.target.result;e(n)},r.onerror=function(e){n(e.target.error)},r.readAsText(o)})),t.click()}))}function Ce(e){var t=e.top,n=void 0===t?0:t,o=e.right,r=void 0===o?0:o,i=e.bottom,a=void 0===i?0:i,c=e.left;return n+"px "+r+"px "+a+"px "+(void 0===c?0:c)+"px"}function Se(e){return(e.top+e.bottom)/2}function we(e){return(e.left+e.right)/2}function De(e,t){return(e.x+t.x)/2}function _e(e,t){return(e.y+t.y)/2}function je(e){return[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Re(e,t,n){void 0===n&&(n=1);var o=e.getBoundingClientRect(),r=je(t.getBoundingClientRect()),i=je(o);i[0]=(i[0]-r[0])/n,i[1]=(i[1]-r[1])/n;var a=o.width/n,c=o.height/n;return{left:i[0]-a/2,right:i[0]+a/2,top:i[1]-c/2,bottom:i[1]+c/2,width:a,height:c}}function Le(e,t){var n=e.getBoundingClientRect(),o=je(t.getBoundingClientRect()),r=je(n);return[r[0]-o[0],r[1]-o[1]]}var Ie={ADD_CHILD:"ADD_CHILD",ADD_SIBLING:"ADD_SIBLING",DELETE_TOPIC:"DELETE_TOPIC",EDIT_CONTENT:"EDIT_CONTENT",EDIT_NOTES:"EDIT_NOTES",SET_EDITOR_ROOT:"SET_EDITOR_ROOT"};function Pe(){return{customizeHotKeys:function(e){var t=function(t){return function(n){!function(e,t){var n=t.topicKey,o=t.model,r=t.controller;void 0===n&&(t=b(b({},t),{topicKey:o.focusKey})),r.run("operation",b(b({},t),{opType:e}))}(t,e)}};return{topicHotKeys:new Map([[Ie.ADD_CHILD,{label:"add child",combo:"tab",onKeyDown:t(u.OpType.ADD_CHILD)}],[Ie.ADD_SIBLING,{label:"add sibling",combo:"enter",onKeyDown:t(u.OpType.ADD_SIBLING)}],[Ie.DELETE_TOPIC,{label:"delete topic",combo:"del",onKeyDown:t(u.OpType.DELETE_TOPIC)}],[Ie.EDIT_CONTENT,{label:"edit content",combo:"space",onKeyDown:t(u.OpType.START_EDITING_CONTENT)}],[Ie.EDIT_NOTES,{label:"edit notes",combo:"alt + d",onKeyDown:t(u.OpType.START_EDITING_DESC)}],[Ie.SET_EDITOR_ROOT,{label:"set editor root",combo:"alt + shift + f",onKeyDown:t(u.OpType.SET_EDITOR_ROOT)}]]),globalHotKeys:new Map}}}}var Me=l("plugin:operation");function Ke(){var e=new Map([[u.OpType.TOGGLE_COLLAPSE,u.ModelModifier.toggleCollapse],[u.OpType.COLLAPSE_ALL,u.ModelModifier.collapseAll],[u.OpType.EXPAND_ALL,u.ModelModifier.expandAll],[u.OpType.EXPAND_TO,u.ModelModifier.expandTo],[u.OpType.ADD_CHILD,u.ModelModifier.addChild],[u.OpType.ADD_SIBLING,u.ModelModifier.addSibling],[u.OpType.DELETE_TOPIC,u.ModelModifier.deleteTopic],[u.OpType.FOCUS_TOPIC,u.ModelModifier.focusTopic],[u.OpType.SET_FOCUS_MODE,u.ModelModifier.setFocusMode],[u.OpType.SET_STYLE,u.ModelModifier.setStyle],[u.OpType.SET_THEME,u.ModelModifier.setTheme],[u.OpType.SET_TOPIC_BLOCK,u.ModelModifier.setBlockData],[u.OpType.DELETE_TOPIC_BLOCK,u.ModelModifier.deleteBlock],[u.OpType.START_EDITING_CONTENT,function(e){var t=e.model,n=e.topicKey;return u.ModelModifier.focusTopic({model:t,topicKey:n,focusMode:u.FocusMode.EDITING_CONTENT})}],[u.OpType.START_EDITING_DESC,function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock(u.BlockType.DESC);return null!=o.block&&null!=o.block.data||(t=u.ModelModifier.setBlockData({model:t,topicKey:n,blockType:u.BlockType.DESC,data:""})),t=u.ModelModifier.focusTopic({model:t,topicKey:n,focusMode:u.FocusMode.EDITING_DESC})}],[u.OpType.DRAG_AND_DROP,function(e){var t=e.srcKey,n=e.dstKey,o=e.dropDir,r=e.model,i=r.getTopic(t),a=r.getTopic(n),c=i.parentKey,l=r.getTopic(c).subKeys,s=l.indexOf(t);if(l=l.delete(s),"in"===o){var u=a.subKeys;u=u.push(t),r=r.withMutations((function(e){e.setIn(["topics",c,"subKeys"],l).setIn(["topics",t,"parentKey"],n).setIn(["topics",n,"subKeys"],u).setIn(["topics",n,"collapse"],!1)}))}else{var p=a.parentKey,d=r.getTopic(p).subKeys,m=d.indexOf(n);if(c===p){var h=f.List();d.forEach((function(e){e!==t&&(h=e===n?"prev"===o?h.push(t).push(e):h.push(e).push(t):h.push(e))})),r=r.withMutations((function(e){e.setIn(["topics",p,"subKeys"],h)}))}else"prev"===o?d=d.insert(m,t):"next"===o&&(d=d.insert(m+1,t)),r=r.withMutations((function(e){e.setIn(["topics",c,"subKeys"],l).setIn(["topics",t,"parentKey"],p).setIn(["topics",p,"subKeys"],d).setIn(["topics",p,"collapse"],!1)}))}return r}],[u.OpType.SET_EDITOR_ROOT,u.ModelModifier.setEditorRootTopicKey]]),t=f.Stack(),n=f.Stack(),o=!0,r=new Set;return{isOperationEnabled:function(e){return o},enableOperation:function(){o=!0},disableOperation:function(e){var t=e.whiteList;o=!1,t?r=new Set(t):r.clear()},getOpMap:function(t){return e},getAllowUndo:function(e){var t=e.model,n=e.opType;if(n)switch(n){case u.OpType.FOCUS_TOPIC:case u.OpType.START_EDITING_CONTENT:case u.OpType.START_EDITING_DESC:return!1}switch(t.focusMode){case"EDITING_DESC":case"EDITING_CONTENT":return!1}return t.config.allowUndo},getUndoRedoStack:function(){return{undoStack:t,redoStack:n}},setUndoStack:function(e){Me("setUndoStack",e.undoStack),t=e.undoStack},setRedoStack:function(e){Me("setRedoStack",e.redoStack),n=e.redoStack},canUndo:function(e){var t=e.controller,n=t.run("getUndoRedoStack",e).undoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},canRedo:function(e){var t=e.controller,n=t.run("getUndoRedoStack",e).redoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},undo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,i=o.redoStack,a=r.peek();a&&(t.run("setUndoStack",b(b({},e),{undoStack:r.shift()})),t.run("setRedoStack",b(b({},e),{redoStack:i.push(n)})),Me(a),t.change(a))}},redo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,i=o.redoStack,a=i.peek();a&&(t.run("setUndoStack",b(b({},e),{undoStack:r.push(n)})),t.run("setRedoStack",b(b({},e),{redoStack:i.shift()})),t.change(a))}},operation:function(e){var t=e.controller,n=e.opType,o=e.model,i=e.opArray,a=e.callback;if(null!=i&&!Array.isArray(i))throw new Error("operation: the type of opArray must be array!");if(null!=n&&null!=i)throw new Error("operation: opType and opArray conflict!");if(!t.run("isOperationEnabled",e)){if(0===r.size)return;if(null!=i){var c=i.filter((function(e){return!r.has(e.opType)}));if(c&&c.length>0)return}else if(!r.has(n))return}Me("operation:",n),Me("operation:",o),Me("operation:",e);var l,s=t.run("getOpMap",e);if(t.run("beforeOperation",e),t.run("getAllowUndo",e)){var u=t.run("getUndoRedoStack",e).undoStack;t.run("setUndoStack",b(b({},e),{undoStack:u.push(o)}))}if(null!=i)l=i.reduce((function(e,n){var o=n.opType;if(!s.has(o))throw new Error("opType:"+o+" not exist!");var r=s.get(o),i=b(b({controller:t},n),{model:e}),a=t.run("beforeOpFunction",i);return a=r(b(b({},i),{model:a})),a=t.run("afterOpFunction",b(b({},i),{model:a}))}),o);else{if(!s.has(n))throw new Error("opType:"+n+" not exist!");var p=s.get(n);l=t.run("beforeOpFunction",e),l=p(b(b({},e),{model:l})),l=t.run("afterOpFunction",b(b({},e),{model:l}))}Me("newModel:",l),t.change(l,a),t.run("afterOperation",e)},deleteRefKey:function(e){var t,n,o=e.model,r=e.topicKey,i=e.deleteRef,a=u.getAllSubTopicKeys(o,r);a.push(r);try{for(var c=k(a),l=c.next();!l.done;l=c.next()){var s=l.value;i(me(s)),i(he(s)),i(se(s)),i(ue(s)),i(pe(s)),i(de(s)),i(fe(s)),i(ye(s)),i(ge(s,"next")),i(ge(s,"prev"))}}catch(p){t={error:p}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}},beforeOperation:function(e){},afterOperation:function(e){},beforeOpFunction:function(e){var t=e.controller,n=e.opType,o=e.model,r=e.topicKey;return n===u.OpType.DELETE_TOPIC&&r!==o.editorRootTopicKey&&t.run("deleteRefKey",e),o},afterOpFunction:function(e){return e.model}}}var Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.render=function(){var e=this.props.controller;return r.createElement(s.Menu,null,e.run("customizeTopicContextMenu",this.props))},t}(B),Ae=[{icon:"edit",label:"edit",shortcut:"Space",rootCanUse:!0,opType:u.OpType.START_EDITING_CONTENT},{icon:"add-sibling",label:"add sibling",shortcut:"Enter",opType:u.OpType.ADD_SIBLING},{icon:"add-child",label:"add child",shortcut:"Tab",rootCanUse:!0,opType:u.OpType.ADD_CHILD},{icon:"notes",label:"edit notes",shortcut:"Alt + D",rootCanUse:!0,opType:u.OpType.START_EDITING_DESC},{icon:"delete-node",label:"delete node",shortcut:"Del",opType:u.OpType.DELETE_TOPIC},{icon:"root",label:"set as editor root",shortcut:"Alt + Shift + F",opType:u.OpType.SET_EDITOR_ROOT}];var Fe,Be,We=l("node:topic-drop-effect"),ze=c.svg(Fe||(Fe=S(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),Ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={content:null},t}return T(t,e),t.prototype.layout=function(){var e=this.props,t=this.props,n=t.getRef,o=t.model,i=t.zoomFactor,a=t.controller.run("getDragTargetProps",e),c=a.key,l=a.dropDir;if(We("layout",l),null!==c){var s=n("in"===l?se(c):ge(c,l)),u=n("svg-drop-effect"),p=n(ve.DRAG_SCROLL_WIDGET_KEY).bigView,d=Re(s,p,i),f=Re(u,p,i),m=d.left-f.left-3,h=d.top-f.top-3,y=d.width+6,g=d.height+6;this.setState({content:r.createElement("g",null,r.createElement("rect",{x:m,y:h,width:y,height:g,fill:"none",stroke:o.config.theme.highlightColor,strokeDasharray:"5,5",strokeWidth:2}))})}else this.setState({content:null})},t.prototype.render=function(){var e=this.props.saveRef;return r.createElement(ze,{ref:e("svg-drop-effect")},this.state.content)},t}(B),He=l("plugin:drag-and-drop"),Ve=c.div(Be||(Be=S(["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"],["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"])),(function(e){return e.height+"px"}));function Ue(){var e=null,t=null;return{renderTopicDropArea:function(e){var t=e.topicKey,n=e.dropDir,o=e.saveRef,i=e.controller,a=e.model,c={onDragEnter:function(o){He("onDragEnter",t,n),i.run("handleTopicDragEnter",b(b({},e),{ev:o,dropDir:n}))},onDragLeave:function(o){He("onDragLeave",t,n),i.run("handleTopicDragLeave",b(b({},e),{ev:o,dropDir:n}))},onDragOver:function(e){e.preventDefault()},onDrop:function(o){He("onDrop",t,n),i.run("handleTopicDrop",b(b({},e),{ev:o,dropDir:n}))}};return r.createElement(Ve,b({height:a.config.theme.marginV/2,ref:o(ge(t,n))},c))},renderDragAndDropEffect:function(e){He("renderDragAndDropEffect");var t=e.saveRef;return r.createElement(Ge,b({ref:t(ve.DROP_EFFECT_KEY)},e))},getDragTargetProps:function(n){return{key:e,dropDir:t}},handleTopicDragStart:function(e){var t=e.controller;e.ev.stopPropagation(),t.run("operation",b(b({},e),{opType:u.OpType.FOCUS_TOPIC,focusMode:u.FocusMode.DRAGGING}))},canDrop:function(e){var t=e.srcKey,n=e.dstKey,o=e.model,r=e.dropDir;return t!==o.editorRootTopicKey&&t!==n&&u.getRelationship(o,t,n)!==u.TopicRelationship.ANCESTOR&&((n!==o.editorRootTopicKey||"in"===r)&&(o.getTopic(t).parentKey!==n||"in"!==r))},handleTopicDragEnter:function(n){var o=n.dropDir,r=n.topicKey,i=n.controller,a=n.model;He("handleTopicDragEnter:",r,o),i.run("canDrop",b(b({},n),{srcKey:a.focusKey,dstKey:r}))&&(e=r,t=o,i.change(a))},handleTopicDragLeave:function(n){var o=n.controller,r=n.model,i=n.topicKey,a=n.dropDir,c=n.getRef,l=n.ev.nativeEvent.relatedTarget;He("handleTopicDragLeave:",i,a);var s=c(se(i));s==l||s.contains(l)||(e=null,t=null,o.change(r))},handleTopicDrop:function(n){He("handleTopicDrop");var o=n.controller,r=n.topicKey,i=n.model;n=b(b({},n),{srcKey:i.focusKey,dstKey:r}),e=null,t=null,o.run("canDrop",n)&&o.run("operation",b(b({},n),{opType:u.OpType.DRAG_AND_DROP}))}}}var Ye,Ze,qe,Je,Xe,Qe,$e,et,tt,nt,ot,rt=c(ne)(Ye||(Ye=S(["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"],["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"]))),it=c.div(Ze||(Ze=S(["\n  max-width: 600px;\n"],["\n  max-width: 600px;\n"]))),at=c.span(qe||(qe=S([""],[""]))),ct=function(e){function t(t){var n=e.call(this,t)||this;return n.setEditorRootTopicKey=function(e){return function(){var t=n.props,o=t.model,r=t.controller;o.editorRootTopicKey!==e&&r.change(u.ModelModifier.setEditorRootTopicKey({model:o,topicKey:e}))}},n.breadcrumbRenderer=function(e){var t=e.text,n=E(e,["text"]),o=t.length>8,i=o?t.substr(0,8)+"...":t,a={content:r.createElement(it,null,t),position:s.PopoverPosition.BOTTOM_RIGHT},c=r.createElement(s.Breadcrumb,b({},n),r.createElement(at,null,i));return o?r.createElement(s.Tooltip,b({},a),c):c},n.state={show:!1},n}return T(t,e),t.prototype.render=function(){var e=this.props,t=e.model,n=e.controller,o=e.zIndex,i=t.editorRootTopicKey;if(i===t.rootTopicKey)return null;for(var a=[],c=t.getTopic(i);null!=c;){var l=n.getValue(be.TOPIC_TITLE,b(b({},e),{topicKey:c.key}));a.unshift({text:l,onClick:this.setEditorRootTopicKey(c.key)}),c=t.getTopic(c.parentKey)}var u={items:a,breadcrumbRenderer:this.breadcrumbRenderer};return r.createElement(rt,{zIndex:o},r.createElement(s.Breadcrumbs,b({},u)))},t}(B),lt=c.div(Je||(Je=S(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"],["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"]))),st=c.div(Xe||(Xe=S(["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"],["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"])),(function(e){return e.theme.background})),ut=function(e){function t(t){var n=e.call(this,t)||this;return n.setZoomFactor=function(e){n.dragScrollWidget.setZoomFactor(e)},n.onWheel=function(e){if(e.altKey||e.ctrlKey){var t=n.props.controller,o=t.run("getZoomFactor",n.props);(o-=e.nativeEvent.deltaY>0?.1:-.1)<.5&&(o=.5),o>4&&(o=4),t.run("setZoomFactor",b(b({},n.props),{zoomFactor:o}))}},n}return T(t,e),t.prototype.renderHotkeys=function(){var e=this.props,t=e.controller,n=e.model,o=t.run("customizeHotKeys",e);if(null===o)return null;if(!(o.topicHotKeys instanceof Map&&o.globalHotKeys instanceof Map))throw new TypeError("topicHotKeys and globalHotKeys must be a Map");var i=[];return n.focusMode!==u.FocusMode.NORMAL&&n.focusMode!==u.FocusMode.SHOW_POPUP||o.topicHotKeys.forEach((function(e,t){i.push(r.createElement(s.Hotkey,b({key:t},e,{global:!0})))})),o.globalHotKeys.forEach((function(e,t){i.push(r.createElement(s.Hotkey,b({key:t},e,{global:!0})))})),r.createElement(s.Hotkeys,null,i)},t.prototype.componentDidMount=function(){var e=this.props,t=e.getRef,n=e.model;e.controller.run("addZoomFactorChangeEventListener",b(b({},this.props),{listener:this.setZoomFactor}));var o=t(fe(n.editorRootTopicKey)),r=t("node-layer"),i=o.getBoundingClientRect(),a=r.getBoundingClientRect();this.dragScrollWidget.setViewBoxScrollDelta(0,i.top-a.top-this.dragScrollWidget.viewBox.getBoundingClientRect().height/2+i.height),this.layout()},t.prototype.componentWillUnmount=function(){this.props.controller.run("removeZoomFactorChangeEventListener",b(b({},this.props),{listener:this.setZoomFactor}))},Object.defineProperty(t.prototype,"dragScrollWidget",{get:function(){return this.props.getRef(ve.DRAG_SCROLL_WIDGET_KEY)},enumerable:!0,configurable:!0}),t.prototype.componentDidUpdate=function(){this.props.controller.run("fireEvent",b(b({},this.props),{key:Te.CENTER_ROOT_TOPIC})),this.layout()},t.prototype.layout=function(){this.props.controller.run("layout",this.props)},t.prototype.render=function(){var e=this,t=this.props,n=t.saveRef,o=t.model,i=t.controller,a=o.editorRootTopicKey;return r.createElement(st,{onWheel:this.onWheel},r.createElement(H,b({},this.state,{enableMouseWheel:!1,zoomFactor:o.zoomFactor,ref:n(ve.DRAG_SCROLL_WIDGET_KEY)}),(function(t,o){var c=b(b({},e.props),{topicKey:a,setViewBoxScroll:t,setViewBoxScrollDelta:o});return r.createElement(lt,{ref:n("node-layer")},i.run("renderRootWidget",c))})))},t=O([s.HotkeysTarget],t)}(r.Component),pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClose=function(){var e=t.props.controller.run("handleActiveModalClose",t.props);e&&e()},t}return T(t,e),t.prototype.render=function(){var e=this.props.controller,t=e.run("renderModal",this.props),n=e.run("getActiveModalProps",this.props);return r.createElement(s.Dialog,{onClose:this.handleClose,isOpen:null!==t,autoFocus:!0,enforceFocus:!0,usePortal:!0,title:n&&n.title,style:n&&n.style},r.createElement("div",{className:s.Classes.DIALOG_BODY,style:{minHeight:0}},t))},t}(B),dt=c.svg(Qe||(Qe=S(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),ft=l("node:root-sub-links"),mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={curves:[]},t}return T(t,e),t.prototype.layout=function(){var e,t,n=this.props,o=n.model,i=n.getRef,a=n.topicKey,c=n.zoomFactor,l=n.controller,s=o.getTopic(a),u=i(se(a)),p=i(he(a)),d=i(ve.DRAG_SCROLL_WIDGET_KEY).bigView,f=Re(u,d,c),m=Re(p,d,c);e={x:we(f)-m.left,y:Se(f)-m.top};var h=[];s.subKeys.forEach((function(o){var a,s=l.run("getLinkStyle",b(b({},n),{topicKey:o})),u=s.lineType,p=Re(i(se(o)),d,c);if(t={x:(t=p.left>f.right?{x:p.left,y:Se(p)}:{x:p.right,y:Se(p)}).x-m.left,y:t.y-m.top},"curve"===u)a="M "+e.x+" "+e.y+" C "+e.x+" "+_e(e,t)+" "+De(e,t)+" "+t.y+" "+t.x+" "+t.y;else if("line"===u)a="M "+e.x+" "+e.y+" L "+t.x+" "+t.y;else if("round"===u){var y=t.y>e.y?1:-1,g=t.x>e.x?1:-1,v=s.lineRadius;if(null==v)throw new Error("link line type is round, but lineRadius is not provided!");a=t.y===e.y?"M "+e.x+" "+e.y+" H "+t.x:"M "+e.x+" "+e.y+"  V "+(t.y-y*v)+" A "+v+" "+v+" 0 0 "+(y*g===1?0:1)+" "+(e.x+v*g)+" "+t.y+" H "+t.x}h.push(r.createElement("path",{key:"link-"+o,d:a,strokeWidth:s.lineWidth,stroke:s.lineColor,fill:"none"}))})),this.setState({curves:h})},t.prototype.render=function(){ft("render");var e=this.props,t=e.topicKey,n=e.saveRef;return r.createElement(dt,{ref:n(he(t))},r.createElement("g",null,this.state.curves))},t}(B),ht=l("RootNode"),yt=c.div($e||($e=S(["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"],["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"])),(function(e){return e.topicDirection===u.TopicDirection.LEFT?"flex-end":"flex-start"}),(function(e){return e.topicDirection===u.TopicDirection.LEFT?"15px 60px 15px 0px":"15px 0px 15px 60px"})),gt=c.div(et||(et=S(["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"],["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"]))),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.renderPartTopics=function(e,t){var n=this.props,o=n.controller,i=n.saveRef,a=o.run("createSubTopics",b(b({},this.props),{dir:t,isRoot:!0,topics:e}));if(!a)return null;var c=a.subTopics,l="bm-layer-"+(t===u.TopicDirection.LEFT?"left":"right");return r.createElement(yt,{topicDirection:t,ref:i(l)},c)},t.prototype.render=function(){ht("render");var e=this.props,t=e.model,n=e.topicKey,o=e.saveRef,i=e.controller,a=i.run("getTopicContentStyle",e),c=t.config,l=i.run("renderTopicContent",b(b({},e),{topicStyle:a,dir:u.TopicDirection.MAIN})),s=i.run("getPartTopics",{layout:c.layoutDir,model:t,topicKey:n}),p=r.createElement(gt,{ref:o(fe(n))},l),d=i.run("renderRootWidgetOtherChildren",e);switch(c.layoutDir){case u.DiagramLayoutType.LEFT_AND_RIGHT:return r.createElement(r.Fragment,null,this.renderPartTopics(s.L,"L"),p,this.renderPartTopics(s.R,"R"),d);case u.DiagramLayoutType.LEFT_TO_RIGHT:return r.createElement(r.Fragment,null,p,this.renderPartTopics(s.R,"R"),d);case u.DiagramLayoutType.RIGHT_TO_LEFT:return r.createElement(r.Fragment,null,this.renderPartTopics(s.L,"L"),p,d);case u.DiagramLayoutType.TOP_TO_BOTTOM:return r.createElement(r.Fragment,null,p,this.renderPartTopics(s.B,"B"),d)}return null},t}(r.Component),Tt=c.div(ot||(ot=S(["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"],["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"])),(function(e){var t=e.dir;return t===u.TopicDirection.RIGHT?a.css(tt||(tt=S(["\n        right: -25px;\n      "],["\n        right: -25px;\n      "]))):t===u.TopicDirection.LEFT?a.css(nt||(nt=S(["\n        left: -25px;\n      "],["\n        left: -25px;\n      "]))):void 0}),(function(e){return e.background}));function bt(e){var t,n=e.model,o=e.topicKey,i=e.topicStyle,a=e.dir,c=e.saveRef,l=e.onClickCollapse,s=n.getTopic(o);return s.subKeys.size>0?r.createElement(Tt,{ref:c(ye(o)),onClick:l,background:i.background,dir:a,className:m((t={icon:!0,iconfont:!0},t["bm-"+(s.collapse?"plus":"minus")]=!0,t))}):null}var Et,Ot,kt=l("node:topic-content2"),xt=c.div(Et||(Et=S(["\n  position: relative;\n"],["\n  position: relative;\n"]))),Ct=c.div(Ot||(Ot=S(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"],["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"]))),St=function(e){kt("cancelEvent"),e.preventDefault(),e.stopPropagation()};function wt(e){var t,n=e.controller,o=e.model,a=e.topicKey,c=e.getRef,l=o.editingContentKey!==a,s=n.run("renderTopicContentEditor",b(b({},e),{readOnly:l}));if(l)t=s;else{var u,p={width:50,height:40},d=c("content-editor-"+a);d&&(p=d.getBoundingClientRect());var f=new i((function(e,t){var n=e[0].contentRect;u.style.left=(p.width-n.width)/2+"px",u.style.top=(p.height-n.height)/2+"px"}));kt(p),t=r.createElement(r.Fragment,null,r.createElement("div",{style:{width:p.width,height:p.height}}),r.createElement(Ct,{ref:function(e){e&&(u=e,f.observe(u))}},s))}return r.createElement(xt,{onDragEnter:St,onDragOver:St},t)}var Dt,_t,jt,Rt=l("node:topic-content-widget"),Lt=c.div(Dt||(Dt=S(["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"],["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"]))),It=c.div(_t||(_t=S(["\n  position: relative;\n"],["\n  position: relative;\n"]))),Pt=function(e){function t(t){var n=e.call(this,t)||this;return n.onDragStart=function(e){n.run("handleTopicDragStart",b(b({},n.props),{ev:e}))},n.onDragOver=function(e){e.preventDefault()},n.onDragEnter=function(e){Rt("onDragEnter",n.props.topicKey),n.run("handleTopicDragEnter",b(b({},n.props),{ev:e,dropDir:"in"}))},n.onDragLeave=function(e){n.run("handleTopicDragLeave",b(b({},n.props),{ev:e,dropDir:"in"}))},n.onDrop=function(e){Rt("onDrop"),n.run("handleTopicDrop",b(b({},n.props),{ev:e,dropDir:"in"}))},n.onClick=function(e){var t=n.props.controller;n.handleTopicClickTimeout=setTimeout((function(){t.run("handleTopicClick",b(b({},n.props),{ev:e}))}),200)},n.onDoubleClick=function(e){clearTimeout(n.handleTopicClickTimeout),n.props.controller.run("handleTopicDoubleClick",b(b({},n.props),{ev:e}))},n.needRelocation=!1,n.onClickCollapse=function(e){e.stopPropagation();var t=n.props,o=t.topicKey,r=t.getRef;n.needRelocation=!0;var i=r(ye(o)).getBoundingClientRect();Rt("oldRect",i),n.oldCollapseIconVector=[i.left+i.width/2,i.top+i.height/2],Rt("oldCollapseIconVector",n.oldCollapseIconVector),n.operation(u.OpType.TOGGLE_COLLAPSE,n.props)},n.state={dragEnter:!1},n}return T(t,e),t.prototype.renderContextMenu=function(){var e=this.props.controller;if(e.getValue(be.TOPIC_CONTEXT_MENU_ENABLED,b({},this.props)))return this.operation(u.OpType.FOCUS_TOPIC,b(b({},this.props),{focusMode:u.FocusMode.SHOW_POPUP})),e.run("renderTopicContextMenu",this.props)},t.prototype.onContextMenuClose=function(){},t.prototype.componentDidUpdate=function(){if(this.needRelocation){var e=this.props,t=e.getRef,n=e.topicKey,o=e.setViewBoxScrollDelta,r=t(ye(n)).getBoundingClientRect(),i=[r.left+r.width/2,r.top+r.height/2];Rt("newVector:",i),Rt("oldVector:",this.oldCollapseIconVector);var a=[i[0]-this.oldCollapseIconVector[0],i[1]-this.oldCollapseIconVector[1]];Rt("vector",a),o(a[0],a[1]),this.needRelocation=!1}},t.prototype.render=function(){var e=this.props,t=e.saveRef,n=e.topicKey,o=e.model,i=e.controller,a=e.topicStyle,c=e.dir;Rt("render",n,o.focusMode);var l=i.run("isOperationEnabled",e)&&o.editingContentKey!==n,s=i.run("renderTopicCollapseIcon",b(b({},e),{onClickCollapse:this.onClickCollapse.bind(this)})),p=i.run("renderTopicDropArea",b(b({},e),{dropDir:"prev"})),d=i.run("renderTopicDropArea",b(b({},e),{dropDir:"next"})),f={onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop};return r.createElement(It,null,p,r.createElement(Lt,b({style:a,draggable:l,ref:t(se(n)),onDragStart:this.onDragStart,onClick:this.onClick,onDoubleClick:this.onDoubleClick},f),i.run("renderTopicBlocks",e),i.run("renderTopicContentOthers",e)),d,c!==u.TopicDirection.MAIN&&s)},t=O([s.ContextMenuTarget],t)}(B),Mt=l("node:topic-desc"),Kt=c.div(jt||(jt=S(["\n  overflow: auto;\n"],["\n  overflow: auto;\n"])));function Nt(e){var t=e.controller,n=e.model,o=e.topicKey,i=e.getRef,a=n.editingDescKey===o;Mt("isEditing",a);var c=n.getTopic(o).getBlock(u.BlockType.DESC);if(!a&&t.run("isBlockEmpty",b(b({},e),{block:c.block})))return null;var l=t.run("renderTopicDescEditor",e),p=i(ve.DIAGRAM_ROOT_KEY),d={maxWidth:"800px",maxHeight:"600px"};if(p){var f=p.getBoundingClientRect();d.maxWidth=.6*f.width+"px",d.maxHeight=.8*f.height+"px"}var m={autoFocus:!1,content:r.createElement(Kt,{onClick:Ee,classname:s.Classes.POPOVER_DISMISS,style:d},l),target:r.createElement(te,{onClick:function(n){n.stopPropagation(),t.run("operation",b(b({},e),{opType:u.OpType.START_EDITING_DESC}))},className:ce(ae.NOTES),tabIndex:-1}),interactionKind:s.PopoverInteractionKind.HOVER,hoverOpenDelay:500};return c.block&&r.createElement(s.Popover,b({},m))}var At,Ft,Bt,Wt,zt,Gt,Ht,Vt,Ut,Yt=c.svg(At||(At=S(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),Zt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={content:null},t}return T(t,e),t.prototype.layout=function(){var e=this.props,t=e.getRef,n=e.model,o=e.zoomFactor,i=n.focusKey,a=n.focusMode;if(i&&a!==u.FocusMode.EDITING_CONTENT){var c=t(se(i)),l=t(ve.DRAG_SCROLL_WIDGET_KEY).bigView,s=t(ve.SVG_HIGHLIGHT_KEY),p=Re(c,l,o),d=Re(s,l,o),f=p.left-d.left-3,m=p.top-d.top-3,h=p.width+6,y=p.height+6;this.setState({content:r.createElement("rect",{x:f,y:m,width:h,height:y,fill:"none",stroke:n.config.theme.highlightColor,strokeWidth:2})})}else this.setState({content:null})},t.prototype.render=function(){var e=this.props.saveRef;return r.createElement(Yt,{ref:e(ve.SVG_HIGHLIGHT_KEY)},this.state.content)},t}(B),qt=c.svg(Ft||(Ft=S(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),Jt=l("node:topic-sub-links"),Xt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={curves:[]},t}return T(t,e),t.prototype.layout=function(){var e,t,n,o=this.props,i=o.model,a=o.getRef,c=o.topicKey,l=o.dir,s=o.controller,p=s.run("getZoomFactor",o),d=i.getTopic(c),f=a(se(c)),m=a(he(c)),h=a(ye(c)),y=a(ve.DRAG_SCROLL_WIDGET_KEY).bigView,g=Re(m,y,p),v=Re(h,y,p),T=Re(f,y,p);Jt(c),Jt("svgRect",g),Jt("collapseRect",v),Jt("contentRect",T),l===u.TopicDirection.RIGHT?(e={x:0,y:Se(T)-g.top},t={x:v.right-g.left+10,y:e.y}):l===u.TopicDirection.LEFT&&(e={x:g.right-g.left,y:Se(T)-g.top},t={x:v.left-g.left-10,y:e.y});var E=[];d.subKeys.forEach((function(i){var c,f=s.run("getLinkStyle",b(b({},o),{topicKey:i})),m=a(se(i));if(m){var h=Re(m,y,p);l===u.TopicDirection.RIGHT&&(n={x:h.left-g.left,y:Se(h)-g.top}),l===u.TopicDirection.LEFT&&(n={x:h.right-g.left,y:Se(h)-g.top});var v=f.lineType;if("curve"===v)c="M "+e.x+" "+e.y+" L "+t.x+" "+t.y+" C "+t.x+" "+_e(t,n)+" "+De(t,n)+" "+n.y+" "+n.x+" "+n.y;else if("round"===v){var T=n.y>e.y?1:-1,O=n.x>e.x?1:-1,k=f.lineRadius;c=1===d.subKeys.size||Math.abs(n.y-e.y)<=1?"M "+e.x+" "+e.y+" L "+n.x+" "+n.y:"M "+e.x+" "+e.y+" H "+t.x+" V "+(n.y-T*k)+" A "+k+" "+k+" 0 0 "+(T*O===1?0:1)+" "+(t.x+k*O)+" "+n.y+" H "+n.x}else"line"===v&&(c="M "+e.x+" "+e.y+" H "+t.x+" L "+n.x+" "+n.y);E.push(r.createElement("path",{key:"link-"+i,d:c,strokeWidth:f.lineWidth,stroke:f.lineColor,fill:"none"}))}})),this.setState({curves:E})},t.prototype.render=function(){var e=this.props,t=e.topicKey,n=e.saveRef;return r.createElement(qt,{ref:n(he(t))},r.createElement("g",null,this.state.curves))},t}(B),Qt=l("node:topic-widget"),$t=c.div(Bt||(Bt=S(["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"],["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===u.TopicDirection.RIGHT?"row":"row-reverse"})),en=c.div(Wt||(Wt=S(["\n  position: relative;\n  padding: ",";\n"],["\n  position: relative;\n  padding: ",";\n"])),(function(e){return e.dir===u.TopicDirection.RIGHT?"0 0 0 "+e.marginH+"px":"0 "+e.marginH+"px 0 0"})),tn=c.div(zt||(zt=S(["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"],["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===u.TopicDirection.RIGHT?"row":"row-reverse"})),nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.renderSubTopics=function(){var e=this.props,t=e.controller,n=e.model,o=e.topicKey,i=e.dir,a=n.getTopic(o).subKeys.toArray(),c=t.run("createSubTopics",b(b({},e),{topics:a}));if(!c)return null;var l=c.subTopics,s=t.run("renderSubLinks",e);return r.createElement(en,{dir:i,marginH:n.config.theme.marginH},l," ",s)},t.prototype.layoutLinks=function(){var e=this.props,t=e.getRef,n=e.topicKey,o=e.model.getTopic(n);if(0!==o.subKeys.size&&!o.collapse){Qt("layoutLinks",n);var r=t(me(n));r&&r.layout()}},t.prototype.render=function(){var e=this.props,t=e.controller,n=e.topicKey,o=e.dir,i=e.saveRef;Qt("render",n);var a=t.run("getTopicContentStyle",e),c=b(b({},e),{topicStyle:a}),l=t.run("renderTopicContent",c);return r.createElement($t,{topicDirection:o},r.createElement(tn,{topicDirection:o,ref:i(fe(n))},l),this.renderSubTopics())},t}(r.Component),on=l("node:view-port-viewer"),rn=c(ne)(Gt||(Gt=S(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"]))),an=c(X)(Ht||(Ht=S(["\n  margin: 10px;\n"],["\n  margin: 10px;\n"]))),cn=c.span(Vt||(Vt=S(["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"],["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"]))),ln=function(e){return r.createElement(s.Tooltip,{content:e.tooltip,position:s.Position.TOP,className:s.Classes.ICON},r.createElement(an,{onClick:e.onClick,tabIndex:-1},e.children))},sn=function(e){function t(t){var n=e.call(this,t)||this;return n.zoomFactorChange=function(e){on("zoomFactorChange",e),n.setState({zoomFactor:e})},n.onClickResetZoom=function(e){var t=n.props;t.controller.run("setZoomFactor",b(b({},t),{zoomFactor:1}))},n.onClickAddZoom=function(e){var t=n.props,o=t.controller,r=o.run("getZoomFactor",t);o.run("setZoomFactor",b(b({},t),{zoomFactor:r+.1}))},n.onClickMinusZoom=function(e){var t=n.props,o=t.controller,r=o.run("getZoomFactor",t);o.run("setZoomFactor",b(b({},t),{zoomFactor:r-.1}))},n.onClickCollapseAll=function(e){var t=n.props,o=t.controller;o.run("addEventListener",b(b({},t),{key:Te.CENTER_ROOT_TOPIC,listener:n.centerRootTopic,once:!0})),o.run("operation",b(b({},t),{opType:u.OpType.COLLAPSE_ALL}))},n.onClickExpandAll=function(e){var t=n.props,o=t.controller;o.run("addEventListener",b(b({},t),{key:Te.CENTER_ROOT_TOPIC,listener:n.centerRootTopic,once:!0})),o.run("operation",b(b({},t),{opType:u.OpType.EXPAND_ALL}))},n.centerRootTopic=function(){var e=n.props,t=e.model;e.controller.run("moveTopicToCenter",b(b({},n.props),{topicKey:t.editorRootTopicKey}))},n}return T(t,e),t.prototype.componentDidMount=function(){var e=this.props;e.controller.run("addZoomFactorChangeEventListener",b(b({},e),{listener:this.zoomFactorChange}))},t.prototype.componentWillUnmount=function(){var e=this.props;e.controller.run("removeZoomFactorChangeEventListener",b(b({},e),{listener:this.zoomFactorChange}))},t.prototype.render=function(){on("render");var e=this.props,t=e.controller,n=e.zIndex,o=t.run("getZoomFactor",e);return r.createElement(rn,{zIndex:n},r.createElement(ln,{onClick:this.onClickCollapseAll,tooltip:"collapse all"},le(ae.COLLAPSE_ALL)),r.createElement(ln,{onClick:this.onClickExpandAll,tooltip:"expand all"},le(ae.EXPAND_ALL)),r.createElement(ln,{onClick:this.centerRootTopic,tooltip:"center root topic"},le(ae.CENTER)),r.createElement(ln,{onClick:this.onClickMinusZoom,tooltip:"zoom in"},le(ae.MINUS)),r.createElement(ln,{onClick:this.onClickResetZoom,tooltip:"reset zoom"},r.createElement(cn,null,"zoom:"+Math.floor(100*o)+"%")),r.createElement(ln,{onClick:this.onClickAddZoom,tooltip:"zoom out"},le(ae.PLUS)))},t}(B),un=c.div(Ut||(Ut=S(["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"],["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"])));function pn(e){var t=e.controller,n=e.model,o=e.topicKey;if(n.focusMode===u.FocusMode.EDITING_DESC){var i=t.run("renderTopicDescEditor",e);return r.createElement(s.Drawer,{key:"drawer",title:"Edit Notes",icon:le("note"),isOpen:!0,hasBackdrop:!0,backdropProps:{onMouseDown:Ee},isCloseButtonShown:!1,onClose:function(n){n.stopPropagation();var r="topic-desc-data-"+o,i=t.run("deleteTempValue",{key:r});t.run("operation",b(b({},e),{opType:u.OpType.SET_TOPIC_BLOCK,topicKey:o,blockType:u.BlockType.DESC,data:i,focusMode:u.FocusMode.NORMAL}))},size:"70%"},r.createElement(un,null,i))}}function dn(e){var t=e.theme,n=e.children;return r.createElement(a.ThemeProvider,{theme:t},r.createElement(r.Fragment,null,n))}var fn,mn=l("plugin:rendering");function hn(){var e,t=c.div(fn||(fn=S(["\n    width: 100%;\n    height: 100%;\n    background: ",";\n    position: relative;\n  "],["\n    width: 100%;\n    height: 100%;\n    background: ",";\n    position: relative;\n  "])),(function(e){return e.theme.background}));return{getDiagramProps:function(){return e},renderDiagram:function(n){var o=n.model,i=n.controller;return r.createElement(U,null,(function(a,c,l){return e=b(b({},n),{saveRef:a,getRef:c,deleteRef:l}),mn("renderDiagram",o),r.createElement(dn,{theme:o.config.theme},r.createElement(t,{ref:a(ve.DIAGRAM_ROOT_KEY)},r.createElement(ut,b({},e)),i.run("renderDiagramCustomize",e)))}))},renderDrawer:pn,renderDiagramCustomize:function(e){var t=e.controller,n=e.model,o=t.getValue(be.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX),r=b(b({},e),{zIndex:o,topicKey:n.focusKey});return[t.run("renderEditorRootBreadcrumbs",r),t.run("renderRightTopPanel",r),t.run("renderModals",b(b({},r),{zIndex:o+1})),t.run("renderDrawer",b(b({},r),{zIndex:o+1})),t.run("renderViewPortViewer",r)]},renderEditorRootBreadcrumbs:function(e){return r.createElement(ct,b({key:"EditorRootBreadcrumbs"},e))},renderModals:function(e){return r.createElement(pt,b({key:"modals"},e))},renderModal:function(e){return null},getActiveModalProps:function(e){return null},renderDoc:function(e){return e.children},renderRootWidget:function(e){return r.createElement(vt,b({},e))},renderTopicWidget:function(e){return r.createElement(nn,b({},e))},renderTopicContent:function(e){return r.createElement(Pt,b({},e))},renderTopicCollapseIcon:function(e){return r.createElement(bt,b({},e))},renderTopicContentOthers:function(e){return[]},renderTopicBlocks:function(e){var t=e.model,n=e.topicKey,o=e.controller,i=t.getTopic(n).blocks,a=[],c=0;return i.forEach((function(t){var n=o.run("renderTopicBlock",b(b({},e),{block:t,blockKey:"block-"+c}));n&&(a.push(r.createElement(r.Fragment,{key:"block-"+c},n)),c++)})),a},renderTopicBlock:function(e){var t=e.controller;switch(e.block.type){case u.BlockType.CONTENT:return t.run("renderTopicBlockContent",e);case u.BlockType.DESC:return t.run("renderTopicBlockDesc",e)}return null},renderTopicBlockContent:function(e){return r.createElement(wt,b({},e))},renderTopicBlockDesc:function(e){return r.createElement(Nt,b({},e))},renderSubLinks:function(e){var t=e.saveRef,n=e.topicKey,o=e.model.getTopic(n);return 0===o.subKeys.size||o.collapse?null:r.createElement(Xt,b({ref:t(me(n))},e))},renderRootSubLinks:function(e){var t=e.saveRef,n=e.topicKey;return r.createElement(mt,b({ref:t(me(n))},e))},renderFocusItemHighlight:function(e){var t=e.saveRef;return r.createElement(Zt,b({ref:t(ve.FOCUS_HIGHLIGHT_KEY)},e))},renderRootWidgetOtherChildren:function(e){var t=e.controller,n=t.run("getZoomFactor",e);return e=b(b({},e),{zoomFactor:n}),r.createElement(r.Fragment,null,t.run("renderRootSubLinks",e),t.run("renderFocusItemHighlight",e),t.run("renderDragAndDropEffect",e))},renderViewPortViewer:function(e){return r.createElement(sn,b({key:"view-port-viewer"},e))}}}var yn,gn,vn=c(ne)(yn||(yn=S(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"]))),Tn=c(s.Tabs)(gn||(gn=S(["\n  padding: 0px 10px;\n"],["\n  padding: 0px 10px;\n"])));function bn(e){var t=e.controller,n=e.zIndex,o=e.selectedTabId,i=e.handleTabIdChange,a=x(r.useState(!1),2),c=a[0],l=a[1];return c?r.createElement(vn,{zIndex:n},r.createElement(ee,null,r.createElement($,{className:ce(ae.CLOSE),onClick:function(){return l(!1)}})),r.createElement(Tn,{id:o,onChange:i},t.run("renderRightTopPanelTabs",e))):r.createElement(vn,{zIndex:n},r.createElement(J,{onClick:function(){return l(!0)}},r.createElement(q,{className:ce(ae.SHOW_MENU)})))}var En,On,kn,xn,Cn,Sn,wn,Dn=c.div(En||(En=S(["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"],["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"]))),_n=c.span(On||(On=S(["\n  margin: 0px 10px 0px 0px;\n"],["\n  margin: 0px 10px 0px 0px;\n"]))),jn=c.div(kn||(kn=S(["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"],["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"]))),Rn=c(_n)(xn||(xn=S([""],[""]))),Ln=c.div(Cn||(Cn=S(["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"],["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"]))),In=c.div(Sn||(Sn=S(["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"],["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"])),(function(e){return e.color})),Pn=c.div(wn||(wn=S(["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"],["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"])));function Mn(e){return r.createElement("div",null,e.children,r.createElement(s.Divider,{style:{margin:"10px 0"}}))}function Kn(e){var t=e.color,n=e.handleColorChange;return r.createElement(_n,null,r.createElement(s.Popover,null,r.createElement(Pn,null,r.createElement("div",{className:ce(ae.COLOR_PICKER)}),r.createElement(In,{color:t})),r.createElement("div",null,r.createElement(y.SketchPicker,{color:t,onChangeComplete:function(e){return n(e.hex)}}))))}function Nn(e){var t=e.title,n=e.handleClick;return r.createElement(_n,null,r.createElement(s.Button,{onClick:n},t))}function An(e){var t=e.layout,n=void 0===t?"h":t,o=e.title,i=E(e,["layout","title"]),a={flexDirection:"h"===n?"row":"column",alignItems:"center"};return r.createElement(_n,null,r.createElement(Y,b({},a),r.createElement(Z,{margin:"0 5px 0 0"},o),r.createElement(s.NumericInput,b({},i))))}function Fn(e){var t=e.text,n=e.items,o=e.itemRenderer,i=e.onItemSelect,a=h.Select.ofType(),c={items:n,itemRenderer:o,onItemSelect:i,filterable:!1};return r.createElement(_n,null,r.createElement(a,b({},c),r.createElement(s.Button,{text:t})))}var Bn=function(e){return function(t,n){var o=n.handleClick;return r.createElement(s.MenuItem,{text:""+t+e,key:t,onClick:o})}},Wn=(h.Select.ofType(),C(Array(7).keys())),zn=C(Array(7).keys()),Gn=[0,5,10,15,20,25,30,35],Hn=["none","solid","dotted","dashed","double"];function Vn(e){var t=e.contentStyle,n=e.setContentStyle;return r.createElement(Mn,null,r.createElement(Dn,null,"Border"),r.createElement("div",null,r.createElement(Fn,{text:"width: "+(t.borderWidth?t.borderWidth:"0px"),items:zn,itemRenderer:Bn("px"),onItemSelect:function(e){n({borderWidth:e+"px"})}}),r.createElement(Fn,{text:"style: "+(t.borderStyle?t.borderStyle:"none"),items:Hn,itemRenderer:Bn(""),onItemSelect:function(e){n({borderStyle:e})}}),r.createElement(Fn,{text:"radius: "+t.borderRadius,items:Gn,itemRenderer:Bn("px"),onItemSelect:function(e){n({borderRadius:e+"px"})}}),r.createElement(Kn,{color:t.borderColor,handleColorChange:function(e){n({borderColor:e})}})))}var Un=["curve","round","line"],Yn=function(e,t){var n=t.handleClick;t.modifiers,t.query;return r.createElement(s.MenuItem,{text:""+e,key:e,onClick:n})};function Zn(e){var t=e.showLinkStyle,n=void 0===t||t,o=e.showSubLinkStyle,i=void 0===o||o,a=e.linkStyle,c=void 0===a?{}:a,l=e.subLinkStyle,s=void 0===l?{}:l,u=e.setLinkStyle,p=e.setSubLinkStyle;return r.createElement(Mn,null,r.createElement(Dn,null,"Link"),n&&r.createElement(Ln,{alignItems:"center"},r.createElement(Z,{margin:"0 5px 0 0"},"LinkToParent: "),r.createElement(Fn,{text:"width: "+(c?c.lineWidth:"0px"),items:Wn,itemRenderer:Bn("px"),onItemSelect:function(e){u({lineWidth:e+"px"})}}),r.createElement(Fn,{text:"lineType: "+c.lineType,items:Un,itemRenderer:Yn,onItemSelect:function(e){u({lineType:e})}}),r.createElement(Kn,{color:c.lineColor,handleColorChange:function(e){u({lineColor:e})}})),i&&r.createElement(Ln,{alignItems:"center"},r.createElement(Z,{margin:"0 5px 0 0"},"SubLinks: "),r.createElement(Fn,{text:"width: "+(s?s.lineWidth:"0px"),items:Wn,itemRenderer:Bn("px"),onItemSelect:function(e){p({lineWidth:e+"px"})}}),r.createElement(Fn,{text:"lineType: "+s.lineType,items:Un,itemRenderer:Yn,onItemSelect:function(e){p({lineType:e})}}),r.createElement(Kn,{color:s.lineColor,handleColorChange:function(e){p({lineColor:e})}})))}function qn(e){var t=e.contentStyle,n=e.setContentStyle,o={title:"FontSize:",min:12,max:100,value:parseInt(t.fontSize),style:{width:50},onValueChange:function(e){n({fontSize:e})}},i={style:{width:50},value:t.lineHeight||"",onChange:function(e){n({lineHeight:e.target.value})}};return r.createElement(Mn,null,r.createElement(Dn,null,"Text Editor"),r.createElement(Y,null,r.createElement(An,b({},o)),r.createElement(_n,null,r.createElement(Y,{alignItems:"center"},r.createElement(Z,{margin:"0 5px 0 0"},"LineHeight: "),r.createElement(s.InputGroup,b({},i)))),r.createElement(Kn,{color:t.color,handleColorChange:function(e){n({color:e})}})))}var Jn,Xn=l("node:style-editor");function Qn(e){var t=e.controller,n=e.model,o=e.topicKey,i=n.getTopic(o),a=function(n){t.run("setTopicContentStyle",b(b({},e),{style:n}))};if(!n.focusKey)return null;var c=t.run("getTopicContentStyle",e),l={linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e),setLinkStyle:function(n){t.run("setLinkStyle",b(b({},e),{linkStyle:n}))},setSubLinkStyle:function(n){t.run("setSubLinkStyle",b(b({},e),{subLinkStyle:n}))}},p={contentStyle:c,setContentStyle:a};return r.createElement(oe,null,r.createElement(Vn,b({},p)),r.createElement(qn,b({},p)),r.createElement(Mn,null,r.createElement(Dn,null,"Background"),r.createElement(Kn,{color:c.background,handleColorChange:function(e){a({background:e})}})),r.createElement(Zn,b({},l)),r.createElement(Mn,null,r.createElement(Nn,{title:"Clear Topic Style",handleClick:function(){i.style&&t.run("operation",b(b({},e),{opType:u.OpType.SET_STYLE,style:null}))}}),r.createElement(Nn,{title:"Copy Style",handleClick:function(){Jn=t.run("getTopicStyle",e),Xn(Jn)}}),r.createElement(Nn,{title:"Paste Style",handleClick:function(){Jn&&t.run("operation",b(b({},e),{opType:u.OpType.SET_STYLE,style:JSON.stringify(Jn)}))}})),function(e){var t=e.controller;return r.createElement(Mn,null,r.createElement(_n,null,r.createElement(s.Button,{onClick:function(n){t.run("clearAllCustomStyle",e)}},"Clear All Custom Styles")))}(e))}var $n=n(314);function eo(e){var t=e.contentStyle,n=e.setContentStyle,o=$n("padding",t.padding||"0"),i={layout:"v",min:0,max:99,style:{width:38}},a=parseInt(o["padding-top"]),c=parseInt(o["padding-right"]),l=parseInt(o["padding-bottom"]),s=parseInt(o["padding-left"]),u={top:a,right:c,bottom:l,left:s},p=function(e){return function(t){var o;n({padding:Ce(b(b({},u),(o={},o[e]=t,o)))})}},d=b(b({},i),{title:"top",value:a,onValueChange:p("top")}),f=b(b({},i),{title:"right",value:c,onValueChange:p("right")}),m=b(b({},i),{title:"bottom",value:l,onValueChange:p("bottom")}),h=b(b({},i),{title:"left",value:s,onValueChange:p("left")});return r.createElement(Mn,null,r.createElement(Dn,null,"Padding"),r.createElement(Ln,null,r.createElement(An,b({},d)),r.createElement(An,b({},f)),r.createElement(An,b({},m)),r.createElement(An,b({},h))))}var to,no=c.div(to||(to=S(["\n  height: 250px;\n  overflow: auto;\n"],["\n  height: 250px;\n  overflow: auto;\n"])));function oo(e){var t=e.topicStyle,n=e.setTopicStyle,o=t.contentStyle,i=void 0===o?{}:o,a=t.linkStyle,c=void 0===a?{}:a,l=t.subLinkStyle,s=function(e){n({contentStyle:e})},u={contentStyle:i,setContentStyle:s},p={showLinkStyle:!1,linkStyle:c,subLinkStyle:void 0===l?{}:l,setLinkStyle:function(e){n({linkStyle:e})},setSubLinkStyle:function(e){n({subLinkStyle:e})}};return r.createElement(no,null,r.createElement(Vn,b({},u)),r.createElement(eo,b({},u)),r.createElement(qn,b({},u)),r.createElement(Mn,null,r.createElement(Dn,null,"Background"),r.createElement(Kn,{color:i.background,handleColorChange:function(e){s({background:e})}})),r.createElement(Zn,b({},p)))}var ro="normal";function io(e){var t,n=x(r.useState(!1),2),o=(n[0],n[1],x(r.useState(!1),2)),i=o[0],a=o[1],c=e.model,l=e.controller,p=c.config.theme,d=p.rootTopic,f=p.primaryTopic,m=p.normalTopic,h=function(t){l.run("operation",b(b({},e),{opType:u.OpType.SET_THEME,theme:g.clone(t)}))},y=(t=function(e){h(g.merge(p,{randomColor:e}))},function(e){return t(e.target.checked)}),v={topicStyle:d,setTopicStyle:function(e){h(g.merge(p,{rootTopic:e}))}},T=r.createElement(oo,b({},v)),E={topicStyle:f,setTopicStyle:function(e){h(g.merge(p,{primaryTopic:e}))}},O=r.createElement(oo,b({},E)),k={topicStyle:m,setTopicStyle:function(e){h(g.merge(p,{normalTopic:e}))}},C=r.createElement(oo,b({},k)),S={id:ro,handleTabIdChange:function(e){ro=e}},w=r.createElement(jn,null,r.createElement(s.Tabs,b({},S),r.createElement(s.Tab,{id:"normal",title:"NormalTopic",panel:C}),r.createElement(s.Tab,{id:"primary",title:"PrimaryTopic",panel:O}),r.createElement(s.Tab,{id:"root",title:"RootTopic",panel:T}))),D={isOpen:i,onClose:function(e){a(!1)}},_=r.createElement(s.Alert,b({},D),r.createElement("p",null,"File format error"));return r.createElement(oe,null,r.createElement(Mn,null,r.createElement(Dn,null,"Global"),r.createElement(Ln,null,r.createElement(Rn,null,"Background:"),r.createElement(Kn,{color:p.background,handleColorChange:function(e){h(g.merge(p,{background:e}))}}),r.createElement(Rn,null,"Highlight:"),r.createElement(Kn,{color:p.highlightColor,handleColorChange:function(e){h(g.merge(p,{highlightColor:e}))}}),r.createElement(Rn,null,"Random Color:"),r.createElement(Q,{checked:p.randomColor,onChange:y}))),w,r.createElement(Mn,null,r.createElement(Nn,{title:"Export Theme",handleClick:function(e){ke(JSON.stringify(p),"blink-mind-theme.json")}}),r.createElement(Nn,{title:"Import Theme",handleClick:function(e){xe(".json,.txt").then((function(e){var t=JSON.parse(e);u.isThemeType(t)?h(t):a(!0)}))}})),_)}function ao(){var e="topic-style",t=function(t){e=t};return{renderRightTopPanel:function(n){var o=b(b({},n),{key:"right-top-panel",selectedTabId:e,handleTabIdChange:t});return r.createElement(bn,b({},o))},renderRightTopPanelTabs:function(e){var t=e.controller;return[t.run("renderTopicStyleEditor",e),t.run("renderThemeEditor",e)]},renderTopicStyleEditor:function(e){var t={id:"topic-style",key:"topic-style",title:"TopicStyle",panel:r.createElement(Qn,b({},e))};return r.createElement(s.Tab,b({},t))},renderThemeEditor:function(e){var t={id:"theme-editor",key:"theme-editor",title:"Theme",panel:r.createElement(io,b({},e))};return r.createElement(s.Tab,b({},t))}}}var co=l("plugin:utils");function lo(){var e=new Map,t=new Map;return{addTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)||t.set(n,[]),t.get(n).push(o)},removeTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)&&(t[n]=t.get(n).filter((function(e){return e!==o})))},getTempValue:function(t){var n=t.key;return co("getTempValue",n),e.get(n)},setTempValue:function(n){var o,r,i=n.key,a=n.value;if(co("setTempValue",i),e.set(i,a),t.has(i)){var c=t.get(i);try{for(var l=k(c),s=l.next();!s.done;s=l.next()){(0,s.value)(a)}}catch(u){o={error:u}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(o)throw o.error}}}},deleteTempValue:function(t){var n=t.key;co("deleteTempValue",n);var o=e.get(n);return e.delete(n),o}}}var so=l("plugin:StylePlugin");function uo(){var e=new Map,t=0;return{getTopicStyle:function(e){var t=e.controller;return{contentStyle:t.run("getTopicContentStyle",e),linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e)}},getTopicContentStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;so("getTopicContentStyle:",t,n);var r,i=n.getTopicVisualLevel(t),a=n.config.theme;if(r=i===u.TopicVisualLevel.ROOT?a.rootTopic:i===u.TopicVisualLevel.PRIMARY?a.primaryTopic:a.normalTopic,r=b(b({},a.contentStyle),r.contentStyle),a.randomColor){var c=o.run("getRandomColor",e);r=b(b({},r),{background:c,borderColor:c,subLinkStyle:b(b({},r.subLinkStyle),{lineColor:c})})}var l=n.getTopic(t);if(!l.style)return r;var s=JSON.parse(l.style);return b(b({},r),s.contentStyle)},getLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;so("getLinkStyle",t);var r,i=n.getTopicVisualLevel(t),a=n.config.theme,c=a.linkStyle;r=i===u.TopicVisualLevel.ROOT?a.rootTopic.linkStyle:i===u.TopicVisualLevel.PRIMARY?a.primaryTopic.linkStyle:a.normalTopic.linkStyle,c=b(b({},c),r);var l=n.getTopic(t);if(null!=l.parentKey){var s=o.run("getSubLinkStyle",b(b({},e),{topicKey:l.parentKey}));c=b(b({},c),s)}if(!l.style)return c;var p=JSON.parse(l.style);return b(b({},c),p.linkStyle)},getSubLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;so("getLinkStyle",t);var r,i=n.getTopicVisualLevel(t),a=n.config.theme,c=a.linkStyle;r=i===u.TopicVisualLevel.ROOT?a.rootTopic.subLinkStyle:i===u.TopicVisualLevel.PRIMARY?a.primaryTopic.subLinkStyle:a.normalTopic.subLinkStyle,c=b(b({},c),r);var l=n.getTopic(t);if(a.randomColor){var s=o.run("getRandomColor",e);so(s),c=b(b({},c),{lineColor:s})}if(!l.style)return c;var p=JSON.parse(l.style);return b(b({},c),p.subLinkStyle)},setTopicContentStyle:function(e){var t=e.topicKey,n=e.controller,o=e.style,r=e.model.getTopic(t).style,i=r?JSON.parse(r):{},a=b(b({},i),{contentStyle:b(b({},i.contentStyle),o)});if(!g.isEqual(i,a)){var c=JSON.stringify(a);n.run("operation",b(b({},e),{opType:u.OpType.SET_STYLE,style:c}))}},setLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.linkStyle,r=e.model.getTopic(t).style,i=r?JSON.parse(r):{},a=b(b({},i),{linkStyle:b(b({},i.linkStyle),o)});if(!g.isEqual(i,a)){var c=JSON.stringify(a);n.run("operation",b(b({},e),{opType:u.OpType.SET_STYLE,style:c}))}},setSubLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.subLinkStyle,r=e.model.getTopic(t).style,i=r?JSON.parse(r):{},a=b(b({},i),{subLinkStyle:b(b({},i.subLinkStyle),o)});if(!g.isEqual(i,a)){var c=JSON.stringify(a);n.run("operation",b(b({},e),{opType:u.OpType.SET_STYLE,style:c}))}},getTopicThemeStyle:function(e){var t=e.topicKey,n=e.model,o=n.getTopicVisualLevel(t),r=n.config.theme;return o===u.TopicVisualLevel.ROOT?r.rootTopic:o===u.TopicVisualLevel.PRIMARY?r.primaryTopic:r.normalTopic},getRandomColor:function(n){var o=n.topicKey;if(e.has(o))return e.get(o);var r=["#00CC99","#FFEE88","#A167A5","#E5F993","#F5C396","#DB995A","#83BCFF","#ED7B84","#739E82","#D3BCC0","#FFA0FD","#EFD3D7","#C6878F"],i=r[++t%r.length];return e.set(o,i),so("getRandomColor",o,i),i},clearAllCustomStyle:function(e){var t=e.model,n=e.controller,o=t.withMutations((function(e){e.topics.keySeq().forEach((function(t){e.setIn(["topics",t,"style"],null)}))}));n.change(o)}}}function po(){return[[hn(),lo(),{renderTopicContextMenu:function(e){return r.createElement(Ne,b({},e))},customizeTopicContextMenu:function(e){var t=e.topicKey,n=e.model,o=e.controller,i=t===n.editorRootTopicKey;function a(t){return function(n){t.opType&&o.run("operation",b(b({},e),{opType:t.opType}))}}return Ae.map((function(e){return i&&!e.rootCanUse?null:r.createElement(s.MenuItem,{key:e.label,icon:le(e.icon),text:e.label,labelElement:r.createElement("kbd",null,e.shortcut),onClick:a(e)})}))}},ao(),Ue()],{getPartTopics:function(e){var t=e.layout,n=e.model,o=e.topicKey,r=n.getTopic(o),i=r.subKeys.size,a=r.subKeys.toArray();switch(t){case u.DiagramLayoutType.LEFT_TO_RIGHT:return{R:a};case u.DiagramLayoutType.RIGHT_TO_LEFT:return{L:a};case u.DiagramLayoutType.LEFT_AND_RIGHT:return{L:a.slice(Math.ceil(i/2),i),R:a.slice(0,Math.ceil(i/2))};case u.DiagramLayoutType.TOP_TO_BOTTOM:return{B:a}}},createSubTopics:function(e){var t=e.model,n=e.topicKey,o=e.controller,r=e.topics,i=e.saveRef,a=t.getTopic(n);if(0===r.size||a.collapse)return null;var c=[];return r.forEach((function(t){var n=b(b({},e),{topicKey:t,key:t,ref:i(de(t))});c.push(o.run("renderTopicWidget",n))})),{subTopics:c}},layout:function(e){var t=e.getRef,n=e.model,o=t(me(n.editorRootTopicKey)),r=t(ve.FOCUS_HIGHLIGHT_KEY),i=t(ve.DROP_EFFECT_KEY);o&&o.layout(),r&&r.layout(),i&&i.layout(),function e(o){var r,i;if(o.key!==n.editorRootTopicKey){var a=t(de(o.key));a&&a.layoutLinks()}if(!o.collapse)try{for(var c=k(o.subKeys),l=c.next();!l.done;l=c.next()){var s=l.value;e(n.getTopic(s))}}catch(u){r={error:u}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}(n.getTopic(n.editorRootTopicKey))},setLayoutDir:function(e){var t=e.layoutDir,n=e.model;e.controller.change(u.ModelModifier.setLayoutDir({model:n,layoutDir:t}))},getRelativeRect:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return Re(t,o(ve.DRAG_SCROLL_WIDGET_KEY).bigView,r)},getRelativeRectFromViewPort:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return Re(t,o(ve.DRAG_SCROLL_WIDGET_KEY).viewBox,r)},getRelativeVectorFromViewPort:function(e){return Le(e.element,(0,e.getRef)(ve.DRAG_SCROLL_WIDGET_KEY).viewBox)},addZoomFactorChangeEventListener:function(e){e.controller.run("addTempValueChangeListener",b({key:"ZoomFactor"},e))},removeZoomFactorChangeEventListener:function(e){e.controller.run("removeTempValueChangeListener",b({key:"ZoomFactor"},e))},setZoomFactor:function(e){var t=e.controller,n=e.zoomFactor;return t.run("setTempValue",{key:"ZoomFactor",value:n})},getZoomFactor:function(e){return e.controller.run("getTempValue",{key:"ZoomFactor"})||1},moveTopicToCenter:function(e){var t=e.getRef,n=e.topicKey,o=e.model;if(o.editorRootTopicKey!==n&&u.getRelationship(o,n,o.editorRootTopicKey)!==u.TopicRelationship.DESCENDANT)throw new Error("moveTopicToCenter error: topicKey "+n+" is not the DESCENDANT of editor root topic");var r=t(fe(n)),i=t(ve.DRAG_SCROLL_WIDGET_KEY),a=i.viewBox;if(!r||!a)throw new Error("moveTopicToCenter error: topic or viewBox is null");var c=Le(r,a);i.setViewBoxScrollDelta(c[0],c[1])},focusTopicAndMoveToCenter:function(e){var t=e.controller,n=e.topicKey;t.run("operation",b(b({},e),{opArray:[{opType:u.OpType.FOCUS_TOPIC,topicKey:n,focusMode:u.FocusMode.NORMAL},{opType:u.OpType.EXPAND_TO,topicKey:n}],callback:function(){t.run("moveTopicToCenter",b(b({},e),{topicKey:n}))}}))}},Ke(),uo(),ie(),Pe(),{getValue:function(e,t){var n=e.propKey,o=e.controller;switch(n){case be.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:return 3;case be.TOPIC_CONTEXT_MENU_ENABLED:return o.run("isOperationEnabled",e);case be.TOPIC_TITLE:return o.run("getTopicTitle",e)}return t()}},d()]}l("node:Diagram");var fo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resolveController=p((function(e,n){void 0===e&&(e=[]);var o=n();t.controller=new u.Controller({plugins:[e,o],construct:!1,onChange:t.props.onChange})})),t}return T(t,e),t.prototype.getDiagramProps=function(){return this.controller.run("getDiagramProps")},t.prototype.openNewModel=function(e){var t=this,n=this.getDiagramProps(),o=n.model,r=n.controller;r.run("deleteRefKey",b(b({},n),{topicKey:o.rootTopicKey})),r.run("operation",b(b({},n),{opType:u.OpType.EXPAND_TO,topicKey:e.focusKey,model:e,callback:function(){var e=t.getDiagramProps(),n=e.model;r.run("moveTopicToCenter",b(b({},e),{topicKey:n.focusKey}))}}))},t.prototype.render=function(){var e=this.props.plugins;return this.resolveController(e,po),this.diagramProps=b(b({},this.props),{controller:this.controller}),this.controller.run("renderDiagram",this.diagramProps)},t}(r.Component);t.BaseWidget=B,t.Btn=X,t.CloseIcon=$,t.DefaultPlugin=po,t.Diagram=fo,t.DragScrollWidget=H,t.EventKey=Te,t.Flex=Y,t.HotKeyName=Ie,t.HotKeyPlugin=Pe,t.Icon=le,t.IconBg=J,t.IconName=ae,t.Margin=Z,t.PanelTabRoot=oe,t.PropKey=be,t.RefKey=ve,t.SaveRef=U,t.ShowMenuIcon=q,t.StyledCheckbox=Q,t.Title=ee,t.TopicBlockIcon=te,t.ZIndex=ne,t.browserDownloadFile=Oe,t.browserDownloadText=ke,t.browserOpenFile=xe,t.cancelEvent=Ee,t.center=je,t.centerPointX=De,t.centerPointY=_e,t.centerX=we,t.centerY=Se,t.collapseRefKey=ye,t.contentEditorRefKey=ue,t.contentRefKey=se,t.descEditorRefKey=pe,t.dropAreaRefKey=ge,t.getLinkKey=function(e,t){return"link-"+e+"-"+t},t.getRelativeRect=Re,t.getRelativeVector=Le,t.iconClassName=ce,t.linksRefKey=me,t.linksSvgRefKey=he,t.paddingCss=Ce,t.topicRefKey=fe,t.topicWidgetRefKey=de},397:function(e,t,n){"use strict";function o(e){return e&&"object"===typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(0),a=n(32),c=o(n(654)),l=o(n(18)),s=o(n(11)),u=o(n(325)),p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function d(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var f=function(){return(f=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var m,h,y,g=l("node:topic-content-editor"),v=s.div(y||(m=["\n  ",";\n"],h=["\n  ",";\n"],Object.defineProperty?Object.defineProperty(m,"raw",{value:h}):m.raw=h,y=m),(function(e){return!e.readOnly&&"\n    // padding: 75px\n    // min-width: 150px\n    // min-height: 150px\n  "})),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t.prototype.initState=function(){e.prototype.initState.call(this);var t=this.props,n=t.controller,o="topic-desc-data-"+t.topicKey,r=this.state.content;n.run("setTempValue",{key:o,value:r})},t.prototype.getCustomizeProps=function(){var e=this.props,t=e.model,n=e.topicKey;return{block:t.getTopic(n).getBlock(r.BlockType.DESC).block,readOnly:t.editingDescKey!==n,getRefKeyFunc:a.descEditorRefKey,placeholder:"write topic notes here"}},t.prototype.onChange=function(e){var t=this.props,n=t.controller,o="topic-desc-data-"+t.topicKey;n.run("setTempValue",{key:o,value:e}),this.setState({content:e})},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.onMouseDown=function(e){e.stopPropagation()},n.onMouseMove=function(e){e.stopPropagation()},n.rootRef=function(e){return function(t){e(t),n.root=t}},n._handleClick=function(e){!n.root.contains(e.target)&&n.onClickOutSide(e)},n.initState(),n}return d(t,e),t.prototype.initState=function(){this.state={content:this.getContent()}},t.prototype.getContent=function(){return this.getCustomizeProps().block.data},t.prototype.onChange=function(e){this.setState({content:e})},t.prototype.getCustomizeProps=function(){return null},t.prototype.componentDidMount=function(){document.addEventListener("click",this._handleClick)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this._handleClick)},t.prototype.onClickOutSide=function(e){},t.prototype.render=function(){var e=this.props,t=e.topicKey,n=e.saveRef,o=this.getCustomizeProps(),r=o.readOnly,a=o.getRefKeyFunc,l=o.placeholder;g("readOnly:",r);var s=r?this.getContent():this.state.content;if(null==s)return null;var u=a(t),p=this.onMouseDown,d=this.onMouseMove,m={editorValue:s,readOnly:r,onChange:this.onChange.bind(this),placeholder:l},h={key:u,ref:this.rootRef(n(u)),readOnly:r,onMouseDown:p,onMouseMove:d};return i.createElement(v,f({},h),i.createElement(c,f({},m)))},t}(a.BaseWidget)),b=new u;t.default=function(){return{renderTopicDescEditor:function(e){return i.createElement(T,f({},e))},isBlockEmpty:function(e,t){var n=e.block,o=e.controller;return n.type===r.BlockType.CONTENT||n.type===r.BlockType.DESC?null==n.data||""===o.run("serializeBlockData",e):t()},serializeBlockData:function(e,t){var n=e.block;return n.type===r.BlockType.DESC?"string"===typeof n.data?n.data:b.serialize(n.data):t()}}}},403:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(6),i=(o=n(18))&&"object"===typeof o&&"default"in o?o.default:o,a=n(3),c=function(){return(c=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},l=i("plugin:json-serializer");t.JsonSerializerPlugin=function(){return{serializeModel:function(e,t){var n=t();if(null!=n)return n;var o=e.model,r=e.controller;return{rootTopicKey:o.rootTopicKey,editorRootTopicKey:o.editorRootTopicKey,focusKey:o.focusKey,extData:r.run("serializeExtData",c(c({},e),{extData:o.extData})),topics:o.topics.valueSeq().toArray().map((function(t){return r.run("serializeTopic",c(c({},e),{topic:t}))})),config:r.run("serializeConfig",c(c({},e),{config:o.config})),formatVersion:o.formatVersion}},deserializeModel:function(e,t){var n=t();if(null!=n)return n;var o=e.obj,i=e.controller;null==o.formatVersion&&(o.formatVersion="0.0");var a=o.rootTopicKey,s=o.editorRootTopicKey,u=o.focusKey,p=o.topics,d=o.config,f=o.extData,m=o.formatVersion,h=new r.Model;return null==(h=h.merge({rootTopicKey:a,editorRootTopicKey:null==s?a:s,focusKey:u,extData:i.run("deserializeExtData",c(c({},e),{extData:f,formatVersion:m})),config:i.run("deserializeConfig",c(c({},e),{config:d,formatVersion:m})),topics:i.run("deserializeTopics",c(c({},e),{topics:p,formatVersion:m})),formatVersion:o.formatVersion})).focusKey&&(h=h.set("focusKey",h.rootTopicKey)),null==h.focusMode&&(h=h.set("focusMode",r.FocusMode.NORMAL)),l("deserializeModel",h),h},serializeExtData:function(e,t){var n=t();if(null!=n)return n;var o=e.extData,r=e.controller,i={};return o.forEach((function(t,n){i[n]=r.run("serializeExtDataItem",{props:e,extDataKey:n,extDataItem:t})})),i},deserializeExtData:function(e,t){var n=t();if(null!=n)return n;var o=e.extData,r=e.controller,i=a.Map();for(var l in o)i=i.set(l,r.run("deserializeExtDataItem",c(c({},e),{extDataKey:l,extDataItem:o[l]})));return i},serializeExtDataItem:function(e,t){var n=t();if(null!=n)return n;var o=e.extDataItem;return a.isImmutable(o)?o.toJS():o},deserializeExtDataItem:function(e,t){var n=t();return null!=n?n:e.extDataItem},serializeConfig:function(e,t){var n=t();return null!=n?n:e.config.toJS()},deserializeConfig:function(e,t){var n=t();if(null!=n)return n;var o=e.config;return new r.Config(o)},serializeTopic:function(e,t){var n=t();if(null!=n)return n;var o=e.topic,r=e.controller;return{key:o.key,parentKey:o.parentKey,subKeys:o.subKeys.toArray(),collapse:o.collapse,style:o.style,blocks:o.blocks.map((function(t){return r.run("serializeBlock",c(c({},e),{block:t}))}))}},deserializeTopic:function(e,t){var n=t();if(null!=n)return n;var o=e.topic,i=e.controller,l=o.key,s=o.parentKey,u=o.subKeys,p=o.blocks,d=o.style,f=o.collapse,m=new r.Topic;return m=m.merge({key:l,parentKey:s,subKeys:a.List(u),style:d,collapse:f,blocks:i.run("deserializeBlocks",c(c({},e),{blocks:p}))})},deserializeTopics:function(e,t){var n=t();if(null!=n)return n;var o=e.topics,r=e.controller,i=a.Map();return i=i.withMutations((function(t){o.forEach((function(n){return t.set(n.key,r.run("deserializeTopic",c(c({},e),{topic:n})))}))}))},serializeBlock:function(e,t){var n=t();if(null!=n)return n;var o=e.block,r=e.controller;return{type:o.type,data:r.run("serializeBlockData",c({},e))}},serializeBlockData:function(e,t){var n=t();return null!=n?n:e.block.data},deserializeBlock:function(e,t){var n=t();if(null!=n)return n;var o=e.block,i=e.controller,a=o.type;return new r.Block({type:a,data:i.run("deserializeBlockData",c(c({},e),{block:o}))})},deserializeBlockData:function(e,t){var n=t();return null!=n?n:e.block.data},deserializeBlocks:function(e,t){var n=t();if(null!=n)return n;var o=e.blocks,r=e.controller,i=a.List();return i=i.withMutations((function(t){o.forEach((function(n){return t.push(r.run("deserializeBlock",c(c({},e),{block:n})))}))}))}}}},404:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),r={name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5",fontSize:"16px"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"36px"},subLinkStyle:{lineType:"curve",lineWidth:"3px"}},primaryTopic:{contentStyle:{fontSize:"24px"},subLinkStyle:{lineType:"curve",lineWidth:"3px"}},normalTopic:{subLinkStyle:{lineType:"curve",lineWidth:"3px"}}},i={name:"theme1",randomColor:!1,background:"rgb(250,245,205)",highlightColor:"#50C9CE",marginH:50,marginV:30,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5},rootTopic:{contentStyle:{background:"rgb(221, 170, 68)",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"rgb(221, 170, 68)"}},primaryTopic:{contentStyle:{background:"#e8eaec",borderWidth:"2px",borderStyle:"solid",borderColor:"rgb(221, 170, 68)",borderRadius:"5px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"rgb(221, 170, 68)"}},normalTopic:{contentStyle:{background:"#fff",border:"1px solid #e8eaec",borderRadius:"20px",color:"rgb(187, 136, 34)",fontSize:"13px",padding:"4px 10px"},subLinkStyle:{lineType:"round",lineRadius:5,lineWidth:"1px",lineColor:"rgb(187, 136, 34)"}}},a={name:"theme2",randomColor:!1,background:"#f8f8f8",highlightColor:"#50C9CE",marginH:45,marginV:10,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5},rootTopic:{contentStyle:{background:"#50C18A",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"#43a9ff"}},primaryTopic:{contentStyle:{background:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(221, 170, 68)",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px"},subLinkStyle:{lineType:"round",lineRadius:5,lineWidth:"2px",lineColor:"#43a9ff"}},normalTopic:{contentStyle:{background:"#fff",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc"},subLinkStyle:{lineType:"round",lineRadius:5,lineWidth:"1px",lineColor:"#43a9ff"}}},c={name:"theme3",randomColor:!1,background:"#A9DEF9",highlightColor:"#50C9CE",marginH:50,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5},rootTopic:{contentStyle:{background:"#FF99C8",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"#43a9ff"}},primaryTopic:{contentStyle:{background:"#FCF6BD",borderWidth:"1px",borderStyle:"solid",borderColor:"#E4C1F9",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"#43a9ff"}},normalTopic:{contentStyle:{background:"#E4FDE1",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc"},subLinkStyle:{lineType:"round",lineRadius:5,lineWidth:"1px",lineColor:"#43a9ff"}}},l={name:"theme3",randomColor:!1,background:"#CCFBFE",highlightColor:"#50C9CE",marginH:50,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5},rootTopic:{contentStyle:{background:"#CD8987",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"#43a9ff"}},primaryTopic:{contentStyle:{background:"#CDACA1",borderWidth:"1px",borderStyle:"solid",borderColor:"#E4C1F9",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px"},subLinkStyle:{lineType:"line",lineWidth:"2px",lineColor:"#43a9ff"}},normalTopic:{contentStyle:{background:"#CDCACC",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc"},subLinkStyle:{lineType:"line",lineRadius:5,lineWidth:"1px",lineColor:"#43a9ff"}}};t.ThemeSelectorPlugin=function(){var e=new Map([["default",o.defaultTheme],["random-color-square",r],["theme1",i],["theme2",a],["theme3",c],["theme4",l]]);return{getAllThemes:function(t){return e},setTheme:function(e){var t=e.model,n=e.controller,r=e.themeKey,i=n.run("getAllThemes",e);if(!i.has(r))throw new Error("setTheme: the theme key is not correct!");var a=i.get(r),c=o.ModelModifier.setTheme({model:t,theme:a});n.change(c)}}},t.theme1=i,t.theme2=a,t.theme3=c,t.theme4=l,t.themeRandomColorSquare=r},405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),r=n(32),i=n(4),a=n(0),c=n(869),l=n(76),s=n(927);n(956);var u,p=(u=n(11))&&"object"===typeof u&&"default"in u?u.default:u,d=n(958),f=n(969),m=n(973),h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function y(e,t){function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var g=function(){return(g=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function v(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function T(e){var t=e.controller,n=e.model,o=e.topicKey,i=n.focusKey===o&&"FOCUS_MODE_EDITING_TOPOLOGY"===n.focusMode,c=n.getTopic(o).getBlock("TOPOLOGY").block;if(!i&&!c)return null;var l={className:r.iconClassName("topology"),onClick:function(n){n.stopPropagation(),t.run("operation",g(g({},e),{opType:"OP_TYPE_START_EDITING_TOPOLOGY"}))},tabIndex:-1};return a.createElement(r.TopicBlockIcon,g({},l))}var b,E,O,k,x,C,S,w,D,_,j=[{group:"Basic",children:[{name:"rectangle",icon:"icon-rect",data:{text:"Topology",rect:{width:100,height:100},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,name:"rectangle",icon:"\ue64d",iconFamily:"topology",iconColor:"#2f54eb"}},{name:"rectangle",icon:"icon-rectangle",data:{text:"rectangle",rect:{width:200,height:50},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,borderRadius:.1,name:"rectangle"}},{name:"circle",icon:"icon-circle",data:{text:"circle",rect:{width:100,height:100},name:"circle",textMaxLine:1}},{name:"triangle",icon:"icon-triangle",data:{text:"triangle",rect:{width:100,height:100},name:"triangle"}},{name:"diamond",icon:"icon-diamond",data:{text:"diamond",rect:{width:100,height:100},name:"diamond"}},{name:"pentagon",icon:"icon-pentagon",data:{text:"pentagon",rect:{width:100,height:100},name:"pentagon"}},{name:"hexagon",icon:"icon-hexagon",data:{text:"hexagon",rect:{width:100,height:100},paddingTop:10,paddingBottom:10,name:"hexagon"}},{name:"pentagram",icon:"icon-pentagram",data:{text:"pentagram",rect:{width:100,height:100},name:"pentagram"}},{name:"left arrow",icon:"icon-arrow-left",data:{text:"",rect:{width:200,height:100},name:"leftArrow"}},{name:"right arrow",icon:"icon-arrow-right",data:{text:"",rect:{width:200,height:100},name:"rightArrow"}},{name:"bidirectional arrow",icon:"icon-twoway-arrow",data:{text:"",rect:{width:200,height:100},name:"twowayArrow"}},{name:"line",icon:"icon-line",data:{text:"line",rect:{width:100,height:100},name:"line"}},{name:"cloud",icon:"icon-cloud",data:{text:"cloud",rect:{width:100,height:100},name:"cloud"}},{name:"message",icon:"icon-msg",data:{text:"message",rect:{width:100,height:100},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,name:"message"}},{name:"file",icon:"icon-file",data:{text:"file",rect:{width:80,height:100},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,name:"file"}},{name:"text",icon:"icon-text",data:{text:"text",rect:{width:160,height:30},name:"text"}},{name:"image",icon:"icon-image",data:{text:"",rect:{width:100,height:100},name:"image",image:"/assets/img/logo.png"}},{name:"cube",icon:"icon-cube",data:{rect:{width:50,height:70},is3D:!0,z:10,zRotate:15,fillStyle:"#ddd",name:"cube",icon:"\ue63c",iconFamily:"topology",iconColor:"#777",iconSize:30}},{name:"people",icon:"icon-people",data:{rect:{width:70,height:100},name:"people"}},{name:"multi media",icon:"icon-pc",data:{text:"multi media",rect:{width:200,height:200},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,name:"div"}}]},{group:"Flow Graph",children:[{name:"start/end",icon:"icon-flow-start",data:{text:"start",rect:{width:120,height:40},borderRadius:.5,name:"rectangle"}},{name:"flow",icon:"icon-rectangle",data:{text:"flow",rect:{width:120,height:40},name:"rectangle"}},{name:"judgement",icon:"icon-diamond",data:{text:"judgement",rect:{width:120,height:60},name:"diamond"}},{name:"data",icon:"icon-flow-data",data:{text:"data",rect:{width:120,height:50},name:"flowData"}},{name:"prepare",icon:"icon-flow-ready",data:{text:"prepare",rect:{width:120,height:50},name:"hexagon"}},{name:"sub flow",icon:"icon-flow-subprocess",data:{text:"sub flow",rect:{width:120,height:50},name:"flowSubprocess"}},{name:"database",icon:"icon-db",data:{text:"database",rect:{width:80,height:120},name:"flowDb"}},{name:"document",icon:"icon-flow-document",data:{text:"document",rect:{width:120,height:100},name:"flowDocument"}},{name:"internal storage",icon:"icon-internal-storage",data:{text:"internal storage",rect:{width:120,height:80},name:"flowInternalStorage"}},{name:"external storage",icon:"icon-extern-storage",data:{text:"external storage",rect:{width:120,height:80},name:"flowExternStorage"}},{name:"queue",icon:"icon-flow-queue",data:{text:"queue",rect:{width:100,height:100},name:"flowQueue"}},{name:"input manually",icon:"icon-flow-manually",data:{text:"input manually",rect:{width:120,height:80},name:"flowManually"}},{name:"display",icon:"icon-flow-display",data:{text:"display",rect:{width:120,height:80},name:"flowDisplay"}},{name:"parallel",icon:"icon-flow-parallel",data:{text:"parallel",rect:{width:120,height:50},name:"flowParallel"}},{name:"comment",icon:"icon-flow-comment",data:{text:"comment",rect:{width:100,height:100},name:"flowComment"}}]},{group:"Activity Diagram",children:[{name:"start",icon:"icon-inital",data:{text:"",rect:{width:30,height:30},name:"circle",fillStyle:"#555",strokeStyle:"transparent"}},{name:"end",icon:"icon-final",data:{text:"",rect:{width:30,height:30},name:"activityFinal"}},{name:"action",icon:"icon-action",data:{text:"action",rect:{width:120,height:50},borderRadius:.25,name:"rectangle"}},{name:"decision/merge",icon:"icon-diamond",data:{text:"\u51b3\u7b56",rect:{width:120,height:50},name:"diamond"}},{name:"vertical swimming lane",icon:"icon-swimlane-v",data:{text:"vertical swimming lane",rect:{width:200,height:500},name:"swimlaneV"}},{name:"horizontal swimming lane",icon:"icon-swimlane-h",data:{text:"horizontal swimming lane",rect:{width:500,height:200},name:"swimlaneH"}},{name:"vertical fork/merge",icon:"icon-fork-v",data:{text:"",rect:{width:10,height:150},name:"forkV",fillStyle:"#555",strokeStyle:"transparent"}},{name:"horizontal fork/merge",icon:"icon-fork",data:{text:"",rect:{width:150,height:10},name:"forkH",fillStyle:"#555",strokeStyle:"transparent"}}]},{group:"Sequence Diagram && Class Diagram",children:[{name:"lifeline",icon:"icon-lifeline",data:{text:"lifeline",rect:{width:150,height:400},name:"lifeline"}},{name:"activation",icon:"icon-focus",data:{text:"",rect:{width:12,height:200},name:"sequenceFocus"}},{name:"simple class",icon:"icon-simple-class",data:{text:"Topolgoy",rect:{width:270,height:200},paddingTop:40,font:{fontFamily:"Arial",color:"#222",fontWeight:"bold"},fillStyle:"#ffffba",strokeStyle:"#7e1212",name:"simpleClass",children:[{text:"- name: string\n+ setName(name: string): void",name:"text",paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rectInParent:{x:0,y:0,width:"100%",height:"100%",rotate:0},font:{fontFamily:"Arial",color:"#222",textAlign:"left",textBaseline:"top"}}]}},{name:"class",icon:"icon-class",data:{text:"Topolgoy",rect:{width:270,height:200},paddingTop:40,font:{fontFamily:"Arial",color:"#222",fontWeight:"bold"},fillStyle:"#ffffba",strokeStyle:"#7e1212",name:"interfaceClass",children:[{text:"- name: string",name:"text",paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rectInParent:{x:0,y:0,width:"100%",height:"50%",rotate:0},font:{fontFamily:"Arial",color:"#222",textAlign:"left",textBaseline:"top"}},{text:"+ setName(name: string): void",name:"text",paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rectInParent:{x:0,y:"50%",width:"100%",height:"50%",rotate:0},font:{fontFamily:"Arial",color:"#222",textAlign:"left",textBaseline:"top"}}]}}]}],R=p.div(b||(b=v(["\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 100%;\n"],["\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 100%;\n"]))),L=p.div(E||(E=v(["\n  flex: 1;\n  width: initial;\n  position: relative;\n  overflow: auto;\n  background: #fff;\n"],["\n  flex: 1;\n  width: initial;\n  position: relative;\n  overflow: auto;\n  background: #fff;\n"]))),I=p.div(O||(O=v(["\n  flex-shrink: 0;\n  width: 1.75rem;\n  background-color: #f8f8f8;\n  border-right: 1px solid #d9d9d9;\n  overflow-y: auto;\n"],["\n  flex-shrink: 0;\n  width: 1.75rem;\n  background-color: #f8f8f8;\n  border-right: 1px solid #d9d9d9;\n  overflow-y: auto;\n"]))),P=p.div(k||(k=v(["\n  color: #0d1a26;\n  font-weight: 600;\n  font-size: 0.12rem;\n  padding: 0.05rem 0.1rem;\n  margin-top: 0.08rem;\n  border-bottom: 1px solid #ddd;\n\n  &:first-child {\n    border-top: none;\n  }\n"],["\n  color: #0d1a26;\n  font-weight: 600;\n  font-size: 0.12rem;\n  padding: 0.05rem 0.1rem;\n  margin-top: 0.08rem;\n  border-bottom: 1px solid #ddd;\n\n  &:first-child {\n    border-top: none;\n  }\n"]))),M=p.div(x||(x=v(["\n  padding: 0.1rem 0;\n  a {\n    display: inline-block;\n    color: @text-color;\n    line-height: 1;\n    width: 0.4rem;\n    height: 0.4rem;\n    text-align: center;\n    text-decoration: none !important;\n\n    .iconfont {\n      font-size: 0.24rem;\n    }\n  }\n"],["\n  padding: 0.1rem 0;\n  a {\n    display: inline-block;\n    color: @text-color;\n    line-height: 1;\n    width: 0.4rem;\n    height: 0.4rem;\n    text-align: center;\n    text-decoration: none !important;\n\n    .iconfont {\n      font-size: 0.24rem;\n    }\n  }\n"]))),K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={id:"",data:null,toolsConfig:j,iconfont:{fontSize:"0.24rem"}},t.canvasOptions={},t.handleContextMenu=function(e){e.preventDefault(),e.stopPropagation()},t.onMessage=function(e,n){var o=(0,t.props.getRef)("TOPOLOGY_DIAGRAM_UTIL");switch(e){case"resize":case"scale":case"locked":t.topology&&o&&o.setCanvasData(t.topology.data)}},t}return y(t,e),t.prototype.canvasRegister=function(){l.registerNode("flowData",s.flowData,s.flowDataAnchors,s.flowDataIconRect,s.flowDataTextRect),l.registerNode("flowSubprocess",s.flowSubprocess,null,s.flowSubprocessIconRect,s.flowSubprocessTextRect),l.registerNode("flowDb",s.flowDb,null,s.flowDbIconRect,s.flowDbTextRect),l.registerNode("flowDocument",s.flowDocument,s.flowDocumentAnchors,s.flowDocumentIconRect,s.flowDocumentTextRect),l.registerNode("flowInternalStorage",s.flowInternalStorage,null,s.flowInternalStorageIconRect,s.flowInternalStorageTextRect),l.registerNode("flowExternStorage",s.flowExternStorage,s.flowExternStorageAnchors,s.flowExternStorageIconRect,s.flowExternStorageTextRect),l.registerNode("flowQueue",s.flowQueue,null,s.flowQueueIconRect,s.flowQueueTextRect),l.registerNode("flowManually",s.flowManually,s.flowManuallyAnchors,s.flowManuallyIconRect,s.flowManuallyTextRect),l.registerNode("flowDisplay",s.flowDisplay,s.flowDisplayAnchors,s.flowDisplayIconRect,s.flowDisplayTextRect),l.registerNode("flowParallel",s.flowParallel,s.flowParallelAnchors,null,null),l.registerNode("flowComment",s.flowComment,s.flowCommentAnchors,null,null),l.registerNode("activityFinal",d.activityFinal,null,d.activityFinalIconRect,d.activityFinalTextRect),l.registerNode("swimlaneV",d.swimlaneV,null,d.swimlaneVIconRect,d.swimlaneVTextRect),l.registerNode("swimlaneH",d.swimlaneH,null,d.swimlaneHIconRect,d.swimlaneHTextRect),l.registerNode("forkH",d.fork,d.forkHAnchors,d.forkIconRect,d.forkTextRect),l.registerNode("forkV",d.fork,d.forkVAnchors,d.forkIconRect,d.forkTextRect),l.registerNode("simpleClass",f.simpleClass,null,f.simpleClassIconRect,f.simpleClassTextRect),l.registerNode("interfaceClass",f.interfaceClass,null,f.interfaceClassIconRect,f.interfaceClassTextRect),l.registerNode("lifeline",m.lifeline,m.lifelineAnchors,m.lifelineIconRect,m.lifelineTextRect),l.registerNode("sequenceFocus",m.sequenceFocus,m.sequenceFocusAnchors,m.sequenceFocusIconRect,m.sequenceFocusTextRect)},t.prototype.componentDidMount=function(){this.canvasRegister(),this.canvasOptions.on=this.onMessage,this.topology=new c.Topology("topology-canvas",this.canvasOptions),this.openData()},t.prototype.componentDidUpdate=function(){this.openData()},t.prototype.openData=function(){var e=this.props,t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock("TOPOLOGY").block;o&&o.data&&""!==o.data&&(this.setState({data:o.data}),this.topology.open(o.data))},t.prototype.onDrag=function(e,t){e.dataTransfer.setData("Text",JSON.stringify(t.data))},t.prototype.renderTools=function(){var e=this;return a.createElement(I,null,this.state.toolsConfig.map((function(t,n){return a.createElement("div",{key:n},a.createElement(P,null,t.group),a.createElement(M,null,t.children.map((function(t,n){return a.createElement("a",{key:n,title:t.name,draggable:!0,onDragStart:function(n){e.onDrag(n,t)}},a.createElement("i",{className:"iconfont "+t.icon,style:e.state.iconfont}))}))))})))},t.prototype.render=function(){return a.createElement(R,null,this.renderTools(),a.createElement(L,{id:"topology-canvas",onContextMenu:this.handleContextMenu}))},t}(r.BaseWidget),N=p.div(C||(C=v(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  z-index: 3;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  z-index: 3;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"]))),A=p(r.Btn)(S||(S=v(["\n  margin: 10px;\n"],["\n  margin: 10px;\n"]))),F=function(e){return a.createElement(i.Tooltip,{content:e.tooltip,position:i.Position.TOP,className:i.Classes.ICON},a.createElement(A,{onClick:e.onClick},e.children))},B=p.span(w||(w=v(["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"],["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"]))),W=function(e){function t(t){var n=e.call(this,t)||this;return n.setCanvasData=function(e){n.setState({canvasData:e})},n.onClickResetZoom=function(e){n.getTopology().scaleTo(1)},n.state={deleteConfirm:!1,canvasData:null},n}return y(t,e),t.prototype.getTopology=function(){return(0,this.props.getRef)("TOPOLOGY_DIAGRAM").topology},t.prototype.render=function(){var e=this,t=this.props,n=t.controller,c={isOpen:this.state.deleteConfirm,cancelButtonText:"cancel",onConfirm:function(e){n.run("operation",g(g({},t),{opType:o.OpType.DELETE_TOPIC_BLOCK,blockType:"TOPOLOGY"}))},onCancel:function(t){e.setState({deleteConfirm:!1})},onClose:function(t){e.setState({deleteConfirm:!1})}},l=this.state.canvasData,s=l?l.scale:1;return a.createElement(N,null,a.createElement(F,{onClick:this.onClickResetZoom,tooltip:"reset zoom"},a.createElement(B,null,"zoom:"+Math.floor(100*s)+"%")),a.createElement(F,{onClick:function(t){e.setState({deleteConfirm:!0})},tooltip:"delete this diagram"},r.Icon(r.IconName.TRASH)),a.createElement(i.Alert,g({},c),a.createElement("p",null,"Are you confirm to delete this topology diagram?")))},t}(a.Component),z=p.div(D||(D=v(["\n  position: relative;\n  overflow: auto;\n  padding: 0px 0px 0px 5px;\n  background: #88888850;\n  height: 100%;\n"],["\n  position: relative;\n  overflow: auto;\n  padding: 0px 0px 0px 5px;\n  background: #88888850;\n  height: 100%;\n"]))),G=p.span(_||(_=v(["\n  padding: 0px 20px;\n"],["\n  padding: 0px 20px;\n"])));function H(e){var t=e.controller,n=e.topicKey,c=e.getRef,l=e.saveRef,s=g(g({},e),{ref:l("TOPOLOGY_DIAGRAM")}),u=g(g({},e),{ref:l("TOPOLOGY_DIAGRAM_UTIL")});return a.createElement(i.Drawer,{title:a.createElement(G,null,"Topology Diagram Editor"),icon:r.Icon("topology"),isOpen:!0,hasBackdrop:!0,backdropClassName:"backdrop",backdropProps:{onMouseDown:r.cancelEvent},canOutsideClickClose:!1,isCloseButtonShown:!0,onClose:function(r){r.stopPropagation();var i=c("TOPOLOGY_DIAGRAM").topology.data;t.run("operation",g(g({},e),{opType:o.OpType.SET_TOPIC_BLOCK,topicKey:n,blockType:"TOPOLOGY",data:i,focusMode:o.FocusMode.NORMAL}))},size:"100%"},a.createElement(z,{onClick:r.cancelEvent,onDoubleClick:r.cancelEvent},a.createElement(K,g({},s)),a.createElement(W,g({},u))))}function V(e){var t=e.model,n=e.topicKey,r=t.getTopic(n).getBlock("TOPOLOGY").block;return null!=r&&null!=r.data||(t=o.ModelModifier.setBlockData({model:t,topicKey:n,blockType:"TOPOLOGY",data:""})),t=o.ModelModifier.focusTopic({model:t,topicKey:n,focusMode:"FOCUS_MODE_EDITING_TOPOLOGY"})}t.default=function(){return{renderTopicBlock:function(e,t){var n=e.controller;return"TOPOLOGY"===e.block.type?n.run("renderTopicBlockTopology",e):t()},renderTopicBlockTopology:function(e){return a.createElement(T,g({},e))},renderDrawer:function(e,t){var n=e.model;if("FOCUS_MODE_EDITING_TOPOLOGY"===n.focusMode){var o=g(g({},e),{topicKey:n.focusKey,key:"topology-drawer"});return a.createElement(H,g({},o))}return t()},customizeTopicContextMenu:function(e,t){var n=e.controller;return a.createElement(a.Fragment,null,t(),a.createElement(i.MenuDivider,null),a.createElement(i.MenuItem,{icon:r.Icon("topology"),text:"Edit Topology Diagram",onClick:function(t){n.run("operation",g(g({},e),{opType:"OP_TYPE_START_EDITING_TOPOLOGY"}))}}))},getOpMap:function(e,t){var n=t();return n.set("OP_TYPE_START_EDITING_TOPOLOGY",V),n}}}},406:function(e,t,n){e.exports=n.p+"static/media/default.4f8c4983.jpg"},407:function(e,t,n){e.exports=n.p+"static/media/theme1.2f59f00b.jpg"},408:function(e,t,n){e.exports=n.p+"static/media/theme2.b18193fb.jpg"},409:function(e,t,n){e.exports=n.p+"static/media/theme3.61c97910.jpg"},410:function(e,t,n){e.exports=n.p+"static/media/theme4.1e21408c.jpg"},424:function(e,t,n){},426:function(e,t,n){},427:function(e,t,n){},428:function(e,t,n){},429:function(e,t,n){},430:function(e,t,n){},444:function(e,t,n){},447:function(e,t,n){},448:function(e,t,n){},449:function(e,t,n){},450:function(e,t,n){},451:function(e,t,n){},475:function(e,t,n){},6:function(e,t,n){"use strict";n.r(t),n.d(t,"Block",(function(){return x})),n.d(t,"BlockType",(function(){return T})),n.d(t,"Config",(function(){return M})),n.d(t,"Controller",(function(){return y})),n.d(t,"DiagramLayoutType",(function(){return h})),n.d(t,"FocusMode",(function(){return b})),n.d(t,"Model",(function(){return N})),n.d(t,"ModelModifier",(function(){return R})),n.d(t,"Modifiers",(function(){return R})),n.d(t,"OpType",(function(){return O})),n.d(t,"Topic",(function(){return C})),n.d(t,"TopicDirection",(function(){return g})),n.d(t,"TopicRelationship",(function(){return E})),n.d(t,"TopicVisualLevel",(function(){return v})),n.d(t,"createKey",(function(){return k})),n.d(t,"defaultTheme",(function(){return I})),n.d(t,"getAllSubTopicKeys",(function(){return S})),n.d(t,"getKeyPath",(function(){return w})),n.d(t,"getRelationship",(function(){return D})),n.d(t,"isThemeType",(function(){return L}));var o=n(18),r=n.n(o),i=n(68),a=n(77),c=n(3),l=n(172),s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function u(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var p=function(){return(p=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function d(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e}r()("core:controller");function m(e){var t,n;if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");try{for(var o=function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(e),r=o.next();!r.done;r=o.next()){if("function"!==typeof r.value)throw new TypeError("Middleware must be composed of functions!")}}catch(i){t={error:i}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return function(t,n){var o=-1;return function r(i){if(i<=o)throw new Error("next() called multiple times");o=i;var a=e[i];i===e.length&&(a=n);if(!a)return null;try{return a(t,r.bind(null,i+1))}catch(c){throw c}}(0)}}var h,y=function(){function e(e){void 0===e&&(e={});var t=e.plugins,n=void 0===t?[]:t,o=e.onChange,r=e.readOnly;this.readOnly=r,this.onChange=o,this.middleware=new Map,function e(t,n){if(Array.isArray(n))n.forEach((function(n){return e(t,n)}));else if(null!=n)for(var o in n){var r=n[o];t.middleware[o]=t.middleware[o]||[],t.middleware[o].push(r)}}(this,function(e){void 0===e&&(e={});var t=e.plugins;return f(void 0===t?[]:t)}({plugins:n}))}return e.prototype.run=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this.middleware,r=o[e]||[];Object(a.default)(0!==r.length,"the middleware function "+e+" is not found!");var c=Object(i.default)(m)(r);return c.apply(void 0,f(t))},e.prototype.getValue=function(e,t){return this.run("getValue",p(p({},t),{propKey:e}))},e.prototype.change=function(e,t){this.onChange(e,t),this.currentModel=e},e}(),g={LEFT:"L",RIGHT:"R",BOTTOM:"B",MAIN:"M"};!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(h||(h={}));var v={ROOT:0,PRIMARY:1,NORMAL:2},T={CONTENT:"CONTENT",DESC:"DESC"},b={NORMAL:"NORMAL",EDITING_CONTENT:"EDITING_CONTENT",EDITING_DESC:"EDITING_DESC",SHOW_POPUP:"SHOW_POPUP",DRAGGING:"DRAGGING"},E={ANCESTOR:"ANCESTOR",DESCENDANT:"DESCENDANT",SIBLING:"SIBLING",NONE:"NONE"},O={TOGGLE_COLLAPSE:"TOGGLE_COLLAPSE",COLLAPSE_ALL:"COLLAPSE_ALL",EXPAND_ALL:"EXPAND_ALL",EXPAND_TO:"EXPAND_TO",ADD_CHILD:"ADD_CHILD",ADD_SIBLING:"ADD_SIBLING",DELETE_TOPIC:"DELETE_TOPIC",FOCUS_TOPIC:"FOCUS_TOPIC",SET_FOCUS_MODE:"SET_FOCUS_MODE",SET_STYLE:"SET_STYLE",SET_THEME:"SET_THEME",SET_TOPIC_BLOCK:"SET_TOPIC_BLOCK",DELETE_TOPIC_BLOCK:"DELETE_TOPIC_BLOCK",START_EDITING_CONTENT:"START_EDITING_CONTENT",START_EDITING_DESC:"START_EDITING_DESC",DRAG_AND_DROP:"DRAG_AND_DROP",SET_EDITOR_ROOT:"SET_EDITOR_ROOT"};function k(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.get("data")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.get("type")},enumerable:!0,configurable:!0}),t.create=function(e){return new t(e)},t.createList=function(e){if(c.List.isList(e)||Array.isArray(e))return Object(c.List)(e.map(t.create));throw new Error("Block.createList only accepts Array or List, but you passed it: "+e)},t}(Object(c.Record)({type:null,key:null,data:null})),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"key",{get:function(){return this.get("key")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentKey",{get:function(){return this.get("parentKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collapse",{get:function(){return this.get("collapse")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subKeys",{get:function(){return this.get("subKeys")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blocks",{get:function(){return this.get("blocks")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relations",{get:function(){return this.get("relations")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.get("style")},enumerable:!0,configurable:!0}),t.prototype.getBlock=function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}},t.fromJSON=function(e){var n=e.key,o=e.parentKey,r=void 0===o?null:o,i=e.blocks,a=e.subKeys,l=void 0===a?[]:a,s=e.collapse;return new t({key:n,parentKey:r,collapse:void 0!==s&&s,subKeys:Object(c.List)(l),blocks:x.createList(i)})},t.create=function(e){var n=e.key,o=e.parentKey,r=void 0===o?null:o,i=e.content,a=void 0===i?"":i,l=e.subKeys,s=void 0===l?[]:l,u=e.collapse,p=void 0!==u&&u,d=x.create({type:T.CONTENT,data:a,key:null});return new t({key:n,parentKey:r,blocks:Object(c.List)([d]),subKeys:Object(c.List)(s),collapse:p})},t}(Object(c.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));function S(e,t){var n=e.getTopic(t),o=[];if(n.subKeys.size>0){var r=n.subKeys.toArray();o.push.apply(o,f(r)),o=r.reduce((function(t,n){return t.push.apply(t,f(S(e,n))),t}),o)}return o}function w(e,t,n){void 0===n&&(n=!1);for(var o=[t],r=e.getTopic(t);r.parentKey;)n?o.push(r.parentKey):o.unshift(r.parentKey),r=e.getParentTopic(r.key);return o}function D(e,t,n){var o=e.getTopic(t),r=e.getTopic(n);if(o&&r){if(o.parentKey==r.parentKey)return E.SIBLING;for(var i=o;i.parentKey;){if(i.parentKey===r.key)return E.DESCENDANT;i=e.getParentTopic(i.key)}for(i=r;i.parentKey;){if(i.parentKey===o.key)return E.ANCESTOR;i=e.getParentTopic(i.key)}}return E.NONE}var _=r()("modifier");function j(e){var t=e.model,n=e.topicKey,o=e.focusMode;return _("focus topic"),n!==t.focusKey&&(t=t.set("focusKey",n)),o!==t.focusMode&&(t=t.set("focusMode",o)),t}var R={addChild:function(e){var t=e.model,n=e.topicKey;_("addChild:",n);var o=t.getTopic(n);if(o){var r=C.create({key:k(),parentKey:o.key});return o=o.set("collapse",!1).update("subKeys",(function(e){return e.push(r.key)})),j({model:t=t.update("topics",(function(e){return e.set(n,o).set(r.key,r)})),topicKey:r.key,focusMode:b.EDITING_CONTENT})}return t},addSibling:function(e){var t=e.model,n=e.topicKey;if(n===t.rootTopicKey)return t;var o=t.getTopic(n);if(o){var r=t.getTopic(o.parentKey),i=r.subKeys.indexOf(n),a=C.create({key:k(),parentKey:r.key});return j({model:t=t.update("topics",(function(e){return e.set(a.key,a)})).updateIn(["topics",r.key,"subKeys"],(function(e){return e.insert(i+1,a.key)})),topicKey:a.key,focusMode:b.EDITING_CONTENT})}return t},toggleCollapse:function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n);return o&&0!==o.subKeys.size&&(o=o.merge({collapse:!o.collapse}),t=t.updateIn(["topics",o.key,"collapse"],(function(e){return!e}))),t=j({model:t,topicKey:n,focusMode:b.NORMAL})},collapseAll:function(e){var t=e.model;_("collapseAll");var n=S(t,t.editorRootTopicKey);return _(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!0)}))})),_(t),t},expandAll:function(e){var t=e.model,n=S(t,t.editorRootTopicKey);return _(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),_(t),t},expandTo:function(e){var t=e.model,n=e.topicKey,o=w(t,n).filter((function(e){return e!==n}));return D(t=t.withMutations((function(e){o.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),n,t.editorRootTopicKey)!==E.DESCENDANT&&(t=t.set("editorRootTopicKey",t.rootTopicKey)),t},focusTopic:j,setFocusMode:function(e){var t=e.model,n=e.focusMode;return _("setFocusMode"),n!==t.focusMode&&(t=t.set("focusMode",n)),t},deleteTopic:function(e){var t=e.model,n=e.topicKey;if(n===t.editorRootTopicKey)return t;var o=t.getTopic(n);return o&&(t=t.withMutations((function(e){e.update("topics",(function(e){e=e.delete(n);var o=S(t,n);return e=e.withMutations((function(e){o.forEach((function(t){e.delete(t)}))}))})),e.updateIn(["topics",o.parentKey,"subKeys"],(function(e){return e.delete(e.indexOf(n))})),e.focusKey===n&&e.set("focusKey",null).set("focusMode",null)}))),t},setBlockData:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=e.focusMode,i=e.data,a=t.getTopic(n);if(a){var c=a.getBlock(o),l=c.index,s=c.block;-1===l?t=t.updateIn(["topics",n,"blocks"],(function(e){return e.push(x.create({type:o,data:i}))})):s.data!==i&&(t=t.updateIn(["topics",n,"blocks",l,"data"],(function(e){return i}))),r&&(t=j({model:t,topicKey:n,focusMode:r}))}return t},deleteBlock:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=t.getTopic(n);if(r){var i=r.getBlock(o).index;-1!==i&&(t=t.updateIn(["topics",n,"blocks"],(function(e){return e.delete(i)}))),t=j({model:t,topicKey:null,focusMode:null})}return t},setStyle:function(e){var t=e.model,n=e.topicKey,o=e.style,r=t.getTopic(n);return r&&o!==r.style&&(t=t.updateIn(["topics",n,"style"],(function(e){return o}))),t},setTheme:function(e){var t=e.model,n=e.theme;return t=t.setIn(["config","theme"],n)},setLayoutDir:function(e){var t=e.model,n=e.layoutDir;return t.config.layoutDir===n?t:t=t.setIn(["config","layoutDir"],n)},setEditorRootTopicKey:function(e){var t=e.model,n=e.topicKey;return t.editorRootTopicKey!==n&&(t=t.set("editorRootTopicKey",n)),t.getTopic(n).collapse&&(t=t.setIn(["topics",n,"collapse"],!1)),t},setZoomFactor:function(e){var t=e.model,n=e.zoomFactor;return t.zoomFactor!==n&&(t=t.set("zoomFactor",n)),t}};function L(e){return null!=e.name&&null!=e.background&&null!=e.highlightColor}var I={name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}},P={readOnly:!1,allowUndo:!0,layoutDir:h.LEFT_AND_RIGHT,theme:I},M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"layoutDir",{get:function(){return this.get("layoutDir")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readOnly",{get:function(){return this.get("readOnly")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowUndo",{get:function(){return this.get("allowUndo")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this.get("theme")},enumerable:!0,configurable:!0}),t.fromJSON=function(e){return new t(e)},t}(Object(c.Record)(P)),K={topics:Object(c.Map)(),extData:Object(c.Map)(),config:null,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1},N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.isModel=function(e){return e instanceof t},t.create=function(e){if(void 0===e&&(e=null),null==e)return t.createEmpty();var n;if(t.isModel(e)&&(n=e),Object(l.a)(e)&&(n=t.fromJSON(e)),n)return null==n.focusKey&&(n=n.set("focusKey",n.rootTopicKey)),null==n.focusMode&&(n=n.set("focusMode",b.NORMAL)),n;throw new Error("`Value.create` only accepts objects or values, but you passed it: "+e)},t.createEmpty=function(){var e=new t,n=C.create({key:k()});return e.update("topics",(function(e){return e.set(n.key,n)})).set("rootTopicKey",n.key).set("focusKey",n.key).set("focusMode",b.NORMAL)},t.fromJSON=function(e){var n=new t,o=e.topics,r=void 0===o?[]:o,i=e.config,a=void 0===i?{}:i,c=e.rootTopicKey,l=e.editorRootTopicKey;return void 0===l&&(l=c),n=(n=n.merge({rootTopicKey:c,editorRootTopicKey:l})).withMutations((function(e){r.forEach((function(t){e.update("topics",(function(e){return e.set(t.key,C.fromJSON(t))}))})),e.set("config",M.fromJSON(a))}))},t.prototype.toJS=function(){return{rootTopicKey:this.rootTopicKey,topics:Object.values(this.topics.toJS()),config:this.config,extData:this.extData,zoomFactor:this.zoomFactor}},Object.defineProperty(t.prototype,"extData",{get:function(){return this.get("extData")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topics",{get:function(){return this.get("topics")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.get("config")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatVersion",{get:function(){return this.get("formatVersion")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootTopicKey",{get:function(){return this.get("rootTopicKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editorRootTopicKey",{get:function(){return this.get("editorRootTopicKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusKey",{get:function(){return this.get("focusKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusMode",{get:function(){return this.get("focusMode")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editingContentKey",{get:function(){return this.focusMode===b.EDITING_CONTENT?this.focusKey:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editingDescKey",{get:function(){return this.focusMode===b.EDITING_DESC?this.focusKey:null},enumerable:!0,configurable:!0}),t.prototype.getTopic=function(e){return this.topics.get(e)},t.prototype.getExtDataItem=function(e,t){return this.extData.get(e)||new t},t.prototype.getParentTopic=function(e){var t=this.getTopic(e);return t.parentKey?this.getTopic(t.parentKey):null},t.prototype.getTopicVisualLevel=function(e){for(var t=this.getTopic(e),n=0;t&&t.key!==this.editorRootTopicKey;)n++,t=this.getParentTopic(t.key);return n},Object.defineProperty(t.prototype,"rootTopic",{get:function(){return this.getTopic(this.rootTopicKey)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomFactor",{get:function(){return this.get("zoomFactor")},enumerable:!0,configurable:!0}),t}(Object(c.Record)(K))},956:function(e,t,n){"use strict";n.r(t);n(957)},957:function(e,t,n){},981:function(e,t,n){},984:function(e,t,n){},985:function(e,t,n){},986:function(e,t,n){},987:function(e,t,n){},989:function(e,t,n){},99:function(e,t,n){"use strict";function o(e){return e&&"object"===typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(18)),i=o(n(68)),a=o(n(77)),c=n(3),l=o(n(999)),s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function u(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var p=function(){return(p=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function d(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e}r("core:controller");function m(e){var t,n;if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");try{for(var o=function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(e),r=o.next();!r.done;r=o.next()){if("function"!==typeof r.value)throw new TypeError("Middleware must be composed of functions!")}}catch(i){t={error:i}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return function(t,n){var o=-1;return function r(i){if(i<=o)throw new Error("next() called multiple times");o=i;var a=e[i];i===e.length&&(a=n);if(!a)return null;try{return a(t,r.bind(null,i+1))}catch(c){throw c}}(0)}}var h,y=function(){function e(e){void 0===e&&(e={});var t=e.plugins,n=void 0===t?[]:t,o=e.onChange,r=e.readOnly;this.readOnly=r,this.onChange=o,this.middleware=new Map,function e(t,n){if(Array.isArray(n))n.forEach((function(n){return e(t,n)}));else if(null!=n)for(var o in n){var r=n[o];t.middleware[o]=t.middleware[o]||[],t.middleware[o].push(r)}}(this,function(e){void 0===e&&(e={});var t=e.plugins;return f(void 0===t?[]:t)}({plugins:n}))}return e.prototype.run=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this.middleware,r=o[e]||[];a(0!==r.length,"the middleware function "+e+" is not found!");var c=i(m)(r);return c.apply(void 0,f(t))},e.prototype.getValue=function(e,t){return this.run("getValue",p(p({},t),{propKey:e}))},e.prototype.change=function(e,t){this.onChange(e,t),this.currentModel=e},e}();(h=t.DiagramLayoutType||(t.DiagramLayoutType={}))[h.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",h[h.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",h[h.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",h[h.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM";var g={CONTENT:"CONTENT",DESC:"DESC"},v={NORMAL:"NORMAL",EDITING_CONTENT:"EDITING_CONTENT",EDITING_DESC:"EDITING_DESC",SHOW_POPUP:"SHOW_POPUP",DRAGGING:"DRAGGING"},T={ANCESTOR:"ANCESTOR",DESCENDANT:"DESCENDANT",SIBLING:"SIBLING",NONE:"NONE"};function b(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.get("data")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.get("type")},enumerable:!0,configurable:!0}),t.create=function(e){return new t(e)},t.createList=function(e){if(c.List.isList(e)||Array.isArray(e))return c.List(e.map(t.create));throw new Error("Block.createList only accepts Array or List, but you passed it: "+e)},t}(c.Record({type:null,key:null,data:null})),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"key",{get:function(){return this.get("key")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentKey",{get:function(){return this.get("parentKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collapse",{get:function(){return this.get("collapse")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subKeys",{get:function(){return this.get("subKeys")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blocks",{get:function(){return this.get("blocks")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relations",{get:function(){return this.get("relations")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.get("style")},enumerable:!0,configurable:!0}),t.prototype.getBlock=function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}},t.fromJSON=function(e){var n=e.key,o=e.parentKey,r=void 0===o?null:o,i=e.blocks,a=e.subKeys,l=void 0===a?[]:a,s=e.collapse;return new t({key:n,parentKey:r,collapse:void 0!==s&&s,subKeys:c.List(l),blocks:E.createList(i)})},t.create=function(e){var n=e.key,o=e.parentKey,r=void 0===o?null:o,i=e.content,a=void 0===i?"":i,l=e.subKeys,s=void 0===l?[]:l,u=e.collapse,p=void 0!==u&&u,d=E.create({type:g.CONTENT,data:a,key:null});return new t({key:n,parentKey:r,blocks:c.List([d]),subKeys:c.List(s),collapse:p})},t}(c.Record({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));function k(e,t){var n=e.getTopic(t),o=[];if(n.subKeys.size>0){var r=n.subKeys.toArray();o.push.apply(o,f(r)),o=r.reduce((function(t,n){return t.push.apply(t,f(k(e,n))),t}),o)}return o}function x(e,t,n){void 0===n&&(n=!1);for(var o=[t],r=e.getTopic(t);r.parentKey;)n?o.push(r.parentKey):o.unshift(r.parentKey),r=e.getParentTopic(r.key);return o}function C(e,t,n){var o=e.getTopic(t),r=e.getTopic(n);if(o&&r){if(o.parentKey==r.parentKey)return T.SIBLING;for(var i=o;i.parentKey;){if(i.parentKey===r.key)return T.DESCENDANT;i=e.getParentTopic(i.key)}for(i=r;i.parentKey;){if(i.parentKey===o.key)return T.ANCESTOR;i=e.getParentTopic(i.key)}}return T.NONE}var S=r("modifier");function w(e){var t=e.model,n=e.topicKey,o=e.focusMode;return S("focus topic"),n!==t.focusKey&&(t=t.set("focusKey",n)),o!==t.focusMode&&(t=t.set("focusMode",o)),t}var D={addChild:function(e){var t=e.model,n=e.topicKey;S("addChild:",n);var o=t.getTopic(n);if(o){var r=O.create({key:b(),parentKey:o.key});return o=o.set("collapse",!1).update("subKeys",(function(e){return e.push(r.key)})),w({model:t=t.update("topics",(function(e){return e.set(n,o).set(r.key,r)})),topicKey:r.key,focusMode:v.EDITING_CONTENT})}return t},addSibling:function(e){var t=e.model,n=e.topicKey;if(n===t.rootTopicKey)return t;var o=t.getTopic(n);if(o){var r=t.getTopic(o.parentKey),i=r.subKeys.indexOf(n),a=O.create({key:b(),parentKey:r.key});return w({model:t=t.update("topics",(function(e){return e.set(a.key,a)})).updateIn(["topics",r.key,"subKeys"],(function(e){return e.insert(i+1,a.key)})),topicKey:a.key,focusMode:v.EDITING_CONTENT})}return t},toggleCollapse:function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n);return o&&0!==o.subKeys.size&&(o=o.merge({collapse:!o.collapse}),t=t.updateIn(["topics",o.key,"collapse"],(function(e){return!e}))),t=w({model:t,topicKey:n,focusMode:v.NORMAL})},collapseAll:function(e){var t=e.model;S("collapseAll");var n=k(t,t.editorRootTopicKey);return S(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!0)}))})),S(t),t},expandAll:function(e){var t=e.model,n=k(t,t.editorRootTopicKey);return S(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),S(t),t},expandTo:function(e){var t=e.model,n=e.topicKey,o=x(t,n).filter((function(e){return e!==n}));return C(t=t.withMutations((function(e){o.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),n,t.editorRootTopicKey)!==T.DESCENDANT&&(t=t.set("editorRootTopicKey",t.rootTopicKey)),t},focusTopic:w,setFocusMode:function(e){var t=e.model,n=e.focusMode;return S("setFocusMode"),n!==t.focusMode&&(t=t.set("focusMode",n)),t},deleteTopic:function(e){var t=e.model,n=e.topicKey;if(n===t.editorRootTopicKey)return t;var o=t.getTopic(n);return o&&(t=t.withMutations((function(e){e.update("topics",(function(e){e=e.delete(n);var o=k(t,n);return e=e.withMutations((function(e){o.forEach((function(t){e.delete(t)}))}))})),e.updateIn(["topics",o.parentKey,"subKeys"],(function(e){return e.delete(e.indexOf(n))})),e.focusKey===n&&e.set("focusKey",null).set("focusMode",null)}))),t},setBlockData:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=e.focusMode,i=e.data,a=t.getTopic(n);if(a){var c=a.getBlock(o),l=c.index,s=c.block;-1===l?t=t.updateIn(["topics",n,"blocks"],(function(e){return e.push(E.create({type:o,data:i}))})):s.data!==i&&(t=t.updateIn(["topics",n,"blocks",l,"data"],(function(e){return i}))),r&&(t=w({model:t,topicKey:n,focusMode:r}))}return t},deleteBlock:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=t.getTopic(n);if(r){var i=r.getBlock(o).index;-1!==i&&(t=t.updateIn(["topics",n,"blocks"],(function(e){return e.delete(i)}))),t=w({model:t,topicKey:null,focusMode:null})}return t},setStyle:function(e){var t=e.model,n=e.topicKey,o=e.style,r=t.getTopic(n);return r&&o!==r.style&&(t=t.updateIn(["topics",n,"style"],(function(e){return o}))),t},setTheme:function(e){var t=e.model,n=e.theme;return t=t.setIn(["config","theme"],n)},setLayoutDir:function(e){var t=e.model,n=e.layoutDir;return t.config.layoutDir===n?t:t=t.setIn(["config","layoutDir"],n)},setEditorRootTopicKey:function(e){var t=e.model,n=e.topicKey;return t.editorRootTopicKey!==n&&(t=t.set("editorRootTopicKey",n)),t.getTopic(n).collapse&&(t=t.setIn(["topics",n,"collapse"],!1)),t},setZoomFactor:function(e){var t=e.model,n=e.zoomFactor;return t.zoomFactor!==n&&(t=t.set("zoomFactor",n)),t}};var _={name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}},j={readOnly:!1,allowUndo:!0,layoutDir:t.DiagramLayoutType.LEFT_AND_RIGHT,theme:_},R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"layoutDir",{get:function(){return this.get("layoutDir")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readOnly",{get:function(){return this.get("readOnly")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowUndo",{get:function(){return this.get("allowUndo")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this.get("theme")},enumerable:!0,configurable:!0}),t.fromJSON=function(e){return new t(e)},t}(c.Record(j)),L={topics:c.Map(),extData:c.Map(),config:null,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1},I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.isModel=function(e){return e instanceof t},t.create=function(e){if(void 0===e&&(e=null),null==e)return t.createEmpty();var n;if(t.isModel(e)&&(n=e),l(e)&&(n=t.fromJSON(e)),n)return null==n.focusKey&&(n=n.set("focusKey",n.rootTopicKey)),null==n.focusMode&&(n=n.set("focusMode",v.NORMAL)),n;throw new Error("`Value.create` only accepts objects or values, but you passed it: "+e)},t.createEmpty=function(){var e=new t,n=O.create({key:b()});return e.update("topics",(function(e){return e.set(n.key,n)})).set("rootTopicKey",n.key).set("focusKey",n.key).set("focusMode",v.NORMAL)},t.fromJSON=function(e){var n=new t,o=e.topics,r=void 0===o?[]:o,i=e.config,a=void 0===i?{}:i,c=e.rootTopicKey,l=e.editorRootTopicKey;return void 0===l&&(l=c),n=(n=n.merge({rootTopicKey:c,editorRootTopicKey:l})).withMutations((function(e){r.forEach((function(t){e.update("topics",(function(e){return e.set(t.key,O.fromJSON(t))}))})),e.set("config",R.fromJSON(a))}))},t.prototype.toJS=function(){return{rootTopicKey:this.rootTopicKey,topics:Object.values(this.topics.toJS()),config:this.config,extData:this.extData,zoomFactor:this.zoomFactor}},Object.defineProperty(t.prototype,"extData",{get:function(){return this.get("extData")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topics",{get:function(){return this.get("topics")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.get("config")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatVersion",{get:function(){return this.get("formatVersion")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootTopicKey",{get:function(){return this.get("rootTopicKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editorRootTopicKey",{get:function(){return this.get("editorRootTopicKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusKey",{get:function(){return this.get("focusKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusMode",{get:function(){return this.get("focusMode")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editingContentKey",{get:function(){return this.focusMode===v.EDITING_CONTENT?this.focusKey:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editingDescKey",{get:function(){return this.focusMode===v.EDITING_DESC?this.focusKey:null},enumerable:!0,configurable:!0}),t.prototype.getTopic=function(e){return this.topics.get(e)},t.prototype.getExtDataItem=function(e,t){return this.extData.get(e)||new t},t.prototype.getParentTopic=function(e){var t=this.getTopic(e);return t.parentKey?this.getTopic(t.parentKey):null},t.prototype.getTopicVisualLevel=function(e){for(var t=this.getTopic(e),n=0;t&&t.key!==this.editorRootTopicKey;)n++,t=this.getParentTopic(t.key);return n},Object.defineProperty(t.prototype,"rootTopic",{get:function(){return this.getTopic(this.rootTopicKey)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomFactor",{get:function(){return this.get("zoomFactor")},enumerable:!0,configurable:!0}),t}(c.Record(L));t.Block=E,t.BlockType=g,t.Config=R,t.Controller=y,t.FocusMode=v,t.Model=I,t.ModelModifier=D,t.Modifiers=D,t.OpType={TOGGLE_COLLAPSE:"TOGGLE_COLLAPSE",COLLAPSE_ALL:"COLLAPSE_ALL",EXPAND_ALL:"EXPAND_ALL",EXPAND_TO:"EXPAND_TO",ADD_CHILD:"ADD_CHILD",ADD_SIBLING:"ADD_SIBLING",DELETE_TOPIC:"DELETE_TOPIC",FOCUS_TOPIC:"FOCUS_TOPIC",SET_FOCUS_MODE:"SET_FOCUS_MODE",SET_STYLE:"SET_STYLE",SET_THEME:"SET_THEME",SET_TOPIC_BLOCK:"SET_TOPIC_BLOCK",DELETE_TOPIC_BLOCK:"DELETE_TOPIC_BLOCK",START_EDITING_CONTENT:"START_EDITING_CONTENT",START_EDITING_DESC:"START_EDITING_DESC",DRAG_AND_DROP:"DRAG_AND_DROP",SET_EDITOR_ROOT:"SET_EDITOR_ROOT"},t.Topic=O,t.TopicDirection={LEFT:"L",RIGHT:"R",BOTTOM:"B",MAIN:"M"},t.TopicRelationship=T,t.TopicVisualLevel={ROOT:0,PRIMARY:1,NORMAL:2},t.createKey=b,t.defaultTheme=_,t.getAllSubTopicKeys=k,t.getKeyPath=x,t.getRelationship=C,t.isThemeType=function(e){return null!=e.name&&null!=e.background&&null!=e.highlightColor}},990:function(e,t,n){},991:function(e,t,n){},992:function(e,t,n){},993:function(e,t,n){},994:function(e,t,n){},995:function(e,t,n){},997:function(e,t,n){},998:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),i=n(22),a=n(29),c=n(35),l=n(43),s=n(16),u=n(17),p=n(20),d=n(19),f=n(40),m=n(8),h="http://localhost:3200/api",y={register:"http://localhost:3200/api/user/register",login:"http://localhost:3200/api/user/login"},g={base:"http://localhost:3200/api/project",create:"http://localhost:3200/api/project/create",list:"http://localhost:3200/api/project/list"},v={base:"http://localhost:3200/api/workspace",create:"http://localhost:3200/api/workspace/create",list:"http://localhost:3200/api/workspace/list"};var T="Work",b="Todo";function E(){return new Promise((function(e,t){fetch(v.list+"/"+localStorage.getItem("user_id"),{method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(t){e(t)})).catch((function(e){console.log("Error:",e),t(e)}))}))}var O=function(e){return new Promise((function(t,n){fetch(v.base+"/"+localStorage.getItem("user_id")+"/delete/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){t(e)})).catch((function(e){console.error("Error:",e),n(e)}))}))},k=void 0,x=function(e,t){return function(n){return new Promise((function(o,r){(function(e){var t={};t.user_id=localStorage.getItem("user_id"),t.name=e;var n=v.create;return new Promise((function(e,o){fetch(n,{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(t){e(t)})).catch((function(e){console.error("Error:",e),o(e)}))}))})(e).then((function(r){console.log("res from createWiki",r);var i={name:e,_id:r._id,map:r.map?r.map:{}};n(function(e,t){return{type:"ADD_WORKSPACE",workspace:e,index:t}}(i,t)),o(r)})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&k.props.history.push("/"),r(e)}))}))}},C=function(e){return function(t){t(function(e){return{type:"SET_WORKSPACES",workspaces:e}}(e))}},S=function(e){return function(t){t(function(e){return{type:"SET_ACTIVE_WS_PROJECT",activeWSProject:e}}(e))}},w=function(e){return function(t){return new Promise((function(n,o){O(e._id).then((function(o){t(function(e){return{type:"DELETE_WORKSPACE",index:e._id}}(e)),n(o)})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&k.props.history.push("/"),o(e)}))}))}},D=function e(t){Object(s.a)(this,e);var n={title:{quill:null,quillText:"",quillContent:{},toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Title"},description:{quill:null,quillText:"",quillContent:{},toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Description"},outcome:{quill:null,quillText:"",quillContent:{},toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Outcome"},reward:{quill:null,quillText:"",quillContent:{},toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Reward"},startTime:new Date,endTime:new Date,label:T,status:b,duration:"",reminders:null,progress:0,tasks:{},tasksCount:0,date:new Date,isTask:!1,offsetForTz:localStorage.getItem("offsetForTz")};0!==Object.keys(t).length?this.project=Object.assign({},Object(m.a)({},n),Object(m.a)({},t)):this.project=Object.assign({},Object(m.a)({},t),Object(m.a)({},n))},_=["title","description","outcome","reward"];function j(e){if(e){var t=Object.assign({},e);return _.forEach((function(e){delete t[e].quill,delete t[e].quillContent,delete t[e].toolbar,delete t[e].placeholder})),delete t.duration,delete t.reminders,t}return{}}function R(e,t){e.user_id=localStorage.getItem("user_id"),e.workspace_id=t;var n=g.base+"/"+localStorage.getItem("user_id")+"/".concat(t)+"/create";return new Promise((function(t,o){fetch(n,{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){t(e)})).catch((function(e){console.error("Error:",e),o(e)}))}))}function L(e){return new Promise((function(t,n){fetch(g.base+"/"+localStorage.getItem("user_id")+"/".concat(e,"/")+"list",{method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){t(e)})).catch((function(e){console.error("Error:",e),n(e)}))}))}var I=function e(){Object(s.a)(this,e);var t={quill:null,quillText:"",quillContent:{},value:"",toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Title"};this.title=Object.assign({},Object(m.a)({},t))},P=void 0;function M(e,t,n){if(e.user_id=localStorage.getItem("user_id"),e)return new Promise((function(o,r){fetch(h+"/project/"+localStorage.getItem("user_id")+"/"+t+"/update/"+n,{method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){o(e)})).catch((function(e){console.error("Error:",e),r(e)}))}))}var K=function(e,t){var n,o,r=!1;return function i(){if(r)return n=arguments,void(o=this);r=!0,e.apply(this,arguments),setTimeout((function(){r=!1,n&&(i.apply(o,n),n=o=null)}),t)}}((function(e){M(e).then((function(e){return console.log("res after updating project in updateProject service call",e)})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&P.props.history.push("/")}))}),3500);function N(e,t){return console.log("in service",e),new Promise((function(n,o){fetch(g.base+"/"+localStorage.getItem("user_id")+"/get/"+e+"/project/"+t,{method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){n(e)})).catch((function(e){console.error("Error:",e),o(e)}))}))}function A(e,t){if(t.user_id=localStorage.getItem("user_id"),t)return new Promise((function(n,o){fetch(g.base+"/"+localStorage.getItem("user_id")+"/"+e+"/update/"+t._id,{method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){n(e)})).catch((function(e){console.error("Error:",e),o(e)}))}))}var F=n(44),B=n.n(F),W=void 0,z=function(e,t,n){return{type:"ADD_PROJECT",_id:e,tid:t,project:n}},G=function(e){return Object(m.a)({type:"UPDATE_PROJECT"},e)},H=function(e){return Object(m.a)({type:"UPDATE_PROJECT_TASK"},e)},V=function(e){return function(t,n){var o=n().projects;if(void 0!=e.tid){if(t(H(e)),console.log("calling update service from UPDATEPROJECMW, when meta.tid exists function-> it updates task"),K(B.a.cloneDeep(o.list[e.id].tasks[e.tid])),"title"==e.key&&t(function(e){return function(t,n){var o=n().projects,r=o.activeProjectId,i=o.list[r].map,a=e.val.topicKey,c=i.topics.filter((function(e){if(e.key==a)return e}));i.topics.filter((function(e){if(null==e.parentKey)return e}));c.length>0&&(c[0].blocks[0].data=e.val.quillText,i.topics.forEach((function(e){e.key==c[0].key&&(e.blocks[0].data=c[0].blocks[0].data)})),t(G({id:e.id,key:"map",val:i})),console.log("calling update service from BINDTRACKTOMAP function"),K(B.a.cloneDeep(o.list[r])))}}(e)),"status"==e.key){var r={key:"timeTaken"};"done"==e.val.toLowerCase()?r.val=new Date:r.val=null,r.id=e.id,r.tid=e.tid,t(H(r))}}else{if(t(G(e)),"status"==e.key){var i={key:"timeTaken"};"done"==e.val.toLowerCase()?i.val=new Date:i.val=null,i.id=e.id,t(G(i))}"map"===e.key&&t((function(e,t){var n=t().projects,o=n.activeProjectId,r=n.list[o];r.map.topics.forEach((function(t,i){if(null!=t.parentKey)if(null==t.task_id){var a=new I;a.title.quillText=t.blocks[0].data,a.title.topicKey=t.key,a.title.parentKey=t.parentKey;var c=new D(a);R(c.project,r._id).then((function(r){c.project._id=r._id,t.task_id=r._id,e(z(o,r._id,c.project)),e(G({id:o,key:"tasksCount",val:n.list[n.activeProjectId].tasksCount+1}))})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&W.props.history.push("/")}))}else{var l=r.tasks[t.task_id].title;l.quillText=t.blocks[0].data,l.quill&&(l.quillContent=l.quill.setText(t.blocks[0].data)),e(H({id:o,tid:t.task_id,key:"title",val:l})),console.log("calling update service from bindMapToTrack function"),K(B.a.cloneDeep(n.list[o].tasks[t.task_id]))}else{var s=r.title;s.quillText=t.blocks[0].data,s.quill&&(s.quillContent=s.quill.setText(t.blocks[0].data)),e(G({id:o,key:"title",val:s})),console.log("calling update service from bindMapToTrack function, updating root nide title"),K(B.a.cloneDeep(n.list[o]))}})),e(G({id:o,key:"map",val:r.map}))}))}}},U=function(e){return function(t){t(function(e){return{type:"SET_ACTIVE_PROJECT",id:e}}(e))}},Y=function(e){return function(t){t(function(e){return Object(m.a)({type:"SET_PROJECTS"},e)}(e))}},Z=(n(424),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={toggleWsModal:!1,workspace:"",data:[],allData:[],isLblHovered:null,activeWsName:"N/A"},e.showWsModal=function(){e.setState({toggleWsModal:!e.state.toggleWsModal})},e.labelInpChange=function(t){if(e.setState({workspace:t.target.value}),t.target.value){console.log("e.target.value:",t.target.value);var n=t.target.value,o=e.state.allData.filter((function(e){return e.name.toLowerCase().includes(n.toLowerCase())?e:null}));e.setState({data:o})}else e.setState({data:e.state.allData})},e.handleWsClick=function(t){console.log("ws::",t),e.props.setActiveWSProjectMW(Object(m.a)({},t)),e.props.setProjectsMW({}),L(t._id).then((function(n){e.setState({loading:!1});var o={};n.list&&n.list.length>0&&n.list.forEach((function(e){o[e._id]=e})),e.props.setProjectsMW({list:o});var r={};n.workspace&&n.workspace.length>0&&(r=n.workspace[0]),e.setState({activeWsName:r}),e.props.setActiveWSProjectMW(Object(m.a)({},r)),e.showWsModal(),e.props.history.push("/workspace/"+t._id+"/dashboard")})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")}))},e.addToWorkspaces=function(){var t=e.state,n=t.workspace,o=t.allData;e.props.addWorkspaceMW(n).then((function(t){o.push({name:n,_id:t._id}),e.setState({workspace:"",data:o,allData:o},(function(){console.log("allData:",o)}))})).catch((function(e){console.log("error in creating workspace:",e)}))},e.deleteWorkspace=function(t,n){t.stopPropagation(),e.props.deleteWorkspaceMw(n);var o,r=e.props.workspaces,i=r.filter((function(e){return e._id==n._id}));1==i.length&&(o=r.indexOf(i[0]),console.log("FOUND INDEX::",o)),e.setState({data:[].concat(Object(f.a)(r.slice(0,o)),Object(f.a)(r.slice(o+1)))})},e}return Object(u.a)(n,[{key:"hoverIn",value:function(e){this.setState({isLblHovered:e})}},{key:"hoverOut",value:function(e){this.setState({isLblHovered:null})}},{key:"componentDidMount",value:function(){var e=this;console.log("inside workspace dd component");var t="";E().then((function(n){console.log("res from getWorkspaces",n),e.props.setWorkspacesMw(n.list);for(var o=0;o<n.list.length;o++){var r=n.list[o];e.props.match.params.workspace_id==r._id&&(t=r)}e.setState({data:n.list,allData:n.list,activeWsName:t})})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.toggleWsModal,o=t.workspace,i=t.data,a=t.activeWsName;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"ws-btn",onClick:this.showWsModal},r.a.createElement("span",null,a.name),r.a.createElement("img",{className:"dropdown",src:"/assets/web/tthroo-dropdown.svg",alt:"dropdown-icon"})),n&&r.a.createElement("div",{className:"label-dd"},r.a.createElement("img",{className:"i-close l-close",src:"/assets/web/tthroo-close-icon.svg",onClick:this.showWsModal,alt:"close-icon"}),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h2",{className:"lm-h"},"Workspaces")),r.a.createElement("div",{className:"em"},r.a.createElement("input",{type:"text",name:"workspace",className:"lm-inp",placeholder:"enter a workspace",onChange:this.labelInpChange,value:o}),r.a.createElement("button",{className:"add-ws",onClick:this.addToWorkspaces},i&&0==i.length&&r.a.createElement("img",{className:"lm-ai",src:"/assets/web/tthroo-add-icon.svg",alt:"add-icon"}))),r.a.createElement("div",{className:"em"},r.a.createElement("ul",null,i&&0!==i.length?i.map((function(t,n){return r.a.createElement("li",{key:t._id,className:a._id===t._id?"active":"",onMouseEnter:function(){return e.hoverIn(n)},onMouseLeave:function(){return e.hoverOut(n)},onClick:function(){return e.handleWsClick(t)}},t.name)})):r.a.createElement("div",null,"No Workspace Found. Try adding a new label."))))))}}]),n}(o.Component)),q=Object(l.g)(Object(a.b)((function(e){return{activeWSProject:e.wikis.activeWSProject,workspaces:e.wikis.workspaces}}),{addWorkspaceMW:x,setWorkspacesMw:C,setActiveWSProjectMW:S,deleteWorkspaceMw:w,setProjectsMW:Y})(Z)),J=(n(426),function(){return r.a.createElement("header",{class:"main-header"},r.a.createElement("div",{className:"hdr-container"},r.a.createElement("div",{className:"tthroo-logo-container"},r.a.createElement("img",{className:"tthroo-logo",src:"/assets/web/tthroo-logo.svg",alt:"TThroo.io"}),r.a.createElement("span",{className:"tthroo"},"TThroo")),r.a.createElement("div",{className:"s-ws-container"},r.a.createElement(q,null)),r.a.createElement("div",{className:"profile-c"},r.a.createElement("img",{className:"profile",src:"/assets/web/default-profile.svg",alt:"profile-icon"}))))}),X=n(47),Q=(n(427),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).state={showLabelModal:!1,labelInp:"",data:[],isLblHovered:null},o.changeLabel=function(e){e.persist();var t=o.props,n=t.activeProjectId,r=t.tid,i=t.updateProjectTask,a=t.updateProject;if(void 0!==r){i({id:n,tid:r,key:"label"===o.props.mode?"label":"status",val:e.target.innerText})}else if(void 0!==n){a({id:n,key:"label"===o.props.mode?"label":"status",val:e.target.innerText})}else"label"===o.props.mode?o.props.setLabelMW(e):o.props.setStatusMW(e);o.setState({showLabelModal:!o.state.showLabelModal}),o.props.modalClickHandler&&o.props.modalClickHandler()},o.deleteLabel=o.deleteLabel.bind(Object(X.a)(o)),o}return Object(u.a)(n,[{key:"toggleLabelModal",value:function(){this.setState({showLabelModal:!this.state.showLabelModal}),this.props.modalClickHandler&&this.props.modalClickHandler()}},{key:"labelInpChange",value:function(e){if(this.setState({labelInp:e.target.value}),e.target.value){var t=e.target.value,n=this.state.data.filter((function(e){return e.label.toLowerCase().includes(t.toLowerCase())?e:null}));this.setState({data:n})}}},{key:"addLabel",value:function(){var e=this.state.labelInp;"label"===this.props.mode?this.props.addLabelMW(e):this.props.addStatusMW(e),this.setState({labelInp:""})}},{key:"hoverIn",value:function(e){this.setState({isLblHovered:e})}},{key:"hoverOut",value:function(e){this.setState({isLblHovered:null})}},{key:"deleteLabel",value:function(e,t){e.stopPropagation(),"label"===this.props.mode?this.props.deleteLabelMW(t):this.props.deleteStatusMW(t)}},{key:"componentDidUpdate",value:function(){this.refData=this.props.data,this.state.data&&(this.props.data.length===this.state.data.length||this.state.labelInp)||this.setState({data:this.props.data})}},{key:"componentDidMount",value:function(){var e=this.props.onlyModal;Boolean(e)&&this.setState({showLabelModal:!this.state.showLabelModal})}},{key:"render",value:function(){var e=this,t=this.state,n=t.showLabelModal,o=t.labelInp,i=t.data,a=t.isLblHovered,c=this.props,l=c.active,s=c.onlyInput,u=c.onlyModal,p=c.modalView,d=c.mode,f=c.value;return r.a.createElement(r.a.Fragment,null,!s&&r.a.createElement(r.a.Fragment,null,"label"===d?r.a.createElement("div",{className:"sb-lbl"},"Labels"):r.a.createElement("div",{className:"sb-lbl"},"Status")),!u&&r.a.createElement("label",{onClick:this.toggleLabelModal.bind(this)},r.a.createElement("button",{className:p?"modal-bg sb-btn em":"sb-btn em"},r.a.createElement("span",{className:"btn-inr"},r.a.createElement("span",null,f||l),r.a.createElement("img",{className:"dropdown",src:"/assets/web/tthroo-dropdown.svg",alt:"dropdown-icon"})))),n&&r.a.createElement("div",{className:"label-dd"},r.a.createElement("img",{className:"i-close l-close",src:"/assets/web/tthroo-close-icon.svg",onClick:this.toggleLabelModal.bind(this),alt:"close-icon"}),r.a.createElement("div",null,"label"===d?r.a.createElement("h2",{className:"lm-h"},"Labels"):r.a.createElement("h2",{className:"lm-h"},"Status"),r.a.createElement("div",{className:"em"},r.a.createElement("input",{type:"text",name:d,className:"lm-inp",placeholder:"enter a label",onChange:this.labelInpChange.bind(this),value:o}),r.a.createElement("span",null,r.a.createElement("img",{className:"lm-ai",onClick:this.addLabel.bind(this),src:"/assets/web/tthroo-add-icon.svg",alt:"add-icon"}))),r.a.createElement("div",{className:"em"},r.a.createElement("ul",null,i&&0!==i.length?i.map((function(t,n){return r.a.createElement("li",{className:f===t.label?"active":"",onMouseEnter:function(){return e.hoverIn(n)},onMouseLeave:function(){return e.hoverOut(n)},onClick:e.changeLabel},t.label,a===n&&r.a.createElement("img",{className:"lm-di",onClick:function(t){return e.deleteLabel(t,n)},src:"/assets/web/tthroo-del-icon.svg",alt:"del-icon"}))})):r.a.createElement("div",null,"No Label Found. Try adding a new label."))))))}}]),n}(o.Component)),$=Object(a.b)((function(e,t){return"label"===t.mode?{data:e.sideBar.label.data,active:e.sideBar.label.active}:{data:e.sideBar.status.data,active:e.sideBar.status.active}}),{addLabelMW:function(e){return function(t){t(function(e){return{type:"ADD_LABEL",label:e}}(e))}},deleteLabelMW:function(e){return function(t){t(function(e){return{type:"DELETE_LABEL",index:e}}(e))}},setLabelMW:function(e){return function(t){var n=e.target.innerText;t({type:"SET_LABEL",activeLabel:n})}},setStatusMW:function(e){return function(t){var n;n="object"===typeof e?e.target.innerText:e,t({type:"SET_STATUS",activeStatus:n})}},addStatusMW:function(e){return function(t){t(function(e){return{type:"ADD_STATUS",label:e}}(e))}},deleteStatusMW:function(e){return function(t){t(function(e){return{type:"DELETE_STATUS",index:e}}(e))}},updateProjectTask:H,updateProject:G})(Q),ee=(n(428),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).navToWSDashboard=function(){o.props.history.push("/workspaces")},o.createProject=o.createProject.bind(Object(X.a)(o)),o}return Object(u.a)(n,[{key:"createProject",value:function(){(0,this.props.toggleCPModal)()}},{key:"render",value:function(){return r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",null,r.a.createElement("button",{className:"sb-btn",onClick:this.navToWSDashboard},"Back")),r.a.createElement("div",null,r.a.createElement("button",{className:"sb-btn em c-p",onClick:this.createProject},"Create Project")))}}]),n}(o.Component)),te=(Object(l.g)(Object(a.b)((function(e){return{}}),{})(ee)),n(73)),ne=function(e){var t=e.type,n=void 0===t?"checkbox":t,o=e.name,i=e.checked,a=void 0!==i&&i,c=e.onChange;return r.a.createElement("input",{type:n,name:o,checked:a,onChange:c})},oe=(n(429),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={title:"",description:"",projectType:"map",checkedTypes:new Map,projectTypes:[{name:"roadmap",key:"roadmap",label:"Roadmap"},{name:"map",key:"map",label:"Mindmap"},{name:"analyse",key:"analyse",label:"Analyse"},{name:"reminders",key:"reminders",label:"Reminders"}]},e.handleInpChange=function(t){e.setState(Object(te.a)({},t.target.name,t.target.value))},e.getProjectType=function(){var t=e.state,n=t.checkedTypes,o=t.projectTypes,r="map";return o.forEach((function(e){n.get(e.name)&&"map"!==e.name&&(r=r+"+"+e.name)})),r},e.createProject=function(){console.log("this.state",e.state);var t=e.getProjectType(),n=e.state;R({title:{quillText:n.title},description:{quillText:n.description},projectType:t},e.props.match.params.workspace_id).then((function(t){var n=Object(m.a)({},t);delete n.status,delete n.statusCode;var o=Object(te.a)({},t._id,Object(m.a)(Object(m.a)({},n),{},{_id:t._id}));console.log("project has been created successfuly, need to update the store now",o),e.props.toggleProject(!0,o)})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")}))},e.handleChange=function(t){t.persist(),console.log("this.props in handleChange func",t.target.name,t.target.checked,e.state);var n=t.target.name,o=t.target.checked;e.setState((function(e){return{checkedTypes:e.checkedTypes.set(n,o)}}))},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=this.props.toggleProject,n=this.state,o=(n.title,n.description,n.projectType,n.projectTypes),i=n.checkedTypes;return r.a.createElement("div",{id:"myModal",class:"modal"},r.a.createElement("div",{class:"modal-content"},r.a.createElement("div",{class:"modal-header"},r.a.createElement("span",{class:"close",onClick:t},"\xd7"),r.a.createElement("h2",null,"Create project")),r.a.createElement("div",{class:"modal-body"},r.a.createElement("div",null,"Title:"),r.a.createElement("input",{type:"text",name:"title",placeholder:"Enter Project Title...",onChange:this.handleInpChange}),r.a.createElement("div",null,"Description:"),r.a.createElement("textarea",{name:"description",placeholder:"Enter description...(optional)",onChange:this.handleInpChange}),o.map((function(t){return r.a.createElement("label",{key:t.key},t.name,r.a.createElement(ne,{name:t.name,checked:i.get(t.name),onChange:e.handleChange}))}))),r.a.createElement("div",{class:"modal-footer"},r.a.createElement("button",{onClick:this.createProject},"Create"),r.a.createElement("button",{onClick:t},"Close"))))}}]),n}(o.Component)),re=Object(l.g)(Object(a.b)(null,{})(oe)),ie=(n(430),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).state={showEditIcon:-1,showActionsDD:!1,loading:!1,toggleProjectModal:!1},o.getProjProgress=function(e){if(e.tasks&&Object.keys(e.tasks).length>0){var t=Object.keys(e.tasks).length,n=Object.keys(e.tasks).reduce((function(t,n){return e.tasks[n].status&&"done"===e.tasks[n].status.toLowerCase()?t+1:t}),0);return Math.ceil(n/t*100)}return"done"===e.status.toLowerCase()?100:0},o.deleteProject=function(e,t){t.stopPropagation(),o.props.delProjectMW(e,o.props.match.params.workspace_id),o.setState({showEditIcon:-1,showActionsDD:!1})},o.toggleProject=function(e,t){var n=o.props.projects;o.setState({toggleProjectModal:!o.state.toggleProjectModal}),e&&(console.log("this.projects",n),o.props.setProjectsMW({list:Object(m.a)(Object(m.a)({},n),t)}))},o.getActiveProjects=function(){var e=o.props.projects,t=Object.keys(e||{}),n=[];return t.length>0&&(n=t.map((function(t){return e[t]}))),n},o.hoverIn=o.hoverIn.bind(Object(X.a)(o)),o.hoverOut=o.hoverOut.bind(Object(X.a)(o)),o.toggleEdit=o.toggleEdit.bind(Object(X.a)(o)),o.switchToProject=o.switchToProject.bind(Object(X.a)(o)),o}return Object(u.a)(n,[{key:"hoverIn",value:function(e){console.log("i::",e),this.setState({showEditIcon:e})}},{key:"hoverOut",value:function(e){this.setState({showEditIcon:-1,showActionsDD:!1})}},{key:"toggleEdit",value:function(e){e.stopPropagation(),this.setState({showActionsDD:!this.state.showActionsDD})}},{key:"switchToProject",value:function(e,t,n,o){Boolean(t)&&n.stopPropagation(),this.props.setActiveWSProjectMW(o),this.props.history.push("/workspace/".concat(this.props.match.params.workspace_id,"/project/").concat(e,"/edit"))}},{key:"componentDidMount",value:function(){var e=this;L(this.props.match.params.workspace_id).then((function(t){e.setState({loading:!1});var n={};t.list&&t.list.length>0&&t.list.forEach((function(e){n[e._id]=e})),e.props.setProjectsMW({list:n});var o={};t.workspace&&t.workspace.length>0&&(o=t.workspace[0]),e.props.setActiveWSProjectMW(Object(m.a)({},o))})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.showEditIcon,o=t.showActionsDD,i=t.loading,a=t.toggleProjectModal,c=this.props.activeWSProject,l=this.getActiveProjects();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"ls-h"},r.a.createElement("h1",{className:"tthroo-p"},c&&c.name,"/Projects"),r.a.createElement("button",{className:"cp",onClick:this.toggleProject},"Create Project")),r.a.createElement("div",{className:"ls"},i?r.a.createElement("div",null,"Loading"):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"p-c"},Object.keys(l).length>0?l.map((function(t,i){return r.a.createElement("div",{className:"ls-data",onMouseEnter:function(){return e.hoverIn(t._id)},onMouseLeave:function(){return e.hoverOut(t._id)},onClick:function(){return e.switchToProject(t._id,null,null,t)}},n===t._id&&r.a.createElement("div",{className:"edit-dd"},r.a.createElement("img",{className:"dropdown",src:"/assets/web/tthroo-dropdown.svg",onClick:e.toggleEdit,alt:"dropdown-icon"}),o&&r.a.createElement("div",{className:"action-proj-dd"},r.a.createElement("ul",null,r.a.createElement("li",{onClick:function(n){return e.switchToProject(t._id,"edit",n,t)}},r.a.createElement("span",{className:"action-lbl"},"Edit")),r.a.createElement("li",{onClick:function(n){return e.deleteProject(t._id,n)}},r.a.createElement("span",{className:"action-lbl"},"Delete"))))),r.a.createElement("div",{className:"p-c-d"},r.a.createElement("div",{className:"title"},r.a.createElement("h4",null,t.title&&t.title.quillText?t.title.quillText.length<38?t.title.quillText:t.title.quillText.substring(0,38)+"...":t.title?t.title:"N/A"),r.a.createElement("h6",null,"This is a demo description."))))})):r.a.createElement("div",{className:"no-projects-lbl"},"No Projects Available, Try Creating New Projects.")))),a&&r.a.createElement(re,{toggleProject:this.toggleProject}))}}]),n}(o.Component)),ae=Object(l.g)(Object(a.b)((function(e){return{projects:e.projects.list,activeWSProject:e.wikis.activeWSProject}}),{delProjectMW:function(e,t){return function(n){(function(e,t){return new Promise((function(n,o){fetch(g.base+"/"+localStorage.getItem("user_id")+"/".concat(t,"/")+"delete/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){n(e)})).catch((function(e){console.error("Error:",e),o(e)}))}))})(e,t).then((function(o){n(function(e,t){return{type:"DEL_PROJECT",id:e,workspace_id:t}}(e,t))})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&W.props.history.push("/")}))}},setProjectsMW:Y,setActiveWSProjectMW:S})(ie)),ce=n(95),le=n(218),se=n.n(le);function ue(e,t){if(null==t)return{val:"Not yet finished"};var n=new Date(t).getTime()-new Date(e).getTime();return{val:Math.floor(n/864e5)+"d "+Math.floor(n%864e5/36e5)+"h "+Math.floor(n%36e5/6e4)+"m "+Math.floor(n%6e4/1e3)+"s "}}var pe=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this)).state={tech:"select"},o}return Object(u.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("select",{id:"lang",onChange:this.props.handleProjectTypeChange,value:this.props.projectType},r.a.createElement("option",{value:"select"},"Select Project Type"),r.a.createElement("option",{value:"map"},"Map"),r.a.createElement("option",{value:"map+analyse"},"Map + Analyse"),r.a.createElement("option",{value:"map+analyse+reminders"},"Map + Analyse + Reminders")))}}]),n}(o.Component),de=(n(444),n(445),n(446),n(447),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).getDeepClonedObj=function(e){return B.a.cloneDeep(e)},o.createProject=function(){console.log("this.meta",o.meta),R(o.meta,null,o.props.match.params.workspace_id).then((function(e){console.log("succesfully created project",e),o.props.addProjectMW(e._id,null,o.meta),o.props.toggleEditModal()})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&o.props.history.push("/")}))},o.handleProjectTypeChange=function(e){o.meta.projectType=e.target.value},o.state={modalView:!1,duration:"",activeProject:{}},o.saveContent=o.saveContent.bind(Object(X.a)(o)),o.editorContainerIds=["title","description","outcome","reward"],o.toggleModal=o.toggleModal.bind(Object(X.a)(o)),o.ws=null,o.meta={},o}return Object(u.a)(n,[{key:"toggleModal",value:function(e){this.setState({modalView:!this.state.modalView})}},{key:"saveContent",value:function(e,t,n,o,r){t.topicKey=o,t.parentKey=r,this.props.updateProjectMW({id:this.props.match.params.id,tid:n,key:e,val:Object.assign({},t)})}},{key:"initializeProjEditor",value:function(e){var t=this,n=se.a.import("delta");this.editorContainerIds.forEach((function(o){var r=new se.a("#"+o,{modules:{toolbar:o.toolbar},scrollingContainer:"#scrolling-container",placeholder:t.meta[o].placeholder,theme:"bubble"});if(t.meta[o].quill=r,e){var i=Object(m.a)({},t.meta[o].quillContent);t.meta[o].quill.setContents(i,"api"),t.meta[o].quillText.length>=0&&t.meta[o].quill.setText(t.meta[o].quillText)}t.meta[o].quill.on("text-change",(function(e){var r=new n,i=Object(m.a)({},t.meta[o]);i.change=r.compose(e);var a=t.meta[o];a.quillContent=a.quill.getContents(),a.quillText=a.quill.getText(),i.change=new n}))})),this.setState({activeProject:this.meta})}},{key:"calcDuration",value:function(e){this.setState({duration:ue(new Date(e.startTime),new Date(e.endTime)).val})}},{key:"componentDidMount",value:function(){var e=this.props.topic;console.log("topic in edit.js componentDidMount function{}::**",e);var t=this.props.match.params.id,n={};if(e&&e.properties?(e.properties.title.quillText=e.blocks[0].data,n=e.properties):n={},Boolean(n&&n.title)){this.meta={};var o=new D(n);this.meta=o.project,this.initializeProjEditor(!0),this.calcDuration(this.meta)}else{this.meta={};var r={};r._id=t;var i=this.props.status;i&&(r.status=i);var a=new D(r);this.meta=a.project,this.initializeProjEditor(!1),this.calcDuration(this.meta)}}},{key:"componentWillUnmount",value:function(){var e=this;this.editorContainerIds.forEach((function(t){e.meta[t]&&e.meta[t].quill&&e.meta[t].quill.off("text-change",(function(e){}))})),clearInterval(this.timer)}},{key:"render",value:function(){var e=this,t=this.state,n=t.modalView,o=t.duration,i=t.activeProject,a=this.props,c=(a.meta,a.activeProjectId),l=a.tid,s=a.mode,u=a.toggleEditModal,p=a.status,d=a.isSidebarOpen,f=a.topic,h=a.updateProperties;return r.a.createElement("div",{className:"track"===s?"track-dv":n?d?"dv modal-bg":"dv toggle":d?"dv":"dv toggle"},r.a.createElement("div",{className:n?"modal-bg edit-content":"edit-content"},"track"===s&&r.a.createElement("img",{className:"i-close edit-close",src:"/assets/web/tthroo-close-icon.svg",onClick:u,alt:"close-icon"}),r.a.createElement("div",{className:"dv-hdr"},"Project Details"),r.a.createElement("div",{className:"e-c-items"},r.a.createElement("div",{className:"item title-c"},r.a.createElement("div",{className:"lbl"},"Title"),r.a.createElement("div",{id:"scrolling-container"},r.a.createElement("div",{id:"title"}))),r.a.createElement("div",{className:"item label"},r.a.createElement("div",{className:"lbl"},"Status"),r.a.createElement($,{mode:"status",onlyInput:!0,modalView:n,modalClickHandler:this.toggleModal,activeProjectId:c,tid:l,value:p||(i&&i.status?i.status:null)})),r.a.createElement("div",{className:"item label"},r.a.createElement("div",{className:"lbl"},"Label"),r.a.createElement($,{mode:"label",onlyInput:!0,modalView:n,modalClickHandler:this.toggleModal,activeProjectId:c,tid:l,value:i&&i.label?i.label:null})),r.a.createElement("div",{className:"item"},r.a.createElement("div",{className:"lbl"},"Project Type"),r.a.createElement("div",null,r.a.createElement(pe,{handleProjectTypeChange:this.handleProjectTypeChange,projectType:this.meta.projectType}))),r.a.createElement("div",{className:"item"},r.a.createElement("div",{className:"lbl"},"Start Time"),r.a.createElement("div",null,r.a.createElement(ce,{viewMode:"time",timeFormat:!0,value:i?i.startTime:null,inputProps:{placeholder:"Enter start time",readOnly:!0,className:n?"modal-bg":""},disabled:n,onChange:function(t){e.props.updateProjectMW({id:e.props.id,tid:l,key:"startTime",val:t.toDate()}),e.calcDuration(Object(m.a)(Object(m.a)({},i),{},{startTime:t.toDate()}))}}))),r.a.createElement("div",{className:"item"},r.a.createElement("div",{className:"lbl"},"End Time"),r.a.createElement("div",null,r.a.createElement(ce,{viewMode:"time",value:i?i.endTime:null,inputProps:{placeholder:"Enter end time",readOnly:!0,className:n?"modal-bg":""},className:n?"modal-bg":"",disabled:n,onChange:function(t){e.props.updateProjectMW({id:e.props.id,tid:l,key:"endTime",val:t.toDate()}),e.calcDuration(Object(m.a)(Object(m.a)({},i),{},{endTime:t.toDate()}))}}))),r.a.createElement("div",{className:"item"},r.a.createElement("div",{className:"lbl"},"Duration"),r.a.createElement("div",null,r.a.createElement("input",{className:n?"modal-bg":"",type:"text",value:o||0,readOnly:!0}))),r.a.createElement("div",{className:"item description-c"},r.a.createElement("div",{className:"lbl"},"Description"),r.a.createElement("div",null,r.a.createElement("div",{id:"scrolling-container"},r.a.createElement("div",{id:"description"})))),r.a.createElement("div",{className:"item outcome-c"},r.a.createElement("div",{className:"lbl"},"Outcome"),r.a.createElement("div",null,r.a.createElement("div",{id:"scrolling-container"},r.a.createElement("div",{id:"outcome"})))),r.a.createElement("div",{className:"item reward-c"},r.a.createElement("div",{className:"lbl"},"Treat Yourself With"),r.a.createElement("div",null,r.a.createElement("div",{id:"scrolling-container"},r.a.createElement("div",{id:"reward"})))),r.a.createElement("div",{className:"item ctas"},null==f||0==Object.keys(f).length?r.a.createElement("button",{className:"c-p-btn create",onClick:this.createProject},"Create"):r.a.createElement("button",{className:"c-p-btn create",onClick:function(){return h(f,e.meta)}},"Update"),r.a.createElement("button",{className:"c-p-btn cancel"},"Cancel")))))}}]),n}(o.Component)),fe=Object(l.g)(Object(a.b)((function(e){return{id:e.projects.activeProjectId,meta:e.projects,activeProjectId:e.projects.activeProjectId}}),{updateProjectMW:V,setActiveProjectMW:U,addProjectMW:function(e,t,n){return function(o){o(z(e,t,n))}}})(de)),me=(n(448),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).state={open:!0,cpModal:!1},o.togglePanel=o.togglePanel.bind(Object(X.a)(o)),o.toggleCPModal=o.toggleCPModal.bind(Object(X.a)(o)),o}return Object(u.a)(n,[{key:"togglePanel",value:function(e){this.setState({open:!this.state.open})}},{key:"toggleCPModal",value:function(){this.setState({cpModal:!this.state.cpModal})}},{key:"render",value:function(){var e=this.state,t=e.open;e.cpModal,e.workspace_id;return r.a.createElement("div",{className:"container"},r.a.createElement(ae,{isSidebarOpen:t}))}}]),n}(o.Component)),he=(n(449),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(J,null),r.a.createElement(me,null))}}]),n}(o.Component)),ye=(n(450),Object(l.g)(Object(a.b)(null,{setActiveProjectMW:U})((function(e){var t=e.match.params.workspace_id,n=e.title;return r.a.createElement("header",{class:"main-header"},r.a.createElement("div",{className:"hdr-container"},r.a.createElement(c.b,{to:"/workspace/".concat(t,"/dashboard"),onClick:function(t){e.setActiveProjectMW(null)},className:"back-btn"},r.a.createElement("img",{alt:"analyse",src:"/assets/web/back-nav.svg"})),r.a.createElement("h1",null,n&&n.quillText?n.quillText:"Loading"),r.a.createElement("div",{className:"s-ws-container"},r.a.createElement(q,null)),r.a.createElement("div",{className:"profile-c"},r.a.createElement("img",{className:"profile",src:"/assets/web/default-profile.svg",alt:"profile-icon"}))))})))),ge=(n(451),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).resetId=function(t){e.props.setActiveProjectMW(null)},e.getProjectType=function(e){return Boolean(e)?e.split("+"):[]},e}return Object(u.a)(n,[{key:"render",value:function(){var e,t=this.props.activeWSProject;this.props.match.params.workspace_id;return t&&(e=this.getProjectType(t.projectType)),console.log("projectType::",e,"projectType.indexOf('map')",e.indexOf("map")),r.a.createElement("div",{className:"sidebar"},r.a.createElement("div",{className:"contents"},-1!=e.indexOf("roadmap")&&r.a.createElement(c.b,{to:"roadmap",activeClassName:"proj-tab active",className:"proj-tab"},r.a.createElement("img",{alt:"edit-project",src:"/assets/web/roadmap.svg"})),-1!=e.indexOf("map")&&r.a.createElement(c.b,{to:"edit",activeClassName:"proj-tab active",className:"proj-tab"},r.a.createElement("img",{alt:"edit-project",src:"/assets/web/edit-project.svg"})),-1!=e.indexOf("analyse")&&r.a.createElement(c.b,{to:"assess",activeClassName:"proj-tab active",className:(e&&e.includes("a"),"proj-tab")},r.a.createElement("img",{alt:"analyse",src:"/assets/web/assessment.svg"})),-1!=e.indexOf("reminders")&&r.a.createElement(c.b,{to:"reminders",activeClassName:"proj-tab active",className:(e&&e.includes("a")&&e.includes("r"),"proj-tab")},r.a.createElement("img",{alt:"reminders",src:"/assets/web/reminders.svg"}))))}}]),n}(o.Component)),ve=Object(l.g)(Object(a.b)((function(e){return{activeWSProject:e.wikis.activeWSProject}}),{setActiveProjectMW:U})(ge)),Te=n(389),be=n(397),Ee=n.n(be),Oe=n(403),ke=n(404),xe=n(405),Ce=n.n(xe),Se=n(226),we=n(5),De=n.n(we),_e=(n(981),n(32));function je(e){return r.a.createElement("div",{className:"bm-toolbar-item ".concat(Object(_e.iconClassName)("openfile")),onClick:function(t){var n=e.diagram,o=n.getDiagramProps().controller;Object(_e.browserOpenFile)(".json,.blinkmind,.bm").then((function(e){var t=JSON.parse(e),r=o.run("deserializeModel",{controller:o,obj:t});n.openNewModel(r)}))}})}var Re=n(6),Le=n(4);function Ie(e){var t=[[Re.DiagramLayoutType.LEFT_AND_RIGHT,"Left And Right","layout-left-and-right"],[Re.DiagramLayoutType.LEFT_TO_RIGHT,"Only Right","layout-right"],[Re.DiagramLayoutType.RIGHT_TO_LEFT,"Only Left","layout-left"]];return r.a.createElement("div",{className:De()("bm-toolbar-item",Object(_e.iconClassName)("layout-left-and-right"))},r.a.createElement(Le.Popover,{enforceFocus:!1},r.a.createElement("div",{className:"bm-toolbar-popover-target"}),r.a.createElement(Le.Menu,null,t.map((function(t){return r.a.createElement(Le.MenuItem,{key:t[1],icon:Object(_e.Icon)(t[2]),text:t[1],onClick:(n=t[0],function(t){var o=e.diagram.getDiagramProps();o.controller.run("setLayoutDir",Object(m.a)(Object(m.a)({},o),{},{layoutDir:n}))})});var n})))))}var Pe=n(406),Me=n.n(Pe),Ke=n(407),Ne=n.n(Ke),Ae=n(408),Fe=n.n(Ae),Be=n(409),We=n.n(Be),ze=n(410),Ge=n.n(ze);function He(e){var t=[["default",Me.a],["theme1",Ne.a],["theme2",Fe.a],["theme3",We.a],["theme4",Ge.a]];return r.a.createElement("div",{className:De()("bm-toolbar-item",Object(_e.iconClassName)("theme"))},r.a.createElement(Le.Popover,{enforceFocus:!1},r.a.createElement("div",{className:"bm-toolbar-popover-target"}),r.a.createElement("div",{className:"bm-popover-theme"},t.map((function(t){return r.a.createElement("div",{key:t[0],className:"bm-theme-item",onClick:(n=t[0],function(t){var o=e.diagram.getDiagramProps();o.controller.run("setTheme",Object(m.a)(Object(m.a)({},o),{},{themeKey:n}))})},r.a.createElement("img",{className:"bm-theme-img",src:t[1],alt:t[0]}));var n})))))}var Ve=n(99);n(982);function Ue(e){return r.a.createElement("div",{className:De()("bm-toolbar-item",Object(_e.iconClassName)("export"))},r.a.createElement(Le.Popover,{enforceFocus:!1},r.a.createElement("div",{className:"bm-toolbar-popover-target"}),r.a.createElement(Le.Menu,null,r.a.createElement(Le.MenuItem,{text:"JSON(.json)",onClick:function(t){var n=e.diagram.getDiagramProps(),o=n.controller,r=n.model,i=o.run("serializeModel",n),a=JSON.stringify(i),c="data:text/plain,".concat(encodeURIComponent(a)),l=o.run("getTopicTitle",Object(m.a)(Object(m.a)({},n),{},{topicKey:r.rootTopicKey}));!function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}(c,"".concat(l,".blinkmind"))}}),r.a.createElement(Le.MenuDivider,null))))}var Ye=n(11),Ze=n(3),qe=n(302),Je=function(e,t){return(Je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Xe(e,t){function n(){this.constructor=e}Je(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Qe(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var $e,et;Object(Ye.default)(_e.ZIndex)($e||($e=Qe(["\n  position: absolute;\n  left: calc(50% - 150px);\n  top: 30px;\n  width: 300px;\n  background: white;\n  padding: 10px;\n  user-select: none;\n"],["\n  position: absolute;\n  left: calc(50% - 150px);\n  top: 30px;\n  width: 300px;\n  background: white;\n  padding: 10px;\n  user-select: none;\n"]))),Ye.default.div(et||(et=Qe(["\n  margin-bottom: 10px;\n"],["\n  margin-bottom: 10px;\n"])));var tt={keyList:Object(Ze.List)(),dataMap:Object(Ze.Map)()},nt=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Xe(t,e),Object.defineProperty(t.prototype,"keyList",{get:function(){return this.get("keyList")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataMap",{get:function(){return this.get("dataMap")},enumerable:!0,configurable:!0})}(Object(Ze.Record)(tt)),{reference:Object(Ze.Map)()});!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Xe(t,e),Object.defineProperty(t.prototype,"reference",{get:function(){return this.get("reference")},enumerable:!0,configurable:!0}),t.prototype.getReferenceKeys=function(e){return this.reference.has(e)?this.reference.get(e).keyList.toArray():[]},t.prototype.getReferencedKeys=function(e){var t=[];return this.reference.forEach((function(n,o){n.keyList.includes(e)&&t.push(o)})),t}}(Object(Ze.Record)(nt));var ot,rt,it;Ye.default.div(ot||(ot=Qe(["\n  display: flex;\n  width: 380px;\n  margin: 10px;\n  justify-content: center;\n  align-items: center;\n"],["\n  display: flex;\n  width: 380px;\n  margin: 10px;\n  justify-content: center;\n  align-items: center;\n"]))),Ye.default.div(rt||(rt=Qe(["\n  width: 300px;\n  text-decoration: underline;\n  cursor: pointer;\n"],["\n  width: 300px;\n  text-decoration: underline;\n  cursor: pointer;\n"]))),Ye.default.div(it||(it=Qe(["\n  width: 80px;\n"],["\n  width: 80px;\n"])));var at,ct,lt,st,ut;Ye.default.div(at||(at=Qe([""],[""]))),Ye.default.div(ct||(ct=Qe(["\n  padding: 10px;\n"],["\n  padding: 10px;\n"]))),Ye.default.div(lt||(lt=Qe(["\n  max-height: 200px;\n  overflow: auto;\n"],["\n  max-height: 200px;\n  overflow: auto;\n"]))),Ye.default.div(st||(st=Qe(["\n  font-size: 20px;\n  color: #106ba3;\n"],["\n  font-size: 20px;\n  color: #106ba3;\n"]))),Ye.default.div(ut||(ut=Qe(["\n  text-decoration: underline;\n  color: #106ba3;\n  cursor: pointer;\n"],["\n  text-decoration: underline;\n  color: #106ba3;\n  cursor: pointer;\n"])));var pt,dt,ft,mt,ht,yt=qe.a.ofType();Object(Ye.default)(yt)(pt||(pt=Qe(["\n  top: 20%;\n  left: 25% !important;\n  width: 50% !important;\n"],["\n  top: 20%;\n  left: 25% !important;\n  width: 50% !important;\n"]))),Ye.default.div(dt||(dt=Qe(["\n  margin: 0 5px;\n  padding: 10px 5px;\n  width: 100%;\n  font-size: 16px;\n  cursor: pointer;\n  &:hover {\n    background: #e3e8ec;\n  }\n"],["\n  margin: 0 5px;\n  padding: 10px 5px;\n  width: 100%;\n  font-size: 16px;\n  cursor: pointer;\n  &:hover {\n    background: #e3e8ec;\n  }\n"]))),Object(Ye.default)(Le.Popover)(ft||(ft=Qe(["\n  display: block;\n"],["\n  display: block;\n"]))),Ye.default.div(mt||(mt=Qe(["\n  padding: 10px;\n  font-size: 16px;\n  //max-width: 800px;\n  //max-height: 600px;\n  overflow: auto;\n"],["\n  padding: 10px;\n  font-size: 16px;\n  //max-width: 800px;\n  //max-height: 600px;\n  overflow: auto;\n"]))),Ye.default.div(ht||(ht=Qe(["\n  white-space: break-spaces;\n"],["\n  white-space: break-spaces;\n"])));function gt(e){return r.a.createElement("div",{className:"bm-toolbar-item ".concat(Object(_e.iconClassName)(_e.IconName.SEARCH)),onClick:function(t){var n=e.diagram.getDiagramProps();n.controller.run("operation",Object(m.a)(Object(m.a)({},n),{},{opType:Re.OpType.SET_FOCUS_MODE,focusMode:"FOCUS_MODE_SEARCH"}))}})}var vt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onClickUndo,n=e.onClickRedo,o=e.canUndo,i=e.canRedo,a=e.updateWsMap;e.navBack;return r.a.createElement("div",{className:"bm-toolbar"},r.a.createElement(je,e),r.a.createElement(Ue,e),r.a.createElement(He,e),r.a.createElement(Ie,e),r.a.createElement(gt,e),r.a.createElement("div",{className:De()("bm-toolbar-item",Object(_e.iconClassName)("undo"),{"bm-toolbar-item-disabled":!o}),onClick:t}),r.a.createElement("div",{className:De()("bm-toolbar-item",Object(_e.iconClassName)("redo"),{"bm-toolbar-item-disabled":!i}),onClick:n}),r.a.createElement("div",{className:"bm-toolbar-item iconfont",onClick:a},r.a.createElement("button",{className:"save-map"},"SAVE")))}}]),n}(r.a.PureComponent),Tt=(n(984),n(18)),bt=(n.n(Tt)()("app"),[Ee()(),Object(ke.ThemeSelectorPlugin)(),Object(Se.TopicReferencePlugin)(),Object(Se.SearchPlugin)(),Ce()(),Object(Oe.JsonSerializerPlugin)()]),Et=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).editNode=function(e){console.log("node in editNode func",e);var t=o.diagram.getDiagramProps(),n=t.controller,r=(t.model,n.run("serializeTopic",Object(m.a)(Object(m.a)({},t),{},{topic:e.model.getTopic(e.topicKey)}))),i=JSON.stringify(r),a=JSON.parse(i);o.props.togglePropertiesModal(a)},o.diagramRef=function(e){o.diagram=e,o.setState({})},o.bindUpdatedTitle=function(e,t,n){console.log("inside bindUpdateTitle function::tk::",e,"data::",t);var r=o.diagram.getDiagramProps().model,i=Ve.ModelModifier.setBlockData({model:r,topicKey:e,blockType:Ve.BlockType.CONTENT,data:t});i=Ve.ModelModifier.setProperties({model:r,topicKey:e,properties:n}),o.setState({model:i})},o.onClickUndo=function(e){var t=o.diagram.getDiagramProps();t.controller.run("undo",t)},o.onClickRedo=function(e){var t=o.diagram.getDiagramProps();t.controller.run("redo",t)},o.updateWsMap=function(){var e=o.props,t=e.activeWSProject,n=e.activeWorkspace;t.map=o.getMap(),console.log("activeWSProject.map",t.map),A(n,t).then((function(e){console.log("res in updateWSProject")})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&o.props.history.push("/")}))},o.navBack=function(){o.props.navBack()},o.onChange=function(e,t){o.setState({model:e},t)},o.getMap=function(){var e=o.diagram.getDiagramProps(),t=e.controller.run("serializeModel",e),n=JSON.stringify(t);return JSON.parse(n)},o.getTopicFromMap=function(e,t){for(var n=0;n<e.topics.length;n++){var o=e.topics[n];if(o.key==t.topicKey)return o}},o.initModel(),window.TThroo={editNode:o.editNode,bindUpdatedTitle:o.bindUpdatedTitle,getMap:o.getMap},o}return Object(u.a)(n,[{key:"initModel",value:function(){var e=this.props,t=e.workspaces,n=(e.activeWorkspace,function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=Object(Ve.createKey)(),r={rootTopicKey:o,topics:[{key:o,blocks:[{type:"CONTENT",data:"MainTopic"}]}],properties:{title:{quillText:"MainTopic"}}};return"string"==typeof e?1==(t=n.filter((function(t){return t._id==e._id}))).length&&t[0]&&t[0].map&&Object.keys(t[0].map).length>0&&(r=t[0].map):"object"==typeof e&&e.map&&(r=e.map),Ve.Model.create(r)}(e.activeWSProject,t));this.state={model:n}}},{key:"renderDiagram",value:function(){return r.a.createElement(Te.Diagram,{ref:this.diagramRef,model:this.state.model,onChange:this.onChange,plugins:bt})}},{key:"renderToolbar",value:function(){var e=this.diagram.getDiagramProps(),t=e.controller,n=t.run("canUndo",e),o=t.run("canRedo",e),i={diagram:this.diagram,onClickUndo:this.onClickUndo,onClickRedo:this.onClickRedo,canUndo:n,canRedo:o,updateWsMap:this.updateWsMap,navBack:this.navBack};return r.a.createElement(vt,i)}},{key:"componentDidUpdate",value:function(){this.initModel()}},{key:"render",value:function(){return r.a.createElement("div",{className:"mindmap"},this.diagram&&this.renderToolbar(),this.renderDiagram())}}]),n}(r.a.Component),Ot=(n(985),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={togglePropertiesModalSt:!1,topic:{}},e.navBack=function(){e.props.history.push("/workspace/".concat(e.props.match.params.workspace_id,"/dashboard"))},e.togglePropertiesModal=function(t){console.log("topic in edit module::",t),e.setState({togglePropertiesModalSt:!e.state.togglePropertiesModalSt,topic:t})},e.updateProperties=function(t,n){for(var o=window.TThroo.getMap(),r=0;r<o.topics.length;r++){var i=o.topics[r];if(i.key==t.key){i.properties=j(n);break}}console.log("updated map properties, this should have properties updated and should be saved::",o);var a=e.props.activeWSProject;a.map=o,e.props.setActiveWSProjectMW(a),window.TThroo.bindUpdatedTitle(t.key,n.title.quillText,n),A(e.props.match.params.workspace_id,a).then((function(e){console.log("res in updateWSProject")})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")})),e.setState({topic:t})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,n=t.workspace_id,o=t.id;console.log("workspace_id",n);var r=this.props.activeWSProject;console.log("about to get worksapcce data, activeWS",r),"object"==typeof r&&0==Object.keys(r).length&&N(n,o).then((function(t){console.log("calling the middle ware now",t),t&&t.list&&t.list[0]&&e.props.setActiveWSProjectMW(t.list[0])})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")}))}},{key:"render",value:function(){var e=this.state,t=e.togglePropertiesModalSt,n=e.topic,o=this.props.activeWSProject;return console.log("activeWSProject--##???",o),r.a.createElement(r.a.Fragment,null,0!=Object.keys(o).length?r.a.createElement(Et,{workspaces:[],activeWorkspace:this.props.match.params.workspace_id,activeWSProject:this.props.activeWSProject,projectId:this.props.match.params.id,navBack:this.navBack,togglePropertiesModal:this.togglePropertiesModal}):r.a.createElement("div",{className:"mindmap"},"Loading..."),t&&r.a.createElement(fe,{mode:"track",toggleEditModal:this.togglePropertiesModal,topic:n,updateProperties:this.updateProperties}))}}]),n}(o.Component)),kt=Object(l.g)(Object(a.b)((function(e){return{activeWSProject:e.wikis.activeWSProject}}),{setActiveWSProjectMW:S})(Ot)),xt=n(411),Ct=n.n(xt),St=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).notify=function(e){if(!o.state.ignore){var t=e,n={tag:Date.now(),body:"Hello"+new Date,icon:"http://localhost:3000/assets/web/tthroo-logo.png",lang:"en",dir:"ltr",sound:"./sound.mp3"};o.setState({title:t,options:n})}},o.ws=null,o.state={ignore:!0,title:""},o}return Object(u.a)(n,[{key:"handlePermissionGranted",value:function(){console.log("Permission Granted"),this.setState({ignore:!1})}},{key:"handlePermissionDenied",value:function(){console.log("Permission Denied"),this.setState({ignore:!0})}},{key:"handleNotSupported",value:function(){console.log("Web Notification not Supported"),this.setState({ignore:!0})}},{key:"handleNotificationOnClick",value:function(e,t){console.log(e,"Notification clicked tag:"+t)}},{key:"handleNotificationOnError",value:function(e,t){console.log(e,"Notification error tag:"+t)}},{key:"handleNotificationOnClose",value:function(e,t){console.log(e,"Notification closed tag:"+t)}},{key:"handleNotificationOnShow",value:function(e,t){this.playSound(),console.log(e,"Notification shown tag:"+t)}},{key:"playSound",value:function(e){document.getElementById("sound").play()}},{key:"handleButtonClick",value:function(){this.notify("On Click Reminder")}},{key:"handleButtonClick2",value:function(){this.props.swRegistration.getNotifications({}).then((function(e){console.log(e)}))}},{key:"componentDidMount",value:function(){var e=this;this.ws=new WebSocket("ws://localhost:3200"),this.ws.onopen=function(t){console.log("Browser client has established connection with server, sending user_id, project_id to websocket");var n={user_id:localStorage.getItem("user_id"),project_id:e.props.id};e.ws.send(JSON.stringify(n))},this.ws.onmessage=function(t){console.log("message received from server, this is about an alert, see for task_id and alert notification",t.data),e.notify("Project Reminder - Sometimes Project title can be huge, need to dig in how this one appears now")}}},{key:"componentWillUnmount",value:function(){this.ws.send("close"),this.ws.close()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("button",{onClick:this.handleButtonClick.bind(this)},"Notif!"),"swExample"===document.title&&r.a.createElement("button",{onClick:this.handleButtonClick2.bind(this)},"swRegistration.getNotifications"),r.a.createElement(Ct.a,{ignore:this.state.ignore&&""!==this.state.title,notSupported:this.handleNotSupported.bind(this),onPermissionGranted:this.handlePermissionGranted.bind(this),onPermissionDenied:this.handlePermissionDenied.bind(this),onShow:this.handleNotificationOnShow.bind(this),onClick:this.handleNotificationOnClick.bind(this),onClose:this.handleNotificationOnClose.bind(this),onError:this.handleNotificationOnError.bind(this),timeout:5e3,title:this.state.title,options:this.state.options,swRegistration:this.props.swRegistration}),r.a.createElement("audio",{id:"sound",preload:"auto"},r.a.createElement("source",{src:"/reminders-sound/sound.mp3",type:"audio/mpeg"}),r.a.createElement("source",{src:"/reminders-sound/sound.ogg",type:"audio/ogg"}),r.a.createElement("embed",{hidden:!0,autostart:"false",loop:!1,src:"./sound.mp3"})))}}]),n}(o.Component),wt=(n(986),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).ws=null,e.formatAMPM=function(e){var t=1==e.getMinutes().toString().length?"0"+e.getMinutes():e.getMinutes(),n=1==e.getHours().toString().length?"0"+e.getHours():e.getHours(),o=e.getHours()>=12?"pm":"am";return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]+" "+e.getDate()+" "+e.getFullYear()+" "+n+":"+t+o},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){(0,this.props.setActiveProjectMW)(this.props.match.params.id)}},{key:"calcDuration",value:function(e){this.setState({duration:ue(e.startTime,e.endTime).val})}},{key:"render",value:function(){var e=this,t=this.props,n=t.isSidebarOpen,o=t.projects,i=t.activeProjectId,a=t.updateProjectMW,c=o[i].tasks,l=Object.keys(o[i].tasks);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:n?"dv":"dv toggle"},r.a.createElement("div",{className:"reminders"},r.a.createElement("table",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Task"),r.a.createElement("th",null,"Start Time"),r.a.createElement("th",null,"End Time"),r.a.createElement("th",null,"Duration"),r.a.createElement("th",null,"Remind me at")),l.map((function(t){return r.a.createElement("tr",null,r.a.createElement("td",{className:"title-col-width"},c[t].title.quillText),r.a.createElement("td",null,r.a.createElement(ce,{viewMode:"time",timeFormat:!0,value:c[t].startTime,inputProps:{placeholder:"Enter start time",readOnly:!0},onChange:function(n){a({id:e.props.match.params.id,tid:c[t].id,key:"startTime",val:n.toDate()})}})),r.a.createElement("td",null,r.a.createElement(ce,{viewMode:"time",timeFormat:!0,value:c[t].endTime,inputProps:{placeholder:"Enter end time",readOnly:!0},onChange:function(n){a({id:e.props.match.params.id,tid:c[t].id,key:"endTime",val:n.toDate()})}})),r.a.createElement("td",null,ue(c[t].startTime,c[t].endTime).val),r.a.createElement("td",null,r.a.createElement(ce,{viewMode:"time",timeFormat:!0,value:c[t].endTime,inputProps:{placeholder:"Enter start time",readOnly:!0,disabled:!0}})))}))),r.a.createElement(St,{id:this.props.match.params.id}))))}}]),n}(o.Component)),Dt=Object(l.g)(Object(a.b)((function(e){return{projects:e.projects.list,activeProjectId:e.projects.activeProjectId,tasksCount:e.projects.list[e.projects.activeProjectId].tasksCount}}),{setActiveProjectMW:U,updateProjectMW:V})(wt)),_t=(n(987),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,n=t.workspace_id,o=t.id;console.log("workspace_id",n);var r=this.props.activeWSProject;console.log("about to get worksapcce data, activeWS",r),"object"==typeof r&&0==Object.keys(r).length&&N(n,o).then((function(t){console.log("calling the middle ware now",t),t&&t.list&&t.list[0]&&e.props.setActiveWSProjectMW(t.list[0])})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")}))}},{key:"render",value:function(){var e,t=this.props.activeWSProject,n=t.title,o=t.map;return null!=o&&o.topics&&(e=o.topics),console.log("topics:",e),r.a.createElement("div",{className:"dv assess"},0!=Object.keys(t).length?r.a.createElement("div",{className:"assess-container"},r.a.createElement("h1",null,n&&n.quillText),r.a.createElement("div",{className:"assess-topics-container"},r.a.createElement("table",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Title"),r.a.createElement("th",null,"Status"),r.a.createElement("th",null,"Start Time"),r.a.createElement("th",null,"End Time"),r.a.createElement("th",null,"Duration"),r.a.createElement("th",null,"Reward")),e&&e.map((function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,e.blocks[0].data),r.a.createElement("td",null,"-"),r.a.createElement("td",null,"-"),r.a.createElement("td",null,"-"),r.a.createElement("td",null,"duration"),r.a.createElement("td",null,"-"))}))))):r.a.createElement("div",null,"Loading..."))}}]),n}(o.Component)),jt=Object(l.g)(Object(a.b)((function(e){return{activeWSProject:e.wikis.activeWSProject}}),{setActiveWSProjectMW:S})(_t)),Rt=n(36),Lt=(n(988),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).dataProcessor=null,o.specifyColumns=function(){var e={type:"date",map_to:"start_date",min:new Date(2018,0,1)};Rt.gantt.config.columns=[{name:"text",label:"Task name",tree:!0,width:"*",editor:{type:"text",map_to:"text"}},{name:"start_date",label:"Start Date",width:120,align:"center",editor:e},{name:"duration",label:"Duration",align:"center",editor:{type:"number",map_to:"duration",min:0,max:100}},{name:"add",width:44}],Rt.gantt.config.min_duration=36e5},o.setupQuickInfo=function(){Rt.gantt.config.quickinfo_buttons=["icon_delete","icon_edit","view_mindmap"],Rt.gantt.locale.labels.view_mindmap="View Mindmap",Rt.gantt.$click.buttons.view_mindmap=function(e){return alert("These are view_mindmap details"),!1}},o.initZoom(),o}return Object(u.a)(n,[{key:"initZoom",value:function(){Rt.gantt.ext.zoom.init({levels:[{name:"Hours",scale_height:60,min_column_width:30,scales:[{unit:"day",step:1,format:"%d %M"},{unit:"hour",step:1,format:"%H"}]},{name:"Days",scale_height:60,min_column_width:70,scales:[{unit:"week",step:1,format:"Week #%W"},{unit:"day",step:1,format:"%d %M"}]},{name:"Months",scale_height:60,min_column_width:70,scales:[{unit:"month",step:1,format:"%F"},{unit:"week",step:1,format:"#%W"}]},{name:"Quarter",height:50,min_column_width:90,scales:[{unit:"month",step:1,format:"%M"},{unit:"quarter",step:1,format:function(e){var t=Rt.gantt.date.date_to_str("%M"),n=Rt.gantt.date.add(Rt.gantt.date.add(e,3,"month"),-1,"day");return t(e)+" - "+t(n)}}]},{name:"Year",scale_height:50,min_column_width:30,scales:[{unit:"year",step:1,format:"%Y"}]}]})}},{key:"setZoom",value:function(e){Rt.gantt.ext.zoom.setLevel(e)}},{key:"initGanttDataProcessor",value:function(){var e=this.props.onDataUpdated;this.dataProcessor=Rt.gantt.createDataProcessor((function(t,n,o,r){return new Promise((function(i,a){return e&&e(t,n,o,r),i()}))}))}},{key:"shouldComponentUpdate",value:function(e){return this.props.zoom!==e.zoom}},{key:"componentDidMount",value:function(){Rt.gantt.config.xml_date="%Y-%m-%d %H:%i";var e=this.props.tasks;console.log("gantt:",Rt.gantt),Rt.gantt.plugins({tooltip:!0,quick_info:!0}),this.specifyColumns(),this.setupQuickInfo(),Rt.gantt.init(this.ganttContainer),Rt.gantt.templates.tooltip_text=function(e,t,n){return"<b>Task:</b> "+n.text+"<br/><b>Start date:</b> "+Rt.gantt.templates.tooltip_date_format(e)+"<br/><b>End date:</b> "+Rt.gantt.templates.tooltip_date_format(t)},Rt.gantt.config.lightbox.sections=[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"period",height:72,map_to:"auto",type:"time",time_format:["%H:%i","%d","%m","%Y"]}],Rt.gantt.locale.labels.section_period="Time period",this.initGanttDataProcessor(),Rt.gantt.parse(e)}},{key:"componentWillUnmount",value:function(){this.dataProcessor&&(this.dataProcessor.destructor(),this.dataProcessor=null)}},{key:"render",value:function(){var e=this,t=this.props.zoom;return this.setZoom(t),r.a.createElement("div",{ref:function(t){e.ganttContainer=t},style:{width:"100%",height:"100%"}})}}]),n}(o.Component)),It=(n(989),Lt),Pt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleZoomChange=function(t){e.props.onZoomChange&&e.props.onZoomChange(t.target.value)},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=["Hours","Days","Months","Quarter","Year"].map((function(t){var n=e.props.zoom===t;return r.a.createElement("label",{key:t,className:"radio-label ".concat(n?"radio-label-active":"")},r.a.createElement("input",{type:"radio",checked:n,onChange:e.handleZoomChange,value:t}),t)}));return r.a.createElement("div",{className:"tool-bar"},r.a.createElement("b",null,"Zoom: "),t)}}]),n}(o.Component),Mt=(n(990),Pt),Kt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.messages.map((function(e){var t=e.message;return r.a.createElement("li",{key:Math.random()},t)}));return r.a.createElement("div",{className:"message-area"},r.a.createElement("h3",null,"Messages:"),r.a.createElement("ul",null,e))}}]),n}(o.Component);Kt.defaultProps={messages:[]};n(991),n(992);var Nt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={currentZoom:"Days",messages:[],roadmap:{data:[],links:[]}},e.updateRoadmap=function(t,n,o,r){var i=e.state.roadmap;if("task"==t)if("create"==n){var a=Object(m.a)({},o);i.data.push(a)}else if("update"==n)for(var c=0;c<i.data.length;c++)if(r==i.data[c].id){i.data[c]=o;break}e.setState({roadmap:i},(function(){var t=e.props.match.params,n=t.workspace_id,o=t.id;M({roadmap:i},n,o)}))},e.logDataUpdate=function(t,n,o,r){console.log("type:",t,"action:",n,"item:",o,"id:",r),delete n["!nativeeditor_status"],e.updateRoadmap(t,n,o,r)},e.handleZoomChange=function(t){e.setState({currentZoom:t})},e.handleRoadmapGanttParse=function(t){t&&Object.keys(t).includes("data")&&(e.setState({roadmap:t}),Rt.gantt.parse(t))},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,n=t.workspace_id,o=t.id;console.log("workspace_id",n);var r=this.props.activeWSProject;console.log("about to get worksapcce data, activeWS",r),"object"==typeof r&&0==Object.keys(r).length?N(n,o).then((function(t){console.log("calling the middle ware now",t),t&&t.list&&t.list[0]&&(e.props.setActiveWSProjectMW(t.list[0]),e.handleRoadmapGanttParse(t.list[0].roadmap))})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")})):this.handleRoadmapGanttParse(r.roadmap)}},{key:"render",value:function(){var e=this.state,t=e.currentZoom,n=(e.messages,e.roadmap);return console.log("roadmap set?:",n),r.a.createElement("div",{className:"tthroo-roadmap"},r.a.createElement("div",{className:"zoom-bar"},r.a.createElement(Mt,{zoom:t,onZoomChange:this.handleZoomChange})),r.a.createElement("div",{className:"gantt-container"},r.a.createElement(It,{tasks:n,zoom:t,onDataUpdated:this.logDataUpdate})))}}]),n}(o.Component),At=Object(l.g)(Object(a.b)((function(e){return{activeWSProject:e.wikis.activeWSProject}}),{setActiveWSProjectMW:S})(Nt)),Ft=(n(993),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id;U(e)}},{key:"render",value:function(){var e=this.props.match.params.phase,t=this.props.activeWSProject,n=null;return"edit"==e?n=r.a.createElement(kt,null):"assess"==e?n=r.a.createElement(jt,null):"reminders"==e?n=r.a.createElement(Dt,null):"roadmap"==e&&(n=r.a.createElement(At,null)),r.a.createElement(r.a.Fragment,null,r.a.createElement(ye,{title:t&&t.title?t.title:null}),r.a.createElement("div",{className:"project-sb-w"},r.a.createElement(ve,null)),n||r.a.createElement("div",null,"Page you are looking for is not found."))}}]),n}(o.Component)),Bt=Object(l.g)(Object(a.b)((function(e){return{meta:e.projects,activeProjectId:e.projects.activeProjectId,activeWSProject:e.wikis.activeWSProject}}),{setActiveProjectMW:U})(Ft)),Wt=n(115),zt=n(413),Gt=void 0,Ht=function(){var e=Object(o.useState)(""),t=Object(Wt.a)(e,2),n=t[0],i=t[1],a=Object(o.useState)(""),c=Object(Wt.a)(a,2),s=c[0],u=c[1],p=Object(o.useState)(""),d=Object(Wt.a)(p,2),f=d[0],m=d[1],h=Object(o.useState)(!1),g=Object(Wt.a)(h,2),v=g[0],T=g[1],b=Object(o.useState)(!0),E=Object(Wt.a)(b,2),O=E[0],k=E[1],x=new zt.a,C=Object(l.f)(),S=function(e){"email"===e.target.name?i(e.target.value):"password"===e.target.name?u(e.target.value):m(e.target.value)},w=function(e){k("register"!==e)},D=function(e,t){e.preventDefault();var o={email:n,password:s};"register"===t?s!==f?T(!0):(o.offsetForTz=(new Date).getTimezoneOffset(),function(e){return new Promise((function(t,n){fetch(y.register,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){console.log("Success register:",e),t(e)})).catch((function(e){console.error("Error:",e),n(e)}))}))}(o).then((function(e){x.set("token",e.token),_(e)})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&Gt.props.history.push("/")}))):function(e){return new Promise((function(t,n){fetch(y.login,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){if(e.ok)return e.json();throw{msg:e.statusText,status:e.status}})).then((function(e){console.log("Success login:",e),t(e)})).catch((function(e){console.error("Error:",e),n(e)}))}))}(o).then((function(e){_(e),C.push("/workspaces")})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&Gt.props.history.push("/")}))},_=function(e){localStorage.setItem("token",e.token),localStorage.setItem("user_id",e.user_id),localStorage.setItem("offsetForTz",e.offsetForTz)};return r.a.createElement("div",null,O?r.a.createElement("form",{onSubmit:function(e){return D(e,"login")}},r.a.createElement("span",null,"Login:"),r.a.createElement("div",null,r.a.createElement("label",null,"Email:"),r.a.createElement("input",{type:"email",name:"email",value:n,onChange:S,required:!0})),r.a.createElement("div",null,r.a.createElement("label",null,"Password:"),r.a.createElement("input",{type:"password",name:"password",value:s,onChange:S,required:!0})),r.a.createElement("div",null,r.a.createElement("input",{type:"submit",value:"Submit"})),r.a.createElement("span",{onClick:function(){return w("register")}},"New to tthroo? register")):r.a.createElement("form",{onSubmit:function(e){return D(e,"register")}},r.a.createElement("span",null,"Register:"),r.a.createElement("div",null,r.a.createElement("label",null,"Email:"),r.a.createElement("input",{type:"email",name:"email",value:n,onChange:S,required:!0})),r.a.createElement("div",null,r.a.createElement("label",null,"Password:"),r.a.createElement("input",{type:"password",name:"password",value:s,onChange:S,required:!0})),r.a.createElement("div",null,r.a.createElement("label",null,"Confirm Password:"),r.a.createElement("input",{type:"password",name:"cpassword",value:f,onChange:S,required:!0})),r.a.createElement("input",{type:"submit",value:"Submit"}),v?r.a.createElement("div",null,"Passwords won't match, Please check again."):null,r.a.createElement("span",{onClick:function(){return w("login")}},"Existing User? Login.")))},Vt=(n(994),function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).handleChange=function(e){o.setState({workspace:e.target.value})},o.addToWorkspaces=function(){var e=o.state.workspace,t=o.props.workspaces.length;o.props.addWorkspaceMW(e,t),o.setState({workspace:""})},o.handleWsClick=function(e){console.log("ws::",e),o.props.setActiveWSProjectMW(e),o.props.history.push("/workspace/"+e._id+"/dashboard")},o.deleteWorkspace=function(e,t){e.stopPropagation(),O(t._id).then((function(e){o.props.deleteWorkspaceMw(t)})).catch((function(e){console.log("e::",e),401==e.status&&"unauthorized"==e.msg.toLowerCase()&&o.props.history.push("/")}))},o.state={workspace:""},o}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;E().then((function(t){console.log("res from getWorkspaces",t),e.props.setWorkspacesMw(t.list)})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")}))}},{key:"render",value:function(){var e=this,t=this.state.workspace,n=this.props.workspaces;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("span",null,"Workspaces:"),r.a.createElement("span",null,r.a.createElement("input",{type:"text",value:t,onChange:this.handleChange}),r.a.createElement("button",{onClick:this.addToWorkspaces},"Add"))),r.a.createElement("ul",{className:"ws-ls"},n.map((function(t){return r.a.createElement("li",{className:"ws-list",onClick:function(){return e.handleWsClick(t)}},r.a.createElement("span",null,t.name),r.a.createElement("button",{className:"del-ws",onClick:function(n){return e.deleteWorkspace(n,t)}},"Delete"))}))))}}]),n}(o.Component)),Ut=Object(l.g)(Object(a.b)((function(e){return{activeWorkspace:e.wikis.activeWorkspace,workspaces:e.wikis.workspaces}}),{addWorkspaceMW:x,setWorkspacesMw:C,setActiveWSProjectMW:S,deleteWorkspaceMw:w})(Vt)),Yt=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).navBack=function(){o.props.history.push("/workspaces")},o}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.workspace_id;console.log("workspace_id",t);var n=this.props,o=(n.workspaces,n.activeWorkspace,n.activeWSProject);console.log("about to get worksapcce data, activeWS",o),"object"==typeof o&&0==Object.keys(o).length&&N(t).then((function(t){console.log("calling the middle ware now",t),t&&t.list&&t.list[0]&&e.props.setActiveWSProjectMW(t.list[0])})).catch((function(t){console.log("e::",t),401==t.status&&"unauthorized"==t.msg.toLowerCase()&&e.props.history.push("/")}))}},{key:"render",value:function(){var e=this.props,t=e.workspaces,n=e.activeWorkspace,o=e.activeWSProject;return r.a.createElement("div",null,0!=Object.keys(o).length?r.a.createElement(Et,{workspaces:t,activeWorkspace:n,navBack:this.navBack}):r.a.createElement("div",null,"Loading..."))}}]),n}(o.Component),Zt=Object(l.g)(Object(a.b)((function(e){return{activeWorkspace:e.wikis.activeWSProject,workspaces:e.wikis.workspaces}}),{setActiveWSProjectMW:S})(Yt));n(995);var qt=function(){return r.a.createElement(c.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,path:"/"},r.a.createElement(Ht,null)),r.a.createElement(l.a,{path:"/workspace/:workspace_id/dashboard"},r.a.createElement(he,null)),r.a.createElement(l.a,{path:"/workspace/:workspace_id/project/:id/:phase"},r.a.createElement(Bt,null)),r.a.createElement(l.a,{path:"/workspaces"},r.a.createElement(Ut,null)),r.a.createElement(l.a,{path:"/workspace/:workspace_id"},r.a.createElement(Zt,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Jt=n(93),Xt=n(412),Qt=(n(996),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TASK":return[].concat(Object(f.a)(e),[{id:t.id,text:t.text,completed:!1}]);default:return e}}),$t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_EVENTS":return[].concat(Object(f.a)(e),Object(f.a)(t.events));case"ADD_EVENT":return[].concat(Object(f.a)(e),[t.event]);default:return e}},en=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{value:"calendar"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APPLY_FILTER":return Object(m.a)(Object(m.a)({},e),{},{value:t.filter});default:return e}},tn={nto:[],dtCount:0,date:new Date},nn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_NAV_OPT":return Object(m.a)(Object(m.a)({},e),{},{nto:Object(f.a)(t.tlOptions)});case"UPDATE_DT_COUNT":return Object(m.a)(Object(m.a)({},e),{},{dtCount:0===t.value?t.value:e.dtCount+t.value});case"UPDATE_DT":return Object(m.a)(Object(m.a)({},e),{},{date:t.date});default:return e}},on={label:{active:"Work",data:[{label:"Work"},{label:"TThroo"}]},status:{active:"Todo",data:[{label:"Todo"},{label:"Doing"},{label:"Done"}]},date:{activeDate:new Date}},rn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:on,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DATE":return Object(m.a)(Object(m.a)({},e),{},{date:Object(m.a)(Object(m.a)({},e.date),{},{activeDate:t.activeDate})});case"SET_STATUS":return Object(m.a)(Object(m.a)({},e),{},{status:Object(m.a)(Object(m.a)({},e.status),{},{active:t.activeStatus})});case"SET_LABEL":return Object(m.a)(Object(m.a)({},e),{},{label:Object(m.a)(Object(m.a)({},e.label),{},{active:t.activeLabel})});case"ADD_LABEL":return Object(m.a)(Object(m.a)({},e),{},{label:Object(m.a)(Object(m.a)({},e.label),{},{data:[].concat(Object(f.a)(e.label.data),[{label:t.label}])})});case"DELETE_LABEL":var n;return n=t.index>0?e.label.data[t.index-1]:e.label.data[t.index+1],Object(m.a)(Object(m.a)({},e),{},{label:Object(m.a)(Object(m.a)({},e.label),{},{data:e.label.data.filter((function(e,n){return n!==t.index})),active:n&&n.label?n.label:null})});case"ADD_STATUS":return Object(m.a)(Object(m.a)({},e),{},{status:Object(m.a)(Object(m.a)({},e.status),{},{data:[].concat(Object(f.a)(e.status.data),[{label:t.label}])})});case"DELETE_STATUS":return t.index>0?e.status.data[t.index-1]:e.status.data[t.index+1],Object(m.a)(Object(m.a)({},e),{},{status:Object(m.a)(Object(m.a)({},e.status),{},{data:e.status.data.filter((function(e,n){return n!==t.index}))})});default:return e}},an={list:{},activeProjectId:null,interval:null},cn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:an,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ACTIVE_PROJECT":return Object(m.a)(Object(m.a)({},e),{},{activeProjectId:t.id});case"ADD_PROJECT":var n=Object(m.a)({},e);return void 0==t.tid?(t.project._id=t._id,n.list[t._id]=Object.assign({},t.project),n):(n.list[t._id].tasks[t.tid]=Object.assign({},t.project),n);case"UPDATE_PROJECT":var o=Object(m.a)({},e);return o.list[t.id]=Object(m.a)(Object(m.a)({},o.list[t.id]),{},Object(te.a)({},t.key,t.val)),t.interval&&(o.list[t.id]=Object(m.a)(Object(m.a)({},o.list[t.id]),{},{interval:t.interval})),Boolean(t.id)?o:e;case"UPDATE_PROJECT_TASK":var r=Object(m.a)({},e),i=t.tid;return r.list[t.id].tasks[i]=Object(m.a)(Object(m.a)({},r.list[t.id].tasks[i]),{},Object(te.a)({},t.key,t.val)),t.interval&&(r.list[t.id].tasks[i]=Object(m.a)(Object(m.a)({},r.list[t.id].tasks[i]),{},{interval:t.interval})),null!=t.id?r:e;case"DEL_PROJECT":var a=Object(m.a)({},e);return delete a.list[t.id],a;case"CLEAR_STs":var c=Object.assign({},e);return c.list[t.id].tasks={},c;case"SET_PROJECTS":var l=B.a.cloneDeep(e);return l.list=t.list,l;default:return e}},ln={id:"",meta:{isSet:!1,title:{quill:null,quillContent:[],quillText:null,value:"",toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Title"},description:{quill:null,quillContent:[],quillText:null,value:"",toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Description"},outcome:{quill:null,quillContent:[],quillText:null,value:"",toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Outcome"},reward:{quill:null,quillContent:[],quillText:null,value:"",toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]],placeholder:"Enter Reward"},startTime:null,endTime:null,label:"",status:"",duration:null,reminders:null},map:{},track:{},analyse:{}},sn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_META":return Object(m.a)(Object(m.a)({},e),{},{meta:t.meta});case"SET_META_OBJ":return Object(m.a)(Object(m.a)({},e),{},{meta:Object(m.a)(Object(m.a)({},e.meta),{},Object(te.a)({},t.key,t.val))});default:return e}},un={activeWSProject:{},workspaces:[]},pn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:un,t=arguments.length>1?arguments[1]:void 0,n=e.workspaces;switch(t.type){case"ADD_WORKSPACE":return void 0==t.index&&(t.index=n.length),Object(m.a)(Object(m.a)({},e),{},{workspaces:[].concat(Object(f.a)(n.slice(0,t.index)),[t.workspace],Object(f.a)(n.slice(t.index)))});case"SET_WORKSPACES":return Object(m.a)(Object(m.a)({},e),{},{workspaces:t.workspaces});case"SET_ACTIVE_WS_PROJECT":return Object(m.a)(Object(m.a)({},e),{},{activeWSProject:Object(m.a)({},t.activeWSProject)});case"DELETE_WORKSPACE":var o,r=n.filter((function(e){return e._id==t.index}));return 1==r.length&&(o=n.indexOf(r[0]),console.log("FOUND INDEX::",o)),Object(m.a)(Object(m.a)({},e),{},{workspaces:[].concat(Object(f.a)(n.slice(0,o)),Object(f.a)(n.slice(o+1)))});default:return e}},dn={title:"",description:"",projectType:"map"},fn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_PROJECT_MODAL":return Object(m.a)(Object(m.a)({},e),t.meta);default:return e}},mn=Object(Jt.c)({tasks:Qt,events:$t,filter:en,notes:nn,sideBar:rn,projects:cn,activeProject:sn,wikis:pn,projectModal:fn}),hn=[Xt.a];var yn=Object(Jt.d)(mn,Jt.a.apply(void 0,hn));n(997);Object(i.render)(r.a.createElement(a.a,{store:yn},r.a.createElement(qt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},999:function(e,t,n){"use strict";function o(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}function r(e){var t,n;return!1!==o(e)&&("function"===typeof(t=e.constructor)&&(!1!==o(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))}n.r(t),n.d(t,"default",(function(){return r}))}}]);
//# sourceMappingURL=chunk-blinkmind.fbda846f.chunk.js.map